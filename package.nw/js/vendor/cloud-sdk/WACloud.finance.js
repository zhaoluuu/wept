;(function() {
try{
  var loadStart = Date.now()
  this.globalThis || (this.globalThis = this)
var __cloudSDK__=function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s="./src/index.ts")}({"../../../cloud-crypto/dist/index.js":function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),function(process,Buffer,global){function asyncGeneratorStep(e,t,r,n,o,i,s){try{var a=e[i](s),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(n,o)}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function s(e){asyncGeneratorStep(i,n,o,s,a,"next",e)}function a(e){asyncGeneratorStep(i,n,o,s,a,"throw",e)}s(void 0)})}}__webpack_require__.d(__webpack_exports__,"AppProtocolV1",function(){return AppProtocolV1}),__webpack_require__.d(__webpack_exports__,"SM",function(){return sm_exports}),__webpack_require__.d(__webpack_exports__,"V1",function(){return v1_exports}),__webpack_require__.d(__webpack_exports__,"V3",function(){return v3_exports}),__webpack_require__.d(__webpack_exports__,"loadAccelerator",function(){return loadAccelerator});var __create=Object.create,__defProp=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__getOwnPropNames=Object.getOwnPropertyNames,__getProtoOf=Object.getPrototypeOf,__hasOwnProp=Object.prototype.hasOwnProperty,__esm=(e,t)=>(function(){return e&&(t=(0,e[__getOwnPropNames(e)[0]])(e=0)),t}),__commonJS=(e,t)=>(function(){return t||(0,e[__getOwnPropNames(e)[0]])((t={exports:{}}).exports,t),t.exports}),__export=(e,t)=>{for(var r in t)__defProp(e,r,{get:t[r],enumerable:!0})},__copyProps=(e,t,r,n)=>{if(t&&"object"==typeof t||"function"==typeof t){var o=function(o){__hasOwnProp.call(e,o)||o===r||__defProp(e,o,{get:()=>t[o],enumerable:!(n=__getOwnPropDesc(t,o))||n.enumerable})};for(var i of __getOwnPropNames(t))o(i)}return e},__toESM=(e,t,r)=>(r=null!=e?__create(__getProtoOf(e)):{},__copyProps(!t&&e&&e.__esModule?r:__defProp(r,"default",{value:e,enumerable:!0}),e)),init_esm_shims=__esm({"node_modules/.pnpm/tsup@5.12.9_@swc+core@1.2.245_typescript@4.8.2/node_modules/tsup/assets/esm_shims.js"(){}}),require_snappy_decompressor=__commonJS({"node_modules/.pnpm/snappyjs@0.7.0/node_modules/snappyjs/snappy_decompressor.js"(e){init_esm_shims();var t=[0,255,65535,16777215,4294967295];function r(e,t,r,n,o){var i;for(i=0;i<o;i++)r[n+i]=e[t+i]}function n(e,t,r,n){var o;for(o=0;o<n;o++)e[t+o]=e[t-r+o]}function o(e){this.array=e,this.pos=0}o.prototype.readUncompressedLength=function(){for(var e,t,r=0,n=0;n<32&&this.pos<this.array.length;){if(e=this.array[this.pos],this.pos+=1,(t=127&e)<<n>>>n!==t)return-1;if(r|=t<<n,e<128)return r;n+=7}return-1},o.prototype.uncompressToBuffer=function(e){for(var o,i,s,a,c=this.array,u=c.length,l=this.pos,d=0;l<c.length;)if(o=c[l],l+=1,0==(3&o)){if((i=1+(o>>>2))>60){if(l+3>=u)return!1;s=i-60,i=1+((i=c[l]+(c[l+1]<<8)+(c[l+2]<<16)+(c[l+3]<<24))&t[s]),l+=s}if(l+i>u)return!1;r(c,l,e,d,i),l+=i,d+=i}else{switch(3&o){case 1:i=4+(o>>>2&7),a=c[l]+(o>>>5<<8),l+=1;break;case 2:if(l+1>=u)return!1;i=1+(o>>>2),a=c[l]+(c[l+1]<<8),l+=2;break;case 3:if(l+3>=u)return!1;i=1+(o>>>2),a=c[l]+(c[l+1]<<8)+(c[l+2]<<16)+(c[l+3]<<24),l+=4}if(0===a||a>d)return!1;n(e,d,a,i),d+=i}return!0},e.SnappyDecompressor=o}}),require_snappy_compressor=__commonJS({"node_modules/.pnpm/snappyjs@0.7.0/node_modules/snappyjs/snappy_compressor.js"(e){init_esm_shims();var t=14,r=new Array(t+1);function n(e,t){return 506832829*e>>>t}function o(e,t){return e[t]+(e[t+1]<<8)+(e[t+2]<<16)+(e[t+3]<<24)}function i(e,t,r){return e[t]===e[r]&&e[t+1]===e[r+1]&&e[t+2]===e[r+2]&&e[t+3]===e[r+3]}function s(e,t,r,n,o){return r<=60?(n[o]=r-1<<2,o+=1):r<256?(n[o]=240,n[o+1]=r-1,o+=2):(n[o]=244,n[o+1]=r-1&255,n[o+2]=r-1>>>8,o+=3),function(e,t,r,n,o){var i;for(i=0;i<o;i++)r[n+i]=e[t+i]}(e,t,n,o,r),o+r}function a(e,t,r,n){return n<12&&r<2048?(e[t]=1+(n-4<<2)+(r>>>8<<5),e[t+1]=255&r,t+2):(e[t]=2+(n-1<<2),e[t+1]=255&r,e[t+2]=r>>>8,t+3)}function c(e,t,r,n){for(;n>=68;)t=a(e,t,r,64),n-=64;return n>64&&(t=a(e,t,r,60),n-=60),a(e,t,r,n)}function u(e,a,u,l,d){for(var p=1;1<<p<=u&&p<=t;)p+=1;var f=32-(p-=1);void 0===r[p]&&(r[p]=new Uint16Array(1<<p));var _,m=r[p];for(_=0;_<m.length;_++)m[_]=0;var h,g,v,y,E,b,S,T,A,w,C=a+u,I=a,O=a,R=!0;if(u>=15)for(h=C-15,v=n(o(e,a+=1),f);R;){b=32,y=a;do{if(g=v,S=b>>>5,b+=1,y=(a=y)+S,a>h){R=!1;break}v=n(o(e,y),f),E=I+m[g],m[g]=a-I}while(!i(e,a,E));if(!R)break;d=s(e,O,a-O,l,d);do{for(T=a,A=4;a+A<C&&e[a+A]===e[E+A];)A+=1;if(a+=A,d=c(l,d,T-E,A),O=a,a>=h){R=!1;break}m[n(o(e,a-1),f)]=a-1-I,E=I+m[w=n(o(e,a),f)],m[w]=a-I}while(i(e,a,E));if(!R)break;v=n(o(e,a+=1),f)}return O<C&&(d=s(e,O,C-O,l,d)),d}function l(e){this.array=e}l.prototype.maxCompressedLength=function(){var e=this.array.length;return 32+e+Math.floor(e/6)},l.prototype.compressToBuffer=function(e){var t,r=this.array,n=r.length,o=0,i=0;for(i=function(e,t,r){do{t[r]=127&e,(e>>>=7)>0&&(t[r]+=128),r+=1}while(e>0);return r}(n,e,i);o<n;)i=u(r,o,t=Math.min(n-o,65536),e,i),o+=t;return i},e.SnappyCompressor=l}}),require_snappyjs=__commonJS({"node_modules/.pnpm/snappyjs@0.7.0/node_modules/snappyjs/index.js"(e){function t(){return"object"==typeof process&&"object"==typeof process.versions&&void 0!==process.versions.node}function r(e){return e instanceof Uint8Array&&(!t()||!Buffer.isBuffer(e))}function n(e){return e instanceof ArrayBuffer}function o(e){return!!t()&&Buffer.isBuffer(e)}init_esm_shims();var i=require_snappy_decompressor().SnappyDecompressor,s=require_snappy_compressor().SnappyCompressor,a="Argument compressed must be type of ArrayBuffer, Buffer, or Uint8Array";e.uncompress=function(e,t){if(!r(e)&&!n(e)&&!o(e))throw new TypeError(a);var s=!1,c=!1;r(e)?s=!0:n(e)&&(c=!0,e=new Uint8Array(e));var u,l,d=new i(e),p=d.readUncompressedLength();if(-1===p)throw new Error("Invalid Snappy bitstream");if(p>t)throw new Error("The uncompressed length of ".concat(p," is too big, expect at most ").concat(t));if(s){if(u=new Uint8Array(p),!d.uncompressToBuffer(u))throw new Error("Invalid Snappy bitstream")}else if(c){if(u=new ArrayBuffer(p),l=new Uint8Array(u),!d.uncompressToBuffer(l))throw new Error("Invalid Snappy bitstream")}else if(u=Buffer.alloc(p),!d.uncompressToBuffer(u))throw new Error("Invalid Snappy bitstream");return u},e.compress=function(e){if(!r(e)&&!n(e)&&!o(e))throw new TypeError(a);var t=!1,i=!1;r(e)?t=!0:n(e)&&(i=!0,e=new Uint8Array(e));var c,u,l,d=new s(e),p=d.maxCompressedLength();if(t?(c=new Uint8Array(p),l=d.compressToBuffer(c)):i?(c=new ArrayBuffer(p),u=new Uint8Array(c),l=d.compressToBuffer(u)):(c=Buffer.alloc(p),l=d.compressToBuffer(c)),!c.slice){var f=new Uint8Array(Array.prototype.slice.call(c,0,l));if(t)return f;if(i)return f.buffer;throw new Error("Not implemented")}return c.slice(0,l)}}}),require_aspromise=__commonJS({"node_modules/.pnpm/@protobufjs+aspromise@1.1.2/node_modules/@protobufjs/aspromise/index.js"(e,t){init_esm_shims(),t.exports=function(e,t){var r=new Array(arguments.length-1),n=0,o=2,i=!0;for(;o<arguments.length;)r[n++]=arguments[o++];return new Promise(function(o,s){r[n]=function(e){if(i)if(i=!1,e)s(e);else{for(var t=new Array(arguments.length-1),r=0;r<t.length;)t[r++]=arguments[r];o.apply(null,t)}};try{e.apply(t||null,r)}catch(e){i&&(i=!1,s(e))}})}}}),require_base64=__commonJS({"node_modules/.pnpm/@protobufjs+base64@1.1.2/node_modules/@protobufjs/base64/index.js"(e){init_esm_shims();var t=e;t.length=function(e){var t=e.length;if(!t)return 0;for(var r=0;--t%4>1&&"="===e.charAt(t);)++r;return Math.ceil(3*e.length)/4-r};var r,n=new Array(64),o=new Array(123);for(r=0;r<64;)o[n[r]=r<26?r+65:r<52?r+71:r<62?r-4:r-59|43]=r++;t.encode=function(e,t,r){for(var o,i=null,s=[],a=0,c=0;t<r;){var u=e[t++];switch(c){case 0:s[a++]=n[u>>2],o=(3&u)<<4,c=1;break;case 1:s[a++]=n[o|u>>4],o=(15&u)<<2,c=2;break;case 2:s[a++]=n[o|u>>6],s[a++]=n[63&u],c=0}a>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,s)),a=0)}return c&&(s[a++]=n[o],s[a++]=61,1===c&&(s[a++]=61)),i?(a&&i.push(String.fromCharCode.apply(String,s.slice(0,a))),i.join("")):String.fromCharCode.apply(String,s.slice(0,a))};t.decode=function(e,t,r){for(var n,i=r,s=0,a=0;a<e.length;){var c=e.charCodeAt(a++);if(61===c&&s>1)break;if(void 0===(c=o[c]))throw Error("invalid encoding");switch(s){case 0:n=c,s=1;break;case 1:t[r++]=n<<2|(48&c)>>4,n=c,s=2;break;case 2:t[r++]=(15&n)<<4|(60&c)>>2,n=c,s=3;break;case 3:t[r++]=(3&n)<<6|c,s=0}}if(1===s)throw Error("invalid encoding");return r-i},t.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}}}),require_eventemitter=__commonJS({"node_modules/.pnpm/@protobufjs+eventemitter@1.1.0/node_modules/@protobufjs/eventemitter/index.js"(e,t){function r(){this._listeners={}}init_esm_shims(),t.exports=r,r.prototype.on=function(e,t,r){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:r||this}),this},r.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var r=this._listeners[e],n=0;n<r.length;)r[n].fn===t?r.splice(n,1):++n;return this},r.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var r=[],n=1;n<arguments.length;)r.push(arguments[n++]);for(n=0;n<t.length;)t[n].fn.apply(t[n++].ctx,r)}return this}}}),require_float=__commonJS({"node_modules/.pnpm/@protobufjs+float@1.0.2/node_modules/@protobufjs/float/index.js"(e,t){function r(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),r=new Uint8Array(t.buffer),n=128===r[3];function o(e,n,o){t[0]=e,n[o]=r[0],n[o+1]=r[1],n[o+2]=r[2],n[o+3]=r[3]}function i(e,n,o){t[0]=e,n[o]=r[3],n[o+1]=r[2],n[o+2]=r[1],n[o+3]=r[0]}function s(e,n){return r[0]=e[n],r[1]=e[n+1],r[2]=e[n+2],r[3]=e[n+3],t[0]}function a(e,n){return r[3]=e[n],r[2]=e[n+1],r[1]=e[n+2],r[0]=e[n+3],t[0]}e.writeFloatLE=n?o:i,e.writeFloatBE=n?i:o,e.readFloatLE=n?s:a,e.readFloatBE=n?a:s}():function(){function t(e,t,r,n){var o=t<0?1:0;if(o&&(t=-t),0===t)e(1/t>0?0:2147483648,r,n);else if(isNaN(t))e(2143289344,r,n);else if(t>3.4028234663852886e38)e((o<<31|2139095040)>>>0,r,n);else if(t<1.1754943508222875e-38)e((o<<31|Math.round(t/1.401298464324817e-45))>>>0,r,n);else{var i=Math.floor(Math.log(t)/Math.LN2);e((o<<31|i+127<<23|8388607&Math.round(t*Math.pow(2,-i)*8388608))>>>0,r,n)}}function r(e,t,r){var n=e(t,r),o=2*(n>>31)+1,i=n>>>23&255,s=8388607&n;return 255===i?s?NaN:o*(1/0):0===i?1.401298464324817e-45*o*s:o*Math.pow(2,i-150)*(s+8388608)}e.writeFloatLE=t.bind(null,n),e.writeFloatBE=t.bind(null,o),e.readFloatLE=r.bind(null,i),e.readFloatBE=r.bind(null,s)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),r=new Uint8Array(t.buffer),n=128===r[7];function o(e,n,o){t[0]=e,n[o]=r[0],n[o+1]=r[1],n[o+2]=r[2],n[o+3]=r[3],n[o+4]=r[4],n[o+5]=r[5],n[o+6]=r[6],n[o+7]=r[7]}function i(e,n,o){t[0]=e,n[o]=r[7],n[o+1]=r[6],n[o+2]=r[5],n[o+3]=r[4],n[o+4]=r[3],n[o+5]=r[2],n[o+6]=r[1],n[o+7]=r[0]}function s(e,n){return r[0]=e[n],r[1]=e[n+1],r[2]=e[n+2],r[3]=e[n+3],r[4]=e[n+4],r[5]=e[n+5],r[6]=e[n+6],r[7]=e[n+7],t[0]}function a(e,n){return r[7]=e[n],r[6]=e[n+1],r[5]=e[n+2],r[4]=e[n+3],r[3]=e[n+4],r[2]=e[n+5],r[1]=e[n+6],r[0]=e[n+7],t[0]}e.writeDoubleLE=n?o:i,e.writeDoubleBE=n?i:o,e.readDoubleLE=n?s:a,e.readDoubleBE=n?a:s}():function(){function t(e,t,r,n,o,i){var s=n<0?1:0;if(s&&(n=-n),0===n)e(0,o,i+t),e(1/n>0?0:2147483648,o,i+r);else if(isNaN(n))e(0,o,i+t),e(2146959360,o,i+r);else if(n>1.7976931348623157e308)e(0,o,i+t),e((s<<31|2146435072)>>>0,o,i+r);else{var a;if(n<2.2250738585072014e-308)e((a=n/5e-324)>>>0,o,i+t),e((s<<31|a/4294967296)>>>0,o,i+r);else{var c=Math.floor(Math.log(n)/Math.LN2);1024===c&&(c=1023),e(4503599627370496*(a=n*Math.pow(2,-c))>>>0,o,i+t),e((s<<31|c+1023<<20|1048576*a&1048575)>>>0,o,i+r)}}}function r(e,t,r,n,o){var i=e(n,o+t),s=e(n,o+r),a=2*(s>>31)+1,c=s>>>20&2047,u=4294967296*(1048575&s)+i;return 2047===c?u?NaN:a*(1/0):0===c?5e-324*a*u:a*Math.pow(2,c-1075)*(u+4503599627370496)}e.writeDoubleLE=t.bind(null,n,0,4),e.writeDoubleBE=t.bind(null,o,4,0),e.readDoubleLE=r.bind(null,i,0,4),e.readDoubleBE=r.bind(null,s,4,0)}(),e}function n(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}function o(e,t,r){t[r]=e>>>24,t[r+1]=e>>>16&255,t[r+2]=e>>>8&255,t[r+3]=255&e}function i(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function s(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}init_esm_shims(),t.exports=r(r)}}),require_inquire=__commonJS({"node_modules/.pnpm/@protobufjs+inquire@1.1.0/node_modules/@protobufjs/inquire/index.js"(exports,module){function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}init_esm_shims(),module.exports=inquire}}),require_utf8=__commonJS({"node_modules/.pnpm/@protobufjs+utf8@1.1.0_patch_hash=3ynfhpkcotxyq64lqcnl2pxsby/node_modules/@protobufjs/utf8/index.js"(e){init_esm_shims();var t=e;t.length=function(e){for(var t=0,r=0,n=0;n<e.length;++n)(r=e.charCodeAt(n))<128?t+=1:r<2048?t+=2:55296==(64512&r)&&56320==(64512&e.charCodeAt(n+1))?(++n,t+=4):t+=3;return t},t.read=function(e,t,r){if(r-t<1)return"";for(var n="",o=t;o<r;){var i=e[o++];if(i<=127)n+=String.fromCharCode(i);else if(i>=192&&i<224)n+=String.fromCharCode((31&i)<<6|63&e[o++]);else if(i>=224&&i<240)n+=String.fromCharCode((15&i)<<12|(63&e[o++])<<6|63&e[o++]);else if(i>=240){var s=((7&i)<<18|(63&e[o++])<<12|(63&e[o++])<<6|63&e[o++])-65536;n+=String.fromCharCode(55296+(s>>10)),n+=String.fromCharCode(56320+(1023&s))}}return n},t.write=function(e,t,r){for(var n,o,i=r,s=0;s<e.length;++s)(n=e.charCodeAt(s))<128?t[r++]=n:n<2048?(t[r++]=n>>6|192,t[r++]=63&n|128):55296==(64512&n)&&56320==(64512&(o=e.charCodeAt(s+1)))?(n=65536+((1023&n)<<10)+(1023&o),++s,t[r++]=n>>18|240,t[r++]=n>>12&63|128,t[r++]=n>>6&63|128,t[r++]=63&n|128):(t[r++]=n>>12|224,t[r++]=n>>6&63|128,t[r++]=63&n|128);return r-i}}}),require_pool=__commonJS({"node_modules/.pnpm/@protobufjs+pool@1.1.0/node_modules/@protobufjs/pool/index.js"(e,t){init_esm_shims(),t.exports=function(e,t,r){var n=r||8192,o=n>>>1,i=null,s=n;return function(r){if(r<1||r>o)return e(r);s+r>n&&(i=e(n),s=0);var a=t.call(i,s,s+=r);return 7&s&&(s=1+(7|s)),a}}}}),require_longbits=__commonJS({"node_modules/.pnpm/protobufjs@7.1.0/node_modules/protobufjs/src/util/longbits.js"(e,t){init_esm_shims(),t.exports=n;var r=require_minimal();function n(e,t){this.lo=e>>>0,this.hi=t>>>0}var o=n.zero=new n(0,0);o.toNumber=function(){return 0},o.zzEncode=o.zzDecode=function(){return this},o.length=function(){return 1};var i=n.zeroHash="\0\0\0\0\0\0\0\0";n.fromNumber=function(e){if(0===e)return o;var t=e<0;t&&(e=-e);var r=e>>>0,i=(e-r)/4294967296>>>0;return t&&(i=~i>>>0,r=~r>>>0,++r>4294967295&&(r=0,++i>4294967295&&(i=0))),new n(r,i)},n.from=function(e){if("number"==typeof e)return n.fromNumber(e);if(r.isString(e)){if(!r.Long)return n.fromNumber(parseInt(e,10));e=r.Long.fromString(e)}return e.low||e.high?new n(e.low>>>0,e.high>>>0):o},n.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,r=~this.hi>>>0;return t||(r=r+1>>>0),-(t+4294967296*r)}return this.lo+4294967296*this.hi},n.prototype.toLong=function(e){return r.Long?new r.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var s=String.prototype.charCodeAt;n.fromHash=function(e){return e===i?o:new n((s.call(e,0)|s.call(e,1)<<8|s.call(e,2)<<16|s.call(e,3)<<24)>>>0,(s.call(e,4)|s.call(e,5)<<8|s.call(e,6)<<16|s.call(e,7)<<24)>>>0)},n.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},n.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},n.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},n.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return 0===r?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:r<128?9:10}}}),require_minimal=__commonJS({"node_modules/.pnpm/protobufjs@7.1.0/node_modules/protobufjs/src/util/minimal.js"(e){init_esm_shims();var t=e;function r(e,t,r){for(var n=Object.keys(t),o=0;o<n.length;++o)void 0!==e[n[o]]&&r||(e[n[o]]=t[n[o]]);return e}function n(e){function t(e,n){if(!(this instanceof t))return new t(e,n);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),n&&r(this,n)}return t.prototype=Object.create(Error.prototype,{constructor:{value:t,writable:!0,enumerable:!1,configurable:!0},name:{get:()=>e,set:void 0,enumerable:!1,configurable:!0},toString:{value(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),t}t.asPromise=require_aspromise(),t.base64=require_base64(),t.EventEmitter=require_eventemitter(),t.float=require_float(),t.inquire=require_inquire(),t.utf8=require_utf8(),t.pool=require_pool(),t.LongBits=require_longbits(),t.isNode=Boolean(void 0!==global&&global&&global.process&&global.process.versions&&global.process.versions.node),t.global=t.isNode&&global||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||e,t.emptyArray=Object.freeze?Object.freeze([]):[],t.emptyObject=Object.freeze?Object.freeze({}):{},t.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},t.isString=function(e){return"string"==typeof e||e instanceof String},t.isObject=function(e){return e&&"object"==typeof e},t.isset=t.isSet=function(e,t){var r=e[t];return!(null==r||!e.hasOwnProperty(t))&&("object"!=typeof r||(Array.isArray(r)?r.length:Object.keys(r).length)>0)},t.Buffer=function(){try{var e=t.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),t._Buffer_from=null,t._Buffer_allocUnsafe=null,t.newBuffer=function(e){return"number"==typeof e?t.Buffer?t._Buffer_allocUnsafe(e):new t.Array(e):t.Buffer?t._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},t.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,t.Long=t.global.dcodeIO&&t.global.dcodeIO.Long||t.global.Long||t.inquire("long"),t.key2Re=/^true|false|0|1$/,t.key32Re=/^-?(?:0|[1-9][0-9]*)$/,t.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,t.longToHash=function(e){return e?t.LongBits.from(e).toHash():t.LongBits.zeroHash},t.longFromHash=function(e,r){var n=t.LongBits.fromHash(e);return t.Long?t.Long.fromBits(n.lo,n.hi,r):n.toNumber(Boolean(r))},t.merge=r,t.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},t.newError=n,t.ProtocolError=n("ProtocolError"),t.oneOfGetter=function(e){for(var t={},r=0;r<e.length;++r)t[e[r]]=1;return function(){for(var e=Object.keys(this),r=e.length-1;r>-1;--r)if(1===t[e[r]]&&void 0!==this[e[r]]&&null!==this[e[r]])return e[r]}},t.oneOfSetter=function(e){return function(t){for(var r=0;r<e.length;++r)e[r]!==t&&delete this[e[r]]}},t.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},t._configure=function(){var e=t.Buffer;e?(t._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,r){return new e(t,r)},t._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):t._Buffer_from=t._Buffer_allocUnsafe=null}}}),require_writer=__commonJS({"node_modules/.pnpm/protobufjs@7.1.0/node_modules/protobufjs/src/writer.js"(e,t){init_esm_shims(),t.exports=u;var r,n=require_minimal(),o=n.LongBits,i=n.base64,s=n.utf8;function a(e,t,r){this.fn=e,this.len=t,this.next=void 0,this.val=r}function c(){}function u(){this.len=0,this.head=new a(c,0,0),this.tail=this.head,this.states=null}var l=function(){return n.Buffer?function(){return(u.create=function(){return new r})()}:function(){return new u}};function d(e,t,r){t[r]=255&e}function p(e,t){this.len=e,this.next=void 0,this.val=t}function f(e,t,r){for(;e.hi;)t[r++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=127&e.lo|128,e.lo=e.lo>>>7;t[r++]=e.lo}function _(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}u.create=l(),u.alloc=function(e){return new n.Array(e)},n.Array!==Array&&(u.alloc=n.pool(u.alloc,n.Array.prototype.subarray)),u.prototype._push=function(e,t,r){return this.tail=this.tail.next=new a(e,t,r),this.len+=t,this},p.prototype=Object.create(a.prototype),p.prototype.fn=function(e,t,r){for(;e>127;)t[r++]=127&e|128,e>>>=7;t[r]=e},u.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new p((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},u.prototype.int32=function(e){return e<0?this._push(f,10,o.fromNumber(e)):this.uint32(e)},u.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},u.prototype.uint64=function(e){var t=o.from(e);return this._push(f,t.length(),t)},u.prototype.int64=u.prototype.uint64,u.prototype.sint64=function(e){var t=o.from(e).zzEncode();return this._push(f,t.length(),t)},u.prototype.bool=function(e){return this._push(d,1,e?1:0)},u.prototype.fixed32=function(e){return this._push(_,4,e>>>0)},u.prototype.sfixed32=u.prototype.fixed32,u.prototype.fixed64=function(e){var t=o.from(e);return this._push(_,4,t.lo)._push(_,4,t.hi)},u.prototype.sfixed64=u.prototype.fixed64,u.prototype.float=function(e){return this._push(n.float.writeFloatLE,4,e)},u.prototype.double=function(e){return this._push(n.float.writeDoubleLE,8,e)};var m=n.Array.prototype.set?function(e,t,r){t.set(e,r)}:function(e,t,r){for(var n=0;n<e.length;++n)t[r+n]=e[n]};u.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(d,1,0);if(n.isString(e)){var r=u.alloc(t=i.length(e));i.decode(e,r,0),e=r}return this.uint32(t)._push(m,t,e)},u.prototype.string=function(e){var t=s.length(e);return t?this.uint32(t)._push(s.write,t,e):this._push(d,1,0)},u.prototype.fork=function(){return this.states=new function(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}(this),this.head=this.tail=new a(c,0,0),this.len=0,this},u.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new a(c,0,0),this.len=0),this},u.prototype.ldelim=function(){var e=this.head,t=this.tail,r=this.len;return this.reset().uint32(r),r&&(this.tail.next=e.next,this.tail=t,this.len+=r),this},u.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),r=0;e;)e.fn(e.val,t,r),r+=e.len,e=e.next;return t},u._configure=function(e){r=e,u.create=l(),r._configure()}}}),require_writer_buffer=__commonJS({"node_modules/.pnpm/protobufjs@7.1.0/node_modules/protobufjs/src/writer_buffer.js"(e,t){init_esm_shims(),t.exports=o;var r=require_writer();(o.prototype=Object.create(r.prototype)).constructor=o;var n=require_minimal();function o(){r.call(this)}function i(e,t,r){e.length<40?n.utf8.write(e,t,r):t.utf8Write?t.utf8Write(e,r):t.write(e,r)}o._configure=function(){o.alloc=n._Buffer_allocUnsafe,o.writeBytesBuffer=n.Buffer&&n.Buffer.prototype instanceof Uint8Array&&"set"===n.Buffer.prototype.set.name?function(e,t,r){t.set(e,r)}:function(e,t,r){if(e.copy)e.copy(t,r,0,e.length);else for(var n=0;n<e.length;)t[r++]=e[n++]}},o.prototype.bytes=function(e){n.isString(e)&&(e=n._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(o.writeBytesBuffer,t,e),this},o.prototype.string=function(e){var t=n.Buffer.byteLength(e);return this.uint32(t),t&&this._push(i,t,e),this},o._configure()}}),require_reader=__commonJS({"node_modules/.pnpm/protobufjs@7.1.0/node_modules/protobufjs/src/reader.js"(e,t){init_esm_shims(),t.exports=a;var r,n=require_minimal(),o=n.LongBits,i=n.utf8;function s(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function a(e){this.buf=e,this.pos=0,this.len=e.length}var c="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new a(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new a(e);throw Error("illegal buffer")},u=function(){return n.Buffer?function(e){return(a.create=function(e){return n.Buffer.isBuffer(e)?new r(e):c(e)})(e)}:c};function l(){var e=new o(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw s(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw s(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function d(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function p(){if(this.pos+8>this.len)throw s(this,8);return new o(d(this.buf,this.pos+=4),d(this.buf,this.pos+=4))}a.create=u(),a.prototype._slice=n.Array.prototype.subarray||n.Array.prototype.slice,a.prototype.uint32=function(){var e=4294967295;return function(){if(e=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return e;if((this.pos+=5)>this.len)throw this.pos=this.len,s(this,10);return e}}(),a.prototype.int32=function(){return 0|this.uint32()},a.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},a.prototype.bool=function(){return 0!==this.uint32()},a.prototype.fixed32=function(){if(this.pos+4>this.len)throw s(this,4);return d(this.buf,this.pos+=4)},a.prototype.sfixed32=function(){if(this.pos+4>this.len)throw s(this,4);return 0|d(this.buf,this.pos+=4)},a.prototype.float=function(){if(this.pos+4>this.len)throw s(this,4);var e=n.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},a.prototype.double=function(){if(this.pos+8>this.len)throw s(this,4);var e=n.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},a.prototype.bytes=function(){var e=this.uint32(),t=this.pos,r=this.pos+e;if(r>this.len)throw s(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,r):t===r?new this.buf.constructor(0):this._slice.call(this.buf,t,r)},a.prototype.string=function(){var e=this.bytes();return i.read(e,0,e.length)},a.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw s(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw s(this)}while(128&this.buf[this.pos++]);return this},a.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},a._configure=function(e){r=e,a.create=u(),r._configure();var t=n.Long?"toLong":"toNumber";n.merge(a.prototype,{int64:function(){return l.call(this)[t](!1)},uint64:function(){return l.call(this)[t](!0)},sint64:function(){return l.call(this).zzDecode()[t](!1)},fixed64:function(){return p.call(this)[t](!0)},sfixed64:function(){return p.call(this)[t](!1)}})}}}),require_reader_buffer=__commonJS({"node_modules/.pnpm/protobufjs@7.1.0/node_modules/protobufjs/src/reader_buffer.js"(e,t){init_esm_shims(),t.exports=o;var r=require_reader();(o.prototype=Object.create(r.prototype)).constructor=o;var n=require_minimal();function o(e){r.call(this,e)}o._configure=function(){n.Buffer&&(o.prototype._slice=n.Buffer.prototype.slice)},o.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},o._configure()}}),require_service=__commonJS({"node_modules/.pnpm/protobufjs@7.1.0/node_modules/protobufjs/src/rpc/service.js"(e,t){init_esm_shims(),t.exports=n;var r=require_minimal();function n(e,t,n){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");r.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(n)}(n.prototype=Object.create(r.EventEmitter.prototype)).constructor=n,n.prototype.rpcCall=function e(t,n,o,i,s){if(!i)throw TypeError("request must be specified");var a=this;if(!s)return r.asPromise(e,a,t,n,o,i);if(a.rpcImpl)try{return a.rpcImpl(t,n[a.requestDelimited?"encodeDelimited":"encode"](i).finish(),function(e,r){if(e)return a.emit("error",e,t),s(e);if(null!==r){if(!(r instanceof o))try{r=o[a.responseDelimited?"decodeDelimited":"decode"](r)}catch(e){return a.emit("error",e,t),s(e)}return a.emit("data",r,t),s(null,r)}a.end(!0)})}catch(e){return a.emit("error",e,t),void setTimeout(function(){s(e)},0)}else setTimeout(function(){s(Error("already ended"))},0)},n.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}}}),require_rpc=__commonJS({"node_modules/.pnpm/protobufjs@7.1.0/node_modules/protobufjs/src/rpc.js"(e){init_esm_shims(),e.Service=require_service()}}),require_roots=__commonJS({"node_modules/.pnpm/protobufjs@7.1.0/node_modules/protobufjs/src/roots.js"(e,t){init_esm_shims(),t.exports={}}}),require_index_minimal=__commonJS({"node_modules/.pnpm/protobufjs@7.1.0/node_modules/protobufjs/src/index-minimal.js"(e){init_esm_shims();var t=e;function r(){t.util._configure(),t.Writer._configure(t.BufferWriter),t.Reader._configure(t.BufferReader)}t.build="minimal",t.Writer=require_writer(),t.BufferWriter=require_writer_buffer(),t.Reader=require_reader(),t.BufferReader=require_reader_buffer(),t.util=require_minimal(),t.rpc=require_rpc(),t.roots=require_roots(),t.configure=r,r()}}),require_minimal2=__commonJS({"node_modules/.pnpm/protobufjs@7.1.0/node_modules/protobufjs/minimal.js"(e,t){init_esm_shims(),t.exports=require_index_minimal()}}),require_jsbn=__commonJS({"node_modules/.pnpm/jsbn@1.1.0/node_modules/jsbn/index.js"(e,t){init_esm_shims(),function(){var r;function n(e,t,r){null!=e&&("number"==typeof e?this.fromNumber(e,t,r):null==t&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,t))}function o(){return new n(null)}var i="undefined"!=typeof navigator;i&&"Microsoft Internet Explorer"==navigator.appName?(n.prototype.am=function(e,t,r,n,o,i){for(var s=32767&t,a=t>>15;--i>=0;){var c=32767&this[e],u=this[e++]>>15,l=a*c+u*s;o=((c=s*c+((32767&l)<<15)+r[n]+(1073741823&o))>>>30)+(l>>>15)+a*u+(o>>>30),r[n++]=1073741823&c}return o},r=30):i&&"Netscape"!=navigator.appName?(n.prototype.am=function(e,t,r,n,o,i){for(;--i>=0;){var s=t*this[e++]+r[n]+o;o=Math.floor(s/67108864),r[n++]=67108863&s}return o},r=26):(n.prototype.am=function(e,t,r,n,o,i){for(var s=16383&t,a=t>>14;--i>=0;){var c=16383&this[e],u=this[e++]>>14,l=a*c+u*s;o=((c=s*c+((16383&l)<<14)+r[n]+o)>>28)+(l>>14)+a*u,r[n++]=268435455&c}return o},r=28),n.prototype.DB=r,n.prototype.DM=(1<<r)-1,n.prototype.DV=1<<r;n.prototype.FV=Math.pow(2,52),n.prototype.F1=52-r,n.prototype.F2=2*r-52;var s,a,c="0123456789abcdefghijklmnopqrstuvwxyz",u=new Array;for(s="0".charCodeAt(0),a=0;a<=9;++a)u[s++]=a;for(s="a".charCodeAt(0),a=10;a<36;++a)u[s++]=a;for(s="A".charCodeAt(0),a=10;a<36;++a)u[s++]=a;function l(e){return c.charAt(e)}function d(e,t){var r=u[e.charCodeAt(t)];return null==r?-1:r}function p(e){var t=o();return t.fromInt(e),t}function f(e){var t,r=1;return 0!=(t=e>>>16)&&(e=t,r+=16),0!=(t=e>>8)&&(e=t,r+=8),0!=(t=e>>4)&&(e=t,r+=4),0!=(t=e>>2)&&(e=t,r+=2),0!=(t=e>>1)&&(e=t,r+=1),r}function _(e){this.m=e}function m(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function h(e,t){return e&t}function g(e,t){return e|t}function v(e,t){return e^t}function y(e,t){return e&~t}function E(e){if(0==e)return-1;var t=0;return 0==(65535&e)&&(e>>=16,t+=16),0==(255&e)&&(e>>=8,t+=8),0==(15&e)&&(e>>=4,t+=4),0==(3&e)&&(e>>=2,t+=2),0==(1&e)&&++t,t}function b(e){for(var t=0;0!=e;)e&=e-1,++t;return t}function S(){}function T(e){return e}function A(e){this.r2=o(),this.q3=o(),n.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}_.prototype.convert=function(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e},_.prototype.revert=function(e){return e},_.prototype.reduce=function(e){e.divRemTo(this.m,null,e)},_.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},_.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},m.prototype.convert=function(e){var t=o();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(n.ZERO)>0&&this.m.subTo(t,t),t},m.prototype.revert=function(e){var t=o();return e.copyTo(t),this.reduce(t),t},m.prototype.reduce=function(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=32767&e[t],n=r*this.mpl+((r*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(e[r=t+this.m.t]+=this.m.am(0,n,e,t,0,this.m.t);e[r]>=e.DV;)e[r]-=e.DV,e[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)},m.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},m.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},n.prototype.copyTo=function(e){for(var t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s},n.prototype.fromInt=function(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+this.DV:this.t=0},n.prototype.fromString=function(e,t){var r;if(16==t)r=4;else if(8==t)r=3;else if(256==t)r=8;else if(2==t)r=1;else if(32==t)r=5;else{if(4!=t)return void this.fromRadix(e,t);r=2}this.t=0,this.s=0;for(var o=e.length,i=!1,s=0;--o>=0;){var a=8==r?255&e[o]:d(e,o);a<0?"-"==e.charAt(o)&&(i=!0):(i=!1,0==s?this[this.t++]=a:s+r>this.DB?(this[this.t-1]|=(a&(1<<this.DB-s)-1)<<s,this[this.t++]=a>>this.DB-s):this[this.t-1]|=a<<s,(s+=r)>=this.DB&&(s-=this.DB))}8==r&&0!=(128&e[0])&&(this.s=-1,s>0&&(this[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),i&&n.ZERO.subTo(this,this)},n.prototype.clamp=function(){for(var e=this.s&this.DM;this.t>0&&this[this.t-1]==e;)--this.t},n.prototype.dlShiftTo=function(e,t){var r;for(r=this.t-1;r>=0;--r)t[r+e]=this[r];for(r=e-1;r>=0;--r)t[r]=0;t.t=this.t+e,t.s=this.s},n.prototype.drShiftTo=function(e,t){for(var r=e;r<this.t;++r)t[r-e]=this[r];t.t=Math.max(this.t-e,0),t.s=this.s},n.prototype.lShiftTo=function(e,t){var r,n=e%this.DB,o=this.DB-n,i=(1<<o)-1,s=Math.floor(e/this.DB),a=this.s<<n&this.DM;for(r=this.t-1;r>=0;--r)t[r+s+1]=this[r]>>o|a,a=(this[r]&i)<<n;for(r=s-1;r>=0;--r)t[r]=0;t[s]=a,t.t=this.t+s+1,t.s=this.s,t.clamp()},n.prototype.rShiftTo=function(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t)t.t=0;else{var n=e%this.DB,o=this.DB-n,i=(1<<n)-1;t[0]=this[r]>>n;for(var s=r+1;s<this.t;++s)t[s-r-1]|=(this[s]&i)<<o,t[s-r]=this[s]>>n;n>0&&(t[this.t-r-1]|=(this.s&i)<<o),t.t=this.t-r,t.clamp()}},n.prototype.subTo=function(e,t){for(var r=0,n=0,o=Math.min(e.t,this.t);r<o;)n+=this[r]-e[r],t[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this[r],t[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e[r],t[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t[r++]=this.DV+n:n>0&&(t[r++]=n),t.t=r,t.clamp()},n.prototype.multiplyTo=function(e,t){var r=this.abs(),o=e.abs(),i=r.t;for(t.t=i+o.t;--i>=0;)t[i]=0;for(i=0;i<o.t;++i)t[i+r.t]=r.am(0,o[i],t,i,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&n.ZERO.subTo(t,t)},n.prototype.squareTo=function(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e[r]=0;for(r=0;r<t.t-1;++r){var n=t.am(r,t[r],e,2*r,0,1);(e[r+t.t]+=t.am(r+1,2*t[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e[r+t.t]-=t.DV,e[r+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(r,t[r],e,2*r,0,1)),e.s=0,e.clamp()},n.prototype.divRemTo=function(e,t,r){var i=e.abs();if(!(i.t<=0)){var s=this.abs();if(s.t<i.t)return null!=t&&t.fromInt(0),void(null!=r&&this.copyTo(r));null==r&&(r=o());var a=o(),c=this.s,u=e.s,l=this.DB-f(i[i.t-1]);l>0?(i.lShiftTo(l,a),s.lShiftTo(l,r)):(i.copyTo(a),s.copyTo(r));var d=a.t,p=a[d-1];if(0!=p){var _=p*(1<<this.F1)+(d>1?a[d-2]>>this.F2:0),m=this.FV/_,h=(1<<this.F1)/_,g=1<<this.F2,v=r.t,y=v-d,E=null==t?o():t;for(a.dlShiftTo(y,E),r.compareTo(E)>=0&&(r[r.t++]=1,r.subTo(E,r)),n.ONE.dlShiftTo(d,E),E.subTo(a,a);a.t<d;)a[a.t++]=0;for(;--y>=0;){var b=r[--v]==p?this.DM:Math.floor(r[v]*m+(r[v-1]+g)*h);if((r[v]+=a.am(0,b,r,y,0,d))<b)for(a.dlShiftTo(y,E),r.subTo(E,r);r[v]<--b;)r.subTo(E,r)}null!=t&&(r.drShiftTo(d,t),c!=u&&n.ZERO.subTo(t,t)),r.t=d,r.clamp(),l>0&&r.rShiftTo(l,r),c<0&&n.ZERO.subTo(r,r)}}},n.prototype.invDigit=function(){if(this.t<1)return 0;var e=this[0];if(0==(1&e))return 0;var t=3&e;return(t=(t=(t=(t=t*(2-(15&e)*t)&15)*(2-(255&e)*t)&255)*(2-((65535&e)*t&65535))&65535)*(2-e*t%this.DV)%this.DV)>0?this.DV-t:-t},n.prototype.isEven=function(){return 0==(this.t>0?1&this[0]:this.s)},n.prototype.exp=function(e,t){if(e>4294967295||e<1)return n.ONE;var r=o(),i=o(),s=t.convert(this),a=f(e)-1;for(s.copyTo(r);--a>=0;)if(t.sqrTo(r,i),(e&1<<a)>0)t.mulTo(i,s,r);else{var c=r;r=i,i=c}return t.revert(r)},n.prototype.toString=function(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(16==e)t=4;else if(8==e)t=3;else if(2==e)t=1;else if(32==e)t=5;else{if(4!=e)return this.toRadix(e);t=2}var r,n=(1<<t)-1,o=!1,i="",s=this.t,a=this.DB-s*this.DB%t;if(s-- >0)for(a<this.DB&&(r=this[s]>>a)>0&&(o=!0,i=l(r));s>=0;)a<t?(r=(this[s]&(1<<a)-1)<<t-a,r|=this[--s]>>(a+=this.DB-t)):(r=this[s]>>(a-=t)&n,a<=0&&(a+=this.DB,--s)),r>0&&(o=!0),o&&(i+=l(r));return o?i:"0"},n.prototype.negate=function(){var e=o();return n.ZERO.subTo(this,e),e},n.prototype.abs=function(){return this.s<0?this.negate():this},n.prototype.compareTo=function(e){var t=this.s-e.s;if(0!=t)return t;var r=this.t;if(0!=(t=r-e.t))return this.s<0?-t:t;for(;--r>=0;)if(0!=(t=this[r]-e[r]))return t;return 0},n.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+f(this[this.t-1]^this.s&this.DM)},n.prototype.mod=function(e){var t=o();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(n.ZERO)>0&&e.subTo(t,t),t},n.prototype.modPowInt=function(e,t){var r;return r=e<256||t.isEven()?new _(t):new m(t),this.exp(e,r)},n.ZERO=p(0),n.ONE=p(1),S.prototype.convert=T,S.prototype.revert=T,S.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r)},S.prototype.sqrTo=function(e,t){e.squareTo(t)},A.prototype.convert=function(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=o();return e.copyTo(t),this.reduce(t),t},A.prototype.revert=function(e){return e},A.prototype.reduce=function(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)},A.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},A.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)};var w,C,I,O=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],R=(1<<26)/O[O.length-1];function N(){!function(e){C[I++]^=255&e,C[I++]^=e>>8&255,C[I++]^=e>>16&255,C[I++]^=e>>24&255,I>=k&&(I-=k)}((new Date).getTime())}if(n.prototype.chunkSize=function(e){return Math.floor(Math.LN2*this.DB/Math.log(e))},n.prototype.toRadix=function(e){if(null==e&&(e=10),0==this.signum()||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),n=p(r),i=o(),s=o(),a="";for(this.divRemTo(n,i,s);i.signum()>0;)a=(r+s.intValue()).toString(e).substr(1)+a,i.divRemTo(n,i,s);return s.intValue().toString(e)+a},n.prototype.fromRadix=function(e,t){this.fromInt(0),null==t&&(t=10);for(var r=this.chunkSize(t),o=Math.pow(t,r),i=!1,s=0,a=0,c=0;c<e.length;++c){var u=d(e,c);u<0?"-"==e.charAt(c)&&0==this.signum()&&(i=!0):(a=t*a+u,++s>=r&&(this.dMultiply(o),this.dAddOffset(a,0),s=0,a=0))}s>0&&(this.dMultiply(Math.pow(t,s)),this.dAddOffset(a,0)),i&&n.ZERO.subTo(this,this)},n.prototype.fromNumber=function(e,t,r){if("number"==typeof t)if(e<2)this.fromInt(1);else for(this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(n.ONE.shiftLeft(e-1),g,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(n.ONE.shiftLeft(e-1),this);else{var o=new Array,i=7&e;o.length=1+(e>>3),t.nextBytes(o),i>0?o[0]&=(1<<i)-1:o[0]=0,this.fromString(o,256)}},n.prototype.bitwiseTo=function(e,t,r){var n,o,i=Math.min(e.t,this.t);for(n=0;n<i;++n)r[n]=t(this[n],e[n]);if(e.t<this.t){for(o=e.s&this.DM,n=i;n<this.t;++n)r[n]=t(this[n],o);r.t=this.t}else{for(o=this.s&this.DM,n=i;n<e.t;++n)r[n]=t(o,e[n]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()},n.prototype.changeBit=function(e,t){var r=n.ONE.shiftLeft(e);return this.bitwiseTo(r,t,r),r},n.prototype.addTo=function(e,t){for(var r=0,n=0,o=Math.min(e.t,this.t);r<o;)n+=this[r]+e[r],t[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this[r],t[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e[r],t[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,n>0?t[r++]=n:n<-1&&(t[r++]=this.DV+n),t.t=r,t.clamp()},n.prototype.dMultiply=function(e){this[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()},n.prototype.dAddOffset=function(e,t){if(0!=e){for(;this.t<=t;)this[this.t++]=0;for(this[t]+=e;this[t]>=this.DV;)this[t]-=this.DV,++t>=this.t&&(this[this.t++]=0),++this[t]}},n.prototype.multiplyLowerTo=function(e,t,r){var n,o=Math.min(this.t+e.t,t);for(r.s=0,r.t=o;o>0;)r[--o]=0;for(n=r.t-this.t;o<n;++o)r[o+this.t]=this.am(0,e[o],r,o,0,this.t);for(n=Math.min(e.t,t);o<n;++o)this.am(0,e[o],r,o,0,t-o);r.clamp()},n.prototype.multiplyUpperTo=function(e,t,r){--t;var n=r.t=this.t+e.t-t;for(r.s=0;--n>=0;)r[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)r[this.t+n-t]=this.am(t-n,e[n],r,0,0,this.t+n-t);r.clamp(),r.drShiftTo(1,r)},n.prototype.modInt=function(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(0==t)r=this[0]%e;else for(var n=this.t-1;n>=0;--n)r=(t*r+this[n])%e;return r},n.prototype.millerRabin=function(e){var t=this.subtract(n.ONE),r=t.getLowestSetBit();if(r<=0)return!1;var i=t.shiftRight(r);(e=e+1>>1)>O.length&&(e=O.length);for(var s=o(),a=0;a<e;++a){s.fromInt(O[Math.floor(Math.random()*O.length)]);var c=s.modPow(i,this);if(0!=c.compareTo(n.ONE)&&0!=c.compareTo(t)){for(var u=1;u++<r&&0!=c.compareTo(t);)if(0==(c=c.modPowInt(2,this)).compareTo(n.ONE))return!1;if(0!=c.compareTo(t))return!1}}return!0},n.prototype.clone=function(){var e=o();return this.copyTo(e),e},n.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},n.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},n.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},n.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},n.prototype.toByteArray=function(){var e=this.t,t=new Array;t[0]=this.s;var r,n=this.DB-e*this.DB%8,o=0;if(e-- >0)for(n<this.DB&&(r=this[e]>>n)!=(this.s&this.DM)>>n&&(t[o++]=r|this.s<<this.DB-n);e>=0;)n<8?(r=(this[e]&(1<<n)-1)<<8-n,r|=this[--e]>>(n+=this.DB-8)):(r=this[e]>>(n-=8)&255,n<=0&&(n+=this.DB,--e)),0!=(128&r)&&(r|=-256),0==o&&(128&this.s)!=(128&r)&&++o,(o>0||r!=this.s)&&(t[o++]=r);return t},n.prototype.equals=function(e){return 0==this.compareTo(e)},n.prototype.min=function(e){return this.compareTo(e)<0?this:e},n.prototype.max=function(e){return this.compareTo(e)>0?this:e},n.prototype.and=function(e){var t=o();return this.bitwiseTo(e,h,t),t},n.prototype.or=function(e){var t=o();return this.bitwiseTo(e,g,t),t},n.prototype.xor=function(e){var t=o();return this.bitwiseTo(e,v,t),t},n.prototype.andNot=function(e){var t=o();return this.bitwiseTo(e,y,t),t},n.prototype.not=function(){for(var e=o(),t=0;t<this.t;++t)e[t]=this.DM&~this[t];return e.t=this.t,e.s=~this.s,e},n.prototype.shiftLeft=function(e){var t=o();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t},n.prototype.shiftRight=function(e){var t=o();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t},n.prototype.getLowestSetBit=function(){for(var e=0;e<this.t;++e)if(0!=this[e])return e*this.DB+E(this[e]);return this.s<0?this.t*this.DB:-1},n.prototype.bitCount=function(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=b(this[r]^t);return e},n.prototype.testBit=function(e){var t=Math.floor(e/this.DB);return t>=this.t?0!=this.s:0!=(this[t]&1<<e%this.DB)},n.prototype.setBit=function(e){return this.changeBit(e,g)},n.prototype.clearBit=function(e){return this.changeBit(e,y)},n.prototype.flipBit=function(e){return this.changeBit(e,v)},n.prototype.add=function(e){var t=o();return this.addTo(e,t),t},n.prototype.subtract=function(e){var t=o();return this.subTo(e,t),t},n.prototype.multiply=function(e){var t=o();return this.multiplyTo(e,t),t},n.prototype.divide=function(e){var t=o();return this.divRemTo(e,t,null),t},n.prototype.remainder=function(e){var t=o();return this.divRemTo(e,null,t),t},n.prototype.divideAndRemainder=function(e){var t=o(),r=o();return this.divRemTo(e,t,r),new Array(t,r)},n.prototype.modPow=function(e,t){var r,n,i=e.bitLength(),s=p(1);if(i<=0)return s;r=i<18?1:i<48?3:i<144?4:i<768?5:6,n=i<8?new _(t):t.isEven()?new A(t):new m(t);var a=new Array,c=3,u=r-1,l=(1<<r)-1;if(a[1]=n.convert(this),r>1){var d=o();for(n.sqrTo(a[1],d);c<=l;)a[c]=o(),n.mulTo(d,a[c-2],a[c]),c+=2}var h,g,v=e.t-1,y=!0,E=o();for(i=f(e[v])-1;v>=0;){for(i>=u?h=e[v]>>i-u&l:(h=(e[v]&(1<<i+1)-1)<<u-i,v>0&&(h|=e[v-1]>>this.DB+i-u)),c=r;0==(1&h);)h>>=1,--c;if((i-=c)<0&&(i+=this.DB,--v),y)a[h].copyTo(s),y=!1;else{for(;c>1;)n.sqrTo(s,E),n.sqrTo(E,s),c-=2;c>0?n.sqrTo(s,E):(g=s,s=E,E=g),n.mulTo(E,a[h],s)}for(;v>=0&&0==(e[v]&1<<i);)n.sqrTo(s,E),g=s,s=E,E=g,--i<0&&(i=this.DB-1,--v)}return n.revert(s)},n.prototype.modInverse=function(e){var t=e.isEven();if(this.isEven()&&t||0==e.signum())return n.ZERO;for(var r=e.clone(),o=this.clone(),i=p(1),s=p(0),a=p(0),c=p(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),t?(i.isEven()&&s.isEven()||(i.addTo(this,i),s.subTo(e,s)),i.rShiftTo(1,i)):s.isEven()||s.subTo(e,s),s.rShiftTo(1,s);for(;o.isEven();)o.rShiftTo(1,o),t?(a.isEven()&&c.isEven()||(a.addTo(this,a),c.subTo(e,c)),a.rShiftTo(1,a)):c.isEven()||c.subTo(e,c),c.rShiftTo(1,c);r.compareTo(o)>=0?(r.subTo(o,r),t&&i.subTo(a,i),s.subTo(c,s)):(o.subTo(r,o),t&&a.subTo(i,a),c.subTo(s,c))}return 0!=o.compareTo(n.ONE)?n.ZERO:c.compareTo(e)>=0?c.subtract(e):c.signum()<0?(c.addTo(e,c),c.signum()<0?c.add(e):c):c},n.prototype.pow=function(e){return this.exp(e,new S)},n.prototype.gcd=function(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var n=t;t=r,r=n}var o=t.getLowestSetBit(),i=r.getLowestSetBit();if(i<0)return t;for(o<i&&(i=o),i>0&&(t.rShiftTo(i,t),r.rShiftTo(i,r));t.signum()>0;)(o=t.getLowestSetBit())>0&&t.rShiftTo(o,t),(o=r.getLowestSetBit())>0&&r.rShiftTo(o,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return i>0&&r.lShiftTo(i,r),r},n.prototype.isProbablePrime=function(e){var t,r=this.abs();if(1==r.t&&r[0]<=O[O.length-1]){for(t=0;t<O.length;++t)if(r[0]==O[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<O.length;){for(var n=O[t],o=t+1;o<O.length&&n<R;)n*=O[o++];for(n=r.modInt(n);t<o;)if(n%O[t++]==0)return!1}return r.millerRabin(e)},n.prototype.square=function(){var e=o();return this.squareTo(e),e},n.prototype.Barrett=A,null==C){var D;if(C=new Array,I=0,"undefined"!=typeof window&&window.crypto)if(window.crypto.getRandomValues){var j=new Uint8Array(32);for(window.crypto.getRandomValues(j),D=0;D<32;++D)C[I++]=j[D]}else if("Netscape"==navigator.appName&&navigator.appVersion<"5"){var L=window.crypto.random(32);for(D=0;D<L.length;++D)C[I++]=255&L.charCodeAt(D)}for(;I<k;)D=Math.floor(65536*Math.random()),C[I++]=D>>>8,C[I++]=255&D;I=0,N()}function M(){if(null==w){for(N(),(w=new x).init(C),I=0;I<C.length;++I)C[I]=0;I=0}return w.next()}function P(){}function x(){this.i=0,this.j=0,this.S=new Array}P.prototype.nextBytes=function(e){var t;for(t=0;t<e.length;++t)e[t]=M()},x.prototype.init=function(e){var t,r,n;for(t=0;t<256;++t)this.S[t]=t;for(r=0,t=0;t<256;++t)r=r+this.S[t]+e[t%e.length]&255,n=this.S[t],this.S[t]=this.S[r],this.S[r]=n;this.i=0,this.j=0},x.prototype.next=function(){var e;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,e=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=e,this.S[e+this.S[this.i]&255]};var k=256;void 0!==e?e=t.exports={default:n,BigInteger:n,SecureRandom:P}:this.jsbn={BigInteger:n,SecureRandom:P}}.call(e)}}),require_miniprogram_dist=__commonJS({"node_modules/.pnpm/miniprogram-sm-crypto@0.3.12/node_modules/miniprogram-sm-crypto/miniprogram_dist/index.js"(e,t){init_esm_shims(),t.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=2)}([function(e,t){e.exports=require_jsbn()},function(e,t,r){var n=new Uint32Array(68),o=new Uint32Array(64);function i(e,t){var r=31&t;return e<<r|e>>>32-r}function s(e,t){for(var r=[],n=e.length-1;n>=0;n--)r[n]=255&(e[n]^t[n]);return r}function a(e){return e^i(e,9)^i(e,17)}function c(e){return e^i(e,15)^i(e,23)}function u(e){var t=8*e.length,r=t%512;r=r>=448?512-r%448-1:448-r-1;for(var s=new Array((r-7)/8),u=new Array(8),l=0,d=s.length;l<d;l++)s[l]=0;for(var p=0,f=u.length;p<f;p++)u[p]=0;t=t.toString(2);for(var _=7;_>=0;_--)if(t.length>8){var m=t.length-8;u[_]=parseInt(t.substr(m),2),t=t.substr(0,m)}else t.length>0&&(u[_]=parseInt(t,2),t="");for(var h=new Uint8Array([].concat(e,[128],s,u)),g=new DataView(h.buffer,0),v=h.length/64,y=new Uint32Array([1937774191,1226093241,388252375,3666478592,2842636476,372324522,3817729613,2969243214]),E=0;E<v;E++){n.fill(0),o.fill(0);for(var b=16*E,S=0;S<16;S++)n[S]=g.getUint32(4*(b+S),!1);for(var T=16;T<68;T++)n[T]=c(n[T-16]^n[T-9]^i(n[T-3],15))^i(n[T-13],7)^n[T-6];for(var A=0;A<64;A++)o[A]=n[A]^n[A+4];for(var w=y[0],C=y[1],I=y[2],O=y[3],R=y[4],N=y[5],D=y[6],j=y[7],L=void 0,M=void 0,P=void 0,x=void 0,k=void 0,B=0;B<64;B++)k=B>=0&&B<=15?2043430169:2055708042,M=(L=i(i(w,12)+R+i(k,B),7))^i(w,12),P=(B>=0&&B<=15?w^C^I:w&C|w&I|C&I)+O+M+o[B],x=(B>=0&&B<=15?R^N^D:R&N|~R&D)+j+L+n[B],O=I,I=i(C,9),C=w,w=P,j=D,D=i(N,19),N=R,R=a(x);y[0]^=w,y[1]^=C,y[2]^=I,y[3]^=O,y[4]^=R,y[5]^=N,y[6]^=D,y[7]^=j}for(var U=[],G=0,q=y.length;G<q;G++){var F=y[G];U.push((4278190080&F)>>>24,(16711680&F)>>>16,(65280&F)>>>8,255&F)}return U}for(var l=64,d=new Uint8Array(l),p=new Uint8Array(l),f=0;f<l;f++)d[f]=54,p[f]=92;e.exports={sm3:u,hmac:function(e,t){for(t.length>l&&(t=u(t));t.length<l;)t.push(0);var r=s(t,d),n=s(t,p),o=u([].concat(r,e));return u([].concat(n,o))}}},function(e,t,r){e.exports={sm2:r(3),sm3:r(7),sm4:r(8)}},function(e,t,r){var n=r(0).BigInteger,o=r(4),i=o.encodeDer,s=o.decodeDer,a=r(5),c=r(1).sm3,u=a.generateEcparam(),l=u.G,d=u.curve,p=u.n,f=0;function _(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"1234567812345678";r=a.utf8ToHex(r);var n=a.leftPad(l.curve.a.toBigInteger().toRadix(16),64),o=a.leftPad(l.curve.b.toBigInteger().toRadix(16),64),i=a.leftPad(l.getX().toBigInteger().toRadix(16),64),s=a.leftPad(l.getY().toBigInteger().toRadix(16),64),u=void 0,d=void 0;if(128===t.length)u=t.substr(0,64),d=t.substr(64,64);else{var p=l.curve.decodePointHex(t);u=a.leftPad(p.getX().toBigInteger().toRadix(16),64),d=a.leftPad(p.getY().toBigInteger().toRadix(16),64)}var f=a.hexToArray(r+n+o+i+s+u+d),_=4*r.length;f.unshift(255&_),f.unshift(_>>8&255);var m=c(f);return a.arrayToHex(c(m.concat(a.hexToArray(e))))}function m(){var e=a.generateKeyPairHex(),t=d.decodePointHex(e.publicKey);return e.k=new n(e.privateKey,16),e.x1=t.getX().toBigInteger(),e}e.exports={generateKeyPairHex:a.generateKeyPairHex,compressPublicKeyHex:a.compressPublicKeyHex,comparePublicKeyHex:a.comparePublicKeyHex,doEncrypt:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;e="string"==typeof e?a.hexToArray(a.utf8ToHex(e)):Array.prototype.slice.call(e),t=a.getGlobalCurve().decodePointHex(t);var o=a.generateKeyPairHex(),i=new n(o.privateKey,16),s=o.publicKey;s.length>128&&(s=s.substr(s.length-128));var u=t.multiply(i),l=a.hexToArray(a.leftPad(u.getX().toBigInteger().toRadix(16),64)),d=a.hexToArray(a.leftPad(u.getY().toBigInteger().toRadix(16),64)),p=a.arrayToHex(c([].concat(l,e,d))),_=1,m=0,h=[],g=[].concat(l,d),v=function(){h=c([].concat(g,[_>>24&255,_>>16&255,_>>8&255,255&_])),_++,m=0};v();for(var y=0,E=e.length;y<E;y++)m===h.length&&v(),e[y]^=255&h[m++];var b=a.arrayToHex(e);return r===f?s+b+p:s+p+b},doDecrypt:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}).output,i=void 0===o?"string":o;t=new n(t,16);var s=e.substr(128,64),u=e.substr(192);r===f&&(s=e.substr(e.length-64),u=e.substr(128,e.length-128-64));var l=a.hexToArray(u),d=a.getGlobalCurve().decodePointHex("04"+e.substr(0,128)).multiply(t),p=a.hexToArray(a.leftPad(d.getX().toBigInteger().toRadix(16),64)),_=a.hexToArray(a.leftPad(d.getY().toBigInteger().toRadix(16),64)),m=1,h=0,g=[],v=[].concat(p,_),y=function(){g=c([].concat(v,[m>>24&255,m>>16&255,m>>8&255,255&m])),m++,h=0};y();for(var E=0,b=l.length;E<b;E++)h===g.length&&y(),l[E]^=255&g[h++];return a.arrayToHex(c([].concat(p,l,_)))===s.toLowerCase()?"array"===i?l:a.arrayToUtf8(l):"array"===i?[]:""},doSignature:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=r.pointPool,s=r.der,c=r.hash,u=r.publicKey,d=r.userId,f="string"==typeof e?a.utf8ToHex(e):a.arrayToHex(e);c&&(f=_(f,u=u||function(e){var t=l.multiply(new n(e,16)),r=a.leftPad(t.getX().toBigInteger().toString(16),64),o=a.leftPad(t.getY().toBigInteger().toString(16),64);return"04"+r+o}(t),d));var h=new n(t,16),g=new n(f,16),v=null,y=null,E=null;do{do{var b=void 0;v=(b=o&&o.length?o.pop():m()).k,y=g.add(b.x1).mod(p)}while(y.equals(n.ZERO)||y.add(v).equals(p));E=h.add(n.ONE).modInverse(p).multiply(v.subtract(y.multiply(h))).mod(p)}while(E.equals(n.ZERO));return s?i(y,E):a.leftPad(y.toString(16),64)+a.leftPad(E.toString(16),64)},doVerifySignature:function(e,t,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=o.der,c=o.hash,u=o.userId,f="string"==typeof e?a.utf8ToHex(e):a.arrayToHex(e);c&&(f=_(f,r,u));var m=void 0,h=void 0;if(i){var g=s(t);m=g.r,h=g.s}else m=new n(t.substring(0,64),16),h=new n(t.substring(64),16);var v=d.decodePointHex(r),y=new n(f,16),E=m.add(h).mod(p);if(E.equals(n.ZERO))return!1;var b=l.multiply(h).add(v.multiply(E)),S=y.add(b.getX().toBigInteger()).mod(p);return m.equals(S)},getPoint:m,verifyPublicKey:a.verifyPublicKey}},function(e,t,r){function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=r(0).BigInteger;var a=function(){function e(){i(this,e),this.tlv=null,this.t="00",this.l="00",this.v=""}return e.prototype.getEncodedHex=function(){return this.tlv||(this.v=this.getValue(),this.l=this.getLength(),this.tlv=this.t+this.l+this.v),this.tlv},e.prototype.getLength=function(){var e=this.v.length/2,t=e.toString(16);return t.length%2==1&&(t="0"+t),e<128?t:(128+t.length/2).toString(16)+t},e.prototype.getValue=function(){return""},e}(),c=function(e){function t(r){i(this,t);var o=n(this,e.call(this));return o.t="02",r&&(o.v=function(e){var t=e.toString(16);if("-"!==t[0])t.length%2==1?t="0"+t:t.match(/^[0-7]/)||(t="00"+t);else{var r=(t=t.substr(1)).length;r%2==1?r+=1:t.match(/^[0-7]/)||(r+=2);for(var n="",o=0;o<r;o++)n+="f";t=(t=(n=new s(n,16)).xor(e).add(s.ONE)).toString(16).replace(/^-/,"")}return t}(r)),o}return o(t,e),t.prototype.getValue=function(){return this.v},t}(a),u=function(e){function t(r){i(this,t);var o=n(this,e.call(this));return o.t="30",o.asn1Array=r,o}return o(t,e),t.prototype.getValue=function(){return this.v=this.asn1Array.map(function(e){return e.getEncodedHex()}).join(""),this.v},t}(a);function l(e,t){return+e[t+2]<8?1:128&+e.substr(t+2,2)}function d(e,t){var r=l(e,t),n=e.substr(t+2,2*r);return n?(+n[0]<8?new s(n,16):new s(n.substr(2),16)).intValue():-1}function p(e,t){return t+2*(l(e,t)+1)}e.exports={encodeDer:function(e,t){var r=new c(e),n=new c(t);return new u([r,n]).getEncodedHex()},decodeDer:function(e){var t=p(e,0),r=p(e,t),n=d(e,t),o=e.substr(r,2*n),i=r+o.length,a=p(e,i),c=d(e,i),u=e.substr(a,2*c);return{r:new s(o,16),s:new s(u,16)}}}},function(e,t,r){var n=r(0),o=n.BigInteger,i=n.SecureRandom,s=r(6).ECCurveFp,a=new i,c=p(),u=c.curve,l=c.G,d=c.n;function p(){var e=new o("FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFF",16),t=new o("FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFC",16),r=new o("28E9FA9E9D9F5E344D5A9E4BCF6509A7F39789F515AB8F92DDBCBD414D940E93",16),n=new s(e,t,r);return{curve:n,G:n.decodePointHex("0432C4AE2C1F1981195F9904466A39C9948FE30BBFF2660BE1715A4589334C74C7BC3736A2F4F6779C59BDCEE36B692153D0A9877CC62A474002DF32E52139F0A0"),n:new o("FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFF7203DF6B21C6052B53BBF40939D54123",16)}}function f(e,t){return e.length>=t?e:new Array(t-e.length+1).join("0")+e}e.exports={getGlobalCurve:function(){return u},generateEcparam:p,generateKeyPairHex:function(e,t,r){var n=(e?new o(e,t,r):new o(d.bitLength(),a)).mod(d.subtract(o.ONE)).add(o.ONE),i=f(n.toString(16),64),s=l.multiply(n);return{privateKey:i,publicKey:"04"+f(s.getX().toBigInteger().toString(16),64)+f(s.getY().toBigInteger().toString(16),64)}},compressPublicKeyHex:function(e){if(130!==e.length)throw new Error("Invalid public key to compress");var t=(e.length-2)/2,r=e.substr(2,t),n="03";return new o(e.substr(t+2,t),16).mod(new o("2")).equals(o.ZERO)&&(n="02"),n+r},utf8ToHex:function(e){for(var t=(e=unescape(encodeURIComponent(e))).length,r=[],n=0;n<t;n++)r[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;for(var o=[],i=0;i<t;i++){var s=r[i>>>2]>>>24-i%4*8&255;o.push((s>>>4).toString(16)),o.push((15&s).toString(16))}return o.join("")},leftPad:f,arrayToHex:function(e){return e.map(function(e){return 1===(e=e.toString(16)).length?"0"+e:e}).join("")},arrayToUtf8:function(e){for(var t=[],r=0,n=0;n<2*e.length;n+=2)t[n>>>3]|=parseInt(e[r],10)<<24-n%8*4,r++;try{for(var o=[],i=0;i<e.length;i++){var s=t[i>>>2]>>>24-i%4*8&255;o.push(String.fromCharCode(s))}return decodeURIComponent(escape(o.join("")))}catch(e){throw new Error("Malformed UTF-8 data")}},hexToArray:function(e){var t=[],r=e.length;r%2!=0&&(e=f(e,r+1)),r=e.length;for(var n=0;n<r;n+=2)t.push(parseInt(e.substr(n,2),16));return t},verifyPublicKey:function(e){var t=u.decodePointHex(e);if(!t)return!1;var r=t.getX();return t.getY().square().equals(r.multiply(r.square()).add(r.multiply(u.a)).add(u.b))},comparePublicKeyHex:function(e,t){var r=u.decodePointHex(e);if(!r)return!1;var n=u.decodePointHex(t);return!!n&&r.equals(n)}}},function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=r(0).BigInteger,i=new o("2"),s=new o("3"),a=function(){function e(t,r){n(this,e),this.x=r,this.q=t}return e.prototype.equals=function(e){return e===this||this.q.equals(e.q)&&this.x.equals(e.x)},e.prototype.toBigInteger=function(){return this.x},e.prototype.negate=function(){return new e(this.q,this.x.negate().mod(this.q))},e.prototype.add=function(t){return new e(this.q,this.x.add(t.toBigInteger()).mod(this.q))},e.prototype.subtract=function(t){return new e(this.q,this.x.subtract(t.toBigInteger()).mod(this.q))},e.prototype.multiply=function(t){return new e(this.q,this.x.multiply(t.toBigInteger()).mod(this.q))},e.prototype.divide=function(t){return new e(this.q,this.x.multiply(t.toBigInteger().modInverse(this.q)).mod(this.q))},e.prototype.square=function(){return new e(this.q,this.x.square().mod(this.q))},e}(),c=function(){function e(t,r,i,s){n(this,e),this.curve=t,this.x=r,this.y=i,this.z=null==s?o.ONE:s,this.zinv=null}return e.prototype.getX=function(){return null===this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))},e.prototype.getY=function(){return null===this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))},e.prototype.equals=function(e){return e===this||(this.isInfinity()?e.isInfinity():e.isInfinity()?this.isInfinity():!!e.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(e.z)).mod(this.curve.q).equals(o.ZERO)&&e.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(e.z)).mod(this.curve.q).equals(o.ZERO))},e.prototype.isInfinity=function(){return null===this.x&&null===this.y||this.z.equals(o.ZERO)&&!this.y.toBigInteger().equals(o.ZERO)},e.prototype.negate=function(){return new e(this.curve,this.x,this.y.negate(),this.z)},e.prototype.add=function(t){if(this.isInfinity())return t;if(t.isInfinity())return this;var r=this.x.toBigInteger(),n=this.y.toBigInteger(),i=this.z,s=t.x.toBigInteger(),a=t.y.toBigInteger(),c=t.z,u=this.curve.q,l=r.multiply(c).mod(u),d=s.multiply(i).mod(u),p=l.subtract(d),f=n.multiply(c).mod(u),_=a.multiply(i).mod(u),m=f.subtract(_);if(o.ZERO.equals(p))return o.ZERO.equals(m)?this.twice():this.curve.infinity;var h=l.add(d),g=i.multiply(c).mod(u),v=p.square().mod(u),y=p.multiply(v).mod(u),E=g.multiply(m.square()).subtract(h.multiply(v)).mod(u),b=p.multiply(E).mod(u),S=m.multiply(v.multiply(l).subtract(E)).subtract(f.multiply(y)).mod(u),T=y.multiply(g).mod(u);return new e(this.curve,this.curve.fromBigInteger(b),this.curve.fromBigInteger(S),T)},e.prototype.twice=function(){if(this.isInfinity())return this;if(!this.y.toBigInteger().signum())return this.curve.infinity;var t=this.x.toBigInteger(),r=this.y.toBigInteger(),n=this.z,o=this.curve.q,i=this.curve.a.toBigInteger(),a=t.square().multiply(s).add(i.multiply(n.square())).mod(o),c=r.shiftLeft(1).multiply(n).mod(o),u=r.square().mod(o),l=u.multiply(t).multiply(n).mod(o),d=c.square().mod(o),p=a.square().subtract(l.shiftLeft(3)).mod(o),f=c.multiply(p).mod(o),_=a.multiply(l.shiftLeft(2).subtract(p)).subtract(d.shiftLeft(1).multiply(u)).mod(o),m=c.multiply(d).mod(o);return new e(this.curve,this.curve.fromBigInteger(f),this.curve.fromBigInteger(_),m)},e.prototype.multiply=function(e){if(this.isInfinity())return this;if(!e.signum())return this.curve.infinity;for(var t=e.multiply(s),r=this.negate(),n=this,o=t.bitLength()-2;o>0;o--){n=n.twice();var i=t.testBit(o);i!==e.testBit(o)&&(n=n.add(i?this:r))}return n},e}(),u=function(){function e(t,r,o){n(this,e),this.q=t,this.a=this.fromBigInteger(r),this.b=this.fromBigInteger(o),this.infinity=new c(this,null,null)}return e.prototype.equals=function(e){return e===this||this.q.equals(e.q)&&this.a.equals(e.a)&&this.b.equals(e.b)},e.prototype.fromBigInteger=function(e){return new a(this.q,e)},e.prototype.decodePointHex=function(e){switch(parseInt(e.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:var t=this.fromBigInteger(new o(e.substr(2),16)),r=this.fromBigInteger(t.multiply(t.square()).add(t.multiply(this.a)).add(this.b).toBigInteger().modPow(this.q.divide(new o("4")).add(o.ONE),this.q));return r.toBigInteger().mod(i).equals(new o(e.substr(0,2),16).subtract(i))||(r=r.negate()),new c(this,t,r);case 4:case 6:case 7:var n=(e.length-2)/2,s=e.substr(2,n),a=e.substr(n+2,n);return new c(this,this.fromBigInteger(new o(s,16)),this.fromBigInteger(new o(a,16)));default:return null}},e}();e.exports={ECPointFp:c,ECCurveFp:u}},function(e,t,r){var n=r(1),o=n.sm3,i=n.hmac;function s(e){return e.map(function(e){return 1===(e=e.toString(16)).length?"0"+e:e}).join("")}function a(e){var t=[],r=e.length;r%2!=0&&(e=function(e,t){return e.length>=t?e:new Array(t-e.length+1).join("0")+e}(e,r+1)),r=e.length;for(var n=0;n<r;n+=2)t.push(parseInt(e.substr(n,2),16));return t}e.exports=function(e,t){if(e="string"==typeof e?function(e){for(var t=[],r=0,n=e.length;r<n;r++){var o=e.codePointAt(r);if(o<=127)t.push(o);else if(o<=2047)t.push(192|o>>>6),t.push(128|63&o);else if(o<=55295||o>=57344&&o<=65535)t.push(224|o>>>12),t.push(128|o>>>6&63),t.push(128|63&o);else{if(!(o>=65536&&o<=1114111))throw t.push(o),new Error("input is not supported");r++,t.push(240|o>>>18&28),t.push(128|o>>>12&63),t.push(128|o>>>6&63),t.push(128|63&o)}}return t}(e):Array.prototype.slice.call(e),t){if("hmac"!==(t.mode||"hmac"))throw new Error("invalid mode");var r=t.key;if(!r)throw new Error("invalid key");return r="string"==typeof r?a(r):Array.prototype.slice.call(r),s(i(e,r))}return s(o(e))}},function(e,t,r){var n=0,o=32,i=16,s=[214,144,233,254,204,225,61,183,22,182,20,194,40,251,44,5,43,103,154,118,42,190,4,195,170,68,19,38,73,134,6,153,156,66,80,244,145,239,152,122,51,84,11,67,237,207,172,98,228,179,28,169,201,8,232,149,128,223,148,250,117,143,63,166,71,7,167,252,243,115,23,186,131,89,60,25,230,133,79,168,104,107,129,178,113,100,218,139,248,235,15,75,112,86,157,53,30,36,14,94,99,88,209,162,37,34,124,59,1,33,120,135,212,0,70,87,159,211,39,82,76,54,2,231,160,196,200,158,234,191,138,210,64,199,56,181,163,247,242,206,249,97,21,161,224,174,93,164,155,52,26,85,173,147,50,48,245,140,177,227,29,246,226,46,130,102,202,96,192,41,35,171,13,83,78,111,213,219,55,69,222,253,142,47,3,255,106,114,109,108,91,81,141,27,175,146,187,221,188,127,17,217,92,65,31,16,90,216,10,193,49,136,165,205,123,189,45,116,208,18,184,229,180,176,137,105,151,74,12,150,119,126,101,185,241,9,197,110,198,132,24,240,125,236,58,220,77,32,121,238,95,62,215,203,57,72],a=[462357,472066609,943670861,1415275113,1886879365,2358483617,2830087869,3301692121,3773296373,4228057617,404694573,876298825,1347903077,1819507329,2291111581,2762715833,3234320085,3705924337,4177462797,337322537,808926789,1280531041,1752135293,2223739545,2695343797,3166948049,3638552301,4110090761,269950501,741554753,1213159005,1684763257];function c(e){for(var t=[],r=0,n=e.length;r<n;r+=2)t.push(parseInt(e.substr(r,2),16));return t}function u(e,t){return e<<t|e>>>32-t}function l(e){return(255&s[e>>>24&255])<<24|(255&s[e>>>16&255])<<16|(255&s[e>>>8&255])<<8|255&s[255&e]}function d(e){return e^u(e,2)^u(e,10)^u(e,18)^u(e,24)}function p(e){return e^u(e,13)^u(e,23)}function f(e,t,r){for(var n=new Array(4),o=new Array(4),i=0;i<4;i++)o[0]=255&e[4*i],o[1]=255&e[4*i+1],o[2]=255&e[4*i+2],o[3]=255&e[4*i+3],n[i]=o[0]<<24|o[1]<<16|o[2]<<8|o[3];for(var s,a=0;a<32;a+=4)s=n[1]^n[2]^n[3]^r[a+0],n[0]^=d(l(s)),s=n[2]^n[3]^n[0]^r[a+1],n[1]^=d(l(s)),s=n[3]^n[0]^n[1]^r[a+2],n[2]^=d(l(s)),s=n[0]^n[1]^n[2]^r[a+3],n[3]^=d(l(s));for(var c=0;c<16;c+=4)t[c]=n[3-c/4]>>>24&255,t[c+1]=n[3-c/4]>>>16&255,t[c+2]=n[3-c/4]>>>8&255,t[c+3]=255&n[3-c/4]}function _(e,t,r){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},u=s.padding,d=void 0===u?"pkcs#7":u,_=s.mode,m=s.iv,h=void 0===m?[]:m,g=s.output,v=void 0===g?"string":g;if("cbc"===_&&("string"==typeof h&&(h=c(h)),16!==h.length))throw new Error("iv is invalid");if("string"==typeof t&&(t=c(t)),16!==t.length)throw new Error("key is invalid");if(e="string"==typeof e?r!==n?function(e){for(var t=[],r=0,n=e.length;r<n;r++){var o=e.codePointAt(r);if(o<=127)t.push(o);else if(o<=2047)t.push(192|o>>>6),t.push(128|63&o);else if(o<=55295||o>=57344&&o<=65535)t.push(224|o>>>12),t.push(128|o>>>6&63),t.push(128|63&o);else{if(!(o>=65536&&o<=1114111))throw t.push(o),new Error("input is not supported");r++,t.push(240|o>>>18&28),t.push(128|o>>>12&63),t.push(128|o>>>6&63),t.push(128|63&o)}}return t}(e):c(e):[].concat(e),("pkcs#5"===d||"pkcs#7"===d)&&r!==n)for(var y=i-e.length%i,E=0;E<y;E++)e.push(y);var b=new Array(o);!function(e,t,r){for(var o=new Array(4),i=new Array(4),s=0;s<4;s++)i[0]=255&e[0+4*s],i[1]=255&e[1+4*s],i[2]=255&e[2+4*s],i[3]=255&e[3+4*s],o[s]=i[0]<<24|i[1]<<16|i[2]<<8|i[3];o[0]^=2746333894,o[1]^=1453994832,o[2]^=1736282519,o[3]^=2993693404;for(var c,u=0;u<32;u+=4)c=o[1]^o[2]^o[3]^a[u+0],t[u+0]=o[0]^=p(l(c)),c=o[2]^o[3]^o[0]^a[u+1],t[u+1]=o[1]^=p(l(c)),c=o[3]^o[0]^o[1]^a[u+2],t[u+2]=o[2]^=p(l(c)),c=o[0]^o[1]^o[2]^a[u+3],t[u+3]=o[3]^=p(l(c));if(r===n)for(var d,f=0;f<16;f++)d=t[f],t[f]=t[31-f],t[31-f]=d}(t,b,r);for(var S=[],T=h,A=e.length,w=0;A>=i;){var C=e.slice(w,w+16),I=new Array(16);if("cbc"===_)for(var O=0;O<i;O++)r!==n&&(C[O]^=T[O]);f(C,I,b);for(var R=0;R<i;R++)"cbc"===_&&r===n&&(I[R]^=T[R]),S[w+R]=I[R];"cbc"===_&&(T=r!==n?I:C),A-=i,w+=i}if(("pkcs#5"===d||"pkcs#7"===d)&&r===n){for(var N=S.length,D=S[N-1],j=1;j<=D;j++)if(S[N-j]!==D)throw new Error("padding is invalid");S.splice(N-D,D)}return"array"!==v?r!==n?function(e){return e.map(function(e){return 1===(e=e.toString(16)).length?"0"+e:e}).join("")}(S):function(e){for(var t=[],r=0,n=e.length;r<n;r++)e[r]>=240&&e[r]<=247?(t.push(String.fromCodePoint(((7&e[r])<<18)+((63&e[r+1])<<12)+((63&e[r+2])<<6)+(63&e[r+3]))),r+=3):e[r]>=224&&e[r]<=239?(t.push(String.fromCodePoint(((15&e[r])<<12)+((63&e[r+1])<<6)+(63&e[r+2]))),r+=2):e[r]>=192&&e[r]<=223?(t.push(String.fromCodePoint(((31&e[r])<<6)+(63&e[r+1]))),r++):t.push(String.fromCodePoint(e[r]));return t.join("")}(S):S}e.exports={encrypt:function(e,t,r){return _(e,t,1,r)},decrypt:function(e,t,r){return _(e,t,0,r)}}}])}});init_esm_shims();var v1_exports={};__export(v1_exports,{decode:()=>decode,decodeRequest:()=>decodeRequest,decodeResponse:()=>decodeResponse,decodeStdPrivResponse:()=>decodeStdPrivResponse,encode:()=>encode,encodeRequest:()=>encodeRequest,encodeResponse:()=>encodeResponse,encodeStdPrivRequest:()=>encodeStdPrivRequest}),init_esm_shims(),init_esm_shims(),init_esm_shims();var AppProtocolV1=(e=>(e.pb="PB",e.json="JSON",e))(AppProtocolV1||{});function is_number(e){return"number"==typeof e}function is_bytes(e){return e instanceof Uint8Array}function _heap_init(e,t,r){var n=t?t.byteLength:r||65536;if(4095&n||n<=0)throw new Error("heap size must be a positive integer and a multiple of 4096");return t=t||new e(new ArrayBuffer(n))}function _heap_write(e,t,r,n,o){var i=e.length-t,s=i<o?i:o;return e.set(r.subarray(n,n+s),t),s}init_esm_shims(),init_esm_shims();var IllegalArgumentError=(()=>{function e(){var e=Error.apply(this,arguments);this.message=e.message,this.stack=e.stack}return e.prototype=Object.create(Error.prototype,{name:{value:"IllegalArgumentError"}}),e})(),SecurityError=(()=>{function e(){var e=Error.apply(this,arguments);this.message=e.message,this.stack=e.stack}return e.prototype=Object.create(Error.prototype,{name:{value:"SecurityError"}}),e})(),AES_asm=(()=>{var e,t,r,n,o,i,s=!1;function a(r,n){var o=e[(t[r]+t[n])%255];return 0!==r&&0!==n||(o=0),o}function c(){function c(r){var n,o,i;for(o=i=function(r){var n=e[255-t[r]];return 0===r&&(n=0),n}(r),n=0;n<4;n++)i^=o=255&(o<<1|o>>>7);return i^=99}s||function(){e=[],t=[];var r,n,o=1;for(r=0;r<255;r++)e[r]=o,n=128&o,o<<=1,o&=255,128===n&&(o^=27),o^=e[r],t[e[r]]=r;e[255]=e[0],t[0]=0,s=!0}(),r=[],n=[],o=[[],[],[],[]],i=[[],[],[],[]];for(var u=0;u<256;u++){var l=c(u);r[u]=l,n[l]=u,o[0][u]=a(2,l)<<24|l<<16|l<<8|a(3,l),i[0][l]=a(14,u)<<24|a(9,u)<<16|a(13,u)<<8|a(11,u);for(var d=1;d<4;d++)o[d][u]=o[d-1][u]>>>8|o[d-1][u]<<24,i[d][l]=i[d-1][l]>>>8|i[d-1][l]<<24}}var u=function(e,t){c();var s=new Uint32Array(t);s.set(r,512),s.set(n,768);for(var a=0;a<4;a++)s.set(o[a],4096+1024*a>>2),s.set(i[a],8192+1024*a>>2);var u=function(e,t,r){var n=0,o=0,i=0,s=0,a=0,c=0,u=0,l=0,d=0,p=0,f=0,_=0,m=0,h=0,g=0,v=0,y=0,E=new e.Uint32Array(r),b=new e.Uint8Array(r);function S(e,t,r,a,c,u,l,d){t|=0,a|=0,c|=0,u|=0,l|=0,d|=0;var p,f,_,m=0,h=0,g=0,v=0,y=0;for(p=1024|(r|=0),f=2048|r,_=3072|r,c^=E[(0|(e|=0))>>2],u^=E[(4|e)>>2],l^=E[(8|e)>>2],d^=E[(12|e)>>2],y=16;(0|y)<=a<<4;y=y+16|0)m=E[(r|c>>22&1020)>>2]^E[(p|u>>14&1020)>>2]^E[(f|l>>6&1020)>>2]^E[(_|d<<2&1020)>>2]^E[(e|y|0)>>2],h=E[(r|u>>22&1020)>>2]^E[(p|l>>14&1020)>>2]^E[(f|d>>6&1020)>>2]^E[(_|c<<2&1020)>>2]^E[(e|y|4)>>2],g=E[(r|l>>22&1020)>>2]^E[(p|d>>14&1020)>>2]^E[(f|c>>6&1020)>>2]^E[(_|u<<2&1020)>>2]^E[(e|y|8)>>2],v=E[(r|d>>22&1020)>>2]^E[(p|c>>14&1020)>>2]^E[(f|u>>6&1020)>>2]^E[(_|l<<2&1020)>>2]^E[(e|y|12)>>2],c=m,u=h,l=g,d=v;n=E[(t|c>>22&1020)>>2]<<24^E[(t|u>>14&1020)>>2]<<16^E[(t|l>>6&1020)>>2]<<8^E[(t|d<<2&1020)>>2]^E[(e|y|0)>>2],o=E[(t|u>>22&1020)>>2]<<24^E[(t|l>>14&1020)>>2]<<16^E[(t|d>>6&1020)>>2]<<8^E[(t|c<<2&1020)>>2]^E[(e|y|4)>>2],i=E[(t|l>>22&1020)>>2]<<24^E[(t|d>>14&1020)>>2]<<16^E[(t|c>>6&1020)>>2]<<8^E[(t|u<<2&1020)>>2]^E[(e|y|8)>>2],s=E[(t|d>>22&1020)>>2]<<24^E[(t|c>>14&1020)>>2]<<16^E[(t|u>>6&1020)>>2]<<8^E[(t|l<<2&1020)>>2]^E[(e|y|12)>>2]}function T(e,t,r,d){S(0,2048,4096,y,a^(e|=0),c^(t|=0),u^(r|=0),l^(d|=0)),a=n,c=o,u=i,l=s}var A=[,,T,function(e,t,r,d){var p;S(1024,3072,8192,y,e|=0,d|=0,r|=0,t|=0),p=o,o=s,s=p,n^=a,o^=c,i^=u,s^=l,a=e,c=t,u=r,l=d},,,,],w=[T];return{set_rounds:function(e){y=e|=0},set_state:function(e,t,r,a){n=e|=0,o=t|=0,i=r|=0,s=a|=0},set_iv:function(e,t,r,n){a=e|=0,c=t|=0,u=r|=0,l=n|=0},set_nonce:function(e,t,r,n){d=e|=0,p=t|=0,f=r|=0,_=n|=0},set_mask:function(e,t,r,n){m=e|=0,h=t|=0,g=r|=0,v=n|=0},set_counter:function(e,t,r,n){_=~v&_|v&(n|=0),f=~g&f|g&(r|=0),p=~h&p|h&(t|=0),d=~m&d|m&(e|=0)},get_state:function(e){return 15&(e|=0)?-1:(b[0|e]=n>>>24,b[1|e]=n>>>16&255,b[2|e]=n>>>8&255,b[3|e]=255&n,b[4|e]=o>>>24,b[5|e]=o>>>16&255,b[6|e]=o>>>8&255,b[7|e]=255&o,b[8|e]=i>>>24,b[9|e]=i>>>16&255,b[10|e]=i>>>8&255,b[11|e]=255&i,b[12|e]=s>>>24,b[13|e]=s>>>16&255,b[14|e]=s>>>8&255,b[15|e]=255&s,16)},get_iv:function(e){return 15&(e|=0)?-1:(b[0|e]=a>>>24,b[1|e]=a>>>16&255,b[2|e]=a>>>8&255,b[3|e]=255&a,b[4|e]=c>>>24,b[5|e]=c>>>16&255,b[6|e]=c>>>8&255,b[7|e]=255&c,b[8|e]=u>>>24,b[9|e]=u>>>16&255,b[10|e]=u>>>8&255,b[11|e]=255&u,b[12|e]=l>>>24,b[13|e]=l>>>16&255,b[14|e]=l>>>8&255,b[15|e]=255&l,16)},cipher:function(e,t,r){e|=0,r|=0;var a=0;if(15&(t|=0))return-1;for(;(0|r)>=16;)A[7&e](b[0|t]<<24|b[1|t]<<16|b[2|t]<<8|b[3|t],b[4|t]<<24|b[5|t]<<16|b[6|t]<<8|b[7|t],b[8|t]<<24|b[9|t]<<16|b[10|t]<<8|b[11|t],b[12|t]<<24|b[13|t]<<16|b[14|t]<<8|b[15|t]),b[0|t]=n>>>24,b[1|t]=n>>>16&255,b[2|t]=n>>>8&255,b[3|t]=255&n,b[4|t]=o>>>24,b[5|t]=o>>>16&255,b[6|t]=o>>>8&255,b[7|t]=255&o,b[8|t]=i>>>24,b[9|t]=i>>>16&255,b[10|t]=i>>>8&255,b[11|t]=255&i,b[12|t]=s>>>24,b[13|t]=s>>>16&255,b[14|t]=s>>>8&255,b[15|t]=255&s,a=a+16|0,t=t+16|0,r=r-16|0;return 0|a},mac:function(e,t,r){e|=0,r|=0;var n=0;if(15&(t|=0))return-1;for(;(0|r)>=16;)w[1&e](b[0|t]<<24|b[1|t]<<16|b[2|t]<<8|b[3|t],b[4|t]<<24|b[5|t]<<16|b[6|t]<<8|b[7|t],b[8|t]<<24|b[9|t]<<16|b[10|t]<<8|b[11|t],b[12|t]<<24|b[13|t]<<16|b[14|t]<<8|b[15|t]),n=n+16|0,t=t+16|0,r=r-16|0;return 0|n}}}({Uint8Array:Uint8Array,Uint32Array:Uint32Array},0,t);return u.set_key=function(e,t,n,o,a,c,l,d,p){var f=s.subarray(0,60),_=s.subarray(256,316);f.set([t,n,o,a,c,l,d,p]);for(var m=e,h=1;m<4*e+28;m++){var g=f[m-1];(m%e==0||8===e&&m%e==4)&&(g=r[g>>>24]<<24^r[g>>>16&255]<<16^r[g>>>8&255]<<8^r[255&g]),m%e==0&&(g=g<<8^g>>>24^h<<24,h=h<<1^(128&h?27:0)),f[m]=f[m-e]^g}for(var v=0;v<m;v+=4)for(var y=0;y<4;y++)g=f[m-(4+v)+(4-y)%4],_[v+y]=v<4||v>=m-4?g:i[0][r[g>>>24]]^i[1][r[g>>>16&255]]^i[2][r[g>>>8&255]]^i[3][r[255&g]];u.set_rounds(e+5)},u};return u.ENC={CBC:2},u.DEC={CBC:3},u.MAC={CBC:0},u.HEAP_DATA=16384,u})(),_AES_heap_instance=new Uint8Array(1048576),_AES_asm_instance=AES_asm(null,_AES_heap_instance.buffer),AES=class{constructor(e,t,r,n,o){this.nonce=null,this.counter=0,this.counterSize=0,this.heap=_heap_init(Uint8Array,n).subarray(AES_asm.HEAP_DATA),this.asm=o||AES_asm(null,this.heap.buffer),this.mode=null,this.key=null,this.AES_reset(e,t,r)}AES_set_key(e){if(void 0!==e){if(!is_bytes(e))throw new TypeError("unexpected key type");var t=e.length;if(16!==t&&24!==t&&32!==t)throw new IllegalArgumentError("illegal key size");var r=new DataView(e.buffer,e.byteOffset,e.byteLength);this.asm.set_key(t>>2,r.getUint32(0),r.getUint32(4),r.getUint32(8),r.getUint32(12),t>16?r.getUint32(16):0,t>16?r.getUint32(20):0,t>24?r.getUint32(24):0,t>24?r.getUint32(28):0),this.key=e}else if(!this.key)throw new Error("key is required")}AES_CTR_set_options(e,t,r){if(void 0!==r){if(r<8||r>48)throw new IllegalArgumentError("illegal counter size");this.counterSize=r;var n=Math.pow(2,r)-1;this.asm.set_mask(0,0,n/4294967296|0,0|n)}else this.counterSize=r=48,this.asm.set_mask(0,0,65535,4294967295);if(void 0===e)throw new Error("nonce is required");if(!is_bytes(e))throw new TypeError("unexpected nonce type");var o=e.length;if(!o||o>16)throw new IllegalArgumentError("illegal nonce size");this.nonce=e;var i=new DataView(new ArrayBuffer(16));if(new Uint8Array(i.buffer).set(e),this.asm.set_nonce(i.getUint32(0),i.getUint32(4),i.getUint32(8),i.getUint32(12)),void 0!==t){if(!is_number(t))throw new TypeError("unexpected counter type");if(t<0||t>=Math.pow(2,r))throw new IllegalArgumentError("illegal counter value");this.counter=t,this.asm.set_counter(0,0,t/4294967296|0,0|t)}else this.counter=0}AES_set_iv(e){if(void 0!==e){if(!is_bytes(e))throw new TypeError("unexpected iv type");if(16!==e.length)throw new IllegalArgumentError("illegal iv size");var t=new DataView(e.buffer,e.byteOffset,e.byteLength);this.iv=e,this.asm.set_iv(t.getUint32(0),t.getUint32(4),t.getUint32(8),t.getUint32(12))}else this.iv=null,this.asm.set_iv(0,0,0,0)}AES_set_padding(e){this.padding=void 0===e||!!e}AES_reset(e,t,r){return this.result=null,this.pos=0,this.len=0,this.AES_set_key(e),this.AES_set_iv(t),this.AES_set_padding(r),this}AES_Encrypt_process(e){if(!is_bytes(e))throw new TypeError("data isn't of expected type");for(var t=this.asm,r=this.heap,n=AES_asm.ENC[this.mode],o=AES_asm.HEAP_DATA,i=this.pos,s=this.len,a=0,c=e.length||0,u=0,l=0,d=new Uint8Array(s+c&-16);c>0;)s+=l=_heap_write(r,i+s,e,a,c),a+=l,c-=l,(l=t.cipher(n,o+i,s))&&d.set(r.subarray(i,i+l),u),u+=l,l<s?(i+=l,s-=l):(i=0,s=0);return this.result=d,this.pos=i,this.len=s,this}AES_Encrypt_finish(e){var t=null,r=0;void 0!==e&&(r=(t=this.AES_Encrypt_process(e).result).length);var n=this.asm,o=this.heap,i=AES_asm.ENC[this.mode],s=AES_asm.HEAP_DATA,a=this.pos,c=this.len,u=16-c%16,l=c;if(this.hasOwnProperty("padding")){if(this.padding){for(var d=0;d<u;++d)o[a+c+d]=u;l=c+=u}else if(c%16)throw new IllegalArgumentError("data length must be a multiple of the block size")}else c+=u;var p=new Uint8Array(r+l);return r&&p.set(t),c&&n.cipher(i,s+a,c),l&&p.set(o.subarray(a,a+l),r),this.result=p,this.pos=0,this.len=0,this}AES_Decrypt_process(e){if(!is_bytes(e))throw new TypeError("data isn't of expected type");var t=this.asm,r=this.heap,n=AES_asm.DEC[this.mode],o=AES_asm.HEAP_DATA,i=this.pos,s=this.len,a=0,c=e.length||0,u=0,l=s+c&-16,d=0,p=0;this.padding&&(l-=d=s+c-l||16);for(var f=new Uint8Array(l);c>0;)s+=p=_heap_write(r,i+s,e,a,c),a+=p,c-=p,(p=t.cipher(n,o+i,s-(c?0:d)))&&f.set(r.subarray(i,i+p),u),u+=p,p<s?(i+=p,s-=p):(i=0,s=0);return this.result=f,this.pos=i,this.len=s,this}AES_Decrypt_finish(e){var t=null,r=0;void 0!==e&&(r=(t=this.AES_Decrypt_process(e).result).length);var n=this.asm,o=this.heap,i=AES_asm.DEC[this.mode],s=AES_asm.HEAP_DATA,a=this.pos,c=this.len,u=c;if(c>0){if(c%16){if(this.hasOwnProperty("padding"))throw new IllegalArgumentError("data length must be a multiple of the block size");c+=16-c%16}if(n.cipher(i,s+a,c),this.hasOwnProperty("padding")&&this.padding){var l=o[a+u-1];if(l<1||l>16||l>u)throw new SecurityError("bad padding");for(var d=0,p=l;p>1;p--)d|=l^o[a+u-p];if(d)throw new SecurityError("bad padding");u-=l}}var f=new Uint8Array(r+u);return r>0&&f.set(t),u>0&&f.set(o.subarray(a,a+u),r),this.result=f,this.pos=0,this.len=0,this}},AES_CBC=(()=>{class e extends AES{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,!(arguments.length>2&&void 0!==arguments[2])||arguments[2],arguments.length>3?arguments[3]:void 0,arguments.length>4?arguments[4]:void 0),this.mode="CBC",this.BLOCK_SIZE=16}encrypt(e){return this.AES_Encrypt_finish(e)}decrypt(e){return this.AES_Decrypt_finish(e)}}return e.encrypt=AES_CBC_encrypt_bytes,e.decrypt=AES_CBC_decrypt_bytes,e})(),__WXCrypto;function AES_CBC_encrypt_bytes(e,t,r,n){if(void 0===e)throw new SyntaxError("data required");if(void 0===t)throw new SyntaxError("key required");return new AES_CBC(t,n,r,_AES_heap_instance,_AES_asm_instance).encrypt(e).result}function AES_CBC_decrypt_bytes(e,t,r,n){if(void 0===e)throw new SyntaxError("data required");if(void 0===t)throw new SyntaxError("key required");return new AES_CBC(t,n,r,_AES_heap_instance,_AES_asm_instance).decrypt(e).result}function loadWASM(e){}function checkInt(e){return parseInt(e)===e}function checkInts(e){if(!checkInt(e.length))return!1;for(var t=0;t<e.length;t++)if(!checkInt(e[t])||e[t]<0||e[t]>255)return!1;return!0}function coerceArray(e,t){if(e.buffer&&ArrayBuffer.isView(e))return t&&(e=e.slice?e.slice():Array.prototype.slice.call(e)),e;if(Array.isArray(e)){if(!checkInts(e))throw new Error("[WACloudCrypto] Array contains invalid value: "+e);return new Uint8Array(e)}if(checkInt(e.length)&&checkInts(e))return new Uint8Array(e);throw new Error("[WACloudCrypto] unsupported array-like object")}function staticMalloc(){var e=16384;return t=>(e+=t)-t}function createArray(e){return new Uint8Array(e)}function copyArray(e,t,r,n,o){null==n&&null==o||(e=e.slice?e.slice(n,o):Array.prototype.slice.call(e,n,o)),t.set(e,r)}function pkcs7pad(e){var t=16-(e=coerceArray(e,!0)).length%16,r=createArray(e.length+t);copyArray(e,r);for(var n=e.length;n<r.length;n++)r[n]=t;return r}function pkcs7strip(e){if((e=coerceArray(e,!0)).length<16)throw new Error("[WACloudCrypto] PKCS#7 invalid length");var t=e[e.length-1];if(t>16)throw new Error("[WACloudCrypto] PKCS#7 padding byte out of range");for(var r=e.length-t,n=0;n<t;n++)if(e[r+n]!==t)throw new Error("[WACloudCrypto] PKCS#7 invalid padding byte");var o=createArray(r);return copyArray(e,o,0,0,r),o}function loadWACloudCrypto(e){return _loadWACloudCrypto.apply(this,arguments)}function _loadWACloudCrypto(){return(_loadWACloudCrypto=_asyncToGenerator(function*(e){var t,r=yield loadWASM(e),n=128,o=staticMalloc(),i=r,s=new Uint8Array(i.memory.buffer),a=o(276),c=o(276),u=o(n/8),l=o(16),d=o(0);function p(e){var t=coerceArray(e);s.set(t,d)}function f(e,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"CBC";s.set(r,l),s.set(e,u),i._aes_setkey_enc(a,u,n),i._aes_setkey_dec(c,u,n),t=o}return{init:f,encrypt:(e,r,n)=>(f(r,n,"CBC"),p(e=pkcs7pad(e)),"CBC"===t?i._aes_crypt_cbc(a,1,e.length,l,d,d):i._aes_crypt_ctr(a,e.length,l,d,d),s.subarray(d,d+e.length).slice()),decrypt:(e,r,n)=>(f(r,n,"CBC"),p(e),"CBC"===t?i._aes_crypt_cbc(c,0,e.length,l,d,d):i._aes_crypt_ctr(a,e.length,l,d,d),pkcs7strip(s.subarray(d,d+e.length).slice()))}})).apply(this,arguments)}function loadAccelerator(e){if(!__WXCrypto)return loadWACloudCrypto(e).then(e=>{__WXCrypto=e}).catch(()=>{})}function getAccelerator(){return __WXCrypto}function encrypt(e,t){var r=getAccelerator();return{encrypted:r?r.encrypt(t,e,e):AES_CBC.encrypt(t,e,void 0,e),backend:r?"wasm":"js"}}function stringToArrayBuffer(e){return stringToUtf8Array(e).buffer}function getType(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function isNil(e){return null==e}function stringToUtf8Array(e){var t=[];if("string"!=typeof e)return new Uint8Array;for(var r=0;r<e.length;r++){var n=e.charCodeAt(r);n<128?t.push(n):n<2048?t.push(192|n>>6,128|63&n):n<55296||n>=57344?t.push(224|n>>12,128|n>>6&63,128|63&n):(r++,n=65536+((1023&n)<<10|1023&e.charCodeAt(r)),t.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|63&n))}return new Uint8Array(t)}function concatArray(e){var t=e.reduce((e,t)=>e+t.length,0);if(!e.length)return null;var r=new Uint8Array(t),n=0;for(var o of e)r.set(o,n),n+=o.length;return r}function Uint8ArrayToString(e){return Utf8ArrayToStr(e)}init_esm_shims(),init_esm_shims(),init_esm_shims();var Utf8ArrayToStr=function(){var e=new Array(128),t=String.fromCodePoint||String.fromCharCode,r=[];return function(n){var o,i,s=n.length;r.length=0;for(var a=0;a<s;)(i=n[a++])<=127?o=i:i<=223?o=(31&i)<<6|63&n[a++]:i<=239?o=(15&i)<<12|(63&n[a++])<<6|63&n[a++]:String.fromCodePoint?o=(7&i)<<18|(63&n[a++])<<12|(63&n[a++])<<6|63&n[a++]:(o=63,a+=3),r.push(e[o]||(e[o]=t(o)));return r.join("")}}(),import_snappyjs=__toESM(require_snappyjs(),1);init_esm_shims();var $protobuf=__toESM(require_minimal2(),1),$Reader=$protobuf.Reader,$Writer=$protobuf.Writer,$util=$protobuf.util,$root=$protobuf.roots.default||($protobuf.roots.default={}),HTTPRequest=$root.HTTPRequest=(()=>{function e(e){if(this.header=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.method="",e.prototype.header=$util.emptyArray,e.prototype.body=$util.newBuffer([]),e.prototype.callId="",e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.method&&Object.hasOwnProperty.call(e,"method")&&t.uint32(10).string(e.method),null!=e.header&&e.header.length)for(var r=0;r<e.header.length;++r)$root.HTTPHeader.encode(e.header[r],t.uint32(18).fork()).ldelim();return null!=e.body&&Object.hasOwnProperty.call(e,"body")&&t.uint32(26).bytes(e.body),null!=e.callId&&Object.hasOwnProperty.call(e,"callId")&&t.uint32(34).string(e.callId),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.HTTPRequest;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:n.method=e.string();break;case 2:n.header&&n.header.length||(n.header=[]),n.header.push($root.HTTPHeader.decode(e,e.uint32()));break;case 3:n.body=e.bytes();break;case 4:n.callId=e.string();break;default:e.skipType(7&o)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.method&&e.hasOwnProperty("method")&&!$util.isString(e.method))return"method: string expected";if(null!=e.header&&e.hasOwnProperty("header")){if(!Array.isArray(e.header))return"header: array expected";for(var t=0;t<e.header.length;++t){var r=$root.HTTPHeader.verify(e.header[t]);if(r)return"header."+r}}return null!=e.body&&e.hasOwnProperty("body")&&!(e.body&&"number"==typeof e.body.length||$util.isString(e.body))?"body: buffer expected":null!=e.callId&&e.hasOwnProperty("callId")&&!$util.isString(e.callId)?"callId: string expected":null},e.fromObject=function(e){if(e instanceof $root.HTTPRequest)return e;var t=new $root.HTTPRequest;if(null!=e.method&&(t.method=String(e.method)),e.header){if(!Array.isArray(e.header))throw TypeError(".HTTPRequest.header: array expected");t.header=[];for(var r=0;r<e.header.length;++r){if("object"!=typeof e.header[r])throw TypeError(".HTTPRequest.header: object expected");t.header[r]=$root.HTTPHeader.fromObject(e.header[r])}}return null!=e.body&&("string"==typeof e.body?$util.base64.decode(e.body,t.body=$util.newBuffer($util.base64.length(e.body)),0):e.body.length>=0&&(t.body=e.body)),null!=e.callId&&(t.callId=String(e.callId)),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.header=[]),t.defaults&&(r.method="",t.bytes===String?r.body="":(r.body=[],t.bytes!==Array&&(r.body=$util.newBuffer(r.body))),r.callId=""),null!=e.method&&e.hasOwnProperty("method")&&(r.method=e.method),e.header&&e.header.length){r.header=[];for(var n=0;n<e.header.length;++n)r.header[n]=$root.HTTPHeader.toObject(e.header[n],t)}return null!=e.body&&e.hasOwnProperty("body")&&(r.body=t.bytes===String?$util.base64.encode(e.body,0,e.body.length):t.bytes===Array?Array.prototype.slice.call(e.body):e.body),null!=e.callId&&e.hasOwnProperty("callId")&&(r.callId=e.callId),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/HTTPRequest"},e})(),HTTPResponse=$root.HTTPResponse=(()=>{function e(e){if(this.header=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.statusCode=0,e.prototype.header=$util.emptyArray,e.prototype.bodyBuffer=$util.newBuffer([]),e.prototype.bodyString="",e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.statusCode&&Object.hasOwnProperty.call(e,"statusCode")&&t.uint32(8).uint32(e.statusCode),null!=e.header&&e.header.length)for(var r=0;r<e.header.length;++r)$root.HTTPHeader.encode(e.header[r],t.uint32(18).fork()).ldelim();return null!=e.bodyBuffer&&Object.hasOwnProperty.call(e,"bodyBuffer")&&t.uint32(26).bytes(e.bodyBuffer),null!=e.bodyString&&Object.hasOwnProperty.call(e,"bodyString")&&t.uint32(34).string(e.bodyString),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.HTTPResponse;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:n.statusCode=e.uint32();break;case 2:n.header&&n.header.length||(n.header=[]),n.header.push($root.HTTPHeader.decode(e,e.uint32()));break;case 3:n.bodyBuffer=e.bytes();break;case 4:n.bodyString=e.string();break;default:e.skipType(7&o)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.statusCode&&e.hasOwnProperty("statusCode")&&!$util.isInteger(e.statusCode))return"statusCode: integer expected";if(null!=e.header&&e.hasOwnProperty("header")){if(!Array.isArray(e.header))return"header: array expected";for(var t=0;t<e.header.length;++t){var r=$root.HTTPHeader.verify(e.header[t]);if(r)return"header."+r}}return null!=e.bodyBuffer&&e.hasOwnProperty("bodyBuffer")&&!(e.bodyBuffer&&"number"==typeof e.bodyBuffer.length||$util.isString(e.bodyBuffer))?"bodyBuffer: buffer expected":null!=e.bodyString&&e.hasOwnProperty("bodyString")&&!$util.isString(e.bodyString)?"bodyString: string expected":null},e.fromObject=function(e){if(e instanceof $root.HTTPResponse)return e;var t=new $root.HTTPResponse;if(null!=e.statusCode&&(t.statusCode=e.statusCode>>>0),e.header){if(!Array.isArray(e.header))throw TypeError(".HTTPResponse.header: array expected");t.header=[];for(var r=0;r<e.header.length;++r){if("object"!=typeof e.header[r])throw TypeError(".HTTPResponse.header: object expected");t.header[r]=$root.HTTPHeader.fromObject(e.header[r])}}return null!=e.bodyBuffer&&("string"==typeof e.bodyBuffer?$util.base64.decode(e.bodyBuffer,t.bodyBuffer=$util.newBuffer($util.base64.length(e.bodyBuffer)),0):e.bodyBuffer.length>=0&&(t.bodyBuffer=e.bodyBuffer)),null!=e.bodyString&&(t.bodyString=String(e.bodyString)),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.header=[]),t.defaults&&(r.statusCode=0,t.bytes===String?r.bodyBuffer="":(r.bodyBuffer=[],t.bytes!==Array&&(r.bodyBuffer=$util.newBuffer(r.bodyBuffer))),r.bodyString=""),null!=e.statusCode&&e.hasOwnProperty("statusCode")&&(r.statusCode=e.statusCode),e.header&&e.header.length){r.header=[];for(var n=0;n<e.header.length;++n)r.header[n]=$root.HTTPHeader.toObject(e.header[n],t)}return null!=e.bodyBuffer&&e.hasOwnProperty("bodyBuffer")&&(r.bodyBuffer=t.bytes===String?$util.base64.encode(e.bodyBuffer,0,e.bodyBuffer.length):t.bytes===Array?Array.prototype.slice.call(e.bodyBuffer):e.bodyBuffer),null!=e.bodyString&&e.hasOwnProperty("bodyString")&&(r.bodyString=e.bodyString),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/HTTPResponse"},e})(),HTTPHeader=$root.HTTPHeader=(()=>{function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.key="",e.prototype.value="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(10).string(e.key),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(18).string(e.value),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.HTTPHeader;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:n.key=e.string();break;case 2:n.value=e.string();break;default:e.skipType(7&o)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.key&&e.hasOwnProperty("key")&&!$util.isString(e.key)?"key: string expected":null!=e.value&&e.hasOwnProperty("value")&&!$util.isString(e.value)?"value: string expected":null},e.fromObject=function(e){if(e instanceof $root.HTTPHeader)return e;var t=new $root.HTTPHeader;return null!=e.key&&(t.key=String(e.key)),null!=e.value&&(t.value=String(e.value)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.key="",r.value=""),null!=e.key&&e.hasOwnProperty("key")&&(r.key=e.key),null!=e.value&&e.hasOwnProperty("value")&&(r.value=e.value),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/HTTPHeader"},e})(),QBaseApiData=$root.QBaseApiData=(()=>{function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.qbaseApiName="",e.prototype.qbaseMeta=null,e.prototype.qbaseOptions=null,e.prototype.qbaseReq="",e.prototype.cliReqId="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.qbaseApiName&&Object.hasOwnProperty.call(e,"qbaseApiName")&&t.uint32(10).string(e.qbaseApiName),null!=e.qbaseMeta&&Object.hasOwnProperty.call(e,"qbaseMeta")&&$root.QBaseApiData.QBaseMeta.encode(e.qbaseMeta,t.uint32(18).fork()).ldelim(),null!=e.qbaseOptions&&Object.hasOwnProperty.call(e,"qbaseOptions")&&$root.QBaseApiData.QBaseOptions.encode(e.qbaseOptions,t.uint32(26).fork()).ldelim(),null!=e.qbaseReq&&Object.hasOwnProperty.call(e,"qbaseReq")&&t.uint32(34).string(e.qbaseReq),null!=e.cliReqId&&Object.hasOwnProperty.call(e,"cliReqId")&&t.uint32(42).string(e.cliReqId),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.QBaseApiData;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:n.qbaseApiName=e.string();break;case 2:n.qbaseMeta=$root.QBaseApiData.QBaseMeta.decode(e,e.uint32());break;case 3:n.qbaseOptions=$root.QBaseApiData.QBaseOptions.decode(e,e.uint32());break;case 4:n.qbaseReq=e.string();break;case 5:n.cliReqId=e.string();break;default:e.skipType(7&o)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.qbaseApiName&&e.hasOwnProperty("qbaseApiName")&&!$util.isString(e.qbaseApiName))return"qbaseApiName: string expected";if(null!=e.qbaseMeta&&e.hasOwnProperty("qbaseMeta")){var t=$root.QBaseApiData.QBaseMeta.verify(e.qbaseMeta);if(t)return"qbaseMeta."+t}if(null!=e.qbaseOptions&&e.hasOwnProperty("qbaseOptions")){var r=$root.QBaseApiData.QBaseOptions.verify(e.qbaseOptions);if(r)return"qbaseOptions."+r}return null!=e.qbaseReq&&e.hasOwnProperty("qbaseReq")&&!$util.isString(e.qbaseReq)?"qbaseReq: string expected":null!=e.cliReqId&&e.hasOwnProperty("cliReqId")&&!$util.isString(e.cliReqId)?"cliReqId: string expected":null},e.fromObject=function(e){if(e instanceof $root.QBaseApiData)return e;var t=new $root.QBaseApiData;if(null!=e.qbaseApiName&&(t.qbaseApiName=String(e.qbaseApiName)),null!=e.qbaseMeta){if("object"!=typeof e.qbaseMeta)throw TypeError(".QBaseApiData.qbaseMeta: object expected");t.qbaseMeta=$root.QBaseApiData.QBaseMeta.fromObject(e.qbaseMeta)}if(null!=e.qbaseOptions){if("object"!=typeof e.qbaseOptions)throw TypeError(".QBaseApiData.qbaseOptions: object expected");t.qbaseOptions=$root.QBaseApiData.QBaseOptions.fromObject(e.qbaseOptions)}return null!=e.qbaseReq&&(t.qbaseReq=String(e.qbaseReq)),null!=e.cliReqId&&(t.cliReqId=String(e.cliReqId)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.qbaseApiName="",r.qbaseMeta=null,r.qbaseOptions=null,r.qbaseReq="",r.cliReqId=""),null!=e.qbaseApiName&&e.hasOwnProperty("qbaseApiName")&&(r.qbaseApiName=e.qbaseApiName),null!=e.qbaseMeta&&e.hasOwnProperty("qbaseMeta")&&(r.qbaseMeta=$root.QBaseApiData.QBaseMeta.toObject(e.qbaseMeta,t)),null!=e.qbaseOptions&&e.hasOwnProperty("qbaseOptions")&&(r.qbaseOptions=$root.QBaseApiData.QBaseOptions.toObject(e.qbaseOptions,t)),null!=e.qbaseReq&&e.hasOwnProperty("qbaseReq")&&(r.qbaseReq=e.qbaseReq),null!=e.cliReqId&&e.hasOwnProperty("cliReqId")&&(r.cliReqId=e.cliReqId),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/QBaseApiData"},e.QBaseMeta=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.firstLaunch=!1,e.prototype.sessionId="",e.prototype.sdkVersion="",e.prototype.filterUserInfo=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.firstLaunch&&Object.hasOwnProperty.call(e,"firstLaunch")&&t.uint32(8).bool(e.firstLaunch),null!=e.sessionId&&Object.hasOwnProperty.call(e,"sessionId")&&t.uint32(18).string(e.sessionId),null!=e.sdkVersion&&Object.hasOwnProperty.call(e,"sdkVersion")&&t.uint32(26).string(e.sdkVersion),null!=e.filterUserInfo&&Object.hasOwnProperty.call(e,"filterUserInfo")&&t.uint32(32).bool(e.filterUserInfo),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.QBaseApiData.QBaseMeta;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:n.firstLaunch=e.bool();break;case 2:n.sessionId=e.string();break;case 3:n.sdkVersion=e.string();break;case 4:n.filterUserInfo=e.bool();break;default:e.skipType(7&o)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.firstLaunch&&e.hasOwnProperty("firstLaunch")&&"boolean"!=typeof e.firstLaunch?"firstLaunch: boolean expected":null!=e.sessionId&&e.hasOwnProperty("sessionId")&&!$util.isString(e.sessionId)?"sessionId: string expected":null!=e.sdkVersion&&e.hasOwnProperty("sdkVersion")&&!$util.isString(e.sdkVersion)?"sdkVersion: string expected":null!=e.filterUserInfo&&e.hasOwnProperty("filterUserInfo")&&"boolean"!=typeof e.filterUserInfo?"filterUserInfo: boolean expected":null},e.fromObject=function(e){if(e instanceof $root.QBaseApiData.QBaseMeta)return e;var t=new $root.QBaseApiData.QBaseMeta;return null!=e.firstLaunch&&(t.firstLaunch=Boolean(e.firstLaunch)),null!=e.sessionId&&(t.sessionId=String(e.sessionId)),null!=e.sdkVersion&&(t.sdkVersion=String(e.sdkVersion)),null!=e.filterUserInfo&&(t.filterUserInfo=Boolean(e.filterUserInfo)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.firstLaunch=!1,r.sessionId="",r.sdkVersion="",r.filterUserInfo=!1),null!=e.firstLaunch&&e.hasOwnProperty("firstLaunch")&&(r.firstLaunch=e.firstLaunch),null!=e.sessionId&&e.hasOwnProperty("sessionId")&&(r.sessionId=e.sessionId),null!=e.sdkVersion&&e.hasOwnProperty("sdkVersion")&&(r.sdkVersion=e.sdkVersion),null!=e.filterUserInfo&&e.hasOwnProperty("filterUserInfo")&&(r.filterUserInfo=e.filterUserInfo),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/QBaseApiData.QBaseMeta"},e}(),e.QBaseOptions=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.env="",e.prototype.appid="",e.prototype.region="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.env&&Object.hasOwnProperty.call(e,"env")&&t.uint32(10).string(e.env),null!=e.appid&&Object.hasOwnProperty.call(e,"appid")&&t.uint32(18).string(e.appid),null!=e.region&&Object.hasOwnProperty.call(e,"region")&&t.uint32(26).string(e.region),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.QBaseApiData.QBaseOptions;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:n.env=e.string();break;case 2:n.appid=e.string();break;case 3:n.region=e.string();break;default:e.skipType(7&o)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.env&&e.hasOwnProperty("env")&&!$util.isString(e.env)?"env: string expected":null!=e.appid&&e.hasOwnProperty("appid")&&!$util.isString(e.appid)?"appid: string expected":null!=e.region&&e.hasOwnProperty("region")&&!$util.isString(e.region)?"region: string expected":null},e.fromObject=function(e){if(e instanceof $root.QBaseApiData.QBaseOptions)return e;var t=new $root.QBaseApiData.QBaseOptions;return null!=e.env&&(t.env=String(e.env)),null!=e.appid&&(t.appid=String(e.appid)),null!=e.region&&(t.region=String(e.region)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.env="",r.appid="",r.region=""),null!=e.env&&e.hasOwnProperty("env")&&(r.env=e.env),null!=e.appid&&e.hasOwnProperty("appid")&&(r.appid=e.appid),null!=e.region&&e.hasOwnProperty("region")&&(r.region=e.region),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/QBaseApiData.QBaseOptions"},e}(),e})(),V3Header=$root.V3Header=(()=>{function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.encryptionTimestamp=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.compression="",e.prototype.userTimeout=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.libBuildTs=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.appProtocol="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.encryptionTimestamp&&Object.hasOwnProperty.call(e,"encryptionTimestamp")&&t.uint32(8).uint64(e.encryptionTimestamp),null!=e.compression&&Object.hasOwnProperty.call(e,"compression")&&t.uint32(18).string(e.compression),null!=e.userTimeout&&Object.hasOwnProperty.call(e,"userTimeout")&&t.uint32(24).uint64(e.userTimeout),null!=e.libBuildTs&&Object.hasOwnProperty.call(e,"libBuildTs")&&t.uint32(32).uint64(e.libBuildTs),null!=e.appProtocol&&Object.hasOwnProperty.call(e,"appProtocol")&&t.uint32(42).string(e.appProtocol),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.V3Header;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:n.encryptionTimestamp=e.uint64();break;case 2:n.compression=e.string();break;case 3:n.userTimeout=e.uint64();break;case 4:n.libBuildTs=e.uint64();break;case 5:n.appProtocol=e.string();break;default:e.skipType(7&o)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.encryptionTimestamp&&e.hasOwnProperty("encryptionTimestamp")&&!($util.isInteger(e.encryptionTimestamp)||e.encryptionTimestamp&&$util.isInteger(e.encryptionTimestamp.low)&&$util.isInteger(e.encryptionTimestamp.high))?"encryptionTimestamp: integer|Long expected":null!=e.compression&&e.hasOwnProperty("compression")&&!$util.isString(e.compression)?"compression: string expected":null!=e.userTimeout&&e.hasOwnProperty("userTimeout")&&!($util.isInteger(e.userTimeout)||e.userTimeout&&$util.isInteger(e.userTimeout.low)&&$util.isInteger(e.userTimeout.high))?"userTimeout: integer|Long expected":null!=e.libBuildTs&&e.hasOwnProperty("libBuildTs")&&!($util.isInteger(e.libBuildTs)||e.libBuildTs&&$util.isInteger(e.libBuildTs.low)&&$util.isInteger(e.libBuildTs.high))?"libBuildTs: integer|Long expected":null!=e.appProtocol&&e.hasOwnProperty("appProtocol")&&!$util.isString(e.appProtocol)?"appProtocol: string expected":null},e.fromObject=function(e){if(e instanceof $root.V3Header)return e;var t=new $root.V3Header;return null!=e.encryptionTimestamp&&($util.Long?(t.encryptionTimestamp=$util.Long.fromValue(e.encryptionTimestamp)).unsigned=!0:"string"==typeof e.encryptionTimestamp?t.encryptionTimestamp=parseInt(e.encryptionTimestamp,10):"number"==typeof e.encryptionTimestamp?t.encryptionTimestamp=e.encryptionTimestamp:"object"==typeof e.encryptionTimestamp&&(t.encryptionTimestamp=new $util.LongBits(e.encryptionTimestamp.low>>>0,e.encryptionTimestamp.high>>>0).toNumber(!0))),null!=e.compression&&(t.compression=String(e.compression)),null!=e.userTimeout&&($util.Long?(t.userTimeout=$util.Long.fromValue(e.userTimeout)).unsigned=!0:"string"==typeof e.userTimeout?t.userTimeout=parseInt(e.userTimeout,10):"number"==typeof e.userTimeout?t.userTimeout=e.userTimeout:"object"==typeof e.userTimeout&&(t.userTimeout=new $util.LongBits(e.userTimeout.low>>>0,e.userTimeout.high>>>0).toNumber(!0))),null!=e.libBuildTs&&($util.Long?(t.libBuildTs=$util.Long.fromValue(e.libBuildTs)).unsigned=!0:"string"==typeof e.libBuildTs?t.libBuildTs=parseInt(e.libBuildTs,10):"number"==typeof e.libBuildTs?t.libBuildTs=e.libBuildTs:"object"==typeof e.libBuildTs&&(t.libBuildTs=new $util.LongBits(e.libBuildTs.low>>>0,e.libBuildTs.high>>>0).toNumber(!0))),null!=e.appProtocol&&(t.appProtocol=String(e.appProtocol)),t},e.toObject=function(e,t){t||(t={});var r={};if(t.defaults){if($util.Long){var n=new $util.Long(0,0,!0);r.encryptionTimestamp=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.encryptionTimestamp=t.longs===String?"0":0;if(r.compression="",$util.Long){var o=new $util.Long(0,0,!0);r.userTimeout=t.longs===String?o.toString():t.longs===Number?o.toNumber():o}else r.userTimeout=t.longs===String?"0":0;if($util.Long){var i=new $util.Long(0,0,!0);r.libBuildTs=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else r.libBuildTs=t.longs===String?"0":0;r.appProtocol=""}return null!=e.encryptionTimestamp&&e.hasOwnProperty("encryptionTimestamp")&&("number"==typeof e.encryptionTimestamp?r.encryptionTimestamp=t.longs===String?String(e.encryptionTimestamp):e.encryptionTimestamp:r.encryptionTimestamp=t.longs===String?$util.Long.prototype.toString.call(e.encryptionTimestamp):t.longs===Number?new $util.LongBits(e.encryptionTimestamp.low>>>0,e.encryptionTimestamp.high>>>0).toNumber(!0):e.encryptionTimestamp),null!=e.compression&&e.hasOwnProperty("compression")&&(r.compression=e.compression),null!=e.userTimeout&&e.hasOwnProperty("userTimeout")&&("number"==typeof e.userTimeout?r.userTimeout=t.longs===String?String(e.userTimeout):e.userTimeout:r.userTimeout=t.longs===String?$util.Long.prototype.toString.call(e.userTimeout):t.longs===Number?new $util.LongBits(e.userTimeout.low>>>0,e.userTimeout.high>>>0).toNumber(!0):e.userTimeout),null!=e.libBuildTs&&e.hasOwnProperty("libBuildTs")&&("number"==typeof e.libBuildTs?r.libBuildTs=t.longs===String?String(e.libBuildTs):e.libBuildTs:r.libBuildTs=t.longs===String?$util.Long.prototype.toString.call(e.libBuildTs):t.longs===Number?new $util.LongBits(e.libBuildTs.low>>>0,e.libBuildTs.high>>>0).toNumber(!0):e.libBuildTs),null!=e.appProtocol&&e.hasOwnProperty("appProtocol")&&(r.appProtocol=e.appProtocol),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/V3Header"},e})();function profileAsync(e,t,r){var n=Date.now();return _asyncToGenerator(function*(){var o=yield t(...arguments),i=Date.now();return e[r]=i-n,o})}function profileSync(e,t,r){var n=Date.now();return function(){var o=t(...arguments),i=Date.now();return e[r]=i-n,o}}function encode(e,t,r){var n=profileSync(r,import_snappyjs.default.compress,"compress")(t);return{data:profileSync(r,encrypt,"encrypt")(e,n).encrypted}}function encodeRequest(e,t,r,n,o,i){var s,a=Object.entries(t).filter(e=>{var[t,r]=e;return!isNil(t)&&!isNil(r)}).map(e=>{var[t,r]=e;return{key:t.toString().toLowerCase(),value:r.toString()}}),c=getType(n),u=!1;return"object"===c?s=JSON.stringify(n):"arraybuffer"!==c?s="undefined"===c?void 0:n+"":(s=n,u=!0),{...encode(e,u?profileSync(i,HTTPRequest.encode,"encodePb")({body:new Uint8Array(n),callId:o,header:a}).finish():new Uint8Array(profileSync(i,stringToArrayBuffer,"stringToBuffer")(JSON.stringify({method:r,header:a,body:s,call_id:o}))),i),contentEncoding:u?"PB":"JSON"}}function encodeResponse(e,t,r,n,o){var i=n instanceof ArrayBuffer,s=Object.entries(t).filter(e=>{var[t,r]=e;return t&&r}).map(e=>{var[t,r]=e;return{key:t.toLowerCase(),value:r}});return{...encode(e,i?HTTPResponse.encode({bodyBuffer:new Uint8Array(n),statusCode:r,header:s}).finish():HTTPResponse.encode({bodyString:JSON.stringify(n),statusCode:r,header:s}).finish(),o),contentEncoding:i?"PB":"JSON"}}function encodeStdPrivRequest(e,t,r){return{...encode(e,QBaseApiData.encode(t).finish(),r)}}function decrypt(e,t){var r=getAccelerator();return r?r.decrypt(t,e,e):AES_CBC.decrypt(t,e,void 0,e)}init_esm_shims(),init_esm_shims(),init_esm_shims();var import_snappyjs2=__toESM(require_snappyjs(),1);function decode(e,t,r){var n=decrypt(e,t);return{data:r?import_snappyjs2.default.uncompress(n):n}}function decodeRequest(e,t,r,n){var o,{data:i}=decode(e,t,r);if("PB"===n)o=HTTPRequest.decode(i);else{var s=Uint8ArrayToString(i);o=JSON.parse(s)}return o}function decodeResponse(e,t,r,n){var o,{data:i}=decode(e,t,r);if("PB"===n)o=HTTPResponse.decode(i);else{var s=Uint8ArrayToString(i);o=JSON.parse(s)}return{statusCode:o.statusCode,body:o.bodyString||o.bodyBuffer,header:o.header.reduce((e,t)=>(t.key&&t.value&&(e[t.key]=e[t.key]?e[t.key]+","+t.value:t.value),e),{})}}function decodeStdPrivResponse(e,t,r){var{data:n}=decode(e,t,r),o=Uint8ArrayToString(n);return{data:JSON.parse(o)}}var v3_exports={};function secureRandom(e){return _secureRandom.apply(this,arguments)}function _secureRandom(){return(_secureRandom=_asyncToGenerator(function*(e){if("wx"in globalThis)return new Promise(t=>{wx.getRandomValues({length:e,success(e){t(new Uint8Array(e.randomValues))}})});try{var t=yield import("crypto"),r=new Uint8Array(e);return t.webcrypto.getRandomValues(r),r}catch(e){throw new Error("no available crypto secure rng available, abort.")}})).apply(this,arguments)}function encrypt2(e,t){return _encrypt.apply(this,arguments)}function _encrypt(){return(_encrypt=_asyncToGenerator(function*(e,t){var r=getAccelerator(),n=yield secureRandom(16);return{iv:n,encrypted:r?r.encrypt(t,e,n):AES_CBC.encrypt(t,e,void 0,n)}})).apply(this,arguments)}__export(v3_exports,{V3HeaderSymbol:()=>V3HeaderSymbol,decode:()=>decode2,decodeRequest:()=>decodeRequest2,decodeResponse:()=>decodeResponse2,encode:()=>encode2,encodeRequest:()=>encodeRequest2,encodeResponse:()=>encodeResponse2}),init_esm_shims(),init_esm_shims(),init_esm_shims(),init_esm_shims(),init_esm_shims();var urlAlphabet="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",nanoid=function(){for(var e="",t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:21;t--;)e+=urlAlphabet[64*Math.random()|0];return e},import_snappyjs3=__toESM(require_snappyjs(),1);init_esm_shims();var V3HeaderSymbol=Symbol("V3Header");function writeUInt16BE(e,t,r){return t=+t,e[r>>>=0]=t>>>8,e[r+1]=255&t,r+2}function encode2(e,t){return _encode.apply(this,arguments)}function _encode(){return(_encode=_asyncToGenerator(function*(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"JSON",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o={appProtocol:"1/".concat(r),compression:"snappy",encryptionTimestamp:Date.now(),libBuildTs:1685699821937},i=yield encrypt2(e,V3Header.encode(o).finish()),s=i.iv.length+i.encrypted.length,a=new Uint8Array(2);writeUInt16BE(a,s,0);var c=profileSync(n,import_snappyjs3.default.compress,"compress")(t),u=yield profileAsync(n,encrypt2,"encrypt")(e,c);return{data:concatArray([a,i.iv,i.encrypted,u.iv,u.encrypted]),[V3HeaderSymbol]:V3Header.fromObject(o)}})).apply(this,arguments)}function encodeRequest2(e,t,r,n){return _encodeRequest.apply(this,arguments)}function _encodeRequest(){return(_encodeRequest=_asyncToGenerator(function*(e,t,r,n){var o,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},s=getType(n),a=Object.entries(t).filter(e=>{var[t,r]=e;return!isNil(t)&&!isNil(r)}).map(e=>{var[t,r]=e;return{key:t.toString().toLowerCase(),value:r.toString()}}),c="".concat(Date.now(),"-").concat(nanoid(8)),u=!1;return"object"===s?o=JSON.stringify(n):"arraybuffer"!==s?o="undefined"===s?void 0:n+"":(o=new Uint8Array(n),u=!0),{...yield encode2(e,u?profileSync(i,HTTPRequest.encode,"encodePb")({body:new Uint8Array(o),callId:c,header:a,method:r}).finish():new Uint8Array(profileSync(i,stringToArrayBuffer,"stringToBuffer")(JSON.stringify({body:o,call_id:c,header:a,method:r}))),u?"PB":"JSON",i),callId:c,stats:i}})).apply(this,arguments)}function encodeResponse2(e,t,r,n){return _encodeResponse.apply(this,arguments)}function _encodeResponse(){return(_encodeResponse=_asyncToGenerator(function*(e,t,r,n){var o,i=getType(n),s=Object.entries(t).filter(e=>{var[t,r]=e;return t&&r}).map(e=>{var[t,r]=e;return{key:t.toString().toLowerCase(),value:r.toString()}}),a=!1;return"object"===i?o=JSON.stringify(n):"arraybuffer"!==i?o=n+"":(o=n,a=!0),"object"===i?o=JSON.stringify(n):"arraybuffer"!==i?o="undefined"===i?void 0:n+"":(o=new Uint8Array(n),a=!0),yield encode2(e,a?HTTPResponse.encode({bodyBuffer:new Uint8Array(o),statusCode:r,header:s}).finish():HTTPResponse.encode({bodyString:JSON.stringify(n),statusCode:r,header:s}).finish(),"PB")})).apply(this,arguments)}function decrypt2(e,t){var r=getAccelerator(),n=t.subarray(0,16),o=t.subarray(16);return r?r.decrypt(o,e,n):AES_CBC.decrypt(o,e,void 0,n)}init_esm_shims(),init_esm_shims();var import_snappyjs4=__toESM(require_snappyjs(),1);function processHeader(e){return e.reduce((e,t)=>(t.key&&t.value&&(e[t.key]=e[t.key]?e[t.key]+","+t.value:t.value),e),{})}function readUInt16BE(e,t){return e[t>>>=0]<<8|e[t+1]}function decode2(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=readUInt16BE(t,0),o=decrypt2(e,t.slice(2,n+2)),i=V3Header.decode(o),s="snappy"===i.compression,a=profileSync(r,decrypt2,"decrypt")(e,t.slice(n+2));return{data:s?profileSync(r,import_snappyjs4.default.uncompress,"uncompress")(a):a,[V3HeaderSymbol]:i}}function decodeRequest2(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{data:n,[V3HeaderSymbol]:o}=decode2(e,t,r),i=!1,s=o.appProtocol.split("/")[1];return s&&(i="PB"===s),{...i?HTTPRequest.decode(n):profileSync(r,e=>JSON.parse(Uint8ArrayToString(e)),"decodeJson")(n),[V3HeaderSymbol]:o,stats:r}}function decodeResponse2(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{data:o,[V3HeaderSymbol]:i}=decode2(e,t,n),s=!1,a=i.appProtocol.split("/")[1];return a&&(s="PB"===a),{statusCode:(r=s?profileSync(n,HTTPResponse.decode,"decodePb")(o):profileSync(n,e=>JSON.parse(Uint8ArrayToString(e)),"decodeJson")(o)).statusCode,body:r.bodyString||r.bodyBuffer,header:processHeader(r.header),[V3HeaderSymbol]:i}}init_esm_shims();var sm_exports={};__export(sm_exports,{SMHeaderSymbol:()=>SMHeaderSymbol,decode:()=>decode3,encode:()=>encode3}),init_esm_shims(),init_esm_shims(),init_esm_shims();var import_miniprogram_sm_crypto2=__toESM(require_miniprogram_dist(),1);function writeUInt32BE(e,t,r){return t=+t,e[r>>>=0]=t>>>24,e[r+1]=t>>>16&255,e[r+2]=t>>>8&255,e[r+3]=255&t,r+4}function readUInt16BE2(e,t){return e[t>>>=0]<<8|e[t+1]}function writeUInt16BE2(e,t,r){return t=+t,e[r>>>=0]=t>>>8,e[r+1]=255&t,e}function writeUInt64BE(e,t,r){"number"!=typeof t&&(t=Number(t));var n=~~(t/4294967295),o=t%4294967295-n;return r?(writeUInt32BE(e,n,r),writeUInt32BE(e,o,r+4),e):(writeUInt32BE(e,n,0),writeUInt32BE(e,o,4),e)}function readUint32BE(e,t){return e[t>>>=0]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}function readUint64BE(e,t){return 4294967296*readUint32BE(e,t>>>=0)+readUint32BE(e,t+4)}function hexToUint8Array(e){if(e.length%2!=0)throw new Error("Hex string length must be even");for(var t=e.length/2,r=new Uint8Array(t),n=0;n<t;n++){var o=parseInt(e.substr(2*n,2),16);if(isNaN(o))throw new Error("Invalid hex string");r[n]=o}return r}function uint8ArrayToHex(e){for(var t=[],r=0;r<e.length;r++){var n=e[r].toString(16);t.push(1===n.length?"0"+n:n)}return t.join("")}init_esm_shims(),init_esm_shims();var import_miniprogram_sm_crypto=__toESM(require_miniprogram_dist(),1),systemInfo;function getNativeCrypto(){if("wx"in globalThis){if(systemInfo||(systemInfo=wx.getSystemInfoSync()),"devtools"===systemInfo.platform)return;if("getGMCryptoManager"in globalThis.wx)return globalThis.wx.getGMCryptoManager()}}function sm2DoEncryptC1C3C2(e,t){return _sm2DoEncryptC1C3C.apply(this,arguments)}function _sm2DoEncryptC1C3C(){return(_sm2DoEncryptC1C3C=_asyncToGenerator(function*(e,t){var r=getNativeCrypto(),n=hexToUint8Array(t);if(r){console.log("using native TSM crypto");var o=yield r.SM2.encrypt({plaintext:e.buffer,publicKey:n.buffer,cipherMode:1});return new Uint8Array(o.ciphertext)}return console.log("using software sm-crypto"),hexToUint8Array(import_miniprogram_sm_crypto.sm2.doEncrypt(Array.from(e),t))})).apply(this,arguments)}function sm4EncryptCBC(e,t,r){return _sm4EncryptCBC.apply(this,arguments)}function _sm4EncryptCBC(){return(_sm4EncryptCBC=_asyncToGenerator(function*(e,t,r){var n=getNativeCrypto();if(n){console.log("using native TSM crypto");var o=yield n.SM4.encrypt({plaintext:e.buffer,cipherMode:"cbc",iv:r.buffer,key:t.buffer});return new Uint8Array(o.ciphertext)}return console.log("using software sm-crypto"),import_miniprogram_sm_crypto.sm4.encrypt(Array.from(e),Array.from(t),{output:"array",mode:"cbc",iv:Array.from(r)})})).apply(this,arguments)}function sm4DecryptCBC(e,t,r){return _sm4DecryptCBC.apply(this,arguments)}function _sm4DecryptCBC(){return(_sm4DecryptCBC=_asyncToGenerator(function*(e,t,r){var n=getNativeCrypto();if(n){console.log("using native TSM crypto");var o=yield n.SM4.decrypt({ciphertext:e.buffer,cipherMode:"cbc",iv:r.buffer,key:t.buffer});return new Uint8Array(o.plaintext)}return console.log("using software sm-crypto"),new Uint8Array(import_miniprogram_sm_crypto.sm4.decrypt(Array.from(e),Array.from(t),{output:"array",mode:"cbc",iv:Array.from(r)}))})).apply(this,arguments)}function sm3Hmac(e,t){return _sm3Hmac.apply(this,arguments)}function _sm3Hmac(){return(_sm3Hmac=_asyncToGenerator(function*(e,t){var r=getNativeCrypto();if(r){console.log("using native TSM crypto");var n=yield r.SM3.hmac({key:t,message:e});return new Uint8Array(n.hmac)}return console.log("using software sm-crypto"),hexToUint8Array((0,import_miniprogram_sm_crypto.sm3)(Array.from(e),{key:t}))})).apply(this,arguments)}function sm2VerifyDer(e,t,r){return _sm2VerifyDer.apply(this,arguments)}function _sm2VerifyDer(){return(_sm2VerifyDer=_asyncToGenerator(function*(e,t,r){var n=getNativeCrypto();return n?(console.log("using native TSM crypto"),(yield n.SM2.verify({message:e.buffer,publicKey:hexToUint8Array(r).buffer,signed:t.buffer,signMode:0,uid:new ArrayBuffer(0)})).success):(console.log("using software sm-crypto"),import_miniprogram_sm_crypto.sm2.doVerifySignature(Array.from(e),uint8ArrayToHex(t),r,{der:!0,hash:!0}))})).apply(this,arguments)}function encodeClientPacket(e,t,r){return _encodeClientPacket.apply(this,arguments)}function _encodeClientPacket(){return(_encodeClientPacket=_asyncToGenerator(function*(e,t,r){var n=new Uint8Array([1]),o=yield secureRandom(48),i=o.subarray(0,16);if(r){if(130!==r.headerArray.length)throw new Error("invalid header chunk")}else{var s=o.subarray(16,32),a=o.subarray(32,48),c=yield sm2DoEncryptC1C3C2(o.subarray(16),e),u=c.length;r={headerArray:concatArray([writeUInt16BE2(new Uint8Array(2),u,0),c]),sm3Key:a,sm4Key:s}}var l=yield sm4EncryptCBC(t,r.sm4Key,i),d=l.length,p=concatArray([n,i,r.headerArray,writeUInt64BE(new Uint8Array(8),d,0),l]);return{data:concatArray([p,yield sm3Hmac(p,r.sm3Key)]),ephemeralKey:r.sm4Key,headerChunk:r}})).apply(this,arguments)}function encode3(e,t,r,n){return _encode2.apply(this,arguments)}function _encode2(){return(_encode2=_asyncToGenerator(function*(e,t,r,n){var o,i,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=getType(n),c=Object.entries(t).filter(e=>{var[t,r]=e;return!isNil(t)&&!isNil(r)}).map(e=>{var[t,r]=e;return{key:t.toString().toLowerCase(),value:r.toString()}}),u="".concat(Date.now(),"-").concat(nanoid(8)),l=!1;"object"===a?i=JSON.stringify(n):"arraybuffer"!==a?i="undefined"===a?void 0:n+"":(i=new Uint8Array(n),l=!0);var d=l?i:new Uint8Array(stringToArrayBuffer(null!==(o=i)&&void 0!==o?o:"")),p=yield encodeClientPacket(e,profileSync(s,HTTPRequest.encode,"encodePb")({body:d,callId:u,header:c,method:r}).finish());return{data:p.data,ephemeralKey:p.ephemeralKey,protocol:"PB",stats:s}})).apply(this,arguments)}init_esm_shims(),init_esm_shims();var import_miniprogram_sm_crypto3=__toESM(require_miniprogram_dist(),1);function decodeServerPacket(e,t,r){return _decodeServerPacket.apply(this,arguments)}function _decodeServerPacket(){return(_decodeServerPacket=_asyncToGenerator(function*(e,t,r){if(1!==e.subarray(0,1)[0])throw new Error("invalid version");var n=e.subarray(1,17),o=readUint64BE(e,17),i=e.subarray(25,25+o),s=readUInt16BE2(e,25+o);if(!(yield sm2VerifyDer(i,e.subarray(27+o,27+o+s),r)))throw new Error("invalid signature");return{data:yield sm4DecryptCBC(i,t,n)}})).apply(this,arguments)}function decode3(e,t,r){return _decode.apply(this,arguments)}function _decode(){return(_decode=_asyncToGenerator(function*(e,t,r){arguments.length>3&&void 0!==arguments[3]&&arguments[3];var n=yield decodeServerPacket(r,e,t),o=HTTPResponse.decode(n.data);return{statusCode:o.statusCode,body:o.bodyString||o.bodyBuffer,header:processHeader(o.header)}})).apply(this,arguments)}init_esm_shims();var SMHeaderSymbol=Symbol("SMHeaderSymbol")}.call(this,__webpack_require__("../../node_modules/.pnpm/process@0.11.10/node_modules/process/browser.js"),__webpack_require__("../../node_modules/.pnpm/buffer@4.9.2/node_modules/buffer/index.js").Buffer,__webpack_require__("../../node_modules/.pnpm/webpack@4.46.0_webpack-command@0.4.2/node_modules/webpack/buildin/global.js"))},"../../node_modules/.pnpm/base64-js@1.5.1/node_modules/base64-js/index.js":function(e,t,r){t.byteLength=function(e){var t=u(e),r=t[0],n=t[1];return 3*(r+n)/4-n},t.toByteArray=function(e){var t,r,n=u(e),s=n[0],a=n[1],c=new i(function(e,t,r){return 3*(t+r)/4-r}(0,s,a)),l=0,d=a>0?s-4:s;for(r=0;r<d;r+=4)t=o[e.charCodeAt(r)]<<18|o[e.charCodeAt(r+1)]<<12|o[e.charCodeAt(r+2)]<<6|o[e.charCodeAt(r+3)],c[l++]=t>>16&255,c[l++]=t>>8&255,c[l++]=255&t;2===a&&(t=o[e.charCodeAt(r)]<<2|o[e.charCodeAt(r+1)]>>4,c[l++]=255&t);1===a&&(t=o[e.charCodeAt(r)]<<10|o[e.charCodeAt(r+1)]<<4|o[e.charCodeAt(r+2)]>>2,c[l++]=t>>8&255,c[l++]=255&t);return c},t.fromByteArray=function(e){for(var t,r=e.length,o=r%3,i=[],s=0,a=r-o;s<a;s+=16383)i.push(d(e,s,s+16383>a?a:s+16383));1===o?(t=e[r-1],i.push(n[t>>2]+n[t<<4&63]+"==")):2===o&&(t=(e[r-2]<<8)+e[r-1],i.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"="));return i.join("")};for(var n=[],o=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,c=s.length;a<c;++a)n[a]=s[a],o[s.charCodeAt(a)]=a;function u(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function l(e){return n[e>>18&63]+n[e>>12&63]+n[e>>6&63]+n[63&e]}function d(e,t,r){for(var n,o=[],i=t;i<r;i+=3)n=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(255&e[i+2]),o.push(l(n));return o.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},"../../node_modules/.pnpm/buffer@4.9.2/node_modules/buffer/index.js":function(e,t,r){(function(e){var n=r("../../node_modules/.pnpm/base64-js@1.5.1/node_modules/base64-js/index.js"),o=r("../../node_modules/.pnpm/ieee754@1.2.1/node_modules/ieee754/index.js"),i=r("../../node_modules/.pnpm/isarray@1.0.0/node_modules/isarray/index.js");function s(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(e,t){if(s()<t)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=c.prototype:(null===e&&(e=new c(t)),e.length=t),e}function c(e,t,r){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(e,t,r);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return d(this,e)}return u(this,e,t,r)}function u(e,t,r,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,r,n){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");t=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n);c.TYPED_ARRAY_SUPPORT?(e=t).__proto__=c.prototype:e=p(e,t);return e}(e,t,r,n):"string"==typeof t?function(e,t,r){"string"==typeof r&&""!==r||(r="utf8");if(!c.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|_(t,r),o=(e=a(e,n)).write(t,r);o!==n&&(e=e.slice(0,o));return e}(e,t,r):function(e,t){if(c.isBuffer(t)){var r=0|f(t.length);return 0===(e=a(e,r)).length?e:(t.copy(e,0,0,r),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||function(e){return e!=e}(t.length)?a(e,0):p(e,t);if("Buffer"===t.type&&i(t.data))return p(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function d(e,t){if(l(t),e=a(e,t<0?0:0|f(t)),!c.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function p(e,t){var r=t.length<0?0:0|f(t.length);e=a(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function f(e){if(e>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|e}function _(e,t){if(c.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return G(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return q(e).length;default:if(n)return G(e).length;t=(""+t).toLowerCase(),n=!0}}function m(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function h(e,t,r,n,o){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=o?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(o)return-1;r=e.length-1}else if(r<0){if(!o)return-1;r=0}if("string"==typeof t&&(t=c.from(t,n)),c.isBuffer(t))return 0===t.length?-1:g(e,t,r,n,o);if("number"==typeof t)return t&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):g(e,[t],r,n,o);throw new TypeError("val must be string, number or Buffer")}function g(e,t,r,n,o){var i,s=1,a=e.length,c=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;s=2,a/=2,c/=2,r/=2}function u(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(o){var l=-1;for(i=r;i<a;i++)if(u(e,i)===u(t,-1===l?0:i-l)){if(-1===l&&(l=i),i-l+1===c)return l*s}else-1!==l&&(i-=i-l),l=-1}else for(r+c>a&&(r=a-c),i=r;i>=0;i--){for(var d=!0,p=0;p<c;p++)if(u(e,i+p)!==u(t,p)){d=!1;break}if(d)return i}return-1}function v(e,t,r,n){r=Number(r)||0;var o=e.length-r;n?(n=Number(n))>o&&(n=o):n=o;var i=t.length;if(i%2!=0)throw new TypeError("Invalid hex string");n>i/2&&(n=i/2);for(var s=0;s<n;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[r+s]=a}return s}function y(e,t,r,n){return F(G(t,e.length-r),e,r,n)}function E(e,t,r,n){return F(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function b(e,t,r,n){return E(e,t,r,n)}function S(e,t,r,n){return F(q(t),e,r,n)}function T(e,t,r,n){return F(function(e,t){for(var r,n,o,i=[],s=0;s<e.length&&!((t-=2)<0);++s)r=e.charCodeAt(s),n=r>>8,o=r%256,i.push(o),i.push(n);return i}(t,e.length-r),e,r,n)}function A(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function w(e,t,r){r=Math.min(e.length,r);for(var n=[],o=t;o<r;){var i,s,a,c,u=e[o],l=null,d=u>239?4:u>223?3:u>191?2:1;if(o+d<=r)switch(d){case 1:u<128&&(l=u);break;case 2:128==(192&(i=e[o+1]))&&(c=(31&u)<<6|63&i)>127&&(l=c);break;case 3:i=e[o+1],s=e[o+2],128==(192&i)&&128==(192&s)&&(c=(15&u)<<12|(63&i)<<6|63&s)>2047&&(c<55296||c>57343)&&(l=c);break;case 4:i=e[o+1],s=e[o+2],a=e[o+3],128==(192&i)&&128==(192&s)&&128==(192&a)&&(c=(15&u)<<18|(63&i)<<12|(63&s)<<6|63&a)>65535&&c<1114112&&(l=c)}null===l?(l=65533,d=1):l>65535&&(l-=65536,n.push(l>>>10&1023|55296),l=56320|1023&l),n.push(l),o+=d}return function(e){var t=e.length;if(t<=C)return String.fromCharCode.apply(String,e);var r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=C));return r}(n)}t.Buffer=c,t.SlowBuffer=function(e){+e!=e&&(e=0);return c.alloc(+e)},t.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=s(),c.poolSize=8192,c._augment=function(e){return e.__proto__=c.prototype,e},c.from=function(e,t,r){return u(null,e,t,r)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(e,t,r){return function(e,t,r,n){return l(t),t<=0?a(e,t):void 0!==r?"string"==typeof n?a(e,t).fill(r,n):a(e,t).fill(r):a(e,t)}(null,e,t,r)},c.allocUnsafe=function(e){return d(null,e)},c.allocUnsafeSlow=function(e){return d(null,e)},c.isBuffer=function(e){return!(null==e||!e._isBuffer)},c.compare=function(e,t){if(!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,n=t.length,o=0,i=Math.min(r,n);o<i;++o)if(e[o]!==t[o]){r=e[o],n=t[o];break}return r<n?-1:n<r?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!i(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=c.allocUnsafe(t),o=0;for(r=0;r<e.length;++r){var s=e[r];if(!c.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,o),o+=s.length}return n},c.byteLength=_,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)m(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this},c.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?w(this,0,e):function(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return R(this,t,r);case"utf8":case"utf-8":return w(this,t,r);case"ascii":return I(this,t,r);case"latin1":case"binary":return O(this,t,r);case"base64":return A(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}.apply(this,arguments)},c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(e+=" ... ")),"<Buffer "+e+">"},c.prototype.compare=function(e,t,r,n,o){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===o&&(o=this.length),t<0||r>e.length||n<0||o>this.length)throw new RangeError("out of range index");if(n>=o&&t>=r)return 0;if(n>=o)return-1;if(t>=r)return 1;if(t>>>=0,r>>>=0,n>>>=0,o>>>=0,this===e)return 0;for(var i=o-n,s=r-t,a=Math.min(i,s),u=this.slice(n,o),l=e.slice(t,r),d=0;d<a;++d)if(u[d]!==l[d]){i=u[d],s=l[d];break}return i<s?-1:s<i?1:0},c.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},c.prototype.indexOf=function(e,t,r){return h(this,e,t,r,!0)},c.prototype.lastIndexOf=function(e,t,r){return h(this,e,t,r,!1)},c.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var o=this.length-t;if((void 0===r||r>o)&&(r=o),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var i=!1;;)switch(n){case"hex":return v(this,e,t,r);case"utf8":case"utf-8":return y(this,e,t,r);case"ascii":return E(this,e,t,r);case"latin1":case"binary":return b(this,e,t,r);case"base64":return S(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,e,t,r);default:if(i)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),i=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var C=4096;function I(e,t,r){var n="";r=Math.min(e.length,r);for(var o=t;o<r;++o)n+=String.fromCharCode(127&e[o]);return n}function O(e,t,r){var n="";r=Math.min(e.length,r);for(var o=t;o<r;++o)n+=String.fromCharCode(e[o]);return n}function R(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var o="",i=t;i<r;++i)o+=U(e[i]);return o}function N(e,t,r){for(var n=e.slice(t,r),o="",i=0;i<n.length;i+=2)o+=String.fromCharCode(n[i]+256*n[i+1]);return o}function D(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function j(e,t,r,n,o,i){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<i)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function L(e,t,r,n){t<0&&(t=65535+t+1);for(var o=0,i=Math.min(e.length-r,2);o<i;++o)e[r+o]=(t&255<<8*(n?o:1-o))>>>8*(n?o:1-o)}function M(e,t,r,n){t<0&&(t=4294967295+t+1);for(var o=0,i=Math.min(e.length-r,4);o<i;++o)e[r+o]=t>>>8*(n?o:3-o)&255}function P(e,t,r,n,o,i){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function x(e,t,r,n,i){return i||P(e,0,r,4),o.write(e,t,r,n,23,4),r+4}function k(e,t,r,n,i){return i||P(e,0,r,8),o.write(e,t,r,n,52,8),r+8}c.prototype.slice=function(e,t){var r,n=this.length;if(e=~~e,t=void 0===t?n:~~t,e<0?(e+=n)<0&&(e=0):e>n&&(e=n),t<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e),c.TYPED_ARRAY_SUPPORT)(r=this.subarray(e,t)).__proto__=c.prototype;else{var o=t-e;r=new c(o,void 0);for(var i=0;i<o;++i)r[i]=this[i+e]}return r},c.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||D(e,t,this.length);for(var n=this[e],o=1,i=0;++i<t&&(o*=256);)n+=this[e+i]*o;return n},c.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||D(e,t,this.length);for(var n=this[e+--t],o=1;t>0&&(o*=256);)n+=this[e+--t]*o;return n},c.prototype.readUInt8=function(e,t){return t||D(e,1,this.length),this[e]},c.prototype.readUInt16LE=function(e,t){return t||D(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUInt16BE=function(e,t){return t||D(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUInt32LE=function(e,t){return t||D(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUInt32BE=function(e,t){return t||D(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||D(e,t,this.length);for(var n=this[e],o=1,i=0;++i<t&&(o*=256);)n+=this[e+i]*o;return n>=(o*=128)&&(n-=Math.pow(2,8*t)),n},c.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||D(e,t,this.length);for(var n=t,o=1,i=this[e+--n];n>0&&(o*=256);)i+=this[e+--n]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*t)),i},c.prototype.readInt8=function(e,t){return t||D(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){t||D(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt16BE=function(e,t){t||D(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt32LE=function(e,t){return t||D(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return t||D(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return t||D(e,4,this.length),o.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return t||D(e,4,this.length),o.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return t||D(e,8,this.length),o.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return t||D(e,8,this.length),o.read(this,e,!1,52,8)},c.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||j(this,e,t,r,Math.pow(2,8*r)-1,0);var o=1,i=0;for(this[t]=255&e;++i<r&&(o*=256);)this[t+i]=e/o&255;return t+r},c.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||j(this,e,t,r,Math.pow(2,8*r)-1,0);var o=r-1,i=1;for(this[t+o]=255&e;--o>=0&&(i*=256);)this[t+o]=e/i&255;return t+r},c.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||j(this,e,t,1,255,0),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},c.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||j(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):L(this,e,t,!0),t+2},c.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||j(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):L(this,e,t,!1),t+2},c.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||j(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):M(this,e,t,!0),t+4},c.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||j(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):M(this,e,t,!1),t+4},c.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t|=0,!n){var o=Math.pow(2,8*r-1);j(this,e,t,r,o-1,-o)}var i=0,s=1,a=0;for(this[t]=255&e;++i<r&&(s*=256);)e<0&&0===a&&0!==this[t+i-1]&&(a=1),this[t+i]=(e/s>>0)-a&255;return t+r},c.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t|=0,!n){var o=Math.pow(2,8*r-1);j(this,e,t,r,o-1,-o)}var i=r-1,s=1,a=0;for(this[t+i]=255&e;--i>=0&&(s*=256);)e<0&&0===a&&0!==this[t+i+1]&&(a=1),this[t+i]=(e/s>>0)-a&255;return t+r},c.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||j(this,e,t,1,127,-128),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||j(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):L(this,e,t,!0),t+2},c.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||j(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):L(this,e,t,!1),t+2},c.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||j(this,e,t,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):M(this,e,t,!0),t+4},c.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||j(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):M(this,e,t,!1),t+4},c.prototype.writeFloatLE=function(e,t,r){return x(this,e,t,!0,r)},c.prototype.writeFloatBE=function(e,t,r){return x(this,e,t,!1,r)},c.prototype.writeDoubleLE=function(e,t,r){return k(this,e,t,!0,r)},c.prototype.writeDoubleBE=function(e,t,r){return k(this,e,t,!1,r)},c.prototype.copy=function(e,t,r,n){if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var o,i=n-r;if(this===e&&r<t&&t<n)for(o=i-1;o>=0;--o)e[o+t]=this[o+r];else if(i<1e3||!c.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)e[o+t]=this[o+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+i),t);return i},c.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!c.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var i;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(i=t;i<r;++i)this[i]=e;else{var s=c.isBuffer(e)?e:G(new c(e,n).toString()),a=s.length;for(i=0;i<r-t;++i)this[i+t]=s[i%a]}return this};var B=/[^+\/0-9A-Za-z-_]/g;function U(e){return e<16?"0"+e.toString(16):e.toString(16)}function G(e,t){var r;t=t||1/0;for(var n=e.length,o=null,i=[],s=0;s<n;++s){if((r=e.charCodeAt(s))>55295&&r<57344){if(!o){if(r>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(s+1===n){(t-=3)>-1&&i.push(239,191,189);continue}o=r;continue}if(r<56320){(t-=3)>-1&&i.push(239,191,189),o=r;continue}r=65536+(o-55296<<10|r-56320)}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,r<128){if((t-=1)<0)break;i.push(r)}else if(r<2048){if((t-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function q(e){return n.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(B,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function F(e,t,r,n){for(var o=0;o<n&&!(o+r>=t.length||o>=e.length);++o)t[o+r]=e[o];return o}}).call(this,r("../../node_modules/.pnpm/webpack@4.46.0_webpack-command@0.4.2/node_modules/webpack/buildin/global.js"))},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/actual/url/index.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/stable/url/index.js");e.exports=n},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/full/url/index.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/actual/url/index.js");e.exports=n},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/a-callable.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/is-callable.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/try-to-string.js"),i=TypeError;e.exports=function(e){if(n(e))return e;throw i(o(e)+" is not a function")}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/a-possible-prototype.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/is-callable.js"),o=String,i=TypeError;e.exports=function(e){if("object"==typeof e||n(e))return e;throw i("Can't set "+o(e)+" as a prototype")}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/add-to-unscopables.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/well-known-symbol.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/object-create.js"),i=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/object-define-property.js").f,s=n("unscopables"),a=Array.prototype;void 0==a[s]&&i(a,s,{configurable:!0,value:o(null)}),e.exports=function(e){a[s][e]=!0}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/an-instance.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/object-is-prototype-of.js"),o=TypeError;e.exports=function(e,t){if(n(t,e))return e;throw o("Incorrect invocation")}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/an-object.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/is-object.js"),o=String,i=TypeError;e.exports=function(e){if(n(e))return e;throw i(o(e)+" is not an object")}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/array-from.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/function-bind-context.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/function-call.js"),i=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/to-object.js"),s=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/call-with-safe-iteration-closing.js"),a=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/is-array-iterator-method.js"),c=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/is-constructor.js"),u=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/length-of-array-like.js"),l=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/create-property.js"),d=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/get-iterator.js"),p=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/get-iterator-method.js"),f=Array;e.exports=function(e){var t=i(e),r=c(this),_=arguments.length,m=_>1?arguments[1]:void 0,h=void 0!==m;h&&(m=n(m,_>2?arguments[2]:void 0));var g,v,y,E,b,S,T=p(t),A=0;if(!T||this===f&&a(T))for(g=u(t),v=r?new this(g):f(g);g>A;A++)S=h?m(t[A],A):t[A],l(v,A,S);else for(b=(E=d(t,T)).next,v=r?new this:[];!(y=o(b,E)).done;A++)S=h?s(E,m,[y.value,A],!0):y.value,l(v,A,S);return v.length=A,v}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/array-includes.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/to-indexed-object.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/to-absolute-index.js"),i=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/length-of-array-like.js"),s=function(e){return function(t,r,s){var a,c=n(t),u=i(c),l=o(s,u);if(e&&r!=r){for(;u>l;)if((a=c[l++])!=a)return!0}else for(;u>l;l++)if((e||l in c)&&c[l]===r)return e||l||0;return!e&&-1}};e.exports={includes:s(!0),indexOf:s(!1)}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/array-slice-simple.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/to-absolute-index.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/length-of-array-like.js"),i=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/create-property.js"),s=Array,a=Math.max;e.exports=function(e,t,r){for(var c=o(e),u=n(t,c),l=n(void 0===r?c:r,c),d=s(a(l-u,0)),p=0;u<l;u++,p++)i(d,p,e[u]);return d.length=p,d}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/array-sort.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/array-slice-simple.js"),o=Math.floor,i=function(e,t){var r=e.length,c=o(r/2);return r<8?s(e,t):a(e,i(n(e,0,c),t),i(n(e,c),t),t)},s=function(e,t){for(var r,n,o=e.length,i=1;i<o;){for(n=i,r=e[i];n&&t(e[n-1],r)>0;)e[n]=e[--n];n!==i++&&(e[n]=r)}return e},a=function(e,t,r,n){for(var o=t.length,i=r.length,s=0,a=0;s<o||a<i;)e[s+a]=s<o&&a<i?n(t[s],r[a])<=0?t[s++]:r[a++]:s<o?t[s++]:r[a++];return e};e.exports=i},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/call-with-safe-iteration-closing.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/an-object.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/iterator-close.js");e.exports=function(e,t,r,i){try{return i?t(n(r)[0],r[1]):t(r)}catch(t){o(e,"throw",t)}}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/classof-raw.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/function-uncurry-this.js"),o=n({}.toString),i=n("".slice);e.exports=function(e){return i(o(e),8,-1)}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/classof.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/to-string-tag-support.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/is-callable.js"),i=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/classof-raw.js"),s=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/well-known-symbol.js")("toStringTag"),a=Object,c="Arguments"==i(function(){return arguments}());e.exports=n?i:function(e){var t,r,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(e){}}(t=a(e),s))?r:c?i(t):"Object"==(n=i(t))&&o(t.callee)?"Arguments":n}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/copy-constructor-properties.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/has-own-property.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/own-keys.js"),i=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/object-get-own-property-descriptor.js"),s=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/object-define-property.js");e.exports=function(e,t,r){for(var a=o(t),c=s.f,u=i.f,l=0;l<a.length;l++){var d=a[l];n(e,d)||r&&n(r,d)||c(e,d,u(t,d))}}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/correct-prototype-getter.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/fails.js");e.exports=!n(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/create-iter-result-object.js":function(e,t){e.exports=function(e,t){return{value:e,done:t}}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/create-non-enumerable-property.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/descriptors.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/object-define-property.js"),i=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/create-property-descriptor.js");e.exports=n?function(e,t,r){return o.f(e,t,i(1,r))}:function(e,t,r){return e[t]=r,e}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/create-property-descriptor.js":function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/create-property.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/to-property-key.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/object-define-property.js"),i=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/create-property-descriptor.js");e.exports=function(e,t,r){var s=n(t);s in e?o.f(e,s,i(0,r)):e[s]=r}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/define-built-in-accessor.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/make-built-in.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/object-define-property.js");e.exports=function(e,t,r){return r.get&&n(r.get,t,{getter:!0}),r.set&&n(r.set,t,{setter:!0}),o.f(e,t,r)}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/define-built-in.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/is-callable.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/object-define-property.js"),i=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/make-built-in.js"),s=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/define-global-property.js");e.exports=function(e,t,r,a){a||(a={});var c=a.enumerable,u=void 0!==a.name?a.name:t;if(n(r)&&i(r,u,a),a.global)c?e[t]=r:s(t,r);else{try{a.unsafe?e[t]&&(c=!0):delete e[t]}catch(e){}c?e[t]=r:o.f(e,t,{value:r,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return e}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/define-built-ins.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/define-built-in.js");e.exports=function(e,t,r){for(var o in t)n(e,o,t[o],r);return e}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/define-global-property.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/global.js"),o=Object.defineProperty;e.exports=function(e,t){try{o(n,e,{value:t,configurable:!0,writable:!0})}catch(r){n[e]=t}return t}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/descriptors.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/fails.js");e.exports=!n(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/document-all.js":function(e,t){var r="object"==typeof document&&document.all,n=void 0===r&&void 0!==r;e.exports={all:r,IS_HTMLDDA:n}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/document-create-element.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/global.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/is-object.js"),i=n.document,s=o(i)&&o(i.createElement);e.exports=function(e){return s?i.createElement(e):{}}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/engine-user-agent.js":function(e,t){e.exports="undefined"!=typeof navigator&&String(navigator.userAgent)||""},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/engine-v8-version.js":function(e,t,r){var n,o,i=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/global.js"),s=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/engine-user-agent.js"),a=i.process,c=i.Deno,u=a&&a.versions||c&&c.version,l=u&&u.v8;l&&(o=(n=l.split("."))[0]>0&&n[0]<4?1:+(n[0]+n[1])),!o&&s&&(!(n=s.match(/Edge\/(\d+)/))||n[1]>=74)&&(n=s.match(/Chrome\/(\d+)/))&&(o=+n[1]),e.exports=o},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/enum-bug-keys.js":function(e,t){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/export.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/global.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/object-get-own-property-descriptor.js").f,i=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/create-non-enumerable-property.js"),s=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/define-built-in.js"),a=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/define-global-property.js"),c=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/copy-constructor-properties.js"),u=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/is-forced.js");e.exports=function(e,t){var r,l,d,p,f,_=e.target,m=e.global,h=e.stat;if(r=m?n:h?n[_]||a(_,{}):(n[_]||{}).prototype)for(l in t){if(p=t[l],d=e.dontCallGetSet?(f=o(r,l))&&f.value:r[l],!u(m?l:_+(h?".":"#")+l,e.forced)&&void 0!==d){if(typeof p==typeof d)continue;c(p,d)}(e.sham||d&&d.sham)&&i(p,"sham",!0),s(r,l,p,e)}}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/fails.js":function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/function-bind-context.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/function-uncurry-this-clause.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/a-callable.js"),i=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/function-bind-native.js"),s=n(n.bind);e.exports=function(e,t){return o(e),void 0===t?e:i?s(e,t):function(){return e.apply(t,arguments)}}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/function-bind-native.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/fails.js");e.exports=!n(function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")})},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/function-call.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/function-bind-native.js"),o=Function.prototype.call;e.exports=n?o.bind(o):function(){return o.apply(o,arguments)}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/function-name.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/descriptors.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/has-own-property.js"),i=Function.prototype,s=n&&Object.getOwnPropertyDescriptor,a=o(i,"name"),c=a&&"something"===function(){}.name,u=a&&(!n||n&&s(i,"name").configurable);e.exports={EXISTS:a,PROPER:c,CONFIGURABLE:u}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/function-uncurry-this-accessor.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/function-uncurry-this.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/a-callable.js");e.exports=function(e,t,r){try{return n(o(Object.getOwnPropertyDescriptor(e,t)[r]))}catch(e){}}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/function-uncurry-this-clause.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/classof-raw.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/function-uncurry-this.js");e.exports=function(e){if("Function"===n(e))return o(e)}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/function-uncurry-this.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/function-bind-native.js"),o=Function.prototype,i=o.call,s=n&&o.bind.bind(i,i);e.exports=n?s:function(e){return function(){return i.apply(e,arguments)}}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/get-built-in.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/global.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/is-callable.js");e.exports=function(e,t){return arguments.length<2?function(e){return o(e)?e:void 0}(n[e]):n[e]&&n[e][t]}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/get-iterator-method.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/classof.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/get-method.js"),i=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/is-null-or-undefined.js"),s=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/iterators.js"),a=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/well-known-symbol.js")("iterator");e.exports=function(e){if(!i(e))return o(e,a)||o(e,"@@iterator")||s[n(e)]}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/get-iterator.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/function-call.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/a-callable.js"),i=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/an-object.js"),s=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/try-to-string.js"),a=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/get-iterator-method.js"),c=TypeError;e.exports=function(e,t){var r=arguments.length<2?a(e):t;if(o(r))return i(n(r,e));throw c(s(e)+" is not iterable")}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/get-method.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/a-callable.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/is-null-or-undefined.js");e.exports=function(e,t){var r=e[t];return o(r)?void 0:n(r)}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/global.js":function(e,t,r){(function(t){var r=function(e){return e&&e.Math==Math&&e};e.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof t&&t)||function(){return this}()||globalThis||Function("return this")()}).call(this,r("../../node_modules/.pnpm/webpack@4.46.0_webpack-command@0.4.2/node_modules/webpack/buildin/global.js"))},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/has-own-property.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/function-uncurry-this.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/to-object.js"),i=n({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return i(o(e),t)}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/hidden-keys.js":function(e,t){e.exports={}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/html.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/get-built-in.js");e.exports=n("document","documentElement")},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/ie8-dom-define.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/descriptors.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/fails.js"),i=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/document-create-element.js");e.exports=!n&&!o(function(){return 7!=Object.defineProperty(i("div"),"a",{get:function(){return 7}}).a})},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/indexed-object.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/function-uncurry-this.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/fails.js"),i=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/classof-raw.js"),s=Object,a=n("".split);e.exports=o(function(){return!s("z").propertyIsEnumerable(0)})?function(e){return"String"==i(e)?a(e,""):s(e)}:s},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/inspect-source.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/function-uncurry-this.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/is-callable.js"),i=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/shared-store.js"),s=n(Function.toString);o(i.inspectSource)||(i.inspectSource=function(e){return s(e)}),e.exports=i.inspectSource},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/internal-state.js":function(e,t,r){var n,o,i,s=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/weak-map-basic-detection.js"),a=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/global.js"),c=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/is-object.js"),u=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/create-non-enumerable-property.js"),l=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/has-own-property.js"),d=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/shared-store.js"),p=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/shared-key.js"),f=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/hidden-keys.js"),_=a.TypeError,m=a.WeakMap;if(s||d.state){var h=d.state||(d.state=new m);h.get=h.get,h.has=h.has,h.set=h.set,n=function(e,t){if(h.has(e))throw _("Object already initialized");return t.facade=e,h.set(e,t),t},o=function(e){return h.get(e)||{}},i=function(e){return h.has(e)}}else{var g=p("state");f[g]=!0,n=function(e,t){if(l(e,g))throw _("Object already initialized");return t.facade=e,u(e,g,t),t},o=function(e){return l(e,g)?e[g]:{}},i=function(e){return l(e,g)}}e.exports={set:n,get:o,has:i,enforce:function(e){return i(e)?o(e):n(e,{})},getterFor:function(e){return function(t){var r;if(!c(t)||(r=o(t)).type!==e)throw _("Incompatible receiver, "+e+" required");return r}}}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/is-array-iterator-method.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/well-known-symbol.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/iterators.js"),i=n("iterator"),s=Array.prototype;e.exports=function(e){return void 0!==e&&(o.Array===e||s[i]===e)}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/is-callable.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/document-all.js"),o=n.all;e.exports=n.IS_HTMLDDA?function(e){return"function"==typeof e||e===o}:function(e){return"function"==typeof e}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/is-constructor.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/function-uncurry-this.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/fails.js"),i=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/is-callable.js"),s=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/classof.js"),a=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/get-built-in.js"),c=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/inspect-source.js"),u=function(){},l=[],d=a("Reflect","construct"),p=/^\s*(?:class|function)\b/,f=n(p.exec),_=!p.exec(u),m=function(e){if(!i(e))return!1;try{return d(u,l,e),!0}catch(e){return!1}},h=function(e){if(!i(e))return!1;switch(s(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return _||!!f(p,c(e))}catch(e){return!0}};h.sham=!0,e.exports=!d||o(function(){var e;return m(m.call)||!m(Object)||!m(function(){e=!0})||e})?h:m},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/is-forced.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/fails.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/is-callable.js"),i=/#|\.prototype\./,s=function(e,t){var r=c[a(e)];return r==l||r!=u&&(o(t)?n(t):!!t)},a=s.normalize=function(e){return String(e).replace(i,".").toLowerCase()},c=s.data={},u=s.NATIVE="N",l=s.POLYFILL="P";e.exports=s},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/is-null-or-undefined.js":function(e,t){e.exports=function(e){return null===e||void 0===e}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/is-object.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/is-callable.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/document-all.js"),i=o.all;e.exports=o.IS_HTMLDDA?function(e){return"object"==typeof e?null!==e:n(e)||e===i}:function(e){return"object"==typeof e?null!==e:n(e)}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/is-pure.js":function(e,t){e.exports=!1},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/is-symbol.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/get-built-in.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/is-callable.js"),i=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/object-is-prototype-of.js"),s=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/use-symbol-as-uid.js"),a=Object;e.exports=s?function(e){return"symbol"==typeof e}:function(e){var t=n("Symbol");return o(t)&&i(t.prototype,a(e))}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/iterator-close.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/function-call.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/an-object.js"),i=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/get-method.js");e.exports=function(e,t,r){var s,a;o(e);try{if(!(s=i(e,"return"))){if("throw"===t)throw r;return r}s=n(s,e)}catch(e){a=!0,s=e}if("throw"===t)throw r;if(a)throw s;return o(s),r}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/iterator-create-constructor.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/iterators-core.js").IteratorPrototype,o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/object-create.js"),i=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/create-property-descriptor.js"),s=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/set-to-string-tag.js"),a=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/iterators.js"),c=function(){return this};e.exports=function(e,t,r,u){var l=t+" Iterator";return e.prototype=o(n,{next:i(+!u,r)}),s(e,l,!1,!0),a[l]=c,e}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/iterator-define.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/export.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/function-call.js"),i=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/is-pure.js"),s=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/function-name.js"),a=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/is-callable.js"),c=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/iterator-create-constructor.js"),u=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/object-get-prototype-of.js"),l=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/object-set-prototype-of.js"),d=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/set-to-string-tag.js"),p=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/create-non-enumerable-property.js"),f=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/define-built-in.js"),_=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/well-known-symbol.js"),m=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/iterators.js"),h=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/iterators-core.js"),g=s.PROPER,v=s.CONFIGURABLE,y=h.IteratorPrototype,E=h.BUGGY_SAFARI_ITERATORS,b=_("iterator"),S=function(){return this};e.exports=function(e,t,r,s,_,h,T){c(r,t,s);var A,w,C,I=function(e){if(e===_&&j)return j;if(!E&&e in N)return N[e];switch(e){case"keys":case"values":case"entries":return function(){return new r(this,e)}}return function(){return new r(this)}},O=t+" Iterator",R=!1,N=e.prototype,D=N[b]||N["@@iterator"]||_&&N[_],j=!E&&D||I(_),L="Array"==t&&N.entries||D;if(L&&(A=u(L.call(new e)))!==Object.prototype&&A.next&&(i||u(A)===y||(l?l(A,y):a(A[b])||f(A,b,S)),d(A,O,!0,!0),i&&(m[O]=S)),g&&"values"==_&&D&&"values"!==D.name&&(!i&&v?p(N,"name","values"):(R=!0,j=function(){return o(D,this)})),_)if(w={values:I("values"),keys:h?j:I("keys"),entries:I("entries")},T)for(C in w)!E&&!R&&C in N||f(N,C,w[C]);else n({target:t,proto:!0,forced:E||R},w);return i&&!T||N[b]===j||f(N,b,j,{name:_}),m[t]=j,w}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/iterators-core.js":function(e,t,r){var n,o,i,s=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/fails.js"),a=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/is-callable.js"),c=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/is-object.js"),u=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/object-create.js"),l=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/object-get-prototype-of.js"),d=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/define-built-in.js"),p=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/well-known-symbol.js"),f=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/is-pure.js"),_=p("iterator"),m=!1;[].keys&&("next"in(i=[].keys())?(o=l(l(i)))!==Object.prototype&&(n=o):m=!0),!c(n)||s(function(){var e={};return n[_].call(e)!==e})?n={}:f&&(n=u(n)),a(n[_])||d(n,_,function(){return this}),e.exports={IteratorPrototype:n,BUGGY_SAFARI_ITERATORS:m}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/iterators.js":function(e,t){e.exports={}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/length-of-array-like.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/to-length.js");e.exports=function(e){return n(e.length)}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/make-built-in.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/function-uncurry-this.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/fails.js"),i=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/is-callable.js"),s=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/has-own-property.js"),a=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/descriptors.js"),c=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/function-name.js").CONFIGURABLE,u=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/inspect-source.js"),l=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/internal-state.js"),d=l.enforce,p=l.get,f=String,_=Object.defineProperty,m=n("".slice),h=n("".replace),g=n([].join),v=a&&!o(function(){return 8!==_(function(){},"length",{value:8}).length}),y=String(String).split("String"),E=e.exports=function(e,t,r){"Symbol("===m(f(t),0,7)&&(t="["+h(f(t),/^Symbol\(([^)]*)\)/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!s(e,"name")||c&&e.name!==t)&&(a?_(e,"name",{value:t,configurable:!0}):e.name=t),v&&r&&s(r,"arity")&&e.length!==r.arity&&_(e,"length",{value:r.arity});try{r&&s(r,"constructor")&&r.constructor?a&&_(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(e){}var n=d(e);return s(n,"source")||(n.source=g(y,"string"==typeof t?t:"")),e};Function.prototype.toString=E(function(){return i(this)&&p(this).source||u(this)},"toString")},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/math-trunc.js":function(e,t){var r=Math.ceil,n=Math.floor;e.exports=Math.trunc||function(e){var t=+e;return(t>0?n:r)(t)}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/object-assign.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/descriptors.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/function-uncurry-this.js"),i=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/function-call.js"),s=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/fails.js"),a=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/object-keys.js"),c=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/object-get-own-property-symbols.js"),u=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/object-property-is-enumerable.js"),l=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/to-object.js"),d=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/indexed-object.js"),p=Object.assign,f=Object.defineProperty,_=o([].concat);e.exports=!p||s(function(){if(n&&1!==p({b:1},p(f({},"a",{enumerable:!0,get:function(){f(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},r=Symbol();return e[r]=7,"abcdefghijklmnopqrst".split("").forEach(function(e){t[e]=e}),7!=p({},e)[r]||"abcdefghijklmnopqrst"!=a(p({},t)).join("")})?function(e,t){for(var r=l(e),o=arguments.length,s=1,p=c.f,f=u.f;o>s;)for(var m,h=d(arguments[s++]),g=p?_(a(h),p(h)):a(h),v=g.length,y=0;v>y;)m=g[y++],n&&!i(f,h,m)||(r[m]=h[m]);return r}:p},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/object-create.js":function(e,t,r){var n,o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/an-object.js"),i=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/object-define-properties.js"),s=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/enum-bug-keys.js"),a=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/hidden-keys.js"),c=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/html.js"),u=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/document-create-element.js"),l=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/shared-key.js")("IE_PROTO"),d=function(){},p=function(e){return"<script>"+e+"<\/script>"},f=function(e){e.write(p("")),e.close();var t=e.parentWindow.Object;return e=null,t},_=function(){try{n=new ActiveXObject("htmlfile")}catch(e){}_="undefined"!=typeof document?document.domain&&n?f(n):function(){var e,t=u("iframe");return t.style.display="none",c.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(p("document.F=Object")),e.close(),e.F}():f(n);for(var e=s.length;e--;)delete _.prototype[s[e]];return _()};a[l]=!0,e.exports=Object.create||function(e,t){var r;return null!==e?(d.prototype=o(e),r=new d,d.prototype=null,r[l]=e):r=_(),void 0===t?r:i.f(r,t)}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/object-define-properties.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/descriptors.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/v8-prototype-define-bug.js"),i=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/object-define-property.js"),s=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/an-object.js"),a=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/to-indexed-object.js"),c=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/object-keys.js");t.f=n&&!o?Object.defineProperties:function(e,t){s(e);for(var r,n=a(t),o=c(t),u=o.length,l=0;u>l;)i.f(e,r=o[l++],n[r]);return e}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/object-define-property.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/descriptors.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/ie8-dom-define.js"),i=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/v8-prototype-define-bug.js"),s=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/an-object.js"),a=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/to-property-key.js"),c=TypeError,u=Object.defineProperty,l=Object.getOwnPropertyDescriptor;t.f=n?i?function(e,t,r){if(s(e),t=a(t),s(r),"function"==typeof e&&"prototype"===t&&"value"in r&&"writable"in r&&!r.writable){var n=l(e,t);n&&n.writable&&(e[t]=r.value,r={configurable:"configurable"in r?r.configurable:n.configurable,enumerable:"enumerable"in r?r.enumerable:n.enumerable,writable:!1})}return u(e,t,r)}:u:function(e,t,r){if(s(e),t=a(t),s(r),o)try{return u(e,t,r)}catch(e){}if("get"in r||"set"in r)throw c("Accessors not supported");return"value"in r&&(e[t]=r.value),e}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/object-get-own-property-descriptor.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/descriptors.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/function-call.js"),i=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/object-property-is-enumerable.js"),s=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/create-property-descriptor.js"),a=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/to-indexed-object.js"),c=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/to-property-key.js"),u=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/has-own-property.js"),l=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/ie8-dom-define.js"),d=Object.getOwnPropertyDescriptor;t.f=n?d:function(e,t){if(e=a(e),t=c(t),l)try{return d(e,t)}catch(e){}if(u(e,t))return s(!o(i.f,e,t),e[t])}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/object-get-own-property-names.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/object-keys-internal.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/enum-bug-keys.js").concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return n(e,o)}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/object-get-own-property-symbols.js":function(e,t){t.f=Object.getOwnPropertySymbols},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/object-get-prototype-of.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/has-own-property.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/is-callable.js"),i=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/to-object.js"),s=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/shared-key.js"),a=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/correct-prototype-getter.js"),c=s("IE_PROTO"),u=Object,l=u.prototype;e.exports=a?u.getPrototypeOf:function(e){var t=i(e);if(n(t,c))return t[c];var r=t.constructor;return o(r)&&t instanceof r?r.prototype:t instanceof u?l:null}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/object-is-prototype-of.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/function-uncurry-this.js");e.exports=n({}.isPrototypeOf)},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/object-keys-internal.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/function-uncurry-this.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/has-own-property.js"),i=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/to-indexed-object.js"),s=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/array-includes.js").indexOf,a=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/hidden-keys.js"),c=n([].push);e.exports=function(e,t){var r,n=i(e),u=0,l=[];for(r in n)!o(a,r)&&o(n,r)&&c(l,r);for(;t.length>u;)o(n,r=t[u++])&&(~s(l,r)||c(l,r));return l}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/object-keys.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/object-keys-internal.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/enum-bug-keys.js");e.exports=Object.keys||function(e){return n(e,o)}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/object-property-is-enumerable.js":function(e,t,r){var n={}.propertyIsEnumerable,o=Object.getOwnPropertyDescriptor,i=o&&!n.call({1:2},1);t.f=i?function(e){var t=o(this,e);return!!t&&t.enumerable}:n},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/object-set-prototype-of.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/function-uncurry-this-accessor.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/an-object.js"),i=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/a-possible-prototype.js");e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{(e=n(Object.prototype,"__proto__","set"))(r,[]),t=r instanceof Array}catch(e){}return function(r,n){return o(r),i(n),t?e(r,n):r.__proto__=n,r}}():void 0)},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/ordinary-to-primitive.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/function-call.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/is-callable.js"),i=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/is-object.js"),s=TypeError;e.exports=function(e,t){var r,a;if("string"===t&&o(r=e.toString)&&!i(a=n(r,e)))return a;if(o(r=e.valueOf)&&!i(a=n(r,e)))return a;if("string"!==t&&o(r=e.toString)&&!i(a=n(r,e)))return a;throw s("Can't convert object to primitive value")}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/own-keys.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/get-built-in.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/function-uncurry-this.js"),i=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/object-get-own-property-names.js"),s=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/object-get-own-property-symbols.js"),a=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/an-object.js"),c=o([].concat);e.exports=n("Reflect","ownKeys")||function(e){var t=i.f(a(e)),r=s.f;return r?c(t,r(e)):t}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/path.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/global.js");e.exports=n},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/require-object-coercible.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/is-null-or-undefined.js"),o=TypeError;e.exports=function(e){if(n(e))throw o("Can't call method on "+e);return e}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/set-to-string-tag.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/object-define-property.js").f,o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/has-own-property.js"),i=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/well-known-symbol.js")("toStringTag");e.exports=function(e,t,r){e&&!r&&(e=e.prototype),e&&!o(e,i)&&n(e,i,{configurable:!0,value:t})}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/shared-key.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/shared.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/uid.js"),i=n("keys");e.exports=function(e){return i[e]||(i[e]=o(e))}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/shared-store.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/global.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/define-global-property.js"),i=n["__core-js_shared__"]||o("__core-js_shared__",{});e.exports=i},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/shared.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/is-pure.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/shared-store.js");(e.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.30.2",mode:n?"pure":"global",copyright:"© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.30.2/LICENSE",source:"https://github.com/zloirock/core-js"})},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/string-multibyte.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/function-uncurry-this.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/to-integer-or-infinity.js"),i=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/to-string.js"),s=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/require-object-coercible.js"),a=n("".charAt),c=n("".charCodeAt),u=n("".slice),l=function(e){return function(t,r){var n,l,d=i(s(t)),p=o(r),f=d.length;return p<0||p>=f?e?"":void 0:(n=c(d,p))<55296||n>56319||p+1===f||(l=c(d,p+1))<56320||l>57343?e?a(d,p):n:e?u(d,p,p+2):l-56320+(n-55296<<10)+65536}};e.exports={codeAt:l(!1),charAt:l(!0)}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/string-punycode-to-ascii.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/function-uncurry-this.js"),o=/[^\0-\u007E]/,i=/[.\u3002\uFF0E\uFF61]/g,s="Overflow: input needs wider integers to process",a=RangeError,c=n(i.exec),u=Math.floor,l=String.fromCharCode,d=n("".charCodeAt),p=n([].join),f=n([].push),_=n("".replace),m=n("".split),h=n("".toLowerCase),g=function(e){return e+22+75*(e<26)},v=function(e,t,r){var n=0;for(e=r?u(e/700):e>>1,e+=u(e/t);e>455;)e=u(e/35),n+=36;return u(n+36*e/(e+38))},y=function(e){var t,r,n=[],o=(e=function(e){for(var t=[],r=0,n=e.length;r<n;){var o=d(e,r++);if(o>=55296&&o<=56319&&r<n){var i=d(e,r++);56320==(64512&i)?f(t,((1023&o)<<10)+(1023&i)+65536):(f(t,o),r--)}else f(t,o)}return t}(e)).length,i=128,c=0,_=72;for(t=0;t<e.length;t++)(r=e[t])<128&&f(n,l(r));var m=n.length,h=m;for(m&&f(n,"-");h<o;){var y=2147483647;for(t=0;t<e.length;t++)(r=e[t])>=i&&r<y&&(y=r);var E=h+1;if(y-i>u((2147483647-c)/E))throw a(s);for(c+=(y-i)*E,i=y,t=0;t<e.length;t++){if((r=e[t])<i&&++c>2147483647)throw a(s);if(r==i){for(var b=c,S=36;;){var T=S<=_?1:S>=_+26?26:S-_;if(b<T)break;var A=b-T,w=36-T;f(n,l(g(T+A%w))),b=u(A/w),S+=36}f(n,l(g(b))),_=v(c,E,h==m),c=0,h++}}c++,i++}return p(n,"")};e.exports=function(e){var t,r,n=[],s=m(_(h(e),i,"."),".");for(t=0;t<s.length;t++)r=s[t],f(n,c(o,r)?"xn--"+y(r):r);return p(n,".")}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/symbol-constructor-detection.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/engine-v8-version.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/fails.js"),i=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/global.js").String;e.exports=!!Object.getOwnPropertySymbols&&!o(function(){var e=Symbol();return!i(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&n&&n<41})},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/to-absolute-index.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/to-integer-or-infinity.js"),o=Math.max,i=Math.min;e.exports=function(e,t){var r=n(e);return r<0?o(r+t,0):i(r,t)}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/to-indexed-object.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/indexed-object.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/require-object-coercible.js");e.exports=function(e){return n(o(e))}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/to-integer-or-infinity.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/math-trunc.js");e.exports=function(e){var t=+e;return t!=t||0===t?0:n(t)}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/to-length.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/to-integer-or-infinity.js"),o=Math.min;e.exports=function(e){return e>0?o(n(e),9007199254740991):0}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/to-object.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/require-object-coercible.js"),o=Object;e.exports=function(e){return o(n(e))}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/to-primitive.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/function-call.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/is-object.js"),i=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/is-symbol.js"),s=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/get-method.js"),a=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/ordinary-to-primitive.js"),c=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/well-known-symbol.js"),u=TypeError,l=c("toPrimitive");e.exports=function(e,t){if(!o(e)||i(e))return e;var r,c=s(e,l);if(c){if(void 0===t&&(t="default"),r=n(c,e,t),!o(r)||i(r))return r;throw u("Can't convert object to primitive value")}return void 0===t&&(t="number"),a(e,t)}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/to-property-key.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/to-primitive.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/is-symbol.js");e.exports=function(e){var t=n(e,"string");return o(t)?t:t+""}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/to-string-tag-support.js":function(e,t,r){var n={};n[r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/well-known-symbol.js")("toStringTag")]="z",e.exports="[object z]"===String(n)},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/to-string.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/classof.js"),o=String;e.exports=function(e){if("Symbol"===n(e))throw TypeError("Cannot convert a Symbol value to a string");return o(e)}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/try-to-string.js":function(e,t){var r=String;e.exports=function(e){try{return r(e)}catch(e){return"Object"}}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/uid.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/function-uncurry-this.js"),o=0,i=Math.random(),s=n(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+s(++o+i,36)}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/url-constructor-detection.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/fails.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/well-known-symbol.js"),i=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/descriptors.js"),s=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/is-pure.js"),a=o("iterator");e.exports=!n(function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,r="";return e.pathname="c%20d",t.forEach(function(e,n){t.delete("b"),r+=n+e}),s&&!e.toJSON||!t.size&&(s||!i)||!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[a]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://тест").host||"#%D0%B1"!==new URL("http://a#б").hash||"a1c3"!==r||"x"!==new URL("http://x",void 0).host})},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/use-symbol-as-uid.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/symbol-constructor-detection.js");e.exports=n&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/v8-prototype-define-bug.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/descriptors.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/fails.js");e.exports=n&&o(function(){return 42!=Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype})},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/validate-arguments-length.js":function(e,t){var r=TypeError;e.exports=function(e,t){if(e<t)throw r("Not enough arguments");return e}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/weak-map-basic-detection.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/global.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/is-callable.js"),i=n.WeakMap;e.exports=o(i)&&/native code/.test(String(i))},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/well-known-symbol.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/global.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/shared.js"),i=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/has-own-property.js"),s=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/uid.js"),a=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/symbol-constructor-detection.js"),c=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/use-symbol-as-uid.js"),u=n.Symbol,l=o("wks"),d=c?u.for||u:u&&u.withoutSetter||s;e.exports=function(e){return i(l,e)||(l[e]=a&&i(u,e)?u[e]:d("Symbol."+e)),l[e]}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/modules/es.array.iterator.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/to-indexed-object.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/add-to-unscopables.js"),i=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/iterators.js"),s=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/internal-state.js"),a=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/object-define-property.js").f,c=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/iterator-define.js"),u=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/create-iter-result-object.js"),l=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/is-pure.js"),d=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/descriptors.js"),p=s.set,f=s.getterFor("Array Iterator");e.exports=c(Array,"Array",function(e,t){p(this,{type:"Array Iterator",target:n(e),index:0,kind:t})},function(){var e=f(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,u(void 0,!0)):u("keys"==r?n:"values"==r?t[n]:[n,t[n]],!1)},"values");var _=i.Arguments=i.Array;if(o("keys"),o("values"),o("entries"),!l&&d&&"values"!==_.name)try{a(_,"name",{value:"values"})}catch(e){}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/modules/es.string.iterator.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/string-multibyte.js").charAt,o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/to-string.js"),i=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/internal-state.js"),s=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/iterator-define.js"),a=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/create-iter-result-object.js"),c=i.set,u=i.getterFor("String Iterator");s(String,"String",function(e){c(this,{type:"String Iterator",string:o(e),index:0})},function(){var e,t=u(this),r=t.string,o=t.index;return o>=r.length?a(void 0,!0):(e=n(r,o),t.index+=e.length,a(e,!1))})},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/modules/web.url-search-params.constructor.js":function(e,t,r){r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/modules/es.array.iterator.js");var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/export.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/global.js"),i=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/function-call.js"),s=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/function-uncurry-this.js"),a=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/descriptors.js"),c=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/url-constructor-detection.js"),u=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/define-built-in.js"),l=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/define-built-in-accessor.js"),d=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/define-built-ins.js"),p=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/set-to-string-tag.js"),f=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/iterator-create-constructor.js"),_=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/internal-state.js"),m=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/an-instance.js"),h=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/is-callable.js"),g=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/has-own-property.js"),v=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/function-bind-context.js"),y=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/classof.js"),E=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/an-object.js"),b=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/is-object.js"),S=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/to-string.js"),T=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/object-create.js"),A=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/create-property-descriptor.js"),w=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/get-iterator.js"),C=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/get-iterator-method.js"),I=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/validate-arguments-length.js"),O=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/well-known-symbol.js"),R=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/array-sort.js"),N=O("iterator"),D=_.set,j=_.getterFor("URLSearchParams"),L=_.getterFor("URLSearchParamsIterator"),M=Object.getOwnPropertyDescriptor,P=function(e){if(!a)return o[e];var t=M(o,e);return t&&t.value},x=P("fetch"),k=P("Request"),B=P("Headers"),U=k&&k.prototype,G=B&&B.prototype,q=o.RegExp,F=o.TypeError,W=o.decodeURIComponent,K=o.encodeURIComponent,H=s("".charAt),Y=s([].join),V=s([].push),J=s("".replace),$=s([].shift),X=s([].splice),z=s("".split),Q=s("".slice),Z=/\+/g,ee=Array(4),te=function(e){return ee[e-1]||(ee[e-1]=q("((?:%[\\da-f]{2}){"+e+"})","gi"))},re=function(e){try{return W(e)}catch(t){return e}},ne=function(e){var t=J(e,Z," "),r=4;try{return W(t)}catch(e){for(;r;)t=J(t,te(r--),re);return t}},oe=/[!'()~]|%20/g,ie={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},se=function(e){return ie[e]},ae=function(e){return J(K(e),oe,se)},ce=f(function(e,t){D(this,{type:"URLSearchParamsIterator",iterator:w(j(e).entries),kind:t})},"Iterator",function(){var e=L(this),t=e.kind,r=e.iterator.next(),n=r.value;return r.done||(r.value="keys"===t?n.key:"values"===t?n.value:[n.key,n.value]),r},!0),ue=function(e){this.entries=[],this.url=null,void 0!==e&&(b(e)?this.parseObject(e):this.parseQuery("string"==typeof e?"?"===H(e,0)?Q(e,1):e:S(e)))};ue.prototype={type:"URLSearchParams",bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t,r,n,o,s,a,c,u=C(e);if(u)for(r=(t=w(e,u)).next;!(n=i(r,t)).done;){if(s=(o=w(E(n.value))).next,(a=i(s,o)).done||(c=i(s,o)).done||!i(s,o).done)throw F("Expected sequence with length 2");V(this.entries,{key:S(a.value),value:S(c.value)})}else for(var l in e)g(e,l)&&V(this.entries,{key:l,value:S(e[l])})},parseQuery:function(e){if(e)for(var t,r,n=z(e,"&"),o=0;o<n.length;)(t=n[o++]).length&&(r=z(t,"="),V(this.entries,{key:ne($(r)),value:ne(Y(r,"="))}))},serialize:function(){for(var e,t=this.entries,r=[],n=0;n<t.length;)e=t[n++],V(r,ae(e.key)+"="+ae(e.value));return Y(r,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var le=function(){m(this,de);var e=arguments.length>0?arguments[0]:void 0,t=D(this,new ue(e));a||(this.length=t.entries.length)},de=le.prototype;if(d(de,{append:function(e,t){I(arguments.length,2);var r=j(this);V(r.entries,{key:S(e),value:S(t)}),a||this.length++,r.updateURL()},delete:function(e){I(arguments.length,1);for(var t=j(this),r=t.entries,n=S(e),o=0;o<r.length;)r[o].key===n?X(r,o,1):o++;a||(this.length=r.length),t.updateURL()},get:function(e){I(arguments.length,1);for(var t=j(this).entries,r=S(e),n=0;n<t.length;n++)if(t[n].key===r)return t[n].value;return null},getAll:function(e){I(arguments.length,1);for(var t=j(this).entries,r=S(e),n=[],o=0;o<t.length;o++)t[o].key===r&&V(n,t[o].value);return n},has:function(e){I(arguments.length,1);for(var t=j(this).entries,r=S(e),n=0;n<t.length;)if(t[n++].key===r)return!0;return!1},set:function(e,t){I(arguments.length,1);for(var r,n=j(this),o=n.entries,i=!1,s=S(e),c=S(t),u=0;u<o.length;u++)(r=o[u]).key===s&&(i?X(o,u--,1):(i=!0,r.value=c));i||V(o,{key:s,value:c}),a||(this.length=o.length),n.updateURL()},sort:function(){var e=j(this);R(e.entries,function(e,t){return e.key>t.key?1:-1}),e.updateURL()},forEach:function(e){for(var t,r=j(this).entries,n=v(e,arguments.length>1?arguments[1]:void 0),o=0;o<r.length;)n((t=r[o++]).value,t.key,this)},keys:function(){return new ce(this,"keys")},values:function(){return new ce(this,"values")},entries:function(){return new ce(this,"entries")}},{enumerable:!0}),u(de,N,de.entries,{name:"entries"}),u(de,"toString",function(){return j(this).serialize()},{enumerable:!0}),a&&l(de,"size",{get:function(){return j(this).entries.length},configurable:!0,enumerable:!0}),p(le,"URLSearchParams"),n({global:!0,constructor:!0,forced:!c},{URLSearchParams:le}),!c&&h(B)){var pe=s(G.has),fe=s(G.set),_e=function(e){if(b(e)){var t,r=e.body;if("URLSearchParams"===y(r))return t=e.headers?new B(e.headers):new B,pe(t,"content-type")||fe(t,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),T(e,{body:A(0,S(r)),headers:A(0,t)})}return e};if(h(x)&&n({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(e){return x(e,arguments.length>1?_e(arguments[1]):{})}}),h(k)){var me=function(e){return m(this,U),new k(e,arguments.length>1?_e(arguments[1]):{})};U.constructor=me,me.prototype=U,n({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:me})}}e.exports={URLSearchParams:le,getState:j}},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/modules/web.url-search-params.js":function(e,t,r){r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/modules/web.url-search-params.constructor.js")},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/modules/web.url-search-params.size.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/descriptors.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/function-uncurry-this.js"),i=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/define-built-in-accessor.js"),s=URLSearchParams.prototype,a=o(s.forEach);!n||"size"in s||i(s,"size",{get:function(){var e=0;return a(this,function(){e++}),e},configurable:!0,enumerable:!0})},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/modules/web.url.can-parse.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/export.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/get-built-in.js"),i=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/fails.js"),s=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/validate-arguments-length.js"),a=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/to-string.js"),c=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/url-constructor-detection.js"),u=o("URL");n({target:"URL",stat:!0,forced:!(c&&i(function(){u.canParse()}))},{canParse:function(e){var t=s(arguments.length,1),r=a(e),n=t<2||void 0===arguments[1]?void 0:a(arguments[1]);try{return!!new u(r,n)}catch(e){return!1}}})},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/modules/web.url.constructor.js":function(e,t,r){r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/modules/es.string.iterator.js");var n,o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/export.js"),i=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/descriptors.js"),s=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/url-constructor-detection.js"),a=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/global.js"),c=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/function-bind-context.js"),u=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/function-uncurry-this.js"),l=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/define-built-in.js"),d=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/define-built-in-accessor.js"),p=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/an-instance.js"),f=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/has-own-property.js"),_=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/object-assign.js"),m=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/array-from.js"),h=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/array-slice-simple.js"),g=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/string-multibyte.js").codeAt,v=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/string-punycode-to-ascii.js"),y=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/to-string.js"),E=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/set-to-string-tag.js"),b=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/validate-arguments-length.js"),S=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/modules/web.url-search-params.constructor.js"),T=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/internal-state.js"),A=T.set,w=T.getterFor("URL"),C=S.URLSearchParams,I=S.getState,O=a.URL,R=a.TypeError,N=a.parseInt,D=Math.floor,j=Math.pow,L=u("".charAt),M=u(/./.exec),P=u([].join),x=u(1..toString),k=u([].pop),B=u([].push),U=u("".replace),G=u([].shift),q=u("".split),F=u("".slice),W=u("".toLowerCase),K=u([].unshift),H=/[a-z]/i,Y=/[\d+-.a-z]/i,V=/\d/,J=/^0x/i,$=/^[0-7]+$/,X=/^\d+$/,z=/^[\da-f]+$/i,Q=/[\0\t\n\r #%/:<>?@[\\\]^|]/,Z=/[\0\t\n\r #/:<>?@[\\\]^|]/,ee=/^[\u0000-\u0020]+/,te=/(^|[^\u0000-\u0020])[\u0000-\u0020]+$/,re=/[\t\n\r]/g,ne=function(e){var t,r,n,o;if("number"==typeof e){for(t=[],r=0;r<4;r++)K(t,e%256),e=D(e/256);return P(t,".")}if("object"==typeof e){for(t="",n=function(e){for(var t=null,r=1,n=null,o=0,i=0;i<8;i++)0!==e[i]?(o>r&&(t=n,r=o),n=null,o=0):(null===n&&(n=i),++o);return o>r&&(t=n,r=o),t}(e),r=0;r<8;r++)o&&0===e[r]||(o&&(o=!1),n===r?(t+=r?":":"::",o=!0):(t+=x(e[r],16),r<7&&(t+=":")));return"["+t+"]"}return e},oe={},ie=_({},oe,{" ":1,'"':1,"<":1,">":1,"`":1}),se=_({},ie,{"#":1,"?":1,"{":1,"}":1}),ae=_({},se,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),ce=function(e,t){var r=g(e,0);return r>32&&r<127&&!f(t,e)?e:encodeURIComponent(e)},ue={ftp:21,file:null,http:80,https:443,ws:80,wss:443},le=function(e,t){var r;return 2==e.length&&M(H,L(e,0))&&(":"==(r=L(e,1))||!t&&"|"==r)},de=function(e){var t;return e.length>1&&le(F(e,0,2))&&(2==e.length||"/"===(t=L(e,2))||"\\"===t||"?"===t||"#"===t)},pe=function(e){return"."===e||"%2e"===W(e)},fe=function(e){return".."===(e=W(e))||"%2e."===e||".%2e"===e||"%2e%2e"===e},_e={},me={},he={},ge={},ve={},ye={},Ee={},be={},Se={},Te={},Ae={},we={},Ce={},Ie={},Oe={},Re={},Ne={},De={},je={},Le={},Me={},Pe=function(e,t,r){var n,o,i,s=y(e);if(t){if(o=this.parse(s))throw R(o);this.searchParams=null}else{if(void 0!==r&&(n=new Pe(r,!0)),o=this.parse(s,null,n))throw R(o);(i=I(new C)).bindURL(this),this.searchParams=i}};Pe.prototype={type:"URL",parse:function(e,t,r){var o,i,s,a,c=this,u=t||_e,l=0,d="",p=!1,_=!1,g=!1;for(e=y(e),t||(c.scheme="",c.username="",c.password="",c.host=null,c.port=null,c.path=[],c.query=null,c.fragment=null,c.cannotBeABaseURL=!1,e=U(e,ee,""),e=U(e,te,"$1")),e=U(e,re,""),o=m(e);l<=o.length;){switch(i=o[l],u){case _e:if(!i||!M(H,i)){if(t)return"Invalid scheme";u=he;continue}d+=W(i),u=me;break;case me:if(i&&(M(Y,i)||"+"==i||"-"==i||"."==i))d+=W(i);else{if(":"!=i){if(t)return"Invalid scheme";d="",u=he,l=0;continue}if(t&&(c.isSpecial()!=f(ue,d)||"file"==d&&(c.includesCredentials()||null!==c.port)||"file"==c.scheme&&!c.host))return;if(c.scheme=d,t)return void(c.isSpecial()&&ue[c.scheme]==c.port&&(c.port=null));d="","file"==c.scheme?u=Ie:c.isSpecial()&&r&&r.scheme==c.scheme?u=ge:c.isSpecial()?u=be:"/"==o[l+1]?(u=ve,l++):(c.cannotBeABaseURL=!0,B(c.path,""),u=je)}break;case he:if(!r||r.cannotBeABaseURL&&"#"!=i)return"Invalid scheme";if(r.cannotBeABaseURL&&"#"==i){c.scheme=r.scheme,c.path=h(r.path),c.query=r.query,c.fragment="",c.cannotBeABaseURL=!0,u=Me;break}u="file"==r.scheme?Ie:ye;continue;case ge:if("/"!=i||"/"!=o[l+1]){u=ye;continue}u=Se,l++;break;case ve:if("/"==i){u=Te;break}u=De;continue;case ye:if(c.scheme=r.scheme,i==n)c.username=r.username,c.password=r.password,c.host=r.host,c.port=r.port,c.path=h(r.path),c.query=r.query;else if("/"==i||"\\"==i&&c.isSpecial())u=Ee;else if("?"==i)c.username=r.username,c.password=r.password,c.host=r.host,c.port=r.port,c.path=h(r.path),c.query="",u=Le;else{if("#"!=i){c.username=r.username,c.password=r.password,c.host=r.host,c.port=r.port,c.path=h(r.path),c.path.length--,u=De;continue}c.username=r.username,c.password=r.password,c.host=r.host,c.port=r.port,c.path=h(r.path),c.query=r.query,c.fragment="",u=Me}break;case Ee:if(!c.isSpecial()||"/"!=i&&"\\"!=i){if("/"!=i){c.username=r.username,c.password=r.password,c.host=r.host,c.port=r.port,u=De;continue}u=Te}else u=Se;break;case be:if(u=Se,"/"!=i||"/"!=L(d,l+1))continue;l++;break;case Se:if("/"!=i&&"\\"!=i){u=Te;continue}break;case Te:if("@"==i){p&&(d="%40"+d),p=!0,s=m(d);for(var v=0;v<s.length;v++){var E=s[v];if(":"!=E||g){var b=ce(E,ae);g?c.password+=b:c.username+=b}else g=!0}d=""}else if(i==n||"/"==i||"?"==i||"#"==i||"\\"==i&&c.isSpecial()){if(p&&""==d)return"Invalid authority";l-=m(d).length+1,d="",u=Ae}else d+=i;break;case Ae:case we:if(t&&"file"==c.scheme){u=Re;continue}if(":"!=i||_){if(i==n||"/"==i||"?"==i||"#"==i||"\\"==i&&c.isSpecial()){if(c.isSpecial()&&""==d)return"Invalid host";if(t&&""==d&&(c.includesCredentials()||null!==c.port))return;if(a=c.parseHost(d))return a;if(d="",u=Ne,t)return;continue}"["==i?_=!0:"]"==i&&(_=!1),d+=i}else{if(""==d)return"Invalid host";if(a=c.parseHost(d))return a;if(d="",u=Ce,t==we)return}break;case Ce:if(!M(V,i)){if(i==n||"/"==i||"?"==i||"#"==i||"\\"==i&&c.isSpecial()||t){if(""!=d){var S=N(d,10);if(S>65535)return"Invalid port";c.port=c.isSpecial()&&S===ue[c.scheme]?null:S,d=""}if(t)return;u=Ne;continue}return"Invalid port"}d+=i;break;case Ie:if(c.scheme="file","/"==i||"\\"==i)u=Oe;else{if(!r||"file"!=r.scheme){u=De;continue}if(i==n)c.host=r.host,c.path=h(r.path),c.query=r.query;else if("?"==i)c.host=r.host,c.path=h(r.path),c.query="",u=Le;else{if("#"!=i){de(P(h(o,l),""))||(c.host=r.host,c.path=h(r.path),c.shortenPath()),u=De;continue}c.host=r.host,c.path=h(r.path),c.query=r.query,c.fragment="",u=Me}}break;case Oe:if("/"==i||"\\"==i){u=Re;break}r&&"file"==r.scheme&&!de(P(h(o,l),""))&&(le(r.path[0],!0)?B(c.path,r.path[0]):c.host=r.host),u=De;continue;case Re:if(i==n||"/"==i||"\\"==i||"?"==i||"#"==i){if(!t&&le(d))u=De;else if(""==d){if(c.host="",t)return;u=Ne}else{if(a=c.parseHost(d))return a;if("localhost"==c.host&&(c.host=""),t)return;d="",u=Ne}continue}d+=i;break;case Ne:if(c.isSpecial()){if(u=De,"/"!=i&&"\\"!=i)continue}else if(t||"?"!=i)if(t||"#"!=i){if(i!=n&&(u=De,"/"!=i))continue}else c.fragment="",u=Me;else c.query="",u=Le;break;case De:if(i==n||"/"==i||"\\"==i&&c.isSpecial()||!t&&("?"==i||"#"==i)){if(fe(d)?(c.shortenPath(),"/"==i||"\\"==i&&c.isSpecial()||B(c.path,"")):pe(d)?"/"==i||"\\"==i&&c.isSpecial()||B(c.path,""):("file"==c.scheme&&!c.path.length&&le(d)&&(c.host&&(c.host=""),d=L(d,0)+":"),B(c.path,d)),d="","file"==c.scheme&&(i==n||"?"==i||"#"==i))for(;c.path.length>1&&""===c.path[0];)G(c.path);"?"==i?(c.query="",u=Le):"#"==i&&(c.fragment="",u=Me)}else d+=ce(i,se);break;case je:"?"==i?(c.query="",u=Le):"#"==i?(c.fragment="",u=Me):i!=n&&(c.path[0]+=ce(i,oe));break;case Le:t||"#"!=i?i!=n&&("'"==i&&c.isSpecial()?c.query+="%27":c.query+="#"==i?"%23":ce(i,oe)):(c.fragment="",u=Me);break;case Me:i!=n&&(c.fragment+=ce(i,ie))}l++}},parseHost:function(e){var t,r,n;if("["==L(e,0)){if("]"!=L(e,e.length-1))return"Invalid host";if(!(t=function(e){var t,r,n,o,i,s,a,c=[0,0,0,0,0,0,0,0],u=0,l=null,d=0,p=function(){return L(e,d)};if(":"==p()){if(":"!=L(e,1))return;d+=2,l=++u}for(;p();){if(8==u)return;if(":"!=p()){for(t=r=0;r<4&&M(z,p());)t=16*t+N(p(),16),d++,r++;if("."==p()){if(0==r)return;if(d-=r,u>6)return;for(n=0;p();){if(o=null,n>0){if(!("."==p()&&n<4))return;d++}if(!M(V,p()))return;for(;M(V,p());){if(i=N(p(),10),null===o)o=i;else{if(0==o)return;o=10*o+i}if(o>255)return;d++}c[u]=256*c[u]+o,2!=++n&&4!=n||u++}if(4!=n)return;break}if(":"==p()){if(d++,!p())return}else if(p())return;c[u++]=t}else{if(null!==l)return;d++,l=++u}}if(null!==l)for(s=u-l,u=7;0!=u&&s>0;)a=c[u],c[u--]=c[l+s-1],c[l+--s]=a;else if(8!=u)return;return c}(F(e,1,-1))))return"Invalid host";this.host=t}else if(this.isSpecial()){if(e=v(e),M(Q,e))return"Invalid host";if(null===(t=function(e){var t,r,n,o,i,s,a,c=q(e,".");if(c.length&&""==c[c.length-1]&&c.length--,(t=c.length)>4)return e;for(r=[],n=0;n<t;n++){if(""==(o=c[n]))return e;if(i=10,o.length>1&&"0"==L(o,0)&&(i=M(J,o)?16:8,o=F(o,8==i?1:2)),""===o)s=0;else{if(!M(10==i?X:8==i?$:z,o))return e;s=N(o,i)}B(r,s)}for(n=0;n<t;n++)if(s=r[n],n==t-1){if(s>=j(256,5-t))return null}else if(s>255)return null;for(a=k(r),n=0;n<r.length;n++)a+=r[n]*j(256,3-n);return a}(e)))return"Invalid host";this.host=t}else{if(M(Z,e))return"Invalid host";for(t="",r=m(e),n=0;n<r.length;n++)t+=ce(r[n],oe);this.host=t}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||"file"==this.scheme},includesCredentials:function(){return""!=this.username||""!=this.password},isSpecial:function(){return f(ue,this.scheme)},shortenPath:function(){var e=this.path,t=e.length;!t||"file"==this.scheme&&1==t&&le(e[0],!0)||e.length--},serialize:function(){var e=this,t=e.scheme,r=e.username,n=e.password,o=e.host,i=e.port,s=e.path,a=e.query,c=e.fragment,u=t+":";return null!==o?(u+="//",e.includesCredentials()&&(u+=r+(n?":"+n:"")+"@"),u+=ne(o),null!==i&&(u+=":"+i)):"file"==t&&(u+="//"),u+=e.cannotBeABaseURL?s[0]:s.length?"/"+P(s,"/"):"",null!==a&&(u+="?"+a),null!==c&&(u+="#"+c),u},setHref:function(e){var t=this.parse(e);if(t)throw R(t);this.searchParams.update()},getOrigin:function(){var e=this.scheme,t=this.port;if("blob"==e)try{return new xe(e.path[0]).origin}catch(e){return"null"}return"file"!=e&&this.isSpecial()?e+"://"+ne(this.host)+(null!==t?":"+t:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(y(e)+":",_e)},getUsername:function(){return this.username},setUsername:function(e){var t=m(y(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var r=0;r<t.length;r++)this.username+=ce(t[r],ae)}},getPassword:function(){return this.password},setPassword:function(e){var t=m(y(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var r=0;r<t.length;r++)this.password+=ce(t[r],ae)}},getHost:function(){var e=this.host,t=this.port;return null===e?"":null===t?ne(e):ne(e)+":"+t},setHost:function(e){this.cannotBeABaseURL||this.parse(e,Ae)},getHostname:function(){var e=this.host;return null===e?"":ne(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,we)},getPort:function(){var e=this.port;return null===e?"":y(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||(""==(e=y(e))?this.port=null:this.parse(e,Ce))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+P(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,Ne))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){""==(e=y(e))?this.query=null:("?"==L(e,0)&&(e=F(e,1)),this.query="",this.parse(e,Le)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){""!=(e=y(e))?("#"==L(e,0)&&(e=F(e,1)),this.fragment="",this.parse(e,Me)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var xe=function(e){var t=p(this,ke),r=b(arguments.length,1)>1?arguments[1]:void 0,n=A(t,new Pe(e,!1,r));i||(t.href=n.serialize(),t.origin=n.getOrigin(),t.protocol=n.getProtocol(),t.username=n.getUsername(),t.password=n.getPassword(),t.host=n.getHost(),t.hostname=n.getHostname(),t.port=n.getPort(),t.pathname=n.getPathname(),t.search=n.getSearch(),t.searchParams=n.getSearchParams(),t.hash=n.getHash())},ke=xe.prototype,Be=function(e,t){return{get:function(){return w(this)[e]()},set:t&&function(e){return w(this)[t](e)},configurable:!0,enumerable:!0}};if(i&&(d(ke,"href",Be("serialize","setHref")),d(ke,"origin",Be("getOrigin")),d(ke,"protocol",Be("getProtocol","setProtocol")),d(ke,"username",Be("getUsername","setUsername")),d(ke,"password",Be("getPassword","setPassword")),d(ke,"host",Be("getHost","setHost")),d(ke,"hostname",Be("getHostname","setHostname")),d(ke,"port",Be("getPort","setPort")),d(ke,"pathname",Be("getPathname","setPathname")),d(ke,"search",Be("getSearch","setSearch")),d(ke,"searchParams",Be("getSearchParams")),d(ke,"hash",Be("getHash","setHash"))),l(ke,"toJSON",function(){return w(this).serialize()},{enumerable:!0}),l(ke,"toString",function(){return w(this).serialize()},{enumerable:!0}),O){var Ue=O.createObjectURL,Ge=O.revokeObjectURL;Ue&&l(xe,"createObjectURL",c(Ue,O)),Ge&&l(xe,"revokeObjectURL",c(Ge,O))}E(xe,"URL"),o({global:!0,constructor:!0,forced:!s,sham:!i},{URL:xe})},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/modules/web.url.js":function(e,t,r){r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/modules/web.url.constructor.js")},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/modules/web.url.to-json.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/export.js"),o=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/function-call.js");n({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return o(URL.prototype.toString,this)}})},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/stable/url/index.js":function(e,t,r){var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/web/url.js");e.exports=n},"../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/web/url.js":function(e,t,r){r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/modules/web.url.js"),r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/modules/web.url.can-parse.js"),r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/modules/web.url.to-json.js"),r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/modules/web.url-search-params.js"),r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/modules/web.url-search-params.size.js");var n=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/internals/path.js");e.exports=n.URL},"../../node_modules/.pnpm/ieee754@1.2.1/node_modules/ieee754/index.js":function(e,t){t.read=function(e,t,r,n,o){var i,s,a=8*o-n-1,c=(1<<a)-1,u=c>>1,l=-7,d=r?o-1:0,p=r?-1:1,f=e[t+d];for(d+=p,i=f&(1<<-l)-1,f>>=-l,l+=a;l>0;i=256*i+e[t+d],d+=p,l-=8);for(s=i&(1<<-l)-1,i>>=-l,l+=n;l>0;s=256*s+e[t+d],d+=p,l-=8);if(0===i)i=1-u;else{if(i===c)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,n),i-=u}return(f?-1:1)*s*Math.pow(2,i-n)},t.write=function(e,t,r,n,o,i){var s,a,c,u=8*i-o-1,l=(1<<u)-1,d=l>>1,p=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:i-1,_=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=l):(s=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-s))<1&&(s--,c*=2),(t+=s+d>=1?p/c:p*Math.pow(2,1-d))*c>=2&&(s++,c/=2),s+d>=l?(a=0,s=l):s+d>=1?(a=(t*c-1)*Math.pow(2,o),s+=d):(a=t*Math.pow(2,d-1)*Math.pow(2,o),s=0));o>=8;e[r+f]=255&a,f+=_,a/=256,o-=8);for(s=s<<o|a,u+=o;u>0;e[r+f]=255&s,f+=_,s/=256,u-=8);e[r+f-_]|=128*m}},"../../node_modules/.pnpm/isarray@1.0.0/node_modules/isarray/index.js":function(e,t){var r={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},"../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_Symbol.js":function(e,t,r){var n=r("../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_root.js").a.Symbol;t.a=n},"../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_baseGetTag.js":function(e,t,r){var n=r("../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_Symbol.js"),o=r("../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_getRawTag.js"),i=r("../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_objectToString.js"),s="[object Null]",a="[object Undefined]",c=n.a?n.a.toStringTag:void 0;t.a=function(e){return null==e?void 0===e?a:s:c&&c in Object(e)?Object(o.a)(e):Object(i.a)(e)}},"../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_baseTrim.js":function(e,t,r){var n=r("../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_trimmedEndIndex.js"),o=/^\s+/;t.a=function(e){return e?e.slice(0,Object(n.a)(e)+1).replace(o,""):e}},"../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_freeGlobal.js":function(e,t,r){(function(e){var r="object"==typeof e&&e&&e.Object===Object&&e;t.a=r}).call(this,r("../../node_modules/.pnpm/webpack@4.46.0_webpack-command@0.4.2/node_modules/webpack/buildin/global.js"))},"../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_getRawTag.js":function(e,t,r){var n=r("../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_Symbol.js"),o=Object.prototype,i=o.hasOwnProperty,s=o.toString,a=n.a?n.a.toStringTag:void 0;t.a=function(e){var t=i.call(e,a),r=e[a];try{e[a]=void 0;var n=!0}catch(e){}var o=s.call(e);return n&&(t?e[a]=r:delete e[a]),o}},"../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_objectToString.js":function(e,t,r){var n=Object.prototype.toString;t.a=function(e){return n.call(e)}},"../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_root.js":function(e,t,r){var n=r("../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_freeGlobal.js"),o="object"==typeof self&&self&&self.Object===Object&&self,i=n.a||o||Function("return this")();t.a=i},"../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_trimmedEndIndex.js":function(e,t,r){var n=/\s/;t.a=function(e){for(var t=e.length;t--&&n.test(e.charAt(t)););return t}},"../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/debounce.js":function(e,t,r){r.r(t);var n=r("../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/isObject.js"),o=r("../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/now.js"),i=r("../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/toNumber.js"),s="Expected a function",a=Math.max,c=Math.min;t.default=function(e,t,r){var u,l,d,p,f,_,m=0,h=!1,g=!1,v=!0;if("function"!=typeof e)throw new TypeError(s);function y(t){var r=u,n=l;return u=l=void 0,m=t,p=e.apply(n,r)}function E(e){var r=e-_;return void 0===_||r>=t||r<0||g&&e-m>=d}function b(){var e=Object(o.a)();if(E(e))return S(e);f=setTimeout(b,function(e){var r=t-(e-_);return g?c(r,d-(e-m)):r}(e))}function S(e){return f=void 0,v&&u?y(e):(u=l=void 0,p)}function T(){var e=Object(o.a)(),r=E(e);if(u=arguments,l=this,_=e,r){if(void 0===f)return function(e){return m=e,f=setTimeout(b,t),h?y(e):p}(_);if(g)return clearTimeout(f),f=setTimeout(b,t),y(_)}return void 0===f&&(f=setTimeout(b,t)),p}return t=Object(i.a)(t)||0,Object(n.a)(r)&&(h=!!r.leading,d=(g="maxWait"in r)?a(Object(i.a)(r.maxWait)||0,t):d,v="trailing"in r?!!r.trailing:v),T.cancel=function(){void 0!==f&&clearTimeout(f),m=0,u=_=l=f=void 0},T.flush=function(){return void 0===f?p:S(Object(o.a)())},T}},"../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/isObject.js":function(e,t,r){t.a=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},"../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/isObjectLike.js":function(e,t,r){t.a=function(e){return null!=e&&"object"==typeof e}},"../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/isSymbol.js":function(e,t,r){var n=r("../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_baseGetTag.js"),o=r("../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/isObjectLike.js"),i="[object Symbol]";t.a=function(e){return"symbol"==typeof e||Object(o.a)(e)&&Object(n.a)(e)==i}},"../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/now.js":function(e,t,r){var n=r("../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_root.js");t.a=function(){return n.a.Date.now()}},"../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/toNumber.js":function(e,t,r){var n=r("../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_baseTrim.js"),o=r("../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/isObject.js"),i=r("../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/isSymbol.js"),s=NaN,a=/^[-+]0x[0-9a-f]+$/i,c=/^0b[01]+$/i,u=/^0o[0-7]+$/i,l=parseInt;t.a=function(e){if("number"==typeof e)return e;if(Object(i.a)(e))return s;if(Object(o.a)(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Object(o.a)(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Object(n.a)(e);var r=c.test(e);return r||u.test(e)?l(e.slice(2),r?2:8):a.test(e)?s:+e}},"../../node_modules/.pnpm/process@0.11.10/node_modules/process/browser.js":function(e,t){var r,n,o=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(r===setTimeout)return setTimeout(e,0);if((r===i||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:i}catch(e){r=i}try{n="function"==typeof clearTimeout?clearTimeout:s}catch(e){n=s}}();var c,u=[],l=!1,d=-1;function p(){l&&c&&(l=!1,c.length?u=c.concat(u):d=-1,u.length&&f())}function f(){if(!l){var e=a(p);l=!0;for(var t=u.length;t;){for(c=u,u=[];++d<t;)c&&c[d].run();d=-1,t=u.length}c=null,l=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function _(e,t){this.fun=e,this.array=t}function m(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new _(e,t)),1!==u.length||l||a(f)},_.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=m,o.addListener=m,o.once=m,o.off=m,o.removeListener=m,o.removeAllListeners=m,o.emit=m,o.prependListener=m,o.prependOnceListener=m,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},"../../node_modules/.pnpm/setimmediate@1.0.5/node_modules/setimmediate/setImmediate.js":function(e,t,r){(function(e,t){!function(e,r){if(!e.setImmediate){var n,o=1,i={},s=!1,a=e.document,c=Object.getPrototypeOf&&Object.getPrototypeOf(e);c=c&&c.setTimeout?c:e,"[object process]"==={}.toString.call(e.process)?n=function(e){t.nextTick(function(){l(e)})}:function(){if(e.postMessage&&!e.importScripts){var t=!0,r=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=r,t}}()?function(){var t="setImmediate$"+Math.random()+"$",r=function(r){r.source===e&&"string"==typeof r.data&&0===r.data.indexOf(t)&&l(+r.data.slice(t.length))};e.addEventListener?e.addEventListener("message",r,!1):e.attachEvent("onmessage",r),n=function(r){e.postMessage(t+r,"*")}}():e.MessageChannel?function(){var e=new MessageChannel;e.port1.onmessage=function(e){l(e.data)},n=function(t){e.port2.postMessage(t)}}():a&&"onreadystatechange"in a.createElement("script")?function(){var e=a.documentElement;n=function(t){var r=a.createElement("script");r.onreadystatechange=function(){l(t),r.onreadystatechange=null,e.removeChild(r),r=null},e.appendChild(r)}}():n=function(e){setTimeout(l,0,e)},c.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),r=0;r<t.length;r++)t[r]=arguments[r+1];var s={callback:e,args:t};return i[o]=s,n(o),o++},c.clearImmediate=u}function u(e){delete i[e]}function l(e){if(s)setTimeout(l,0,e);else{var t=i[e];if(t){s=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(r,n)}}(t)}finally{u(e),s=!1}}}}}("undefined"==typeof self?void 0===e?globalThis:e:self)}).call(this,r("../../node_modules/.pnpm/webpack@4.46.0_webpack-command@0.4.2/node_modules/webpack/buildin/global.js"),r("../../node_modules/.pnpm/process@0.11.10/node_modules/process/browser.js"))},"../../node_modules/.pnpm/timers-browserify@2.0.12/node_modules/timers-browserify/main.js":function(e,t,r){(function(e){var n=void 0!==e&&e||"undefined"!=typeof self&&self||window,o=Function.prototype.apply;function i(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new i(o.call(setTimeout,n,arguments),clearTimeout)},t.setInterval=function(){return new i(o.call(setInterval,n,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(n,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},r("../../node_modules/.pnpm/setimmediate@1.0.5/node_modules/setimmediate/setImmediate.js"),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||globalThis&&globalThis.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||globalThis&&globalThis.clearImmediate}).call(this,r("../../node_modules/.pnpm/webpack@4.46.0_webpack-command@0.4.2/node_modules/webpack/buildin/global.js"))},"../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js":function(e,t,r){r.r(t),r.d(t,"__extends",function(){return o}),r.d(t,"__assign",function(){return i}),r.d(t,"__rest",function(){return s}),r.d(t,"__decorate",function(){return a}),r.d(t,"__param",function(){return c}),r.d(t,"__metadata",function(){return u}),r.d(t,"__awaiter",function(){return l}),r.d(t,"__generator",function(){return d}),r.d(t,"__createBinding",function(){return p}),r.d(t,"__exportStar",function(){return f}),r.d(t,"__values",function(){return _}),r.d(t,"__read",function(){return m}),r.d(t,"__spread",function(){return h}),r.d(t,"__spreadArrays",function(){return g}),r.d(t,"__spreadArray",function(){return v}),r.d(t,"__await",function(){return y}),r.d(t,"__asyncGenerator",function(){return E}),r.d(t,"__asyncDelegator",function(){return b}),r.d(t,"__asyncValues",function(){return S}),r.d(t,"__makeTemplateObject",function(){return T}),r.d(t,"__importStar",function(){return w}),r.d(t,"__importDefault",function(){return C}),r.d(t,"__classPrivateFieldGet",function(){return I}),r.d(t,"__classPrivateFieldSet",function(){return O}),r.d(t,"__classPrivateFieldIn",function(){return R});var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){Object.defineProperty(this,"constructor",{value:e})}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function s(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function a(e,t,r,n){var o,i=arguments.length,s=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,r,s):o(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s}function c(e,t){return function(r,n){t(r,n,e)}}function u(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t,r,n){return new(r||(r=Promise))(function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):function(e){return e instanceof r?e:new r(function(t){t(e)})}(e.value).then(s,a)}c((n=n.apply(e,t||[])).next())})}function d(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(a){return function(c){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(r=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}var p=Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function f(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||p(t,e,r)}function _(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function m(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function h(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(m(arguments[t]));return e}function g(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,o++)n[o]=i[s];return n}function v(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function y(e){return this instanceof y?(this.v=e,this):new y(e)}function E(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n={},s("next"),s("throw"),s("return"),n[Symbol.asyncIterator]=function(){return this},n;function s(e){o[e]&&(n[e]=function(t){return new Promise(function(r,n){i.push([e,t,r,n])>1||a(e,t)})})}function a(e,t){try{!function(e){e.value instanceof y?Promise.resolve(e.value.v).then(c,u):l(i[0][2],e)}(o[e](t))}catch(e){l(i[0][3],e)}}function c(e){a("next",e)}function u(e){a("throw",e)}function l(e,t){e(t),i.shift(),i.length&&a(i[0][0],i[0][1])}}function b(e){var t,r;return t={},n("next"),n("throw",function(e){throw e}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:y(e[n](t)),done:"return"===n}:o?o(t):t}:o}}function S(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=_(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,o){(function(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)})(n,o,(t=e[r](t)).done,t.value)})}}}function T(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var A=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function w(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&p(t,e,r);return A(t,e),t}function C(e){return e&&e.__esModule?e:{default:e}}function I(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function O(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}function R(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},"../../node_modules/.pnpm/webpack@4.46.0_webpack-command@0.4.2/node_modules/webpack/buildin/global.js":function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},"./src/cloud/index.ts":function(e,t,r){(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.InstanceCloud=t.DefaultCloud=t.getCloudAPI=t.getCloudInstance=void 0;var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),o=r("./src/utils/merge.ts"),i=r("./src/services/index.ts"),s=r("./src/runtime/app/index.ts"),a=r("@web"),c=r("./src/utils/error.ts"),u=r("./src/utils/type.ts"),l=r("./src/network/tunnel.ts"),d=r("./src/config/error.config.ts"),p=r("./src/externals/public-lib/appserviceSdk.ts"),f=r("./src/externals/globals/wxconfig.ts"),_=r("./src/utils/report.ts"),m=r("./src/config/app.config.ts"),h=r("./src/runtime/runtime.ts"),g=r("@web"),v=r("./src/utils/service-endpoint.ts"),y=r("./src/utils/utils.ts"),E=r("./src/utils/userAgent.ts"),b=r("./src/services/obs/index.ts"),S=r("./src/services/saas/internal.ts");t.getCloudInstance=function(e){void 0===e&&(e={});var t=e.sdk,r=e.identifiers||{};return t&&(0,p.setSDK)(r,t),new T(r,!1)};t.getCloudAPI=function(e){return void 0===e&&(e={}),(0,t.getCloudInstance)(e).exportAPI};var T=function(){function t(t,r){var o,s=this;this.inited=!1,this.services={},this.apiServiceMap={},this.plugins=[],this.debug=!1,this.testSpeed=function(){return n.__awaiter(s,void 0,void 0,function(){var e,t,r;return n.__generator(this,function(n){return e=+new Date,t=e,r=(0,l.constructTunnelReq)({cloud:this,apiName:"tcbapi_testspeed",serializedReqData:null}),[2,(0,l.tunnel)(r,{fireOnIdle:!0,onFire:function(){e=+new Date,t=e}}).then(function(r){(0,_.reportAPISpeed)({apiName:"cloud.testspeed",apiEndTime:+new Date,apiStartTime:e,tunnelEndTime:+new Date,tunnelStartTime:t,tunnelTimeNoCSNetCost:r.data.baseresponse.stat.qbase_cost_time})}).catch(function(e){0})]})})},this.identifiers=t,this.isInstance=r,this.runtimeInfo=(0,h.getRuntimeInfo)(),this.serviceEndpoint=new v.ServiceEndpoint(t),this.request=(0,l.getBoundTunnelRequest)({cloud:this});var a=this;this.exportAPI={init:this.init.bind(this),obs:b.default},this.isInstance||(this.exportAPI.Cloud=function(e){return new A(t,a,e).exportAPI}),(0,i.registerServices)(this),this.meta={session_id:Date.now()+""},e.env.WEB&&(this.meta.session_id=""),this.serviceEndpoint.setMetaData(this.getMetaData()),this.serviceEndpoint.setTunnelRequest(this.request),this.config={database:w()},this.appConfig=n.__assign({},m.default),this.apiPermissions={};try{this.hijackNativeFunctions(this.services.services)}catch(e){console.error(e)}try{null===(o=f.default.onReady)||void 0===o||o.call(f.default,function(){setTimeout(function(){(0,_.init)()},2e3),(0,E.getUA)()}),e.env.TEST&&(this.exportAPI.getCloudInstance=function(){return s})}catch(e){}}return t.prototype.getMetaData=function(){var t,r=this;if(!this.meta.sdk_version){var n=(0,p.getSDK)(this.identifiers);if(n){var o=n.wx;o&&o.version&&("miniprogram"===this.runtimeInfo.env?this.meta.sdk_version="wx-miniprogram-sdk/".concat(o.version.version," (").concat(Date.parse("".concat(o.version.updateTime," GMT+0800"))," platform/").concat(this.runtimeInfo.platform,"})"):this.meta.sdk_version="wx-web-sdk/".concat(e.env.SDKVERSION," (").concat(Date.parse("".concat(e.env.SDKVERSION_UPDATETIME," GMT+0800")),")"))}null===(t=f.default.onReady)||void 0===t||t.call(f.default,function(){var e;r.meta.filter_user_info="singlePage"===(null===(e=f.default.appLaunchInfo)||void 0===e?void 0:e.mode)})}return this.meta},t.prototype.getConfig=function(){return this.config},t.prototype.getEnvForService=function(e){if(this.isInstance)return this.instanceOptions.resourceEnv;var t=this.config;if(t.env)switch((0,u.getType)(t.env)){case"string":return t.env;case"object":return t.env[e];default:return}},t.prototype.checkAPIPermission=function(e){return!this.apiPermissions.hasOwnProperty(e)||1===this.apiPermissions[e]},t.prototype.init=function(e){var t=this;void 0===e&&(e={}),this.inited=!0,this.initConfig(e),e.prefetch&&this.serviceEndpoint.getEndpoint("container").catch(function(e){});try{(0,y.privateGetBackgroundFetchData)(500,this.identifiers)}catch(e){null===y._wxConsole||void 0===y._wxConsole||y._wxConsole.log("privateGetBackgroundFetchData error",e)}return Promise.all([this.sendInitRequest().then(function(){Math.random()<.1&&t.testSpeed()})]).then(function(){})},t.prototype.initConfig=function(e){this.config=JSON.parse(JSON.stringify(e)),this.plugins=(e.plugins||[]).map(function(e){return S.SaaSServiceMap.get(e)}).filter(function(e){return!!e}),this.config.database?this.config.database=(0,o.default)(this.config.database,w()):this.config.database=w(),"sdk"===this.runtimeInfo.platform&&(0,s.patchAppSDK)()},t.prototype.sendInitRequest=function(){var e=this,t="string"==typeof this.config.env?this.config.env:void 0,r=JSON.stringify({trace_user:!1!==this.config.traceUser,env:t,region:this.config.region}),o=+new Date,i=o;return this.request(n.__assign(n.__assign({},this.config),{apiName:"tcbapi_init",serializedReqData:r,env:t})).then(function(t){var r=+new Date,s=t.data;e.appConfig=n.__assign(n.__assign({},e.appConfig),s.config);for(var a=s.tcb_api_list||[],c=0,u=a.length;c<u;c++)e.apiPermissions[a[c].apiname]=a[c].status;(0,_.reportAPISpeed)({apiName:"cloud.init",apiEndTime:+new Date,apiStartTime:o,tunnelEndTime:r,tunnelStartTime:i,tunnelTimeNoCSNetCost:s.baseresponse.stat.qbase_cost_time})}).catch(function(e){console.error("cloud init error: ",e)})},t.prototype.registerService=function(e,t){this.services[e.name]=e;var r=e.getAPIs();for(var n in r)if(this.apiServiceMap[n]=e.name,"function"==typeof r[n])this.registerFunction(n,!0,r[n],t);else{var o=r[n],i=o.initRequired,s=o.fn;this.registerFunction(n,i,s,t)}},t.prototype.hijackNativeFunctions=function(e){var t,r=null===(t=e.getHijackPattern)||void 0===t?void 0:t.call(e);for(var n in r)if(Object.prototype.hasOwnProperty.call(r,n)){var o=r[n],i=wx[n];console.log("[cloud] rewriting native function",n),Object.defineProperty(wx,n,{configurable:!1,enumerable:!0,value:o}),Object.defineProperty(wx,"_".concat(n),{configurable:!1,enumerable:!0,value:i})}},t.prototype.registerFunction=function(e,t,r,n){var o=this,i=this.exportAPI;n&&(this.exportAPI[n]=Object.assign({},this.exportAPI[n]),i=this.exportAPI[n]),i[e]=t?function(){if(!o.inited)throw new c.CloudSDKError({errMsg:"Cloud API isn't enabled, please call wx.cloud.init first\n请先调用 wx.cloud.init() 完成初始化后再调用其他云 API。"});if(!o.checkAPIPermission(e))throw new c.CloudSDKError({errCode:d.ERR_CODE.SDK_API_PERMISSION_DENIED,errMsg:d.ERR_CODE[d.ERR_CODE.SDK_API_PERMISSION_DENIED]});return r.apply(o,arguments)}:r},t.prototype.toJSON=function(){},t}();t.DefaultCloud=T;var A=function(e){function t(t,r,n){var i=e.call(this,t,!0)||this;if("web"===i.runtimeInfo.env){if(!n.identityless&&!n.appid)throw new Error("appid must be provided");if(!n.resourceAppid)throw new Error("resourceAppid must be provided")}if(!n.resourceEnv)throw new Error("resourceEnv must be provided");if(n.config||(n.config={}),i.defaultInstance=r,i.instanceOptions=JSON.parse(JSON.stringify(n)),i.meta=r.meta,i.apiPermissions=r.apiPermissions,i.instanceOptions.config.database=(0,o.default)(w(),i.instanceOptions.config.database||{}),"web"===i.runtimeInfo.env){if(i.exportAPI.init=i.webInit.bind(i),i.webRequest=(0,g.getBoundAuthRequest)(i),i.registerService((0,a.createWebService)(i)),!i.instanceOptions.identityless&&(i.authStorage=i.defaultInstance.authStorage,!i.authStorage))throw new Error("authStorage not found")}else"sdk"===i.runtimeInfo.env?(i.exportAPI.init=i.webInit.bind(i),i.registerService((0,s.createAppService)(i)),i.instanceOptions.identityless=!0):i.exportAPI.init=i.miniprogramInit.bind(i);return i.instanceOptions.resourceAppid&&(i.exportAPI.refreshAuth=i.refreshAuth.bind(i)),i}return n.__extends(t,e),t.prototype.miniprogramInit=function(){return n.__awaiter(this,void 0,void 0,function(){var t,r;return n.__generator(this,function(n){switch(n.label){case 0:return this.inited?[2]:this.instanceOptions.resourceAppid?[4,this.refreshAuth()]:[3,2];case 1:return t=n.sent(),0===(r=t.data.env_auth_info).errCode?(e.prototype.init.call(this),[2,{errCode:r.errCode,errMsg:r.errMsg,expireTime:1e3*r.expire_time}]):[2,{errCode:r.errCode,errMsg:r.errMsg}];case 2:return e.prototype.init.call(this),[2]}})})},t.prototype.webInit=function(){return n.__awaiter(this,void 0,void 0,function(){var t,r,o=this;return n.__generator(this,function(n){switch(n.label){case 0:return this.inited?[2]:this.instanceOptions.identityless?[3,2]:[4,this.refreshAuth()];case 1:return t=n.sent(),0===(r=t.data.env_auth_info).errCode?(this.sendInitRequest().then(function(){o.testSpeed()}),e.prototype.init.call(this),[2,{errCode:r.errCode,errMsg:r.errMsg,expireTime:1e3*r.expire_time}]):[2,{errCode:r.errCode,errMsg:r.errMsg}];case 2:return this.inited=!0,[2]}})})},t.prototype.webRefreshToken=function(){return n.__awaiter(this,void 0,void 0,function(){var e=this;return n.__generator(this,function(t){return this._webCurrentRefreshTokenPromise?[2,this._webCurrentRefreshTokenPromise]:(this._webCurrentRefreshTokenPromise=new Promise(function(t,r){return n.__awaiter(e,void 0,void 0,function(){var e,o,i;return n.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,3,4]),[4,this.webRequest({url:"/refresh_token",method:"POST",json:{appid:this.instanceOptions.appid,refresh_token:this.authStorage.getItem("refreshToken")}})];case 1:return e=n.sent(),o=e.data,this.authStorage.setItem("appid",o.access_token),t(),[3,4];case 2:return i=n.sent(),r(i),[3,4];case 3:return this._webCurrentRefreshTokenPromise=void 0,[7];case 4:return[2]}})})}),[2,this._webCurrentRefreshTokenPromise])})})},t.prototype.refreshAuth=function(){var e=JSON.stringify({resource_appid:this.instanceOptions.resourceAppid,resource_env:this.instanceOptions.resourceEnv}),t=+new Date,r=t,n=this.request({apiName:"tcbapi_getenvauth",serializedReqData:e});return n.then(function(e){var n=+new Date;(0,_.reportAPISpeed)({apiName:"cloud.refreshAuth",apiEndTime:+new Date,apiStartTime:t,tunnelEndTime:n,tunnelStartTime:r})}),n},t}(T);function w(){return{realtime:{maxReconnect:m.clientConfigDefaults.REALTIME_DB_MAX_RECONNECT,reconnectInterval:m.clientConfigDefaults.REALTIME_DB_WS_RECONNECT_INTERVAL,totalConnectionTimeout:m.clientConfigDefaults.REALTIME_DB_TOTAL_CONNECTION_TIMEOUT}}}t.InstanceCloud=A}).call(this,r("../../node_modules/.pnpm/process@0.11.10/node_modules/process/browser.js"))},"./src/config/app.config.ts":function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.clientConfigDefaults=t.serverConfigurable=void 0,t.serverConfigurable={db_doc_size_limit:524288,db_realtime_ping_interval:15e3,db_realtime_pong_wait_timeout:15e3,db_realtime_query_event_cache_timeout:18e4,upload_max_file_size:20971520,get_temp_file_url_max_requests:50,call_function_poll_max_retry:10,call_function_max_req_data_size:5242880,call_function_client_poll_timeout:15e3,call_function_valid_start_retry_gap:6e4,call_container_poll_max_retry:10,call_container_client_poll_timeout:15e3,call_container_valid_start_retry_gap:6e4,call_container_max_req_data_size:5242880,call_container_use_private_http:0},t.clientConfigDefaults={REALTIME_DB_MAX_RECONNECT:5,REALTIME_DB_WS_RECONNECT_INTERVAL:5e3,REALTIME_DB_TOTAL_CONNECTION_TIMEOUT:1/0},t.default=t.serverConfigurable},"./src/config/error.config.ts":function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ERR_CODE=void 0,t.ERR_CODE={"-1":"",UNKNOWN_ERROR:-1,"-401001":"api permission denied",SDK_API_PERMISSION_DENIED:-401001,"-401002":"api parameter error",SDK_API_PARAMETER_ERROR:-401002,"-401003":"api parameter type error",SDK_API_PARAMETER_TYPE_ERROR:-401003,"-402001":"circular reference detected",SDK_DATABASE_CIRCULAR_REFERENCE:-402001,"-402002":"realtime listener init watch fail",SDK_DATABASE_REALTIME_LISTENER_INIT_WATCH_FAIL:-402002,"-402003":"realtime listener reconnect ws fail",SDK_DATABASE_REALTIME_LISTENER_RECONNECT_WS_FAIL:-402003,"-402004":"realtime listener rebuild watch fail",SDK_DATABASE_REALTIME_LISTENER_REBUILD_WATCH_FAIL:-402004,"-402005":"realtime listener close watch fail",SDK_DATABASE_REALTIME_LISTENER_CLOSE_WATCH_FAIL:-402005,"-402006":"realtime listener receive server error msg",SDK_DATABASE_REALTIME_LISTENER_SERVER_ERROR_MSG:-402006,"-402007":"realtime listener receive invalid server data",SDK_DATABASE_REALTIME_LISTENER_RECEIVE_INVALID_SERVER_DATA:-402007,"-402008":"realtime listener websocket connection error",SDK_DATABASE_REALTIME_LISTENER_WEBSOCKET_CONNECTION_ERROR:-402008,"-402009":"realtime listener websocket connection closed",SDK_DATABASE_REALTIME_LISTENER_WEBSOCKET_CONNECTION_CLOSED:-402009,"-402010":"realtime listener check last fail",SDK_DATABASE_REALTIME_LISTENER_CHECK_LAST_FAIL:-402010,"-402011":"realtime listener unexpected fatal error",SDK_DATABASE_REALTIME_LISTENER_UNEXPECTED_FATAL_ERROR:-402011,"-402012":"realtime listener init ws fail",SDK_DATABASE_REALTIME_LISTENER_INIT_WS_FAIL:-402012,"-403001":"max upload file size exceeded",SDK_STORAGE_EXCEED_MAX_UPLOAD_SIZE:-403001,"-403002":"internal server error: empty upload url",SDK_STORAGE_INTERNAL_SERVER_ERROR_EMPTY_UPLOAD_URL:-403002,"-403003":"internal server error: empty download url",SDK_STORAGE_INTERNAL_SERVER_ERROR_EMPTY_DOWNLOAD_URL:-403003,"-404001":"empty call result",SDK_FUNCTIONS_EMPTY_CALL_RESULT:-404001,"-404002":"empty event id",SDK_FUNCTIONS_EMPTY_EVENT_ID:-404002,"-404003":"empty poll url",SDK_FUNCTIONS_EMPTY_POLL_URL:-404003,"-404004":"empty poll result json",SDK_FUNCTIONS_EMPTY_POLL_RESULT_JSON:-404004,"-404005":"exceed max poll retry",SDK_FUNCTIONS_EXCEED_MAX_POLL_RETRY:-404005,"-404006":"empty poll result base resp",SDK_FUNCTIONS_EMPTY_POLL_RESULT_BASE_RESP:-404006,"-404007":"poll result base resp ret abnormal",SDK_FUNCTIONS_POLL_RESULT_BASE_RESP_RET_ABNORMAL:-404007,"-404008":"poll result status code error",SDK_FUNCTIONS_POLL_RESULT_STATUS_CODE_ERROR:-404008,"-404009":"poll error",SDK_FUNCTIONS_POLL_ERROR:-404009,"-404010":"result expired",SDK_FUNCTIONS_POLL_RESULT_EXPIRED:-404010,"-404011":"cloud function execution error",SDK_FUNCTIONS_CLOUD_FUNCTION_EXECUTION_ERROR:-404011,"-404012":"polling exceed max timeout retry",SDK_FUNCTIONS_EXCEED_MAX_TIMEOUT_POLL_RETRY:-404012,"-404013":"polling exceed max system error retry",SDK_FUNCTIONS_EXCEED_MAX_SYSTEM_ERROR_POLL_RETRY:-404013,"-405001":"empty call result",SDK_CONTAINER_EMPTY_CALL_RESULT:-405001,"-405002":"empty event id",SDK_CONTAINER_EMPTY_EVENT_ID:-405002,"-405003":"empty poll url",SDK_CONTAINER_EMPTY_POLL_URL:-405003,"-405004":"empty poll result json",SDK_CONTAINER_EMPTY_POLL_RESULT_JSON:-405004,"-405005":"exceed max poll retry",SDK_CONTAINER_EXCEED_MAX_POLL_RETRY:-405005,"-405006":"empty poll result base resp",SDK_CONTAINER_EMPTY_POLL_RESULT_BASE_RESP:-405006,"-405007":"poll result base resp ret abnormal",SDK_CONTAINER_POLL_RESULT_BASE_RESP_RET_ABNORMAL:-405007,"-405008":"poll result status code error",SDK_CONTAINER_POLL_RESULT_STATUS_CODE_ERROR:-405008,"-405009":"poll error",SDK_CONTAINER_POLL_ERROR:-405009,"-405010":"result expired",SDK_CONTAINER_POLL_RESULT_EXPIRED:-405010,"-405012":"polling exceed max timeout retry",SDK_CONTAINER_EXCEED_MAX_TIMEOUT_POLL_RETRY:-405012,"-405013":"polling exceed max system error retry",SDK_CONTAINER_EXCEED_MAX_SYSTEM_ERROR_POLL_RETRY:-405013,"-405014":"cannot download result (cdn)",SDK_CONTAINER_DOWNLOAD_RESULT_FROM_CDN_FAIL:-405014,"-601001":"system error",WX_SYSTEM_ERROR:-601001,"-601002":"system args error",WX_SYSTEM_ARGS_ERROR:-601002,"-601003":"system network error",WX_SYSTEM_NETWORK_ERROR:-601003,"-601004":"api permission denied",WX_API_PERMISSION_DENIED:-601004,"-601005":"invalid cloudID",WX_INVALID_CLOUDID:-601005,"-601006":"cloudID expired",WX_CLOUDID_EXPIRED:-601006,"-601007":"cloudID and calling user does not match",WX_CLOUDID_USER_NOT_MATCH:-601007,"-601008":"server-side request timedout",WX_SERVER_REQUEST_TIMEOUT:-601008,"-601009":"missing mobile phone",WX_MISSING_MOBILE_PHONE:-601009,"-601010":"no write permission",WX_NO_WRITE_PERMISSION:-601010,"-601011":"no privilege permission",WX_NO_PRIVILEGE_PERMISSION:-601011,"-601012":"unauthorized env",WX_UNAUTHORIZED_ENV:-601012,"-601013":"no multiend permission",WX_NO_MULTIEND_PERMISSION:-601013,"-601015":"access denied (cloudfunction cloudbase_auth returns empty errCode)",WX_CLOUDBASE_AUTH_RETURN_EMPTY_ERRCODE:-601015,"-601016":"missing env auth info",WX_MISSING_ENV_AUTH_INFO:-601016,"-601017":"access denied (cloudbase_auth returns non-zero errCode)",WX_CLOUDBASE_AUTH_RETURN_NON_ZERO_ERRCODE:-601017,"-602018":"unauthorized API",WX_UNAUTHORIZED_API:-601018,"-602001":"database query result size exceed limit (1MB)",WX_DATABASE_QUERY_SIZE_EXCEED_LIMIT:-602001,"-604001":"cloudfunction result size exceed limit (1MB)",WX_CLOUDFUNCTION_RESULT_SIZE_EXCEED_LIMIT:-604001,"-501001":"resource system error",TCB_RESOURCE_SYSTEM_ERROR:-501001,"-501002":"resource server timeout",TCB_RESOURCE_SERVER_TIMEOUT:-501002,"-501003":"exceed request limit",TCB_EXCEED_REQUEST_LIMIT:-501003,"-501004":"exceed concurrent request limit",TCB_EXCEED_CONCURRENT_REQUEST_LIMIT:-501004,"-501005":"invalid env",TCB_INVALID_ENV:-501005,"-501006":"invalid common parameters",TCB_INVALID_COMMON_PARAM:-501006,"-501007":"invalid parameters",TCB_INVALID_PARAM:-501007,"-501008":"invalid request source",TCB_INVALID_REQUEST_SOURCE:-501008,"-501009":"resource not initialized",TCB_RESOURCE_NOT_INITIALIZED:-501009,"-501010":"tencentcloud key signature verification fail",TCB_KEY_SIGNATURE_VERIFICATION_FAIL:-501010,"-501011":"invalid env status",TCB_INVALID_ENV_STATUS:-501011,"-501012":"invalid api name",TCB_INVALID_API_NAME:-501012,"-501013":"request data size exceeds limit (5M)",TCB_REQ_DATA_EXCEED_LIMIT_5M:-501013,"-501014":"upload file size exceeds limit (5M)",TCB_UPLOAD_FILE_SIZE_EXCEED_LIMIT_5M:-501014,"-501023":"permission denied",TCB_PERMISSION_DENIED:-501023,"-502001":"database request fail",TCB_DB_REQUEST_FAIL:-502001,"-502002":"database invalid command",TCB_DB_INVALID_COMMAND:-502002,"-502003":"database permission denied",TCB_DB_PERMISSION_DENIED:-502003,"-502004":"database exceed collection limit",TCB_DB_EXCEED_COLLECTION_LIMIT:-502004,"-502005":"database collection not exists",TCB_DB_COLLECTION_NOT_EXISTS:-502005,"-503001":"storage request fail",TCB_STORAGE_REQUEST_FAIL:-503001,"-503002":"storage permission denied",TCB_STORAGE_PERMISSION_DENIED:-503002,"-503003":"storage file not exists",TCB_STORAGE_FILE_NOT_EXISTS:-503003,"-503004":"storage invalid sign parameter",TCB_STORAGE_INVALID_SIGN_PARAM:-503004,"-504001":"functions request fail",TCB_FUNCTIONS_REQUEST_FAIL:-504001,"-504002":"functions execute fail",TCB_FUNCTIONS_EXEC_FAIL:-504002}},"./src/config/report.config.ts":function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorKey=t.ErrorID=void 0,t.ErrorID=1128,t.ErrorKey={REALTIME_DB_INIT_WS_SUCCESS:1,REALTIME_DB_INIT_WS_FAIL:2,REALTIME_DB_RECONNECT_WS_SUCCESS:3,REALTIME_DB_RECONNECT_WS_FAIL:4,REALTIME_DB_INIT_WATCH_SUCCESS:5,REALTIME_DB_INIT_WATCH_FAIL:6,REALTIME_DB_REBUILD_WATCH_SUCCESS:7,REALTIME_DB_REBUILD_WATCH_FAIL:8,REALTIME_DB_WS_ONERROR_BEFORE_OPEN:9,REALTIME_DB_WS_ONERROR_WHILE_ACTIVE:10,REALTIME_DB_WS_ONCLOSE:11,REALTIME_DB_WS_ONCLOSE_HEARTBEAT_PING_FAIL:12,REALTIME_DB_WS_ONCLOSE_HEARTBEAT_PONG_TIMEOUT:13,REALTIME_DB_WS_ONCLOSE_AB_NORMAL_CLOSURE:14,REALTIME_DB_WS_ONCLOSE_SERVER_CLOSE_NO_AUTH:15,REALTIME_DB_WS_ONCLOSE_UNKNOWN_ORIGIN:16,REALTIME_DB_WS_TOTAL_CONNECTION_TIMEOUT:17,REALTIME_DB_WS_ONCLOSE_SERVER_CLOSE_FOR_UPGRADE:18,REALTIME_DB_RECV_MSG_WITH_CLOSED_WATCHID:30,REALTIME_DB_RECV_MSG_WITH_UNKNOWN_WATCHID:31,REALTIME_DB_RECV_MSG_WITHOUT_WATCHID:32,REALTIME_DB_HANDLE_EVENT_ERROR:33,REALTIME_DB_RECV_DUPLICATE_EVENT:34,REALTIME_DB_RECV_DUPLICATE_EVENT_AND_EVENT_OUT_OF_ORDER:35,REALTIME_DB_UNEXPECTED_EVENT_DATATYPE_UPDATE_NO_ASSOCIATED_DOC:36,REALTIME_DB_UNEXPECTED_EVENT_REMOVE_NO_ASSOCIATED_DOC:37,REALTIME_DB_UNEXPECTED_EVENT_DEQUEUE_NO_ASSOCIATED_DOC:38,REALTIME_DB_UNEXPECTED_EVENT_QUEUETYPE_UPDATE_NO_ASSOCIATED_DOC:39,REALTIME_DB_EVENT_OUT_OF_ORDER:40,REALTIME_DB_INIT_WATCH_FAIL_SERVER_SIGN_ERROR:50,REALTIME_DB_REBUILD_WATCH_FAIL_SERVER_SIGN_ERROR:51,REALTIME_DB_INIT_WATCH_FAIL_SERVER_OTHER_ERROR:52,REALTIME_DB_REBUILD_WATCH_FAIL_SERVER_OTHER_ERROR:53,REALTIME_DB_INIT_WATCH_FAIL_TIMEOUT_ERROR_TOTAL_CONNECTION:54,REALTIME_DB_REBUILD_WATCH_FAIL_TIMEOUT_ERROR_TOTAL_CONNECTION:55,REALTIME_DB_REBUILD_WATCH_FAIL_TIMEOUT_ERROR_QUERY_EVENT_CACHE:56,REALTIME_DB_INIT_WATCH_FAIL_CANCELLED_ERROR:57,REALTIME_DB_REBUILD_WATCH_FAIL_CANCELLED_ERROR:58,REALTIME_DB_INIT_WATCH_FAIL_UNKNOWN_ERROR:59,REALTIME_DB_REBUILD_WATCH_FAIL_UNKNOWN_ERROR:60}},"./src/externals/globals/devtools.ts":function(e,t,r){var n=this;Object.defineProperty(t,"__esModule",{value:!0}),t.autoDevtoolsNetworkLog=t.devtoolsNetworkLog=void 0;var o=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),i=r("./src/externals/globals/wxconfig.ts"),s=r("./src/utils/type.ts"),a=function(e){return o.__assign(o.__assign({},e),{errMsg:void 0})};t.devtoolsNetworkLog=function(e){try{(0,i.isDevTools)()&&"undefined"!=typeof __global&&__global.networkLog&&__global.networkLog(o.__assign(o.__assign({},e),{domain:"cloud",method:"POST",realMethod:e.method,timestampMs:e.timestampMs||+new Date,callFramesIgnoreLength:e.hasOwnProperty("callFramesIgnoreLength")?e.callFramesIgnoreLength:1}))}catch(e){}};t.autoDevtoolsNetworkLog=function(e,r){try{if((0,i.isDevTools)()&&"undefined"!=typeof __global&&__global.networkLog){var c=r(),u="".concat(Math.random(),"-").concat(+new Date),l=c.console||!1,d=c.resultGetter||a;(0,t.devtoolsNetworkLog)({reqId:u,type:"requestWillBeSent",url:c.url,headers:c.headers||{},body:c.reqBody,console:l,callFramesIgnoreLength:2,timestampMs:c.timestampMs,method:c.method}),e.then(function(e){return o.__awaiter(n,void 0,void 0,function(){var r;return o.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),r=JSON.stringify(d(e),null,2),[4,function(e){return void 0===e&&(e=0),new Promise(function(t){return setTimeout(t,e)})}()];case 1:return n.sent(),(0,t.devtoolsNetworkLog)({reqId:u,type:"loadingFinished",body:r,console:l,callFramesIgnoreLength:2,timestampMs:Date.now()}),[3,3];case 2:return n.sent(),[3,3];case 3:return[2]}})})}).catch(function(e){try{(0,t.devtoolsNetworkLog)({reqId:u,type:"loadingFailed",errorCode:e&&e.errCode||-1,errorMsg:(0,s.isObject)(e)?e.errMsg||JSON.stringify(e):e.toString(),console:l,callFramesIgnoreLength:2,timestampMs:Date.now()})}catch(e){}})}}catch(e){}}},"./src/externals/globals/wxconfig.ts":function(e,t,r){(function(e,r){Object.defineProperty(t,"__esModule",{value:!0}),t.isMac=t.isWindows=t.isMINA=t.isDevTools=void 0;var n=__wxConfig;e.env.TEST&&(r.__wxConfig=n),t.default=n;t.isDevTools=function(){return"devtools"===n.platform};t.isMINA=function(){return"mina"===n.platform};t.isWindows=function(){return"windows"===n.platform};t.isMac=function(){return"mac"===n.platform}}).call(this,r("../../node_modules/.pnpm/process@0.11.10/node_modules/process/browser.js"),r("../../node_modules/.pnpm/webpack@4.46.0_webpack-command@0.4.2/node_modules/webpack/buildin/global.js"))},"./src/externals/public-lib/appserviceSdk.ts":function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.patchDefaultSDK=t.setDefaultSDK=t.setSDK=t.getSDK=void 0;var r,n=new WeakMap,o=[];function i(){var e=null!==r&&void 0!==r?r:"undefined"!=typeof wx?wx:void 0;return e?o.reduce(function(e,t){return t(e)},e):e}t.getSDK=function(e){if(!e)return i();var t=n.get(e);return t&&t||i()};t.setSDK=function(e,t){n.set(e,t)};t.setDefaultSDK=function(e){r=e};t.patchDefaultSDK=function(e){o.push(function(t){return Object.assign({},t,e)})}},"./src/externals/public-lib/reporter.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n,o=r("./src/utils/fail-safe.ts"),i={fake:!0,errorReport:function(){},surroundThirdByTryCatch:function(e,t){return function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return(0,o.tryCatch)(function(){try{return e.apply(e,r)}catch(r){throw console.error(JSON.stringify(r)+"; ".concat(t,"\n")+r.stack),console.error(e.toString()),r}},t)}},reportIDKey:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},reportIDKeyDirectly:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},reportKeyValue:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]}},s=!1,a=10;function c(){try{return s?Reporter:a<=0?n:(a--,Reporter.surroundThirdByTryCatch,n=Reporter,s=!0,n)}catch(e){return n=i}}t.default={surroundThirdByTryCatch:function(e,t){return c().surroundThirdByTryCatch(e,t)},reportIDKey:function(e){return c().reportIDKey(e)},reportIDKeyDirectly:function(e){return c().reportIDKeyDirectly(e)},reportKeyValue:function(e){return c().reportKeyValue(e)},errorReport:function(e){return c().errorReport(e)}}},"./src/hook/invoke.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.hasAPICallback=t.invokeFailCompleteCallbacks=t.invokeSuccessCompleteCallbacks=t.invokeCompleteCallback=t.invokeFailCallback=t.invokeSuccessCallback=void 0;var n=r("./src/utils/type.ts"),o=r("./src/utils/fail-safe.ts");function i(e,t,r){t.success&&(0,n.isFunction)(t.success)&&(0,o.wrapWithTryCatch)(t.success,"at api ".concat(e," success callback function;"))(r)}function s(e,t,r){t.fail&&(0,n.isFunction)(t.fail)&&(0,o.wrapWithTryCatch)(t.fail,"at api ".concat(e," fail callback function;"))(r)}function a(e,t,r){t.complete&&(0,n.isFunction)(t.complete)&&(0,o.wrapWithTryCatch)(t.complete,"at api ".concat(e," complete callback function;"))(r)}t.invokeSuccessCallback=i,t.invokeFailCallback=s,t.invokeCompleteCallback=a,t.invokeSuccessCompleteCallbacks=function(e,t,r){i(e,t,r),a(e,t,r)},t.invokeFailCompleteCallbacks=function(e,t,r){s(e,t,r),a(e,t,r)},t.hasAPICallback=function(e){return e&&(e.success||e.fail||e.complete)}},"./src/index.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js");n.__exportStar(r("./src/cloud/index.ts"),t),n.__exportStar(r("./src/servicemarket/index.ts"),t),n.__exportStar(r("./src/externals/public-lib/appserviceSdk.ts"),t)},"./src/network/tunnel.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.stdPrivateProtocol=t.getBoundTunnelRequest=t.constructTunnelReq=t.tunnel=void 0;var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),o=r("./src/utils/error.ts"),i=r("./src/externals/public-lib/appserviceSdk.ts"),s=r("./src/utils/utils.ts"),a=r("./src/utils/service-endpoint.ts"),c=r("../../../cloud-crypto/dist/index.js"),u=s._wxConsole,l=new Set(["tcbapi_init","tcbapi_get_service_info"]),d=new(function(){function e(){this._running=0,this._onIdleCallbacks=[]}return Object.defineProperty(e.prototype,"running",{get:function(){return this._running},enumerable:!1,configurable:!0}),e.prototype.incrementRunning=function(e){void 0===e&&(e=1),this._running+=e,this._idleTriggerTimer&&clearTimeout(this._idleTriggerTimer)},e.prototype.decrementRunning=function(e){var t=this;void 0===e&&(e=1),this._running-=e,this._running<0&&(this._running=0),this._running<=0&&this._onIdleCallbacks.length&&(this._idleTriggerTimer=setTimeout(function(){if(t._idleTriggerTimer=null,t._onIdleCallbacks.length){var e=t._onIdleCallbacks.shift();e&&e()}},50))},e.prototype.onceIdle=function(e){this._running>0?this._onIdleCallbacks.push(e):e()},e}());function p(e,t){var r=this;if(void 0===t&&(t={}),t.fireOnIdle&&d.running>0)return new Promise(function(o,i){d.onceIdle(function(){return n.__awaiter(r,void 0,void 0,function(){var r,s;return n.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,p(e,t)];case 1:return r=n.sent(),o(r),[3,3];case 2:return s=n.sent(),i(s),[3,3];case 3:return[2]}})})})});if(t.onFire)try{t.onFire()}catch(e){}return new Promise(function(r,s){var a,c,u,l,p,f,_,m;if(d.incrementRunning(),null===(a=e.cloud)||void 0===a?void 0:a.plugins){var h=e.cloud.plugins.reduce(function(e,t){return t.getMetadata(e)},{});m="https://".concat(h.host||"servicewechat.com","/wxa-qbase/jsoperatewxdata"),e=e.cloud.plugins.reduce(function(t,r){return r.beforeTunnelRequest(e)},e)||e}(0,i.getSDK)((e.cloud||t.cloud||{}).identifiers).operateWXData({appid:(null===(u=null===(c=e.cloud)||void 0===c?void 0:c.instanceOptions)||void 0===u?void 0:u.resourceAppid)||(null===(l=e.cloud)||void 0===l?void 0:l.config.appid),accessToken:null===(f=null===(p=e.cloud)||void 0===p?void 0:p.authStorage)||void 0===f?void 0:f.getItem("access_token"),webRequest:null===(_=e.cloud)||void 0===_?void 0:_.webRequest,url:m,apiName:e.apiName||"qbase_commapi",reqData:e.data,requestInQueue:!1,success:function(i){var a;!(i=(null===(a=e.cloud)||void 0===a?void 0:a.plugins.reduce(function(e,t){return t.afterTunnelRequest(e)},i))||i).data&&i.rawData&&(i.data=JSON.parse(i.rawData));var c=n.__assign(n.__assign({},i),{data:i.data});if(i.data)try{var u=i.data;if(u.baseresponse&&0!==u.baseresponse.errcode){var l=new o.CloudSDKError({errCode:u.baseresponse.errcode,errMsg:u.baseresponse.errmsg});return void s(l)}c=n.__assign(n.__assign({},i),{data:u})}catch(e){l=new o.CloudSDKError({errMsg:e&&e.toString()});return void s(l)}else if(t&&t.requireDataNotEmpty){l=new o.CloudSDKError({errCode:i.errCode,errMsg:"error empty internal server response, ".concat(i.errMsg)});return void s(l)}r(c)},fail:function(e){if(e&&e.errMsg)if(e.errMsg.includes("invalid scope")){var t="invalid scope 没有权限，请先开通云服务";(e=new Error(t)).errMsg=t,e.operateWXDataFail=!0}else{t=e.errMsg.replace(/^operateWXData:fail /,"");(e=new Error(t)).errMsg=t,e.operateWXDataFail=!0}s(e)},complete:function(){e.complete&&e.complete.apply(null,arguments),d.decrementRunning()}})})}function f(e,t){return n.__awaiter(this,void 0,void 0,function(){var r,o,l,d,p,f;return n.__generator(this,function(_){if(!(null===(r=e.serviceEndpoint.getEndpointSync("container"))||void 0===r?void 0:r.cloudServiceUrl))throw{errCode:-9998,errMsg:"cloudServiceUrl not found"};return null===u||void 0===u||u.info("cloud stdpriv begin",t),o=(0,i.getSDK)(e.identifiers),(l={"X-WX-ENCRYPTION-VERSION":2,"X-WX-ENCRYPTION-TIMESTAMP":r.timestamp+"","X-WX-COMPRESSION":"snappy","X-WX-LIB-BUILD-TS":1685699826199,"X-WX-RESPONSE-CONTENT-ACCEPT-ENCODING":"JSON","Content-Type":"application/octet-stream"})["X-WX-REQUEST-CONTENT-ENCODING"]="PB",d=new Uint8Array(s.base64ToArrayBuffer(r.key)),p=c.V1.encodeStdPrivRequest(d,{cliReqId:t.cli_req_id,qbaseApiName:t.qbase_api_name,qbaseMeta:{filterUserInfo:t.qbase_meta.filter_user_info,sdkVersion:t.qbase_meta.sdk_version,sessionId:t.qbase_meta.session_id},qbaseOptions:{env:t.qbase_options.env},qbaseReq:t.qbase_req},{}).data,f=(0,a.getCloudServiceToken)({rdm:e.getConfig().rdm}),[2,new Promise(function(e,t){o.request({url:f.url,method:"POST",header:l,data:p.buffer,dataType:"arraybuffer",responseType:"arraybuffer",enableHttp2:!0,success:function(r){try{for(var n in null===u||void 0===u||u.info("res",r),r.header)if("x-nws-log-uuid"===n.toLowerCase()&&(null===u||void 0===u||u.log("[cloud.callContainer] x-nws-log-uuid ".concat(r.header[n]))),"x-wx-system-error"===n.toLowerCase()){var o=Number(r.header[n]);return 85104===o&&f.invalidate(),void t(new Error("wx system error. code: ".concat(o)))}if(200===r.statusCode){var i=r.data,s=!1;for(var a in r.header)"x-wx-compression"===a.toLowerCase()&&"snappy"===r.header[a]&&(s=!0);var l=c.V1.decodeStdPrivResponse(d,new Uint8Array(i),s);e({errCode:0,errMsg:"",data:l,profile:r.profile,channelType:1})}else t({errCode:-9999,errMsg:"system conn status not 200"})}catch(e){t(new Error("error while processing internal response ".concat(e)))}},fail:function(e){t(n.__assign(n.__assign({},e),{errCode:-9999,errMsg:e.errMsg}))}})})]})})}t.tunnel=p,t.constructTunnelReq=function(e){var t=e.cloud;return{apiName:"qbase_commapi",data:{qbase_api_name:e.apiName,qbase_req:e.serializedReqData,qbase_options:{env:e.env},qbase_meta:t.getMetaData(),cli_req_id:"".concat(+new Date,"_").concat(Math.random())},cloud:t}},t.getBoundTunnelRequest=function(e){var t=e.cloud;return function(e){return n.__awaiter(this,void 0,void 0,function(){var r,o;return n.__generator(this,function(i){switch(i.label){case 0:return r=t.isInstance?n.__assign(n.__assign({},t.instanceOptions),{appid:t.instanceOptions.resourceAppid,env:t.instanceOptions.resourceEnv}):{identityless:"sdk"===t.runtimeInfo.platform||void 0,appid:"sdk"===t.runtimeInfo.platform?t.config.appid:void 0,env:e.env||("sdk"===t.runtimeInfo.platform?t.config.env:void 0)},o={qbase_api_name:e.apiName,qbase_req:e.serializedReqData,qbase_options:r,qbase_meta:t.getMetaData(),cli_req_id:"".concat(+new Date,"_").concat(Math.random())},!e.stdpriv||l.has(e.apiName)||"windows"===s.getSystemInfo().platform?[3,2]:[4,f(t,o).catch(function(e){if(e&&(-9999===e.errCode||-9998===e.errCode))return p({apiName:"qbase_commapi",data:o,cloud:t}).then(function(t){return n.__assign(n.__assign({},t),{channelType:-9998===e.errCode?0:2})});throw e})];case 1:return[2,i.sent()];case 2:return[2,p({apiName:"qbase_commapi",data:o,cloud:t})]}})})}},t.stdPrivateProtocol=f,t.default=p},"./src/runtime/app/index.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js");n.__exportStar(r("./src/runtime/app/patch-sdk.ts"),t),n.__exportStar(r("./src/runtime/app/service/index.ts"),t)},"./src/runtime/app/patch-sdk.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.patchAppSDK=void 0;var n=r("./src/externals/public-lib/appserviceSdk.ts"),o=r("./src/runtime/app/polyfill-sdk/operateWXData.ts"),i={operateWXData:o.operateWXData,operateWXData:o.operateWXData};t.patchAppSDK=function(){(0,n.patchDefaultSDK)(i)}},"./src/runtime/app/polyfill-sdk/operateWXData.ts":function(e,t,r){var n=this;Object.defineProperty(t,"__esModule",{value:!0}),t.operateWXData=void 0;var o=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),i=r("./src/runtime/app/polyfill-sdk/utils.ts"),s=r("./src/externals/public-lib/appserviceSdk.ts");t.operateWXData=function(e){return o.__awaiter(n,void 0,void 0,function(){var t,r,n,a;return o.__generator(this,function(o){switch(o.label){case 0:if(o.trys.push([0,2,,3]),!e.appid)throw new Error("missing appid");return t={appid:e.appid,data:e.reqData},[4,new Promise(function(r,n){return(0,s.getSDK)().wx.request({url:"".concat(e.url||"https://servicewechat.com/wxa-qbase/jsoperatewxdata"),method:"POST",data:t,success:r,fail:n})})];case 1:return r=o.sent(),0===(n=r.data).base_resp.ret?(0,i.callbackSuccessComplete)(e,{data:JSON.parse(n.data),rawData:n.data}):(0,i.callbackFailComplete)(e,{errMsg:"operateWXData:fail base_resp.ret ".concat(n.base_resp.ret)}),[3,3];case 2:return a=o.sent(),(0,i.callbackFailComplete)(e,a),[3,3];case 3:return[2]}})})}},"./src/runtime/app/polyfill-sdk/utils.ts":function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.formatHeader=t.callbackFailComplete=t.callbackSuccessComplete=void 0,t.callbackSuccessComplete=function(e,t){e.success&&e.success(t),e.complete&&e.complete(t),e.success=void 0,e.complete=void 0},t.callbackFailComplete=function(e,t){e.fail&&e.fail(t),e.complete&&e.complete(t),e.fail=void 0,e.complete=void 0},t.formatHeader=function(e){var t={};e.getAllResponseHeaders().trim().split(/[\r\n]+/).forEach(function(e){var r=e.split(": "),n=r.shift(),o=r.join(": ");t[n]=o})}},"./src/runtime/app/service/api/api.ts":function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getAPIs=void 0,t.getAPIs=function(e){return{}}},"./src/runtime/app/service/index.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.createAppService=t.APP_SERVICE_NAME=void 0;var n=r("./src/runtime/app/service/api/api.ts");t.APP_SERVICE_NAME="app",t.createAppService=function(e){var r={name:t.APP_SERVICE_NAME,identifiers:e.identifiers,request:e.request,isInstance:e.isInstance,get debug(){return e.debug},get env(){return e.getEnvForService(t.APP_SERVICE_NAME)},cloud:e,appConfig:{}};return{name:t.APP_SERVICE_NAME,context:r,getAPIs:n.getAPIs.bind(null,r)}}},"./src/runtime/runtime.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.setRuntimeInfo=t.getRuntimeInfo=void 0,r("@web");var n={env:"",platform:""};t.getRuntimeInfo=function(){return n};if(t.setRuntimeInfo=function(e){n.platform=e,n.env="web"},"undefined"!=typeof __wxConfig)n.env="miniprogram",n.platform=__wxConfig.platform,__wxConfig.host&&"SAAASDK"===__wxConfig.host.env&&(n.platform="sdk");else if(n.env="web",window)if(window.__wxjs_environment&&"miniprogram"===window.__wxjs_environment)n.platform="miniprogram";else{var o=window.navigator.userAgent.toLowerCase();/MicroMessenger/i.test(o)&&(n.platform="wxweb")}},"./src/servicemarket/cdn.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.uploadToCommonCDN=t.CDN=t.CDNObjectSymbol=void 0;var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),o=r("./src/externals/public-lib/appserviceSdk.ts");t.CDNObjectSymbol=Symbol("CDN");var i=function(){return function(e){this.symbol=t.CDNObjectSymbol,this.options=e}}();t.CDN=i,t.uploadToCommonCDN=function(e,t){return new Promise(function(r,i){(t||(0,o.getSDK)()).uploadToCommonCDN(n.__assign(n.__assign({},e),{success:r,fail:i}))})}},"./src/servicemarket/config.ts":function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ERR_MSG=t.ERR_CODE=void 0,t.ERR_CODE={SM_EXCEED_MAX_TIMEOUT_POLL_RETRY:100,SM_EMPTY_CALL_RESULT:101,SM_EXCEED_MAX_POLL_RETRY:102,SM_PROVIDER_EXECUTION_ERROR:103,SM_POLL_RESULT_EXPIRED:104,SM_EMPTY_POLL_RESULT_BASE_RESP:105,SM_POLL_RESULT_BASE_RESP_RET_ABNORMAL:106,SM_UNKNOWN_SCENE:107,SM_SYSTEM_ERROR:108},t.ERR_MSG={SM_EXCEED_MAX_TIMEOUT_POLL_RETRY:"exceed max timeout retry",SM_EMPTY_CALL_RESULT:"empty call result",SM_EXCEED_MAX_POLL_RETRY:"exceed max poll retry",SM_PROVIDER_EXECUTION_ERROR:"provider execution error",SM_POLL_RESULT_EXPIRED:"poll result expired",SM_EMPTY_POLL_RESULT_BASE_RESP:"empty poll result base resp",SM_POLL_RESULT_BASE_RESP_RET_ABNORMAL:"poll result base resp ret abnormal",SM_UNKNOWN_SCENE:"unknown scene",SM_SYSTEM_ERROR:"system error"}},"./src/servicemarket/index.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getServiceMarketAPI=void 0;var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),o=r("./src/hook/invoke.ts"),i=r("./src/externals/globals/wxconfig.ts"),s=r("./src/servicemarket/cdn.ts"),a=r("./src/servicemarket/invokeService/v1.ts"),c=r("./src/servicemarket/invokeService/v2.ts"),u=function(e){return(0,o.hasAPICallback)(e)?l(e):(0,i.isDevTools)()&&!e.async?a.invokeService(e):c.invokeService(e)},l=function(e){((0,i.isDevTools)()&&!e.async?a.invokeService(e):c.invokeService(e)).then(function(t){(0,o.invokeSuccessCompleteCallbacks)("invokeService",e,t)}).catch(function(t){(0,o.invokeFailCompleteCallbacks)("invokeService",e,t)})},d=function(e){return(0,o.hasAPICallback)(e)?p(e):c.getAsyncResult(e)},p=function(e){c.getAsyncResult(e).then(function(t){(0,o.invokeSuccessCompleteCallbacks)("getAsyncResult",e,t)}).catch(function(t){(0,o.invokeFailCompleteCallbacks)("getAsyncResult",e,t)})};t.getServiceMarketAPI=function(e){void 0===e&&(e={});var t=e.sdk;return{invokeService:function(e){return u(n.__assign(n.__assign({},e),{sdk:t}))},getAsyncResult:function(e){return d(n.__assign(n.__assign({},e),{sdk:t}))},CDN:s.CDN}}},"./src/servicemarket/invokeService/v1.ts":function(e,t,r){var n=this;Object.defineProperty(t,"__esModule",{value:!0}),t.invokeService=void 0;var o=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),i=r("./src/servicemarket/cdn.ts"),s=r("./src/servicemarket/operateWXData.ts");t.invokeService=function(e){return o.__awaiter(n,void 0,void 0,function(){var t,r,n,a,c,u,l,d,p,f,_,m;return o.__generator(this,function(o){switch(o.label){case 0:if(o.trys.push([0,3,,4]),!e.service||!e.api)throw new Error("field 'service' and 'api' must be provided");return t=new WeakMap,r=[],e.data&&JSON.stringify(e.data,function(n,o){return o&&o.symbol===i.CDNObjectSymbol?void r.push(new Promise(function(r,n){var s={appType:301,fileType:20303,fileKey:"file_".concat(Math.random())},a=o;switch(function(e){return Object.prototype.toString.call(e).slice(8,-1)}(a.options)){case"Object":if(!a.options.filePath)throw new Error("filePath must be provided");s.filePath=a.options.filePath;break;default:s.fileData=a.options}r((0,i.uploadToCommonCDN)(s,e.sdk).then(function(e){t.set(o,e.fileUrl)}))})):o}),[4,Promise.all(r)];case 1:return o.sent(),n=JSON.stringify(e.data,function(e,r){return r&&r.symbol===i.CDNObjectSymbol&&t.has(r)?t.get(r):r}),[4,(0,s.operateWXData)({apiName:"WxaServiceMarketJsapiComm",reqData:{service_id:e.service,api_name:e.api,data:n,consume_type:e.consumeType,consume_appid:e.consumeAppid,client_msg_id:"".concat(Math.random(),"_").concat(Date.now()),version:1}},e.sdk)];case 2:!(a=o.sent()).data&&a.rawData&&(a.data=JSON.parse(a.rawData)),c=a.data,wxConsole.info("[servicemarket] raw response",c),u=void 0,l=void 0,d=void 0;try{u=(p=c).request_id,0===p.errcode?l=JSON.parse(p.data):(_="invokeService:fail ".concat(p.errcode," ").concat(p.errmsg," (requestId: ").concat(u,")"),(d=new Error(_)).errCode=p.errcode,d.errMsg=_,d.requestId=u)}catch(e){_="invokeService:fail inner protocol parse failed (requestId: ".concat(u||"empty",")"),(d=new Error(_)).errCode=-1,d.errMsg=_,d.requestId=u}if(d)throw d;return[2,{errMsg:"invokeService:ok",data:l,requestId:u}];case 3:throw f=o.sent(),_="invokeService:fail ",f&&f.errMsg&&f.err_code?(_+=f.errMsg,(m=new Error(_+"(err_code ".concat(f.err_code,")"))).errCode=f.err_code,m):f&&f.errMsg&&f.errCode?f:new Error("invokeService:fail ".concat(f));case 4:return[2]}})})}},"./src/servicemarket/invokeService/v2.ts":function(e,t,r){var n=this;Object.defineProperty(t,"__esModule",{value:!0}),t.getAsyncResult=t.invokeService=void 0;var o,i=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),s=r("./src/servicemarket/types.ts"),a=r("./src/utils/utils.ts"),c=r("./src/utils/error.ts"),u=r("./src/externals/globals/wxconfig.ts"),l=r("./src/servicemarket/config.ts"),d=r("./src/servicemarket/cdn.ts"),p=r("./src/servicemarket/operateWXData.ts"),f="invokeService",_=50,m=2,h=2,g=60,v=2e4;!function(e){e[e.InvalidRequestId=14]="InvalidRequestId"}(o||(o={}));var y=function(e){var t=new Date;return"".concat(t.getHours(),":").concat(t.getMinutes(),":").concat(t.getSeconds()," ").concat(e)},E=function(e){return e.join("->")};t.invokeService=function(e){return i.__awaiter(n,void 0,void 0,function(){function t(t,r,n){return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(o){return[2,new Promise(function(o,d){var b=[y("start")],S=function(e,t,r){var n=function(t){e.push(y("app ".concat(t)))};return(0,a.onAppVisibilityChange)(n),{resolve:function(e){(0,a.offAppVisibilityChange)(n),t(e)},reject:function(e){(0,a.offAppVisibilityChange)(n),r(e)}}}(b,o,d),T=S.resolve,A=S.reject;!function t(r){return i.__awaiter(this,void 0,void 0,function(){var n,o,d,_,m,h,b,S,T,A,w,C,I,O,R,N,D,j,L,M,P,x,k,B=this;return i.__generator(this,function(U){switch(U.label){case 0:n=r.param,o=r.data,d=r.callID,_=r.scene,m=r.retryReason,h=r.tryCount,b=r.trace,S=r.systemErrorRetry,T=r.timeoutErrorRetry,A=r.resolve,w=r.reject,C={service_id:n.service,api_name:n.api,data:_===s.Scene.CALL?o:void 0,consume_type:e.consumeType,consume_appid:e.consumeAppid,client_msg_id:"".concat(Math.random(),"_").concat(Date.now()),version:2,call_id:d,scene:_,retry_reason:m},I=!1,O=!1,R=function(){clearTimeout(D),O=!0},N=+new Date,D=setTimeout(function(){return i.__awaiter(B,void 0,void 0,function(){var e;return i.__generator(this,function(n){switch(n.label){case 0:return e=v,+new Date-N>e?[4,(0,a.sleep)()]:[3,2];case 1:if(n.sent(),O)return[2];n.label=2;case 2:return!(0,u.isDevTools)()&&+new Date-N>g?(b.push(y("timeout, exceed max retry gap")),[2,w((0,c.returnAsFinalCloudSDKError)({errCode:l.ERR_CODE.SM_POLL_RESULT_EXPIRED,errMsg:"timeout for retry, cannot retry fetching the result anymore (callId: ".concat(d,") (trace: ").concat(E(b),")")},f))]):(I=!0,r.timeoutErrorRetry>0?(b.push(y("timeout, retry")),t(i.__assign(i.__assign({},r),{scene:_,retryReason:s.RetryReason.Timeout,tryCount:h-1,timeoutErrorRetry:T-1}))):(b.push(y("timeout, abort")),w((0,c.returnAsFinalCloudSDKError)({errCode:l.ERR_CODE.SM_EXCEED_MAX_TIMEOUT_POLL_RETRY,errMsg:"".concat(l.ERR_MSG.SM_EXCEED_MAX_TIMEOUT_POLL_RETRY," (callId: ").concat(d,") (trace: ").concat(E(b),")")},f))),[2])}})})},v),U.label=1;case 1:return U.trys.push([1,3,,4]),[4,(0,p.operateWXData)({apiName:"WxaServiceMarketJsapiComm",reqData:C},e.sdk)];case 2:!(j=U.sent()).data&&j.rawData&&(j.data=JSON.parse(j.rawData));try{if(I)return[2];if(R(),!(L=j.data)&&j.rawData)try{L=JSON.parse(j.rawData)}catch(e){}if(!L)return b.push(y("empty resp")),[2,w((0,c.returnAsFinalCloudSDKError)({errCode:l.ERR_CODE.SM_EMPTY_CALL_RESULT,errMsg:l.ERR_MSG.SM_EMPTY_CALL_RESULT},f))];if(L.scene!==s.Scene.PreResp){if(L.scene===s.Scene.FinalResp){if(0!==L.errcode)return(M=(0,c.returnAsFinalCloudSDKError)({errCode:l.ERR_CODE.SM_PROVIDER_EXECUTION_ERROR,errMsg:"requestID ".concat(L.request_id,", error message ").concat(L.provider_errmsg||"unknown"," (callid ").concat(d,")")},f)).requestID=L.request_id,[2,w(M)];P=L.data;try{P=JSON.parse(P)}catch(e){}return[2,A({result:P,requestID:L.request_id})]}return b.push(y("unexpected scene")),[2,w((0,c.returnAsFinalCloudSDKError)({errCode:l.ERR_CODE.SM_UNKNOWN_SCENE,errMsg:"unknown scene ".concat(L.scene," (callId: ").concat(d,") (trace: ").concat(E(b),")")},f))]}if(!(h>=0))return b.push(y("too many polls, abort")),[2,w((0,c.returnAsFinalCloudSDKError)({errCode:l.ERR_CODE.SM_EXCEED_MAX_POLL_RETRY,errMsg:"".concat(l.ERR_MSG.SM_EXCEED_MAX_POLL_RETRY," (callId: ").concat(d,") (trace: ").concat(E(b),")")},f))];b.push(y("normal poll")),t(i.__assign(i.__assign({},r),{scene:s.Scene.POLL,retryReason:s.RetryReason.None,tryCount:h-1}))}catch(e){w((0,c.returnAsFinalCloudSDKError)({errCode:l.ERR_CODE.SM_POLL_ERROR,errMsg:"polling catch error: ".concat(e," (callId: ").concat(d,")")},f))}return[3,4];case 3:return x=U.sent(),I?[2]:(R(),k=x instanceof Error?x:JSON.stringify(x),x&&x.operateWXDataFail&&S>0?(b.push(y("system error (".concat(k,"), retry"))),t(i.__assign(i.__assign({},r),{scene:_,retryReason:s.RetryReason.SysErr,tryCount:h-1,systemErrorRetry:S-1}))):(b.push(y("system error (".concat(k,"), abort"))),w((0,c.returnAsFinalCloudSDKError)("".concat(k," (callId: ").concat(d,") (trace: ").concat(E(b),")"),f))),[3,4]);case 4:return[2]}})})}({param:t,data:r,callID:n,scene:s.Scene.CALL,retryReason:s.RetryReason.None,tryCount:_,systemErrorRetry:m,timeoutErrorRetry:h,trace:b,resolve:T,reject:A})})]})})}var r,n,o,b,S,T,A,w,C,I,O,R,N,D;return i.__generator(this,function(i){switch(i.label){case 0:if(i.trys.push([0,6,,7]),!e.service||!e.api)throw new Error("field 'service' and 'api' must be provided");return r=new WeakMap,n=[],e.data&&JSON.stringify(e.data,function(t,o){return o&&o.symbol===d.CDNObjectSymbol?void n.push(new Promise(function(t,n){var i={appType:301,fileType:20303,fileKey:"file_".concat(Math.random())},s=o;switch(function(e){return Object.prototype.toString.call(e).slice(8,-1)}(s.options)){case"Object":if(!s.options.filePath)throw new Error("filePath must be provided");i.filePath=s.options.filePath;break;default:i.fileData=s.options}t((0,d.uploadToCommonCDN)(i,e.sdk).then(function(e){r.set(o,e.fileUrl)}))})):o}),[4,Promise.all(n)];case 1:return i.sent(),o=JSON.stringify(e.data,function(e,t){return t&&t.symbol===d.CDNObjectSymbol&&r.has(t)?r.get(t):t}),b="".concat(Math.random(),"_").concat(Date.now()),e.async?[3,3]:[4,t(e,o,b)];case 2:return S=i.sent(),T=S.result,A=S.requestID,[2,{errMsg:"invokeService:ok",data:T,requestId:A}];case 3:return w={service_id:e.service,api_name:e.api,data:o,consume_type:e.consumeType,consume_appid:e.consumeAppid,client_msg_id:"".concat(Math.random(),"_").concat(Date.now()),version:2,call_id:b,scene:s.Scene.CALL,retry_reason:s.RetryReason.None,req_type:s.ReqType.LongAsync},[4,(0,p.operateWXData)({apiName:"WxaServiceMarketJsapiComm",reqData:w},e.sdk)];case 4:if(!(C=i.sent()).data&&C.rawData&&(C.data=JSON.parse(C.rawData)),wxConsole.log("longAsync result",C),(I=C.data).scene===s.Scene.FinalResp&&0===I.errcode)return[2,{errMsg:"invokeService:ok",requestId:I.request_id}];throw(O=(0,c.returnAsFinalCloudSDKError)({errCode:l.ERR_CODE.SM_SYSTEM_ERROR,errMsg:"requestID ".concat(I.request_id,", error message ").concat(I.errmsg||"unknown"," (callid ").concat(b,")")},f)).requestID=I.request_id,O;case 5:return[3,7];case 6:throw R=i.sent(),N="invokeService:fail ",R&&R.errMsg&&R.err_code?(N+=R.errMsg,(D=new Error(N+"(err_code ".concat(R.err_code,")"))).errCode=R.err_code,D):R&&R.errMsg&&R.errCode?R:new Error("invokeService:fail ".concat(R));case 7:return[2]}})})},t.getAsyncResult=function(e){return i.__awaiter(this,void 0,void 0,function(){var t,r,n;return i.__generator(this,function(o){switch(o.label){case 0:return[4,(0,p.operateWXData)({apiName:"webapi_servicemarket_jsapi_retrieve",reqData:{request_id:e.requestId}},e.sdk)];case 1:if(!(t=o.sent()).data&&t.rawData&&(t.data=JSON.parse(t.rawData)),wxConsole.log("getAsyncResult resp",t),0===(r=t.data).errcode)return r.provider_errmsg?[2,{errCode:0,errMsg:"getAsyncResult:fail provider execution error",status:r.status,providerErrMsg:r.provider_errmsg,requestId:r.request_id}]:[2,{errCode:0,errMsg:"getAsyncResult:ok",data:JSON.parse(r.data),status:r.status,requestId:r.request_id}];throw(n=new Error("getAsyncResult:fail requestID ".concat(r.request_id,", error message ").concat(r.errmsg||"unknown"))).errCode=r.errcode,n.errMsg=r.errmsg,n}})})}},"./src/servicemarket/operateWXData.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.operateWXData=void 0;var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),o=r("./src/externals/public-lib/appserviceSdk.ts");t.operateWXData=function(e,t){return new Promise(function(r,i){(t||(0,o.getSDK)()).operateWXData(n.__assign(n.__assign({},e),{success:r,fail:i}))})}},"./src/servicemarket/types.ts":function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ReqType=t.RetryReason=t.Scene=void 0,function(e){e[e.CALL=1]="CALL",e[e.POLL=2]="POLL",e[e.PreResp=3]="PreResp",e[e.FinalResp=4]="FinalResp"}(t.Scene||(t.Scene={})),function(e){e[e.None=0]="None",e[e.SysErr=1]="SysErr",e[e.Timeout=2]="Timeout"}(t.RetryReason||(t.RetryReason={})),function(e){e[e.Sync=0]="Sync",e[e.LongAsync=2]="LongAsync"}(t.ReqType||(t.ReqType={}))},"./src/services/container/api/api.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getAPIs=void 0;var n=r("./src/services/container/api/callContainer.ts"),o=r("./src/services/container/api/connectContainer.ts");t.getAPIs=function(e){return{callContainer:(0,n.default)(e),connectContainer:(0,o.default)(e)}}},"./src/services/container/api/callContainer.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.API_NAME=void 0;var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),o=r("./src/hook/invoke.ts"),i=r("./src/utils/assert.ts"),s=r("./src/utils/error.ts"),a=r("./src/utils/fail-safe.ts"),c=r("./src/utils/fn/clone.ts"),u=r("./src/utils/report.ts"),l=r("./src/utils/serializer.ts"),d=r("./src/utils/cdn.ts"),p=r("./src/externals/globals/devtools.ts"),f=r("./src/externals/public-lib/appserviceSdk.ts"),_=r("./src/services/container/api/callContainer/v1.ts"),m=r("./src/services/container/api/callContainer/v2.ts"),h=r("./src/services/container/api/callContainer/v3.ts"),g=r("./src/utils/utils.ts"),v=r("../../../cloud-crypto/dist/index.js"),y=r("./src/utils/simulate-request.ts"),E=r("./src/utils/service-endpoint.ts");function b(e){var t=!1;return function(r){t||(t=!0,e(r))}}t.API_NAME="cloud.callContainer";var S={OFF:0,ON:1,UNKNOWN:2},T=!0,A=0,w=6,C=new WeakMap;t.default=function(e){var r=[void 0,(0,_.default)(e),(0,m.default)(e),(0,h.default)(e)];function I(e){return r[e]}return function(e){var r=+new Date;(0,i.assertType)(e,"object");var n=(0,c.shallowClone)(e);return n.data||(n.data={}),n.dataType||(n.dataType="json"),n.context={tunnelTimeNoCSNetCost:0,apiStartTime:r},n.stats={apiStartTime:r},(0,o.hasAPICallback)(n)?function(e){(0,a.wrapParamCallbacksWithTryCatch)({apiName:t.API_NAME,param:e});var r=b(function(r){return(0,o.invokeSuccessCompleteCallbacks)(t.API_NAME,e,r)});e.context.onFinalized=r,O(e).then(r).catch(function(r){(0,o.invokeFailCompleteCallbacks)(t.API_NAME,e,r)})}(n):O(n)};function O(r){return n.__awaiter(this,void 0,void 0,function(){var o,a,u,_,m,h,g,I,O,j,L,M,P;return n.__generator(this,function(x){switch(x.label){case 0:o=!1,x.label=1;case 1:return x.trys.push([1,6,7,8]),A++,function(t){var r;if(t.service,e.isInstance){if(!e.env)throw new Error("envId must be provided")}else if(null===(r=t.config)||void 0===r?void 0:r.env)(0,i.assertType)(t.config.env,"string");else if(!e.env)throw new Error("envId must be provided")}(r),(0,y.processParam)(r),r.cdnMapPromise=r.shouldSerialize?d.collect(r.data):void 0,a=Date.now(),T?(T=!1,[4,function(t){return n.__awaiter(this,void 0,void 0,function(){var r,o;return n.__generator(this,function(n){switch(n.label){case 0:return Boolean(e.serviceEndpoint.getEndpointSync("container"))?[3,2]:(r=new Promise(function(e){return setTimeout(e,50)}),o=e.serviceEndpoint.getEndpoint("container"),[4,Promise.race([r,o])]);case 1:n.sent(),n.label=2;case 2:return[2,R(t)]}})})}(r)]):[3,3];case 2:return u=x.sent(),[3,4];case 3:u=R(r),x.label=4;case 4:return o=u,r.stats.tsBeforeCallContainerImpl=Date.now(),_=(0,c.shallowClone)(r),m=r.data,h=N(r,o),I=r.service||r.header["X-WX-SERVICE"],g=I?"wx.cloud.callContainer.".concat(I).concat(r.path):"wx.cloud.callContainer".concat(r.path),(0,p.autoDevtoolsNetworkLog)(h,function(){var t;return{url:g,method:r.method,headers:n.__assign({Env:e.isInstance?e.env:(null===(t=r.config)||void 0===t?void 0:t.env)||e.env},r.header),reqBody:(0,l.serialize)(m),timestampMs:a,console:e.debug}}),O=function(r,o){var i;return null===(i=r.followRedirect)||void 0===i||i?function r(i,s){return new Promise(function(a,u){s.then(function(s){var l;if((0,y.is3XXResponse)(s.statusCode)){var d=null!==(l=C.get(o))&&void 0!==l?l:0;if(d>=w)u("reach the max redirect count");else{C.set(o,d+1);var p="";for(var _ in s.header)"location"===_.toLowerCase()&&(p=s.header[_]);if(p)if(p.startsWith("/")){var m=(0,c.shallowClone)(i);i.path=p;var h=N(i);r(m,h).then(a).catch(u)}else{var g=(0,f.getSDK)(e.identifiers);g.request({url:p,method:i.method,header:i.header,data:i.data,dataType:i.dataType,responseType:i.responseType,timeout:i.timeout,success:function(e){a(n.__assign(n.__assign({},e),{errMsg:"".concat(t.API_NAME,":ok")}))},fail:function(e){u(e.errMsg.replace(/^request/,t.API_NAME))}})}else a(s)}}else a(s)}).catch(u)})}(r,o):o}(_,h),j=function(t,r){var n;if(e.identifiers.pluginId)return r;var o=(0,f.getSDK)(e.identifiers);if(!o.isUsedCache())return r;var i=function(e){var t={abort:function(){},promise:Promise.resolve()},r=new Promise(function(e,r){t.abort=r});return t.promise=Promise.race([e,r]),t}(r),s=o.reportCallContainer,a=o.privateCacheManager,c=o.cacheManager,u=Date.now(),l=t.data,d=t.method,p=(null===(n=t.config)||void 0===n?void 0:n.env)||e.env,_="https://wx.cloud.callContainer/".concat(p),m=t.service;if(!m)for(var h in t.header)"X-WX-SERVICE"===h.toUpperCase()&&(m=t.header[h]);_+=m?"/".concat(m).concat(t.path):t.path;var g=function(e,t,n){var o=a.emit("request",{url:_,data:l,method:d,request:function(){return new Promise(function(e,t){r.then(e).catch(t)})}});if(o.length){var s=o.find(function(e){return e&&"function"==typeof e.then});s&&s.then(e).catch(t).finally(function(){i.abort()})}else n&&t(n)};return new Promise(function(e,t){var n=function(t){s({isSuccess:!0,costTime:Date.now()-u,extra1:_}),e(t)},o=function(e){s({isSuccess:!1,costTime:Date.now()-u,extra1:_}),t(e)},i=function(e){a.checkNeedStore(_,l,d,e),n(e)};c.state===S.UNKNOWN?r.then(function(e){i(e)}).catch(function(e){g(n,o,e)}):c.state===S.ON?g(n,o):c.state===S.OFF&&r.then(function(e){i(e)}).catch(function(e){o(e)})})}(r,O),L=b(function(){return D(r,o)}),r.context.onRequestDone=L,[4,j];case 5:return M=x.sent(),D(r,o),(0,E.deferKeepAlive)(),[2,M];case 6:throw P=x.sent(),(0,s.returnAsFinalCloudSDKError)(P,t.API_NAME);case 7:return 0==--A&&(0,v.loadAccelerator)((0,f.getSDK)()._WebAssembly),[7];case 8:return[2]}})})}function R(t){return"windows"!==(0,g.getSystemInfo)().platform&&(1===t.apiVersion||2!==t.apiVersion&&Boolean(e.serviceEndpoint.getEndpointSync("container")))}function N(e,t){var r;if(t=null!==t&&void 0!==t?t:R(e),1e3===e.mode)r=I(0)(e);else if(t){var o=n.__assign(n.__assign({},e),{stats:n.__assign({},e.stats)});r=I(1)(e).catch(function(e){if(-9999===(null===e||void 0===e?void 0:e.errCode))return I(2)(o);throw e})}else r=I(2)(e);return r}function D(e,r){(0,u.reportCallContainerLike)(t.API_NAME,e,r?"v1":"im")}}},"./src/services/container/api/callContainer/v1.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.API_NAME=void 0;var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),o=r("./src/utils/serializer.ts"),i=r("./src/externals/public-lib/appserviceSdk.ts"),s=r("./src/utils/utils.ts"),a=r("./src/utils/type.ts"),c=r("../../../cloud-crypto/dist/index.js"),u=r("./src/utils/service-endpoint.ts"),l=r("./src/utils/simulate-request.ts");t.API_NAME="cloud.callContainer",t.default=function(e){return function(r){return n.__awaiter(this,void 0,void 0,function(){var d,p,f,_;return n.__generator(this,function(m){switch(m.label){case 0:return d=e.serviceEndpoint.getEndpointSync("container"),p=new WeakMap,!r.cdnMapPromise&&d?[3,2]:[4,Promise.all([r.cdnMapPromise,function(e,t,r){var n=Date.now();return e.then(function(){return t[r]=Date.now()-n}).catch(function(){return t[r]=Date.now()-n}),e}(e.serviceEndpoint.getEndpoint("container"),r.stats,"getServiceEndpoint")])];case 1:return(f=m.sent())[0]&&(p=f[0]),d=f[1],[3,3];case 2:r.stats.getServiceEndpoint=0,m.label=3;case 3:return r.shouldSerialize&&(r.data=(0,o.serialize)(r.data,p)),d.http?((_=function(r,o){return new Promise(function(u,d){var p,f;o.stats.tsCallContainerImplStart=Date.now();var _=(0,i.getSDK)(e.identifiers),m={"X-WX-ENCRYPTION-VERSION":2,"X-WX-ENCRYPTION-TIMESTAMP":r.timestamp+"","X-WX-COMPRESSION":"snappy","X-WX-USER-TIMEOUT":o.timeout||"","X-WX-LIB-BUILD-TS":1685699826199,"X-WX-RESPONSE-CONTENT-ACCEPT-ENCODING":"PB, JSON","Content-Type":"application/octet-stream"},h="".concat(Math.random(),"_").concat(Date.now()),g=n.__assign(n.__assign({},o.header),{"X-WX-ENV":e.isInstance?e.env:(null===(p=o.config)||void 0===p?void 0:p.env)||e.env,"X-WX-CALL-ID":h});e.appid&&(g["X-WX-RESOURCE-APPID"]=e.appid),o.service&&(g["X-WX-SERVICE"]=o.service);var v=o.stats;v.callid=h;var y=Date.now();if("GET"===(null===(f=o.method)||void 0===f?void 0:f.toUpperCase())&&o.data&&(0,a.isObject)(o.data)){var E=[];for(var b in o.data)E.push("".concat(b,"=").concat(o.data[b]));o.path+="".concat(o.path.includes("?")?o.path.endsWith("&")?"":"&":"?").concat(E.join("&")),o.data=void 0}g["X-WX-CONTAINER-PATH"]=o.path;var S=new Uint8Array(s.base64ToArrayBuffer(r.key)),T=c.V1.encodeRequest(S,g,o.method||"GET",o.data,h,v),A=T.data,w=T.contentEncoding;m["X-WX-REQUEST-CONTENT-ENCODING"]=w,v.encrypt=Date.now()-y,y=Date.now();var C=r.url;o.rdm?C="https://wxardm.weixin.qq.com/wxa-qbase/container_service?token=".concat(r.token):o.ecdn&&(C="https://cloudbase.servicewechat.com/wxa-qbase/container_service?token=".concat(r.token)),o.verbose&&console.log("[cloud.callContainer] url ".concat(C)),r.domain&&(o.stats.domain=r.domain),v.requestBodyBytes=A.byteLength,v.requestStartTs=Date.now(),o._fallback?d({errCode:-9999,errMsg:"".concat(t.API_NAME,":fail emulated fallback")}):_.request({url:C,method:"POST",header:m,data:A.buffer,dataType:"arraybuffer",responseType:"arraybuffer",timeout:o.timeout,enableHttp2:!0,success:function(e){var n,i,s,a;v.requestSuccessTs=Date.now();try{for(var p in e.header)if("x-nws-log-uuid"===p.toLowerCase()&&(o.verbose&&console.log("[cloud.callContainer] x-nws-log-uuid ".concat(e.header[p])),o.stats.ecdnId=e.header[p]),"x-edge-timing"===p.toLowerCase()&&(o.stats.ecdnEdgeTiming=e.header[p]),"x-wx-system-error"===p.toLowerCase()){var f=Number(e.header[p]);return 85104===f&&r.invalidate(),void d({errCode:f,errMsg:"".concat(t.API_NAME,":fail system error. code: ").concat(f)})}if(o.verbose&&console.warn("res",e),v.profile=e.profile,v.httpRequest=Date.now()-y,200===e.statusCode){var _=e.data;v.responseBodyBytes=_.byteLength,y=Date.now();var m=!1,g="PB";for(var E in e.header)if("x-wx-compression"===E.toLowerCase()&&"snappy"===e.header[E]&&(y=Date.now(),m=!0),"x-wx-response-content-encoding"===E.toLowerCase()&&"json"===e.header[E].toLowerCase()&&(g="JSON"),"x-wx-server-timing"===E.toLowerCase()){var b=e.header[E]||"",T=b.split(",");T.length>=2&&(v.serverStartTs=Number(T[0]),v.serverEndTs=Number(T[1]))}var A=c.V1.decodeResponse(S,new Uint8Array(_),m,g);y=Date.now();var w=void 0,C=A.body;(0,l.is3XXResponse)(A.statusCode)||(w=(0,l.processResponse)(o,C,A.statusCode)),v.decodeBody=Date.now()-y;var I={statusCode:A.statusCode,header:A.header,data:w,stats:v,callID:h,errMsg:"".concat(t.API_NAME,":ok")};v.responseProcessEndTs=Date.now(),null===(i=(n=o.context).onRequestDone)||void 0===i||i.call(n,I),(0,l.is3XXResponse)(A.statusCode)||null===(a=(s=o.context).onFinalized)||void 0===a||a.call(s,I),u(I)}else d({errCode:-9999,errMsg:"".concat(t.API_NAME,":fail [call_id ").concat(h,"] system conn status not 200")})}catch(e){d({errCode:-1,errMsg:"".concat(t.API_NAME,":fail [call_id ").concat(h,"] error while processing internal response ").concat(e)})}},fail:function(e){d(n.__assign(n.__assign({},e),{errCode:-9999,errMsg:e.errMsg.replace(/^request/,t.API_NAME)}))}})})}(d,r)).then(u.keepAlive).catch(u.keepAlive),[2,_]):[2,function(r,o){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(s){return[2,new Promise(function(s,a){var c,u=(0,i.getSDK)(e.identifiers),l=n.__assign(n.__assign({},o.header),{"X-WX-ENV":e.isInstance?e.env:(null===(c=o.config)||void 0===c?void 0:c.env)||e.env,"X-WX-SERVICE":o.service,"X-WX-CONTAINER-PATH":o.path,"X-WX-CALL-ID":"".concat(Math.random(),"_").concat(Date.now()),"X-WX-USER-TIMEOUT":o.timeout});e.appid&&(l["X-WX-RESOURCE-APPID"]=e.appid),u.request({url:r,method:o.method,header:l,data:o.data,dataType:o.dataType,responseType:o.responseType,timeout:o.timeout,success:function(e){s(n.__assign(n.__assign({},e),{errMsg:"".concat(t.API_NAME,":ok")}))},fail:function(e){a(n.__assign(n.__assign({},e),{errMsg:e.errMsg.replace(/^request/,t.API_NAME)}))}})})]})})}(d.url,r)]}})})}}},"./src/services/container/api/callContainer/v2.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.API_NAME=void 0;var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),o=r("./src/utils/msg.ts"),i=r("./src/utils/data-pipe.ts");t.API_NAME="cloud.callContainer",t.default=function(e){return function(r){var s;return n.__awaiter(this,void 0,void 0,function(){var a,c,u,l;return n.__generator(this,function(d){switch(d.label){case 0:return[4,(0,i.processDataPipeParam)(r)];case 1:return a=d.sent(),c=a.tunnelReqDataType,u=a.callID,r.header=n.__assign(n.__assign({},r.header),{"X-WX-ENV":e.isInstance?e.env:(null===(s=r.config)||void 0===s?void 0:s.env)||e.env,"X-WX-CONTAINER-PATH":r.path}),r.service&&(r.header["X-WX-SERVICE"]=r.service),r.context.tunnelStartTime=+new Date,[4,(0,i.callAndWaitResult)(t.API_NAME,r,r.data,c,u,e)];case 2:return l=d.sent().result,r.context.tunnelEndTime=+new Date,[2,n.__assign(n.__assign({},l),{errMsg:(0,o.apiSuccessMsg)(t.API_NAME),callID:u})]}})})}}},"./src/services/container/api/callContainer/v3.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.API_NAME=void 0;var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),o=r("./src/utils/serializer.ts"),i=r("./src/externals/public-lib/appserviceSdk.ts"),s=r("./src/utils/utils.ts"),a=r("../../../cloud-crypto/dist/index.js");t.API_NAME="cloud.callContainer",t.default=function(e){return function(r){return n.__awaiter(this,void 0,void 0,function(){var c,u,l;return n.__generator(this,function(d){switch(d.label){case 0:return c=e.serviceEndpoint.getEndpointSync("container"),u=new WeakMap,!r.cdnMapPromise&&c?[3,2]:[4,Promise.all([r.cdnMapPromise,function(e,t,r){var n=Date.now();return e.then(function(){return t[r]=Date.now()-n}).catch(function(){return t[r]=Date.now()-n}),e}(e.serviceEndpoint.getEndpoint("container"),r.stats,"getServiceEndpoint")])];case 1:return(l=d.sent())[0]&&(u=l[0]),c=l[1],[3,3];case 2:r.stats.getServiceEndpoint=0,d.label=3;case 3:return r.shouldSerialize&&(r.data=(0,o.serialize)(r.data,u)),c.http?[2,function(r,o){return new Promise(function(c,u){var l;o.stats.tsCallContainerImplStart=Date.now();var d=(0,i.getSDK)(e.identifiers),p={"X-WX-EV":3,"Content-Type":"application/octet-stream"},f="".concat(Math.random(),"_").concat(Date.now()),_=n.__assign(n.__assign({},o.header),{"X-WX-ENV":e.isInstance?e.env:(null===(l=o.config)||void 0===l?void 0:l.env)||e.env,"X-WX-SERVICE":o.service,"X-WX-CONTAINER-PATH":o.path,"X-WX-CALL-ID":f});e.appid&&(_["X-WX-RESOURCE-APPID"]=e.appid);var m=o.stats;m.callid=f;var h=Date.now(),g=new Uint8Array(s.base64ToArrayBuffer(r.key));a.V3.encodeRequest(g,_,o.method||"GET",o.data).then(function(e){var i=e.data;m.encrypt=Date.now()-h,h=Date.now();var l=r.url;o.rdm?l="https://wxardm.weixin.qq.com/wxa-qbase/container_service?token=".concat(r.token):o.ecdn&&(l="https://cloudbase.servicewechat.com/wxa-qbase/container_service?token=".concat(r.token)),o.verbose&&console.log("[cloud.callContainer] url ".concat(l)),r.domain&&(o.stats.domain=r.domain),m.requestBodyBytes=i.byteLength,m.requestStartTs=Date.now(),d.request({url:l,method:"POST",header:p,data:i.buffer,dataType:"arraybuffer",responseType:"arraybuffer",timeout:o.timeout,enableHttp2:!0,success:function(e){try{for(var r in e.header)if("x-nws-log-uuid"===r.toLowerCase()&&(o.verbose&&console.log("[cloud.callContainer] x-nws-log-uuid ".concat(e.header[r])),o.stats.ecdnId=e.header[r]),"x-edge-timing"===r.toLowerCase()&&(o.stats.ecdnEdgeTiming=e.header[r]),"x-wx-system-error"===r.toLowerCase()){var n=Number(e.header[r]);return void u({errCode:n,errMsg:"".concat(t.API_NAME,":fail system error. code: ").concat(n)})}if(m.profile=e.profile,m.httpRequest=Date.now()-h,200===e.statusCode){var i=e.data;m.responseBodyBytes=i.byteLength,h=Date.now();var l=a.V3.decodeResponse(g,new Uint8Array(i));for(var d in m.decrypt=Date.now()-h,e.header)if("x-wx-server-timing"===d.toLowerCase()){var p=e.header[d]||"",_=p.split(",");_.length>=2&&(m.serverStartTs=Number(_[0]),m.serverEndTs=Number(_[1]))}h=Date.now();var v=void 0,y=l.body;if("json"===o.dataType){var E="string"==typeof y?y:s.arrayBufferToString(y.buffer);v=s.tryJSONParse(E)}else v="text"===o.responseType?"string"==typeof y?y:s.arrayBufferToString(y.buffer):"arraybuffer"===o.responseType?"string"==typeof y?s.stringToArrayBuffer(y):y.buffer:y;m.decodeBody=Date.now()-h,m.responseProcessEndTs=Date.now(),c({statusCode:l.statusCode,header:l.header,data:v,stats:m,callID:f,errMsg:"".concat(t.API_NAME,":ok")})}else{var n=-1;for(var b in e.header)"x-wx-system-error"===b.toLowerCase()&&(n=Number(e.header[b]));u({errCode:n,errMsg:"".concat(t.API_NAME,":fail system error, status ").concat(e.statusCode,". code: ").concat(n)})}}catch(e){u({errCode:-1,errMsg:"".concat(t.API_NAME,":fail error while processing internal response ").concat(e)})}},fail:function(e){u(n.__assign(n.__assign({},e),{errMsg:e.errMsg.replace(/^request/,t.API_NAME)}))}})})})}(c,r)]:[2,function(r,o){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(s){return[2,new Promise(function(s,a){var c,u=(0,i.getSDK)(e.identifiers),l=n.__assign(n.__assign({},o.header),{"X-WX-ENV":e.isInstance?e.env:(null===(c=o.config)||void 0===c?void 0:c.env)||e.env,"X-WX-SERVICE":o.service,"X-WX-CONTAINER-PATH":o.path,"X-WX-CALL-ID":"".concat(Math.random(),"_").concat(Date.now()),"X-WX-USER-TIMEOUT":o.timeout});e.appid&&(l["X-WX-RESOURCE-APPID"]=e.appid),u.request({url:r,method:o.method,header:l,data:o.data,dataType:o.dataType,responseType:o.responseType,timeout:o.timeout,success:function(e){s(n.__assign(n.__assign({},e),{errMsg:"".concat(t.API_NAME,":ok")}))},fail:function(e){a(n.__assign(n.__assign({},e),{errMsg:e.errMsg.replace(/^request/,t.API_NAME)}))}})})]})})}(c.url,r)]}})})}}},"./src/services/container/api/connectContainer.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),o=r("./src/externals/public-lib/appserviceSdk.ts"),i=r("./src/utils/assert.ts"),s=r("./src/hook/invoke.ts"),a=r("./src/utils/msg.ts"),c=r("./src/utils/fn/clone.ts"),u=r("./src/utils/report.ts"),l="cloud.connectContainer";t.default=function(e){return function(e){var r=(0,c.shallowClone)(e);return r.timing={apiStartTime:+new Date},(0,s.hasAPICallback)(r)?function(e){t(e).then(function(t){(0,s.invokeSuccessCompleteCallbacks)(l,e,t)}).catch(function(t){(0,s.invokeFailCompleteCallbacks)(l,e,t)})}(r):t(r)};function t(t){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,3,4]),function(e){e.config&&e.config.env&&(0,i.assertType)(e.config.env,"string")}(t),[4,function(t){return n.__awaiter(this,void 0,void 0,function(){var r,i,s,c,u,d;return n.__generator(this,function(p){switch(p.label){case 0:return r={service_name:t.service},i=JSON.stringify(r),t.timing.tunnelStartTime=+new Date,[4,e.request(n.__assign(n.__assign({},t.config),{apiName:"tcbapi_get_websocket_info",serviceName:e.name,serializedReqData:i,env:t.config&&t.config.env||e.env}))];case 1:return s=p.sent(),t.timing.tunnelEndTime=+new Date,c=s.data,t.success,t.complete,u=n.__rest(t,["success","complete"]),d=(0,o.getSDK)(e.identifiers).connectSocket(n.__assign(n.__assign({},u),{url:"wss://".concat(c.host).concat(t.path||""),header:n.__assign(n.__assign({},u.header),{"content-type":"application/json","x-wx-token":c.token}),perMessageDeflate:!0})),[2,{errMsg:(0,a.apiSuccessMsg)(l),socketTask:d}]}})})}(t)];case 1:return[2,r.sent()];case 2:throw r.sent();case 3:return(0,u.reportAPISpeed)(n.__assign(n.__assign({},t.timing),{apiEndTime:+new Date,apiName:l})),[7];case 4:return[2]}})})}}},"./src/services/container/index.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.registerService=t.CONTAINER_SERVICE_NAME=void 0;var n=r("./src/services/container/api/api.ts");t.CONTAINER_SERVICE_NAME="container",t.registerService=function(e){e.registerService(function(e){var r={name:t.CONTAINER_SERVICE_NAME,identifiers:e.identifiers,request:e.request,isInstance:e.isInstance,serviceEndpoint:e.serviceEndpoint,get debug(){return e.debug},get appid(){return e.isInstance?e.instanceOptions.resourceAppid:void 0},get env(){return e.getEnvForService(t.CONTAINER_SERVICE_NAME)},appConfig:{get maxPollRetry(){return e.appConfig.call_container_poll_max_retry},get clientPollTimeout(){return e.appConfig.call_container_client_poll_timeout},get maxStartRetryGap(){return e.appConfig.call_container_valid_start_retry_gap}}};return{name:t.CONTAINER_SERVICE_NAME,context:r,getAPIs:n.getAPIs.bind(null,r)}}(e))}},"./src/services/database/api/api.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getAPIs=void 0;var n=r("./src/services/database/api/database.ts");t.getAPIs=function(e){return{database:n.default.bind(null,e)}}},"./src/services/database/api/database.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getDatabase=void 0;var n=r("./src/services/database/api/database/command.ts"),o=r("./src/services/database/api/database/collection.ts"),i=r("./src/services/database/api/database/geo.ts"),s=r("./src/services/database/api/database/date.ts"),a=r("./src/services/database/api/database/regexp.ts"),c=r("./src/services/database/internal/grammar/engine.ts"),u=r("./src/utils/assert.ts");function l(e,t){return new(p(e.identifiers||{}))({context:e,config:t})}function d(e){return e.debug}t.getDatabase=l,t.default=l;var p=function(e){var t,r;return function(){function l(l){var p=l.config,f=l.context;this.identifiers=e,this.config=p||{},t={database:this,serviceContext:f,engine:(0,c.getEngine)()},r=(0,o.getCollectionReferenceClass)(t),p&&p.env&&(0,u.assertType)(p.env,"string"),this.command=n.commands,this.Geo=i,this.serverDate=s.serverDate,this.RegExp=a.regExp,p&&p.hasOwnProperty("debug")&&Object.defineProperties(this,{debug:{value:!0},QuerySerializer:{enumerable:!1,configurable:!1,get:function(){return function(e){return d(e.database)?e.engine.QuerySerializer:void 0}(t)},set:function(){}},UpdateSerializer:{enumerable:!1,configurable:!1,get:function(){return function(e){return d(e.database)?e.engine.UpdateSerializer:void 0}(t)},set:function(){}},ProjectionSerializer:{enumerable:!1,configurable:!1,get:function(){return function(e){return d(e.database)?e.engine.ProjectionSerializer:void 0}(t)},set:function(){}},AggregateSerializer:{enumerable:!1,configurable:!1,get:function(){return function(e){return d(e.database)?e.engine.AggregateSerializer:void 0}(t)},set:function(){}},Decoder:{enumerable:!1,configurable:!1,get:function(){return function(e){return d(e.database)?e.engine.Decoder:void 0}(t)},set:function(){}}})}return l.prototype.collection=function(e){return new r(e)},l.prototype.toJSON=function(){},l}()}},"./src/services/database/api/database/aggregate.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.isPipelineStage=t.isPipeline=t.isAggregate=t.Pipeline=t.getAggregateClass=void 0;var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),o=r("./src/services/database/api/database/helper/symbol.ts"),i=r("./src/hook/invoke.ts"),s=r("./src/utils/msg.ts"),a=r("./src/utils/error.ts"),c=r("./src/utils/report.ts"),u=r("./src/services/database/internal/backend-api/backend-api.ts"),l=r("./src/externals/globals/wxconfig.ts");t.getAggregateClass=function(e){return function(t){function r(e,r){var n=t.call(this,r)||this;return n._internalType=o.SYMBOL_AGGREGATE,n.collection=e,n}return n.__extends(r,t),r.prototype.pushStage=function(e,t){return new r(this.collection,n.__spreadArray(n.__spreadArray([],n.__read(this._stages),!1),[new d(e,t)],!1))},r.prototype.end=function(t){var r=this;void 0===t&&(t={});var o="collection.aggregate",d={apiStartTime:+new Date},p=(0,i.hasAPICallback)(t),f=new Promise(function(i,p){return n.__awaiter(r,void 0,void 0,function(){var f,_;return n.__generator(this,function(m){switch(m.label){case 0:return m.trys.push([0,2,3,4]),[4,(0,u.runAggregate)({env:e.database.config.env,collectionName:r.collection.collectionName,stages:e.engine.AggregateSerializer.encodeStages(r._stages),instanceContext:e,timing:d,explain:t.explain})];case 1:return f=m.sent(),t.explain&&(0,l.isDevTools)()?[2,i(f)]:(i({list:f.list,errMsg:(0,s.apiSuccessMsg)(o)}),[3,4]);case 2:return _=m.sent(),p((0,a.returnAsFinalCloudSDKError)(_,o)),[3,4];case 3:return(0,c.reportAPISpeed)(n.__assign(n.__assign({},d),{apiEndTime:+new Date,apiName:"cloud.db.".concat(o)})),[7];case 4:return[2]}})})});if(!p)return f;f.then(function(e){(0,i.invokeSuccessCompleteCallbacks)(o,t,e)}).catch(function(e){(0,i.invokeFailCompleteCallbacks)(o,t,e)})},r}(p)};var d=function(){return function(e,t){this._internalType=o.SYMBOL_AGGREGATE_PIPELINE_STAGE,this.stage=e,this.val=t}}(),p=function(){function e(e){this._internalType=o.SYMBOL_AGGREGATE_PIPELINE,this._stages=e}return e.prototype.pushStage=function(t,r){return new e(n.__spreadArray(n.__spreadArray([],n.__read(this._stages),!1),[new d(t,r)],!1))},e.prototype.addFields=function(e){return this.pushStage("addFields",e)},e.prototype.bucket=function(e){return this.pushStage("bucket",e)},e.prototype.bucketAuto=function(e){return this.pushStage("bucketAuto",e)},e.prototype.collStats=function(e){return this.pushStage("collStats",e)},e.prototype.count=function(e){return this.pushStage("count",e)},e.prototype.facet=function(e){return this.pushStage("facet",e)},e.prototype.geoNear=function(e){return this.pushStage("geoNear",e)},e.prototype.graphLookup=function(e){return this.pushStage("graphLookup",e)},e.prototype.group=function(e){return this.pushStage("group",e)},e.prototype.indexStats=function(){return this.pushStage("indexStats",{})},e.prototype.limit=function(e){return this.pushStage("limit",e)},e.prototype.lookup=function(e){return this.pushStage("lookup",e)},e.prototype.match=function(e){return this.pushStage("match",e)},e.prototype.out=function(e){return this.pushStage("out",e)},e.prototype.project=function(e){return this.pushStage("project",e)},e.prototype.redact=function(e){return this.pushStage("redact",e)},e.prototype.replaceRoot=function(e){return this.pushStage("replaceRoot",e)},e.prototype.sample=function(e){return this.pushStage("sample",e)},e.prototype.skip=function(e){return this.pushStage("skip",e)},e.prototype.sort=function(e){return this.pushStage("sort",e)},e.prototype.sortByCount=function(e){return this.pushStage("sortByCount",e)},e.prototype.unwind=function(e){return this.pushStage("unwind",e)},e.prototype.end=function(){},e}(),f=function(e){function t(t,r){void 0===r&&(r=!1);var n=e.call(this,t)||this;return n._sealed=r,n}return n.__extends(t,e),t.prototype.pushStage=function(e,r){if(this._sealed)throw new Error("pushing new stage is not allowed after calling 'done()'");return new t(n.__spreadArray(n.__spreadArray([],n.__read(this._stages),!1),[new d(e,r)],!1))},t.prototype.done=function(){return new t(this._stages,!0)},t}(p);t.Pipeline=f;t.isAggregate=function(e){return e&&e._internalType===o.SYMBOL_AGGREGATE};t.isPipeline=function(e){return e&&e._internalType===o.SYMBOL_AGGREGATE_PIPELINE};t.isPipelineStage=function(e){return e&&e._internalType===o.SYMBOL_AGGREGATE_PIPELINE_STAGE}},"./src/services/database/api/database/collection.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getCollectionReferenceClass=void 0;var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),o=r("./src/services/database/api/database/query.ts"),i=r("./src/services/database/api/database/document.ts"),s=r("./src/services/database/api/database/aggregate.ts"),a=r("./src/hook/invoke.ts"),c=r("./src/services/database/internal/backend-api/backend-api.ts"),u=r("./src/utils/msg.ts"),l=r("./src/utils/error.ts"),d=r("./src/utils/assert.ts"),p=r("./src/utils/report.ts");t.getCollectionReferenceClass=function(e){var t=(0,o.getQueryClass)(e),r=(0,i.getDocumentReferenceClass)(e),f=(0,s.getAggregateClass)(e);return function(t){function o(e){var r=t.call(this,e)||this;return r.collectionName=e,r}return n.__extends(o,t),o.prototype.doc=function(e){if(null===e||void 0===e)throw(0,l.returnAsFinalCloudSDKError)({errCode:-1,errMsg:"docId must not be empty"},"collection.doc");return new r(this,e)},o.prototype.add=function(t){var r=this,o="collection.add",i={apiStartTime:+new Date},s=(0,a.hasAPICallback)(t),f=new Promise(function(s,a){return n.__awaiter(r,void 0,void 0,function(){var f,_;return n.__generator(this,function(m){switch(m.label){case 0:return m.trys.push([0,2,3,4]),(0,d.assertType)(t,{data:"object"}),[4,(0,c.addDocument)({env:e.database.config.env,collectionName:r.collectionName,data:e.engine.encodeInternalDataType(t.data),instanceContext:e,timing:i})];case 1:return f=m.sent(),s({_id:f._id,errMsg:(0,u.apiSuccessMsg)(o)}),[3,4];case 2:return _=m.sent(),a((0,l.returnAsFinalCloudSDKError)(_,o)),[3,4];case 3:return(0,p.reportAPISpeed)(n.__assign(n.__assign({},i),{apiEndTime:+new Date,apiName:"cloud.db.".concat(o)})),[7];case 4:return[2]}})})});if(!s)return f;f.then(function(e){(0,a.invokeSuccessCompleteCallbacks)(o,t,e)}).catch(function(e){(0,a.invokeFailCompleteCallbacks)(o,t,e)})},o.prototype.aggregate=function(){return new f(this,[])},o}(t)}},"./src/services/database/api/database/command.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.commands=void 0;var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),o=r("./src/services/database/api/database/commands/query.ts"),i=r("./src/services/database/api/database/commands/logic.ts"),s=r("./src/services/database/api/database/commands/update.ts"),a=r("./src/services/database/api/database/commands/aggregate.ts"),c=r("./src/services/database/api/database/commands/projection.ts"),u=r("./src/services/database/api/database/aggregate.ts"),l=r("./src/utils/type.ts"),d=new Set(["each","position","slice","sort"]);t.commands={eq:function(e){return new o.QueryCommmand(o.QUERY_COMMANDS_LITERAL.EQ,[e])},neq:function(e){return new o.QueryCommmand(o.QUERY_COMMANDS_LITERAL.NEQ,[e])},lt:function(e){return new o.QueryCommmand(o.QUERY_COMMANDS_LITERAL.LT,[e])},lte:function(e){return new o.QueryCommmand(o.QUERY_COMMANDS_LITERAL.LTE,[e])},gt:function(e){return new o.QueryCommmand(o.QUERY_COMMANDS_LITERAL.GT,[e])},gte:function(e){return new o.QueryCommmand(o.QUERY_COMMANDS_LITERAL.GTE,[e])},in:function(e){return new o.QueryCommmand(o.QUERY_COMMANDS_LITERAL.IN,e)},nin:function(e){return new o.QueryCommmand(o.QUERY_COMMANDS_LITERAL.NIN,e)},geoNear:function(e){return new o.QueryCommmand(o.QUERY_COMMANDS_LITERAL.GEO_NEAR,[e])},geoWithin:function(e){return new o.QueryCommmand(o.QUERY_COMMANDS_LITERAL.GEO_WITHIN,[e])},geoIntersects:function(e){return new o.QueryCommmand(o.QUERY_COMMANDS_LITERAL.GEO_INTERSECTS,[e])},and:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=(0,l.isArray)(arguments[0])?arguments[0]:Array.from(arguments);return new i.LogicCommmand(i.LOGIC_COMMANDS_LITERAL.AND,r)},or:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=(0,l.isArray)(arguments[0])?arguments[0]:Array.from(arguments);return new i.LogicCommmand(i.LOGIC_COMMANDS_LITERAL.OR,r)},nor:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=(0,l.isArray)(arguments[0])?arguments[0]:Array.from(arguments);return new i.LogicCommmand(i.LOGIC_COMMANDS_LITERAL.NOR,r)},not:function(e){return new i.LogicCommmand(i.LOGIC_COMMANDS_LITERAL.NOT,[e])},exists:function(e){return new o.QueryCommmand(o.QUERY_COMMANDS_LITERAL.EXISTS,[e])},mod:function(e,t){return new o.QueryCommmand(o.QUERY_COMMANDS_LITERAL.MOD,[e,t])},all:function(e){return new o.QueryCommmand(o.QUERY_COMMANDS_LITERAL.ALL,e)},elemMatch:function(e){return new o.QueryCommmand(o.QUERY_COMMANDS_LITERAL.ELEM_MATCH,[e])},size:function(e){return new o.QueryCommmand(o.QUERY_COMMANDS_LITERAL.SIZE,[e])},expr:function(e){return new o.QueryCommmand(o.QUERY_COMMANDS_LITERAL.EXPR,[e])},set:function(e){return new s.UpdateCommand(s.UPDATE_COMMANDS_LITERAL.SET,[e])},remove:function(){return new s.UpdateCommand(s.UPDATE_COMMANDS_LITERAL.REMOVE,[])},inc:function(e){return new s.UpdateCommand(s.UPDATE_COMMANDS_LITERAL.INC,[e])},mul:function(e){return new s.UpdateCommand(s.UPDATE_COMMANDS_LITERAL.MUL,[e])},min:function(e){return new s.UpdateCommand(s.UPDATE_COMMANDS_LITERAL.MIN,[e])},max:function(e){return new s.UpdateCommand(s.UPDATE_COMMANDS_LITERAL.MAX,[e])},rename:function(e){return new s.UpdateCommand(s.UPDATE_COMMANDS_LITERAL.RENAME,[e])},bit:function(e){return new s.UpdateCommand(s.UPDATE_COMMANDS_LITERAL.BIT,[e])},push:function(e){var t,r,o={};if((0,l.isArray)(e))o.each=e;else if((0,l.isObject)(e)&&(0,l.isArray)(e.each)){var i=Object.keys(e);if(1===i.length)o=e;else{var a=!1;try{for(var c=n.__values(i),u=c.next();!u.done;u=c.next()){var p=u.value;if(!d.has(p)){a=!0;break}}}catch(e){t={error:e}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(t)throw t.error}}o=a?[e]:e}}else o.each=[e];return new s.UpdateCommand(s.UPDATE_COMMANDS_LITERAL.PUSH,[o])},pop:function(){return new s.UpdateCommand(s.UPDATE_COMMANDS_LITERAL.POP,[])},shift:function(){return new s.UpdateCommand(s.UPDATE_COMMANDS_LITERAL.SHIFT,[])},unshift:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=(0,l.isArray)(arguments[0])?arguments[0]:Array.from(arguments);return new s.UpdateCommand(s.UPDATE_COMMANDS_LITERAL.UNSHIFT,r)},addToSet:function(e){return new s.UpdateCommand(s.UPDATE_COMMANDS_LITERAL.ADD_TO_SET,[e])},pull:function(e){return new s.UpdateCommand(s.UPDATE_COMMANDS_LITERAL.PULL,[e])},pullAll:function(e){return new s.UpdateCommand(s.UPDATE_COMMANDS_LITERAL.PULL_ALL,[e])},project:{slice:function(e){return new c.ProjectionCommmand(c.PROJECTION_COMMANDS_LITERAL.SLICE,[e])}},aggregate:{pipeline:function(){return new u.Pipeline([])},abs:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.ABS,[e])},add:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.ADD,[e])},addToSet:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.ADDTOSET,[e])},allElementsTrue:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.ALLELEMENTSTRUE,[e])},and:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.AND,[e])},anyElementTrue:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.ANYELEMENTTRUE,[e])},arrayElemAt:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.ARRAYELEMAT,[e])},arrayToObject:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.ARRAYTOOBJECT,[e])},avg:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.AVG,[e])},ceil:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.CEIL,[e])},cmp:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.CMP,[e])},concat:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.CONCAT,[e])},concatArrays:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.CONCATARRAYS,[e])},cond:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.COND,[e])},convert:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.CONVERT,[e])},dateFromParts:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.DATEFROMPARTS,[e])},dateToParts:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.DATETOPARTS,[e])},dateFromString:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.DATEFROMSTRING,[e])},dateToString:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.DATETOSTRING,[e])},dayOfMonth:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.DAYOFMONTH,[e])},dayOfWeek:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.DAYOFWEEK,[e])},dayOfYear:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.DAYOFYEAR,[e])},divide:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.DIVIDE,[e])},eq:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.EQ,[e])},exp:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.EXP,[e])},filter:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.FILTER,[e])},first:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.FIRST,[e])},floor:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.FLOOR,[e])},gt:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.GT,[e])},gte:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.GTE,[e])},hour:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.HOUR,[e])},ifNull:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.IFNULL,[e])},in:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.IN,[e])},indexOfArray:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.INDEXOFARRAY,[e])},indexOfBytes:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.INDEXOFBYTES,[e])},indexOfCP:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.INDEXOFCP,[e])},isArray:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.ISARRAY,[e])},isoDayOfWeek:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.ISODAYOFWEEK,[e])},isoWeek:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.ISOWEEK,[e])},isoWeekYear:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.ISOWEEKYEAR,[e])},last:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.LAST,[e])},let:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.LET,[e])},literal:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.LITERAL,[e])},ln:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.LN,[e])},log:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.LOG,[e])},log10:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.LOG10,[e])},lt:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.LT,[e])},lte:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.LTE,[e])},ltrim:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.LTRIM,[e])},map:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.MAP,[e])},max:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.MAX,[e])},mergeObjects:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.MERGEOBJECTS,[e])},meta:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.META,[e])},min:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.MIN,[e])},millisecond:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.MILLISECOND,[e])},minute:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.MINUTE,[e])},mod:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.MOD,[e])},month:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.MONTH,[e])},multiply:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.MULTIPLY,[e])},neq:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.NEQ,[e])},not:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.NOT,[e])},objectToArray:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.OBJECTTOARRAY,[e])},or:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.OR,[e])},pow:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.POW,[e])},push:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.PUSH,[e])},range:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.RANGE,[e])},reduce:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.REDUCE,[e])},reverseArray:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.REVERSEARRAY,[e])},rtrim:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.RTRIM,[e])},second:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.SECOND,[e])},setDifference:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.SETDIFFERENCE,[e])},setEquals:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.SETEQUALS,[e])},setIntersection:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.SETINTERSECTION,[e])},setIsSubset:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.SETISSUBSET,[e])},setUnion:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.SETUNION,[e])},size:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.SIZE,[e])},slice:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.SLICE,[e])},split:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.SPLIT,[e])},sqrt:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.SQRT,[e])},stdDevPop:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.STDDEVPOP,[e])},stdDevSamp:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.STDDEVSAMP,[e])},strcasecmp:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.STRCASECMP,[e])},strLenBytes:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.STRLENBYTES,[e])},strLenCP:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.STRLENCP,[e])},substr:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.SUBSTR,[e])},substrBytes:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.SUBSTRBYTES,[e])},substrCP:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.SUBSTRCP,[e])},subtract:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.SUBTRACT,[e])},sum:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.SUM,[e])},switch:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.SWITCH,[e])},toBool:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.TOBOOL,[e])},toDate:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.TODATE,[e])},toDecimal:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.TODECIMAL,[e])},toDouble:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.TODOUBLE,[e])},toInt:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.TOINT,[e])},toLong:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.TOLONG,[e])},toObjectId:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.TOOBJECTID,[e])},toString:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.TOSTRING,[e])},toLower:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.TOLOWER,[e])},toUpper:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.TOUPPER,[e])},trim:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.TRIM,[e])},trunc:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.TRUNC,[e])},type:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.TYPE,[e])},week:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.WEEK,[e])},year:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.YEAR,[e])},zip:function(e){return new a.AggregateCommand(a.AGGREGATE_COMMANDS_LITERAL.ZIP,[e])}}},t.default=t.commands},"./src/services/database/api/database/commands/aggregate.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.LTRIM=t.LTE=t.LT=t.LOG10=t.LOG=t.LN=t.LITERAL=t.LET=t.LAST=t.ISOWEEKYEAR=t.ISOWEEK=t.ISODAYOFWEEK=t.ISARRAY=t.INDEXOFCP=t.INDEXOFBYTES=t.INDEXOFARRAY=t.IN=t.IFNULL=t.HOUR=t.GTE=t.GT=t.FLOOR=t.FIRST=t.FILTER=t.EXP=t.EQ=t.DIVIDE=t.DAYOFYEAR=t.DAYOFWEEK=t.DAYOFMONTH=t.DATETOSTRING=t.DATEFROMSTRING=t.DATETOPARTS=t.DATEFROMPARTS=t.CONVERT=t.COND=t.CONCATARRAYS=t.CONCAT=t.CMP=t.CEIL=t.AVG=t.ARRAYTOOBJECT=t.ARRAYELEMAT=t.ANYELEMENTTRUE=t.AND=t.ALLELEMENTSTRUE=t.ADDTOSET=t.ADD=t.ABS=t.AGGREGATE_COMMANDS_LITERAL=void 0,t.TOLOWER=t.TOSTRING=t.TOOBJECTID=t.TOLONG=t.TOINT=t.TODOUBLE=t.TODECIMAL=t.TODATE=t.TOBOOL=t.SWITCH=t.SUM=t.SUBTRACT=t.SUBSTRCP=t.SUBSTRBYTES=t.SUBSTR=t.STRLENCP=t.STRLENBYTES=t.STRCASECMP=t.STDDEVSAMP=t.STDDEVPOP=t.SQRT=t.SPLIT=t.SLICE=t.SIZE=t.SETUNION=t.SETISSUBSET=t.SETINTERSECTION=t.SETEQUALS=t.SETDIFFERENCE=t.SECOND=t.RTRIM=t.REVERSEARRAY=t.REDUCE=t.RANGE=t.PUSH=t.POW=t.OR=t.OBJECTTOARRAY=t.NOT=t.NEQ=t.MULTIPLY=t.MONTH=t.MOD=t.MINUTE=t.MILLISECOND=t.MIN=t.META=t.MERGEOBJECTS=t.MAX=t.MAP=void 0,t.isKnownAggregateCommand=t.isAggregateCommand=t.AggregateCommand=t.ZIP=t.YEAR=t.WEEK=t.TYPE=t.TRUNC=t.TRIM=t.TOUPPER=void 0;var n,o=r("./src/services/database/api/database/helper/symbol.ts");!function(e){e.ABS="abs",e.ADD="add",e.ADDTOSET="addToSet",e.ALLELEMENTSTRUE="allElementsTrue",e.AND="and",e.ANYELEMENTTRUE="anyElementTrue",e.ARRAYELEMAT="arrayElemAt",e.ARRAYTOOBJECT="arrayToObject",e.AVG="avg",e.CEIL="ceil",e.CMP="cmp",e.CONCAT="concat",e.CONCATARRAYS="concatArrays",e.COND="cond",e.CONVERT="convert",e.DATEFROMPARTS="dateFromParts",e.DATETOPARTS="dateToParts",e.DATEFROMSTRING="dateFromString",e.DATETOSTRING="dateToString",e.DAYOFMONTH="dayOfMonth",e.DAYOFWEEK="dayOfWeek",e.DAYOFYEAR="dayOfYear",e.DIVIDE="divide",e.EQ="eq",e.EXP="exp",e.FILTER="filter",e.FIRST="first",e.FLOOR="floor",e.GT="gt",e.GTE="gte",e.HOUR="hour",e.IFNULL="ifNull",e.IN="in",e.INDEXOFARRAY="indexOfArray",e.INDEXOFBYTES="indexOfBytes",e.INDEXOFCP="indexOfCP",e.ISARRAY="isArray",e.ISODAYOFWEEK="isoDayOfWeek",e.ISOWEEK="isoWeek",e.ISOWEEKYEAR="isoWeekYear",e.LAST="last",e.LET="let",e.LITERAL="literal",e.LN="ln",e.LOG="log",e.LOG10="log10",e.LT="lt",e.LTE="lte",e.LTRIM="ltrim",e.MAP="map",e.MAX="max",e.MERGEOBJECTS="mergeObjects",e.META="meta",e.MIN="min",e.MILLISECOND="millisecond",e.MINUTE="minute",e.MOD="mod",e.MONTH="month",e.MULTIPLY="multiply",e.NEQ="ne",e.NOT="not",e.OBJECTTOARRAY="objectToArray",e.OR="or",e.POW="pow",e.PUSH="push",e.RANGE="range",e.REDUCE="reduce",e.REVERSEARRAY="reverseArray",e.RTRIM="rtrim",e.SECOND="second",e.SETDIFFERENCE="setDifference",e.SETEQUALS="setEquals",e.SETINTERSECTION="setIntersection",e.SETISSUBSET="setIsSubset",e.SETUNION="setUnion",e.SIZE="size",e.SLICE="slice",e.SPLIT="split",e.SQRT="sqrt",e.STDDEVPOP="stdDevPop",e.STDDEVSAMP="stdDevSamp",e.STRCASECMP="strcasecmp",e.STRLENBYTES="strLenBytes",e.STRLENCP="strLenCP",e.SUBSTR="substr",e.SUBSTRBYTES="substrBytes",e.SUBSTRCP="substrCP",e.SUBTRACT="subtract",e.SUM="sum",e.SWITCH="switch",e.TOBOOL="toBool",e.TODATE="toDate",e.TODECIMAL="toDecimal",e.TODOUBLE="toDouble",e.TOINT="toInt",e.TOLONG="toLong",e.TOOBJECTID="toObjectId",e.TOSTRING="toString",e.TOLOWER="toLower",e.TOUPPER="toUpper",e.TRIM="trim",e.TRUNC="trunc",e.TYPE="type",e.WEEK="week",e.YEAR="year",e.ZIP="zip"}(n=t.AGGREGATE_COMMANDS_LITERAL||(t.AGGREGATE_COMMANDS_LITERAL={})),t.ABS=n.ABS,t.ADD=n.ADD,t.ADDTOSET=n.ADDTOSET,t.ALLELEMENTSTRUE=n.ALLELEMENTSTRUE,t.AND=n.AND,t.ANYELEMENTTRUE=n.ANYELEMENTTRUE,t.ARRAYELEMAT=n.ARRAYELEMAT,t.ARRAYTOOBJECT=n.ARRAYTOOBJECT,t.AVG=n.AVG,t.CEIL=n.CEIL,t.CMP=n.CMP,t.CONCAT=n.CONCAT,t.CONCATARRAYS=n.CONCATARRAYS,t.COND=n.COND,t.CONVERT=n.CONVERT,t.DATEFROMPARTS=n.DATEFROMPARTS,t.DATETOPARTS=n.DATETOPARTS,t.DATEFROMSTRING=n.DATEFROMSTRING,t.DATETOSTRING=n.DATETOSTRING,t.DAYOFMONTH=n.DAYOFMONTH,t.DAYOFWEEK=n.DAYOFWEEK,t.DAYOFYEAR=n.DAYOFYEAR,t.DIVIDE=n.DIVIDE,t.EQ=n.EQ,t.EXP=n.EXP,t.FILTER=n.FILTER,t.FIRST=n.FIRST,t.FLOOR=n.FLOOR,t.GT=n.GT,t.GTE=n.GTE,t.HOUR=n.HOUR,t.IFNULL=n.IFNULL,t.IN=n.IN,t.INDEXOFARRAY=n.INDEXOFARRAY,t.INDEXOFBYTES=n.INDEXOFBYTES,t.INDEXOFCP=n.INDEXOFCP,t.ISARRAY=n.ISARRAY,t.ISODAYOFWEEK=n.ISODAYOFWEEK,t.ISOWEEK=n.ISOWEEK,t.ISOWEEKYEAR=n.ISOWEEKYEAR,t.LAST=n.LAST,t.LET=n.LET,t.LITERAL=n.LITERAL,t.LN=n.LN,t.LOG=n.LOG,t.LOG10=n.LOG10,t.LT=n.LT,t.LTE=n.LTE,t.LTRIM=n.LTRIM,t.MAP=n.MAP,t.MAX=n.MAX,t.MERGEOBJECTS=n.MERGEOBJECTS,t.META=n.META,t.MIN=n.MIN,t.MILLISECOND=n.MILLISECOND,t.MINUTE=n.MINUTE,t.MOD=n.MOD,t.MONTH=n.MONTH,t.MULTIPLY=n.MULTIPLY,t.NEQ=n.NEQ,t.NOT=n.NOT,t.OBJECTTOARRAY=n.OBJECTTOARRAY,t.OR=n.OR,t.POW=n.POW,t.PUSH=n.PUSH,t.RANGE=n.RANGE,t.REDUCE=n.REDUCE,t.REVERSEARRAY=n.REVERSEARRAY,t.RTRIM=n.RTRIM,t.SECOND=n.SECOND,t.SETDIFFERENCE=n.SETDIFFERENCE,t.SETEQUALS=n.SETEQUALS,t.SETINTERSECTION=n.SETINTERSECTION,t.SETISSUBSET=n.SETISSUBSET,t.SETUNION=n.SETUNION,t.SIZE=n.SIZE,t.SLICE=n.SLICE,t.SPLIT=n.SPLIT,t.SQRT=n.SQRT,t.STDDEVPOP=n.STDDEVPOP,t.STDDEVSAMP=n.STDDEVSAMP,t.STRCASECMP=n.STRCASECMP,t.STRLENBYTES=n.STRLENBYTES,t.STRLENCP=n.STRLENCP,t.SUBSTR=n.SUBSTR,t.SUBSTRBYTES=n.SUBSTRBYTES,t.SUBSTRCP=n.SUBSTRCP,t.SUBTRACT=n.SUBTRACT,t.SUM=n.SUM,t.SWITCH=n.SWITCH,t.TOBOOL=n.TOBOOL,t.TODATE=n.TODATE,t.TODECIMAL=n.TODECIMAL,t.TODOUBLE=n.TODOUBLE,t.TOINT=n.TOINT,t.TOLONG=n.TOLONG,t.TOOBJECTID=n.TOOBJECTID,t.TOSTRING=n.TOSTRING,t.TOLOWER=n.TOLOWER,t.TOUPPER=n.TOUPPER,t.TRIM=n.TRIM,t.TRUNC=n.TRUNC,t.TYPE=n.TYPE,t.WEEK=n.WEEK,t.YEAR=n.YEAR,t.ZIP=n.ZIP;var i=function(){function e(e,t,r){this._internalType=o.SYMBOL_AGGREGATE_COMMAND,Object.defineProperties(this,{_internalType:{enumerable:!1,configurable:!1}}),this.operator=e,this.operands=t,this.fieldName=r||o.SYMBOL_UNSET_FIELD_NAME}return e.prototype._setFieldName=function(t){return new e(this.operator,this.operands,t)},e}();function s(e){return e&&e instanceof i&&e._internalType===o.SYMBOL_AGGREGATE_COMMAND}t.AggregateCommand=i,t.isAggregateCommand=s,t.isKnownAggregateCommand=function(e){return s(e)&&e.operator.toUpperCase()in n},t.default=i},"./src/services/database/api/database/commands/logic.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.isKnownLogicCommand=t.isLogicCommand=t.LogicCommmand=t.logicCommandsSet=t.LOGIC_COMMANDS_LITERAL=void 0;var n,o=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),i=r("./src/services/database/api/database/helper/symbol.ts"),s=r("./src/utils/assert.ts"),a=r("./src/utils/type.ts");!function(e){e.AND="and",e.OR="or",e.NOT="not",e.NOR="nor"}(n=t.LOGIC_COMMANDS_LITERAL||(t.LOGIC_COMMANDS_LITERAL={}));var c=[n.AND,n.OR,n.NOT,n.NOR];t.logicCommandsSet=new Set(c);var u=function(){function e(e,t,r){this._internalType=i.SYMBOL_LOGIC_COMMAND,Object.defineProperties(this,{_internalType:{enumerable:!1,configurable:!1}}),this.operator=e,this.operands=t,this.fieldName=r||i.SYMBOL_UNSET_FIELD_NAME}return e.prototype._setFieldName=function(t){var r=this.operands.map(function(e){return e===n.AND||e===n.OR?e._setFieldName(t):e});return new e(this.operator,r,t)},e.prototype.and=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];(0,s.assertRequiredParam)(arguments[0],"expressions","and");var i=(0,a.isArray)(arguments[0])?arguments[0]:Array.from(arguments);return new e(n.AND,o.__spreadArray([this],o.__read(i),!1),this.fieldName)},e.prototype.or=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];(0,s.assertRequiredParam)(arguments[0],"expressions","or");var i=(0,a.isArray)(arguments[0])?arguments[0]:Array.from(arguments);return new e(n.OR,o.__spreadArray([this],o.__read(i),!1),this.fieldName)},e.prototype.nor=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];(0,s.assertRequiredParam)(arguments[0],"expressions","nor");var i=(0,a.isArray)(arguments[0])?arguments[0]:Array.from(arguments);return new e(n.NOR,o.__spreadArray([this],o.__read(i),!1),this.fieldName)},e.prototype.not=function(t){return(0,s.assertRequiredParam)(t,"expression","not"),new e(n.NOT,[t],this.fieldName)},e.prototype.toJSON=function(){},e}();function l(e){return e&&e instanceof u&&e._internalType===i.SYMBOL_LOGIC_COMMAND}t.LogicCommmand=u,t.isLogicCommand=l,t.isKnownLogicCommand=function(e){return l(e)&&t.logicCommandsSet.has(e.operator)},t.default=u},"./src/services/database/api/database/commands/projection.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.isProjectionCommand=t.ProjectionCommmand=t.projectionCommandsSet=t.PROJECTION_COMMANDS_LITERAL=t.SLICE=void 0;var n,o=r("./src/services/database/api/database/helper/symbol.ts");t.SLICE="slice",function(e){e.SLICE="slice"}(n=t.PROJECTION_COMMANDS_LITERAL||(t.PROJECTION_COMMANDS_LITERAL={})),t.projectionCommandsSet=new Set([n.SLICE]);var i=function(){function e(e,t,r){this._internalType=o.SYMBOL_PROJECT_COMMAND,this.operator=e,this.operands=t,this.fieldName=r||o.SYMBOL_UNSET_FIELD_NAME}return e.prototype._setFieldName=function(t){return new e(this.operator,this.operands,t)},e}();t.ProjectionCommmand=i,t.isProjectionCommand=function(e){return e&&e instanceof i&&e._internalType===o.SYMBOL_PROJECT_COMMAND},t.default=i},"./src/services/database/api/database/commands/query.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.isComparisonCommand=t.isKnownQueryCommand=t.isQueryCommand=t.QueryCommmand=t.queryCommandsSet=t.QUERY_COMMANDS_LITERAL=void 0;var n,o=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),i=r("./src/services/database/api/database/commands/logic.ts"),s=r("./src/services/database/api/database/helper/symbol.ts"),a=r("./src/utils/assert.ts");!function(e){e.EQ="eq",e.NEQ="neq",e.GT="gt",e.GTE="gte",e.LT="lt",e.LTE="lte",e.IN="in",e.NIN="nin",e.GEO_NEAR="geoNear",e.GEO_WITHIN="geoWithin",e.GEO_INTERSECTS="geoIntersects",e.EXISTS="exists",e.MOD="mod",e.ALL="all",e.ELEM_MATCH="elemMatch",e.SIZE="size",e.EXPR="expr"}(n=t.QUERY_COMMANDS_LITERAL||(t.QUERY_COMMANDS_LITERAL={}));var c=[n.EQ,n.NEQ,n.GT,n.GTE,n.LT,n.LTE,n.IN,n.NIN,n.GEO_NEAR,n.GEO_WITHIN,n.GEO_INTERSECTS,n.EXISTS,n.MOD,n.ALL,n.ELEM_MATCH,n.SIZE];t.queryCommandsSet=new Set(c);new Set(o.__spreadArray(o.__spreadArray([],o.__read(t.queryCommandsSet),!1),o.__read(i.logicCommandsSet),!1));var u=function(e){function t(t,r,n){var o=e.call(this,t,r,n)||this;return o.operator=t,o._internalType=s.SYMBOL_QUERY_COMMAND,o}return o.__extends(t,e),t.prototype._setFieldName=function(e){return new t(this.operator,this.operands,e)},t.prototype.eq=function(e){var r=new t(n.EQ,[e],this.fieldName);return this.and(r)},t.prototype.neq=function(e){var r=new t(n.NEQ,[e],this.fieldName);return this.and(r)},t.prototype.gt=function(e){var r=new t(n.GT,[e],this.fieldName);return this.and(r)},t.prototype.gte=function(e){var r=new t(n.GTE,[e],this.fieldName);return this.and(r)},t.prototype.lt=function(e){var r=new t(n.LT,[e],this.fieldName);return this.and(r)},t.prototype.lte=function(e){var r=new t(n.LTE,[e],this.fieldName);return this.and(r)},t.prototype.in=function(e){(0,a.assertType)(e,"array");var r=new t(n.IN,e,this.fieldName);return this.and(r)},t.prototype.nin=function(e){(0,a.assertType)(e,"array");var r=new t(n.NIN,e,this.fieldName);return this.and(r)},t.prototype.geoNear=function(e){var r=new t(n.GEO_NEAR,[e],this.fieldName);return this.and(r)},t.prototype.geoWithin=function(e){var r=new t(n.GEO_WITHIN,[e],this.fieldName);return this.and(r)},t.prototype.geoIntersects=function(e){var r=new t(n.GEO_INTERSECTS,[e],this.fieldName);return this.and(r)},t.prototype.exists=function(e){var r=new t(n.EXISTS,[e],this.fieldName);return this.and(r)},t.prototype.mod=function(e,r){var o=new t(n.MOD,[e,r],this.fieldName);return this.and(o)},t.prototype.all=function(e){var r=new t(n.ALL,e,this.fieldName);return this.and(r)},t.prototype.elemMatch=function(e){var r=new t(n.ELEM_MATCH,[e],this.fieldName);return this.and(r)},t.prototype.size=function(e){var r=new t(n.SIZE,[e],this.fieldName);return this.and(r)},t}(i.LogicCommmand);function l(e){return e&&e instanceof u&&e._internalType===s.SYMBOL_QUERY_COMMAND}t.QueryCommmand=u,t.isQueryCommand=l,t.isKnownQueryCommand=function(e){return l(e)&&t.queryCommandsSet.has(e.operator)},t.isComparisonCommand=function(e){return l(e)},t.default=u},"./src/services/database/api/database/commands/update.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.isKnownUpdateCommand=t.isUpdateCommand=t.UpdateCommand=t.updateCommandsSet=t.UPDATE_COMMANDS_LITERAL=void 0;var n,o=r("./src/services/database/api/database/helper/symbol.ts");!function(e){e.SET="set",e.REMOVE="remove",e.INC="inc",e.MUL="mul",e.MIN="min",e.MAX="max",e.RENAME="rename",e.BIT="bit",e.PUSH="push",e.POP="pop",e.SHIFT="shift",e.UNSHIFT="unshift",e.ADD_TO_SET="addToSet",e.PULL="pull",e.PULL_ALL="pullAll"}(n=t.UPDATE_COMMANDS_LITERAL||(t.UPDATE_COMMANDS_LITERAL={})),t.updateCommandsSet=new Set([n.SET,n.REMOVE,n.INC,n.MUL,n.MIN,n.MAX,n.RENAME,n.BIT,n.PUSH,n.POP,n.SHIFT,n.UNSHIFT,n.ADD_TO_SET,n.PULL,n.PULL_ALL]);var i=function(){function e(e,t,r){this._internalType=o.SYMBOL_UPDATE_COMMAND,Object.defineProperties(this,{_internalType:{enumerable:!1,configurable:!1}}),this.operator=e,this.operands=t,this.fieldName=r||o.SYMBOL_UNSET_FIELD_NAME}return e.prototype._setFieldName=function(t){return new e(this.operator,this.operands,t)},e.prototype.toJSON=function(){},e}();function s(e){return e&&e instanceof i&&e._internalType===o.SYMBOL_UPDATE_COMMAND}t.UpdateCommand=i,t.isUpdateCommand=s,t.isKnownUpdateCommand=function(e){return s(e)&&t.updateCommandsSet.has(e.operator)},t.default=i},"./src/services/database/api/database/date.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js").__exportStar(r("./src/services/database/api/database/date/serverDate.ts"),t)},"./src/services/database/api/database/date/serverDate.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.ServerDate=t.serverDate=void 0;var n=r("./src/services/database/api/database/helper/symbol.ts"),o=r("./src/utils/assert.ts");t.serverDate=function(e){return new i(e)};var i=function(){function e(e){void 0===e&&(e={offset:0}),(0,o.assertType)(e,"object","serverDate.options"),this.options=e}return Object.defineProperty(e.prototype,"_internalType",{get:function(){return n.SYMBOL_SERVER_DATE},enumerable:!1,configurable:!0}),e.prototype.toJSON=function(){return{$date:this.options}},e}();t.ServerDate=i},"./src/services/database/api/database/document.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getDocumentReferenceClass=void 0;var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),o=r("./src/hook/invoke.ts"),i=r("./src/services/database/internal/backend-api/backend-api.ts"),s=r("./src/utils/msg.ts"),a=r("./src/utils/error.ts"),c=r("./src/utils/assert.ts"),u=r("./src/utils/report.ts"),l=r("./src/config/error.config.ts"),d=r("./src/services/database/api/database/realtime/websocket-client.ts");t.getDocumentReferenceClass=function(e){return function(){function t(t,r){var o=this;if(this.watch=function(t){return(0,c.assertType)(t,{onChange:"function",onError:"function"}),e.serviceContext.ws||(e.serviceContext.ws=new d.RealtimeWebSocketClient({serviceContext:e.serviceContext})),e.serviceContext.ws.watch(n.__assign(n.__assign({},t),{envId:e.database.config.env||e.serviceContext.env,collectionName:o.collection.collectionName,query:JSON.stringify({_id:o._id}),queryType:i.QUERY_TYPE.DOC,reportAPIName:"cloud.db.document.watch"}))},this.collection=t,this._id=r,null===r||void 0===r)throw new a.CloudSDKError({errCode:l.ERR_CODE.SDK_API_PARAMETER_TYPE_ERROR,errMsg:"docId must not be null or undefined"});Object.defineProperties(this,{_field:{enumerable:!1,configurable:!1,writable:!0}}),this._field={}}return t.prototype.field=function(e){return(0,c.assertRequiredParam)(e,"object","field"),(0,c.assertType)(e,"object","field"),this._field=e,this},t.prototype.get=function(t){var r=this,c={apiStartTime:+new Date},l=(0,o.hasAPICallback)(t),d=new Promise(function(t,o){return n.__awaiter(r,void 0,void 0,function(){var l,d,p;return n.__generator(this,function(f){switch(f.label){case 0:return f.trys.push([0,2,3,4]),l=this._id,[4,(0,i.queryDocument)({env:e.database.config.env,collectionName:r.collection.collectionName,query:e.engine.QuerySerializer.encode({_id:r._id}),options:{projection:e.engine.ProjectionSerializer.encode(r._field)},queryType:i.QUERY_TYPE.DOC,instanceContext:e,timing:c})];case 1:if(!(d=f.sent()).list||!d.list.length)throw new Error("cannot find document with _id ".concat(l,", ")+"please make sure that the document exists and you have the corresponding access permission");return t({data:d.list[0],errMsg:(0,s.apiSuccessMsg)("document.get")}),[3,4];case 2:return p=f.sent(),o((0,a.returnAsFinalCloudSDKError)(p,"document.get")),[3,4];case 3:return(0,u.reportAPISpeed)(n.__assign(n.__assign({},c),{apiEndTime:+new Date,apiName:"cloud.db.".concat("document.get")})),[7];case 4:return[2]}})})});if(!l)return d;d.then(function(e){(0,o.invokeSuccessCompleteCallbacks)("document.get",t,e)}).catch(function(e){(0,o.invokeFailCompleteCallbacks)("document.get",t,e)})},t.prototype.set=function(t){var r=this,l={apiStartTime:+new Date},d=(0,o.hasAPICallback)(t),p=new Promise(function(o,d){return n.__awaiter(r,void 0,void 0,function(){var p,f;return n.__generator(this,function(_){switch(_.label){case 0:return _.trys.push([0,2,3,4]),(0,c.assertType)(t,{data:"object"}),(0,c.assertObjectNotEmpty)({name:"options.data",target:t.data}),[4,(0,i.setDocument)({env:e.database.config.env,collectionName:r.collection.collectionName,_id:r._id,data:e.engine.encodeInternalDataType(t.data),options:{},instanceContext:e,timing:l})];case 1:return p=_.sent(),o({_id:p._id,errMsg:(0,s.apiSuccessMsg)("document.set"),stats:{updated:p.updated,created:p.created}}),[3,4];case 2:return f=_.sent(),d((0,a.returnAsFinalCloudSDKError)(f,"document.set")),[3,4];case 3:return(0,u.reportAPISpeed)(n.__assign(n.__assign({},l),{apiEndTime:+new Date,apiName:"cloud.db.".concat("document.set")})),[7];case 4:return[2]}})})});if(!d)return p;p.then(function(e){(0,o.invokeSuccessCompleteCallbacks)("document.set",t,e)}).catch(function(e){(0,o.invokeFailCompleteCallbacks)("document.set",t,e)})},t.prototype.update=function(t){var r=this,l={apiStartTime:+new Date},d=(0,o.hasAPICallback)(t),p=new Promise(function(o,d){return n.__awaiter(r,void 0,void 0,function(){var p,f;return n.__generator(this,function(_){switch(_.label){case 0:return _.trys.push([0,2,3,4]),(0,c.assertType)(t,{data:"object"}),(0,c.assertObjectNotEmpty)({name:"options.data",target:t.data}),[4,(0,i.updateDocument)({env:e.database.config.env,collectionName:r.collection.collectionName,query:e.engine.QuerySerializer.encode({_id:r._id}),data:e.engine.UpdateSerializer.encode(t.data),queryType:i.QUERY_TYPE.DOC,options:{multi:!1,merge:!1},instanceContext:e,timing:l})];case 1:return p=_.sent(),o({stats:{updated:p.updated},errMsg:(0,s.apiSuccessMsg)("document.update")}),[3,4];case 2:return f=_.sent(),d((0,a.returnAsFinalCloudSDKError)(f,"document.update")),[3,4];case 3:return(0,u.reportAPISpeed)(n.__assign(n.__assign({},l),{apiEndTime:+new Date,apiName:"cloud.db.".concat("document.update")})),[7];case 4:return[2]}})})});if(!d)return p;p.then(function(e){(0,o.invokeSuccessCompleteCallbacks)("document.update",t,e)}).catch(function(e){(0,o.invokeFailCompleteCallbacks)("document.update",t,e)})},t.prototype.remove=function(t){var r=this,c={apiStartTime:+new Date},l=(0,o.hasAPICallback)(t),d=new Promise(function(t,o){return n.__awaiter(r,void 0,void 0,function(){var l,d,p;return n.__generator(this,function(f){switch(f.label){case 0:return f.trys.push([0,2,3,4]),l=this._id,[4,(0,i.removeDocument)({env:e.database.config.env,collectionName:r.collection.collectionName,query:e.engine.QuerySerializer.encode({_id:r._id}),queryType:i.QUERY_TYPE.DOC,options:{},instanceContext:e,timing:c})];case 1:if(0===(d=f.sent()).removed)throw new Error("cannot remove document with _id ".concat(l,", ")+"please make sure that the document exists and you have the corresponding Write permission");return t({stats:{removed:d.removed||0},errMsg:(0,s.apiSuccessMsg)("document.remove")}),[3,4];case 2:return p=f.sent(),o((0,a.returnAsFinalCloudSDKError)(p,"document.remove")),[3,4];case 3:return(0,u.reportAPISpeed)(n.__assign(n.__assign({},c),{apiEndTime:+new Date,apiName:"cloud.db.".concat("document.remove")})),[7];case 4:return[2]}})})});if(!l)return d;d.then(function(e){(0,o.invokeSuccessCompleteCallbacks)("document.remove",t,e)}).catch(function(e){(0,o.invokeFailCompleteCallbacks)("document.remove",t,e)})},t.prototype.toJSON=function(){},t}()}},"./src/services/database/api/database/geo.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.__safe_props__=void 0;var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js");n.__exportStar(r("./src/services/database/api/database/geo/point.ts"),t),n.__exportStar(r("./src/services/database/api/database/geo/multipoint.ts"),t),n.__exportStar(r("./src/services/database/api/database/geo/linestring.ts"),t),n.__exportStar(r("./src/services/database/api/database/geo/multilinestring.ts"),t),n.__exportStar(r("./src/services/database/api/database/geo/polygon.ts"),t),n.__exportStar(r("./src/services/database/api/database/geo/multipolygon.ts"),t);t.__safe_props__=void 0},"./src/services/database/api/database/geo/linestring.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.GeoLineString=t.LineString=void 0;var n=r("./src/services/database/api/database/helper/symbol.ts"),o=r("./src/services/database/api/database/helper/geojson.ts");t.LineString=function(e){return(0,o.isGeoJSONLineString)(e)?(0,o.toLineString)(e):new i(e)};var i=function(){function e(e){this._internalType=n.SYMBOL_GEO_LINESTRING,Object.defineProperties(this,{_internalType:{enumerable:!1,configurable:!1}}),this.points=e}return e.prototype.toJSON=function(){return(0,o.toGeoJSONLineString)(this)},e.prototype.toString=function(){return JSON.stringify(this.toJSON())},e}();t.GeoLineString=i},"./src/services/database/api/database/geo/multilinestring.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.GeoMultiLineString=t.MultiLineString=void 0;var n=r("./src/services/database/api/database/helper/symbol.ts"),o=r("./src/services/database/api/database/helper/geojson.ts");t.MultiLineString=function(e){return(0,o.isGeoJSONMultiLineString)(e)?(0,o.toMultiLineString)(e):new i(e)};var i=function(){function e(e){this._internalType=n.SYMBOL_GEO_MULTILINESTRING,Object.defineProperties(this,{_internalType:{enumerable:!1,configurable:!1}}),this.lines=e}return e.prototype.toJSON=function(){return(0,o.toGeoJSONMultiLineString)(this)},e.prototype.toString=function(){return JSON.stringify(this.toJSON())},e}();t.GeoMultiLineString=i},"./src/services/database/api/database/geo/multipoint.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.GeoMultiPoint=t.MultiPoint=void 0;var n=r("./src/services/database/api/database/helper/symbol.ts"),o=r("./src/services/database/api/database/helper/geojson.ts");t.MultiPoint=function(e){return(0,o.isGeoJSONMultiPoint)(e)?(0,o.toMultiPoint)(e):new i(e)};var i=function(){function e(e){this._internalType=n.SYMBOL_GEO_MULTIPOINT,Object.defineProperties(this,{_internalType:{enumerable:!1,configurable:!1}}),this.points=e}return e.prototype.toJSON=function(){return(0,o.toGeoJSONMultiPoint)(this)},e.prototype.toString=function(){return JSON.stringify(this.toJSON())},e}();t.GeoMultiPoint=i},"./src/services/database/api/database/geo/multipolygon.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.GeoMultiPolygon=t.MultiPolygon=void 0;var n=r("./src/services/database/api/database/helper/symbol.ts"),o=r("./src/services/database/api/database/helper/geojson.ts");t.MultiPolygon=function(e){return(0,o.isGeoJSONMultiPolygon)(e)?(0,o.toMultiPolygon)(e):new i(e)};var i=function(){function e(e){this._internalType=n.SYMBOL_GEO_MULTIPOLYGON,Object.defineProperties(this,{_internalType:{enumerable:!1,configurable:!1}}),this.polygons=e}return e.prototype.toJSON=function(){return(0,o.toGeoJSONMultiPolygon)(this)},e.prototype.toString=function(){return JSON.stringify(this.toJSON())},e}();t.GeoMultiPolygon=i},"./src/services/database/api/database/geo/point.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.GeoPoint=t.Point=void 0;var n=r("./src/services/database/api/database/helper/symbol.ts"),o=r("./src/utils/assert.ts"),i=r("./src/utils/error.ts"),s=r("./src/services/database/api/database/helper/geojson.ts");t.Point=function(e,t){return(0,s.isGeoJSONPoint)(e)?(0,s.toPoint)(e):new a(e,t)};var a=function(){function e(e,t){this._internalType=n.SYMBOL_GEO_POINT,Object.defineProperties(this,{_internalType:{enumerable:!1,configurable:!1}});var r=e,s=t;Object.defineProperties(this,{longitude:{enumerable:!0,configurable:!1,get:function(){return r},set:function(e){if((0,o.assertType)(e,"number","longitude"),e>180||e<-180)throw new i.CloudSDKError({errMsg:"longitude should be a number ranges from -180 to 180"})}},latitude:{enumerable:!0,configurable:!1,get:function(){return s},set:function(e){if((0,o.assertType)(e,"number","latitude"),e>90||e<-90)throw new i.CloudSDKError({errMsg:"latitude should be a number ranges from -90 to 90"})}}}),this.longitude=r,this.latitude=s}return e.prototype.toJSON=function(){return(0,s.toGeoJSONPoint)(this)},e.prototype.toString=function(){return JSON.stringify(this.toJSON())},e}();t.GeoPoint=a},"./src/services/database/api/database/geo/polygon.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.GeoPolygon=t.Polygon=void 0;var n=r("./src/services/database/api/database/helper/symbol.ts"),o=r("./src/services/database/api/database/helper/geojson.ts");t.Polygon=function(e){return(0,o.isGeoJSONPolygon)(e)?(0,o.toPolygon)(e):new i(e)};var i=function(){function e(e){this._internalType=n.SYMBOL_GEO_POLYGON,Object.defineProperties(this,{_internalType:{enumerable:!1,configurable:!1}}),this.lines=e}return e.prototype.toJSON=function(){return(0,o.toGeoJSONPolygon)(this)},e.prototype.toString=function(){return JSON.stringify(this.toJSON())},e}();t.GeoPolygon=i},"./src/services/database/api/database/helper/geojson.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.isMultiPolygonCoordinates=t.isPolygonCoordinates=t.isMultiLineStringCoordinates=t.isLineStringCoordinates=t.isMultiPointCoordinates=t.isPointCoordinates=t.isGeoJSONMultiPolygon=t.isGeoJSONPolygon=t.isGeoJSONMultiLineString=t.isGeoJSONLineString=t.isGeoJSONMultiPoint=t.isGeoJSONPoint=t.toGeoJSONMultiPolygon=t.toGeoJSONPolygon=t.toGeoJSONMultiLineString=t.toGeoJSONLineString=t.toGeoJSONMultiPoint=t.toGeoJSONPoint=t.toMultiPolygon=t.toPolygon=t.toMultiLineString=t.toLineString=t.toMultiPoint=t.toPoint=t.fromGeoJSON=void 0;var n=r("./src/services/database/api/database/geo.ts"),o=r("./src/utils/type.ts"),i=r("./src/utils/error.ts");function s(e){return(0,n.Point)(e.coordinates[0],e.coordinates[1])}function a(e){return(0,n.MultiPoint)(e.coordinates.map(function(e){return(0,n.Point)(e[0],e[1])}))}function c(e){return(0,n.LineString)(e.coordinates.map(function(e){return(0,n.Point)(e[0],e[1])}))}function u(e){return(0,n.MultiLineString)(e.coordinates.map(function(e){return(0,n.LineString)(e.map(function(e){return(0,n.Point)(e[0],e[1])}))}))}function l(e){return(0,n.Polygon)(e.coordinates.map(function(e){return(0,n.LineString)(e.map(function(e){return(0,n.Point)(e[0],e[1])}))}))}function d(e){return(0,n.MultiPolygon)(e.coordinates.map(function(e){return(0,n.Polygon)(e.map(function(e){return(0,n.LineString)(e.map(function(e){return(0,n.Point)(e[0],e[1])}))}))}))}function p(e){return(0,o.isArray)(e)&&(0,o.isNumber)(e[0])&&(0,o.isNumber)(e[1])}function f(e){return(0,o.isArray)(e)&&e.every(p)}function _(e){return f(e)}function m(e){return(0,o.isArray)(e)&&e.every(_)}function h(e){return m(e)}function g(e){return(0,o.isArray)(e)&&e.every(h)}t.fromGeoJSON=function(e){switch(e.type){case"Point":return s(e);case"MultiPoint":return a(e);case"LineString":return c(e);case"MultiLineString":return u(e);case"Polygon":return l(e);case"MultiPolygon":return d(e);default:throw new i.CloudSDKError({errCode:-1,errMsg:"Invalid GeoJSON input"})}},t.toPoint=s,t.toMultiPoint=a,t.toLineString=c,t.toMultiLineString=u,t.toPolygon=l,t.toMultiPolygon=d,t.toGeoJSONPoint=function(e){return{type:"Point",coordinates:[e.longitude,e.latitude]}},t.toGeoJSONMultiPoint=function(e){return{type:"MultiPoint",coordinates:e.points.map(function(e){return[e.longitude,e.latitude]})}},t.toGeoJSONLineString=function(e){return{type:"LineString",coordinates:e.points.map(function(e){return[e.longitude,e.latitude]})}},t.toGeoJSONMultiLineString=function(e){return{type:"MultiLineString",coordinates:e.lines.map(function(e){return e.points.map(function(e){return[e.longitude,e.latitude]})})}},t.toGeoJSONPolygon=function(e){return{type:"Polygon",coordinates:e.lines.map(function(e){return e.points.map(function(e){return[e.longitude,e.latitude]})})}},t.toGeoJSONMultiPolygon=function(e){return{type:"MultiPolygon",coordinates:e.polygons.map(function(e){return e.lines.map(function(e){return e.points.map(function(e){return[e.longitude,e.latitude]})})})}},t.isGeoJSONPoint=function(e){return(0,o.isObject)(e)&&p(e.coordinates)},t.isGeoJSONMultiPoint=function(e){return(0,o.isObject)(e)&&f(e.coordinates)},t.isGeoJSONLineString=function(e){return(0,o.isObject)(e)&&_(e.coordinates)},t.isGeoJSONMultiLineString=function(e){return(0,o.isObject)(e)&&m(e.coordinates)},t.isGeoJSONPolygon=function(e){return(0,o.isObject)(e)&&h(e.coordinates)},t.isGeoJSONMultiPolygon=function(e){return(0,o.isObject)(e)&&g(e.coordinates)},t.isPointCoordinates=p,t.isMultiPointCoordinates=f,t.isLineStringCoordinates=_,t.isMultiLineStringCoordinates=m,t.isPolygonCoordinates=h,t.isMultiPolygonCoordinates=g},"./src/services/database/api/database/helper/symbol.ts":function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SYMBOL_REGEXP=t.SYMBOL_SERVER_DATE=t.SYMBOL_GEO_MULTIPOLYGON=t.SYMBOL_GEO_MULTILINESTRING=t.SYMBOL_GEO_MULTIPOINT=t.SYMBOL_GEO_POLYGON=t.SYMBOL_GEO_LINESTRING=t.SYMBOL_GEO_POINT=t.SYMBOL_PROJECT_COMMAND=t.SYMBOL_AGGREGATE_COMMAND=t.SYMBOL_LOGIC_COMMAND=t.SYMBOL_QUERY_COMMAND=t.SYMBOL_UPDATE_COMMAND=t.SYMBOL_AGGREGATE_PIPELINE_STAGE=t.SYMBOL_AGGREGATE_PIPELINE=t.SYMBOL_AGGREGATE=t.SYMBOL_UNSET_FIELD_NAME=void 0,t.SYMBOL_UNSET_FIELD_NAME=Symbol.for("UNSET_FIELD_NAME"),t.SYMBOL_AGGREGATE=Symbol.for("AGGREGATE"),t.SYMBOL_AGGREGATE_PIPELINE=Symbol.for("AGGREGATE_PIPELINE"),t.SYMBOL_AGGREGATE_PIPELINE_STAGE=Symbol.for("AGGREGATE_PIPELINE_STAGE"),t.SYMBOL_UPDATE_COMMAND=Symbol.for("UPDATE_COMMAND"),t.SYMBOL_QUERY_COMMAND=Symbol.for("QUERY_COMMAND"),t.SYMBOL_LOGIC_COMMAND=Symbol.for("LOGIC_COMMAND"),t.SYMBOL_AGGREGATE_COMMAND=Symbol.for("AGGREGATE_COMMAND"),t.SYMBOL_PROJECT_COMMAND=Symbol.for("PROJECT_COMMAND"),t.SYMBOL_GEO_POINT=Symbol.for("GEO_POINT"),t.SYMBOL_GEO_LINESTRING=Symbol.for("GEO_LINESTRING"),t.SYMBOL_GEO_POLYGON=Symbol.for("GEO_POLYGON"),t.SYMBOL_GEO_MULTIPOINT=Symbol.for("GEO_MULTIPOINT"),t.SYMBOL_GEO_MULTILINESTRING=Symbol.for("GEO_MULTILINESTRING"),t.SYMBOL_GEO_MULTIPOLYGON=Symbol.for("GEO_MULTIPOLYGON"),t.SYMBOL_SERVER_DATE=Symbol.for("SERVER_DATE"),t.SYMBOL_REGEXP=Symbol.for("REGEXP")},"./src/services/database/api/database/query.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getQueryClass=t.ORDER_DIRECTION=void 0;var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),o=r("./src/utils/msg.ts"),i=r("./src/services/database/internal/grammar/default/extractor.ts"),s=r("./src/utils/assert.ts"),a=r("./src/services/database/internal/backend-api/backend-api.ts"),c=r("./src/hook/invoke.ts"),u=r("./src/utils/error.ts"),l=r("./src/utils/report.ts"),d=r("./src/services/database/api/database/command.ts"),p=r("./src/externals/globals/wxconfig.ts"),f=r("./src/services/database/api/database/realtime/websocket-client.ts"),_=r("./src/config/error.config.ts");!function(e){e.ASC="asc",e.DESC="desc"}(t.ORDER_DIRECTION||(t.ORDER_DIRECTION={}));t.getQueryClass=function(e){var t=function(){function t(t,o){var i=this;if(this.watch=function(t){return(0,s.assertType)(t,{onChange:"function",onError:"function"}),e.serviceContext.ws||(e.serviceContext.ws=new f.RealtimeWebSocketClient({serviceContext:e.serviceContext})),e.serviceContext.ws.watch(n.__assign(n.__assign({},t),{envId:e.database.config.env||e.serviceContext.env,collectionName:i.collectionName,query:JSON.stringify(e.engine.QuerySerializer.encode(i._query.where||{})),limit:i._query.limit,orderBy:i._query.order?i._query.order.reduce(function(e,t){return e[t.fieldPath]=t.order,e},{}):void 0,queryType:a.QUERY_TYPE.WHERE,reportAPIName:"cloud.db.collection.watch"}))},!t)throw new u.CloudSDKError({errCode:_.ERR_CODE.SDK_API_PARAMETER_TYPE_ERROR,errMsg:"collectionName must be provided"});this.collectionName=t,this._query=new r(o),Object.defineProperties(this,{_field:{enumerable:!1,configurable:!1,writable:!0}}),this._field=o&&o.field||{}}return t.prototype.field=function(e){return(0,s.assertRequiredParam)(e,"object","field"),new t(this.collectionName,n.__assign(n.__assign({},this._query.getProperties()),{field:e}))},t.prototype.where=function(e){return(0,s.assertRequiredParam)(e,"condition","where"),this._query.where?new t(this.collectionName,n.__assign(n.__assign({},this._query.getProperties()),{where:d.commands.and(this._query.where,e)})):new t(this.collectionName,n.__assign(n.__assign({},this._query.getProperties()),{where:e}))},t.prototype.orderBy=function(e,r){return(0,s.assertRequiredParam)(e,"fieldPath","orderBy"),(0,s.assertRequiredParam)(r,"order","orderBy"),new t(this.collectionName,n.__assign(n.__assign({},this._query.getProperties()),{order:n.__spreadArray(n.__spreadArray([],n.__read(this._query.order||[]),!1),[{fieldPath:e,order:r}],!1)}))},t.prototype.limit=function(e){return(0,s.assertRequiredParam)(e,"max","limit"),new t(this.collectionName,n.__assign(n.__assign({},this._query.getProperties()),{limit:e}))},t.prototype.skip=function(e){return(0,s.assertRequiredParam)(e,"offset","skip"),new t(this.collectionName,n.__assign(n.__assign({},this._query.getProperties()),{offset:e}))},t.prototype.get=function(t){var r=this,s="collection.get",d={apiStartTime:+new Date},f=(0,c.hasAPICallback)(t),_=new Promise(function(c,f){return n.__awaiter(r,void 0,void 0,function(){var _,m;return n.__generator(this,function(h){switch(h.label){case 0:return h.trys.push([0,2,3,4]),[4,(0,a.queryDocument)({env:e.database.config.env,collectionName:r.collectionName,query:e.engine.QuerySerializer.encode(r._query.where||{}),queryType:a.QUERY_TYPE.WHERE,options:(0,i.extractQueryOptions)(r,e),instanceContext:e,timing:d,explain:null===t||void 0===t?void 0:t.explain})];case 1:return _=h.sent(),(null===t||void 0===t?void 0:t.explain)&&(0,p.isDevTools)()?(c(_),[2]):(c({data:_.list,errMsg:(0,o.apiSuccessMsg)(s)}),[3,4]);case 2:return m=h.sent(),f((0,u.returnAsFinalCloudSDKError)(m,s)),[3,4];case 3:return(0,l.reportAPISpeed)(n.__assign(n.__assign({},d),{apiEndTime:+new Date,apiName:"cloud.db.".concat(s)})),[7];case 4:return[2]}})})});if(!f)return _;_.then(function(e){(0,c.invokeSuccessCompleteCallbacks)(s,t,e)}).catch(function(e){(0,c.invokeFailCompleteCallbacks)(s,t,e)})},t.prototype.update=function(t){var r=this,i="collection.update",d={apiStartTime:+new Date},f=(0,c.hasAPICallback)(t),_=new Promise(function(c,f){return n.__awaiter(r,void 0,void 0,function(){var _,m;return n.__generator(this,function(h){switch(h.label){case 0:return h.trys.push([0,2,3,4]),function(){if((0,s.assertRequiredParam)(t,"options","update"),(0,s.assertType)(t,{data:"object"}),!r._query.where)throw new u.CloudSDKError({errCode:-1,errMsg:"query condition must be provided"})}(),[4,(0,a.updateDocument)({env:e.database.config.env,collectionName:r.collectionName,query:e.engine.QuerySerializer.encode(r._query.where||{}),data:e.engine.UpdateSerializer.encode(t.data),queryType:a.QUERY_TYPE.WHERE,options:{multi:!1!==t.multi,merge:!0},instanceContext:e,timing:d,explain:t.explain})];case 1:return _=h.sent(),(null===t||void 0===t?void 0:t.explain)&&(0,p.isDevTools)()?[2,c(_)]:(c({stats:{updated:_.updated},errMsg:(0,o.apiSuccessMsg)(i)}),[3,4]);case 2:return m=h.sent(),f((0,u.returnAsFinalCloudSDKError)(m,i)),[3,4];case 3:return(0,l.reportAPISpeed)(n.__assign(n.__assign({},d),{apiEndTime:+new Date,apiName:"cloud.db.".concat(i)})),[7];case 4:return[2]}})})});if(!f)return _;_.then(function(e){(0,c.invokeSuccessCompleteCallbacks)(i,t,e)}).catch(function(e){(0,c.invokeFailCompleteCallbacks)(i,t,e)})},t.prototype.remove=function(t){var r=this,i="collection.remove",s={apiStartTime:+new Date},d=(0,c.hasAPICallback)(t),f=new Promise(function(c,d){return n.__awaiter(r,void 0,void 0,function(){var f,_;return n.__generator(this,function(m){switch(m.label){case 0:return m.trys.push([0,2,3,4]),function(){if(!r._query.where||0===Object.keys(r._query.where).length)throw new u.CloudSDKError({errCode:-1,errMsg:"query condition must be provided and not be empty"})}(),[4,(0,a.removeDocument)({env:e.database.config.env,collectionName:r.collectionName,query:e.engine.QuerySerializer.encode(r._query.where||{}),queryType:a.QUERY_TYPE.WHERE,options:{multi:!0},instanceContext:e,timing:s,explain:null===t||void 0===t?void 0:t.explain})];case 1:return f=m.sent(),(null===t||void 0===t?void 0:t.explain)&&(0,p.isDevTools)()?[2,c(f)]:(c({stats:{removed:f.removed||0},errMsg:(0,o.apiSuccessMsg)(i)}),[3,4]);case 2:return _=m.sent(),d((0,u.returnAsFinalCloudSDKError)(_,i)),[3,4];case 3:return(0,l.reportAPISpeed)(n.__assign(n.__assign({},s),{apiEndTime:+new Date,apiName:"cloud.db.".concat(i)})),[7];case 4:return[2]}})})});if(!d)return f;f.then(function(e){(0,c.invokeSuccessCompleteCallbacks)(i,t,e)}).catch(function(e){(0,c.invokeFailCompleteCallbacks)(i,t,e)})},t.prototype.count=function(t){var r=this,i="collection.count",s={apiStartTime:+new Date},d=(0,c.hasAPICallback)(t),f=new Promise(function(c,d){return n.__awaiter(r,void 0,void 0,function(){var f,_;return n.__generator(this,function(m){switch(m.label){case 0:return m.trys.push([0,2,3,4]),[4,(0,a.countDocument)({env:e.database.config.env,collectionName:r.collectionName,query:e.engine.QuerySerializer.encode(r._query.where||{}),queryType:a.QUERY_TYPE.WHERE,instanceContext:e,timing:s,explain:null===t||void 0===t?void 0:t.explain})];case 1:return f=m.sent(),(null===t||void 0===t?void 0:t.explain)&&(0,p.isDevTools)()?[2,c(f)]:(c({total:f.total,errMsg:(0,o.apiSuccessMsg)(i)}),[3,4]);case 2:return _=m.sent(),d((0,u.returnAsFinalCloudSDKError)(_,i)),[3,4];case 3:return(0,l.reportAPISpeed)(n.__assign(n.__assign({},s),{apiEndTime:+new Date,apiName:"cloud.db.".concat(i)})),[7];case 4:return[2]}})})});if(!d)return f;f.then(function(e){(0,c.invokeSuccessCompleteCallbacks)(i,t,e)}).catch(function(e){(0,c.invokeFailCompleteCallbacks)(i,t,e)})},t.prototype.toJSON=function(){},t}(),r=function(){function e(e){this.where=e&&e.where,this.offset=e&&e.offset,this.limit=e&&e.limit,this.order=e&&e.order,this.field=e&&e.field}return e.prototype.getProperties=function(){return{where:this.where,offset:this.offset,limit:this.limit,order:this.order,field:this.field}},e}();return t}},"./src/services/database/api/database/realtime/error.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.isRealtimeErrorMessageError=t.RealtimeErrorMessageError=void 0;var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),o=function(e){function t(t){var r=e.call(this,"Watch Error ".concat(JSON.stringify(t.msgData)," (requestid: ").concat(t.requestId,")"))||this;return r.isRealtimeErrorMessageError=!0,r.payload=t,r}return n.__extends(t,e),t}(Error);t.RealtimeErrorMessageError=o;t.isRealtimeErrorMessageError=function(e){return e&&e.isRealtimeErrorMessageError}},"./src/services/database/api/database/realtime/fsm/vws.ts":function(e,t){var r,n,o;Object.defineProperty(t,"__esModule",{value:!0}),t.VWSStates=t.VWSEvent=t.VWSState=void 0,function(e){e.UNINIT="UNINIT",e.CLOSED="CLOSED",e.INIT_LOGGING_IN="INIT_LOGGING_IN",e.INIT_LOGGED_IN="INIT_LOGGED_IN",e.INIT_LOGIN_FAIL="INIT_LOGIN_FAIL",e.INIT_WATCH_PENDING="INIT_WATCH_PENDING",e.INIT_WATCH_FAIL="INIT_WATCH_FAIL",e.INIT_WATCH_SUCCESS="INIT_WATCH_SUCCESS",e.PAUSED="PAUSED",e.ABNORMAL_WATCH_STATUS="ABNORMAL_WATCH_STATUS",e.REBUILD_LOGGING_IN="REBUILD_LOGGING_IN",e.REBUILD_LOGGED_IN="REBUILD_LOGGED_IN",e.REBUILD_LOGIN_FAIL="REBUILD_LOGIN_FAIL",e.REBUILD_WATCH_PENDING="REBUILD_WATCH_PENDING",e.REBUILD_WATCH_FAIL="REBUILD_WATCH_FAIL",e.REBUILD_WATCH_SUCCESS="REBUILD_WATCH_SUCCESS"}(n=t.VWSState||(t.VWSState={})),function(e){e.CLOSE="close",e.LOGIN_START="loginStart",e.LOGIN_FAIL="loginFail",e.LOGIN_SUCCESS="loginSuccess",e.INIT_WATCH_START="initWatchStart",e.INIT_WATCH_FAIL="initWatchFail",e.INIT_WATCH_SUCCESS="initWatchSuccess",e.WS_DISCONNECTED="wsDisconnected",e.WS_CONNECTED="wsConnected",e.REBUILD_WATCH_START="rebuildWatchStart",e.REBUILD_WATCH_FAIL="rebuildWatchFail",e.REBUILD_WATCH_SUCCESS="rebuildWatchSuccess",e.NEED_REBUILD_WATCH="needRebuildWatch"}(o=t.VWSEvent||(t.VWSEvent={}));var i={accept:o.CLOSE,to:n.CLOSED},s={accept:o.WS_DISCONNECTED,to:n.CLOSED},a={accept:o.WS_DISCONNECTED,to:n.PAUSED};t.VWSStates=((r={})[n.UNINIT]={transitions:[{accept:o.LOGIN_START,to:n.INIT_LOGGING_IN},s,i]},r[n.CLOSED]={transitions:[i]},r[n.INIT_LOGGING_IN]={transitions:[{accept:o.LOGIN_FAIL,to:n.INIT_LOGIN_FAIL},{accept:o.LOGIN_SUCCESS,to:n.INIT_LOGGED_IN},s,i]},r[n.INIT_LOGIN_FAIL]={transitions:[{accept:o.LOGIN_START,to:n.INIT_LOGGING_IN},s,i]},r[n.INIT_LOGGED_IN]={transitions:[{accept:o.INIT_WATCH_START,to:n.INIT_WATCH_PENDING},s,i]},r[n.INIT_WATCH_PENDING]={transitions:[{accept:o.INIT_WATCH_FAIL,to:n.INIT_WATCH_FAIL},{accept:o.INIT_WATCH_SUCCESS,to:n.INIT_WATCH_SUCCESS},s,i]},r[n.INIT_WATCH_FAIL]={transitions:[{accept:o.LOGIN_START,to:n.INIT_LOGGING_IN},s,i]},r[n.INIT_WATCH_SUCCESS]={transitions:[{accept:o.WS_DISCONNECTED,to:n.PAUSED},{accept:o.NEED_REBUILD_WATCH,to:n.ABNORMAL_WATCH_STATUS},a,i]},r[n.PAUSED]={transitions:[{accept:o.LOGIN_START,to:n.REBUILD_LOGGING_IN},a,i]},r[n.ABNORMAL_WATCH_STATUS]={transitions:[{accept:o.LOGIN_START,to:n.REBUILD_LOGGING_IN},a,i]},r[n.REBUILD_LOGGING_IN]={transitions:[{accept:o.LOGIN_FAIL,to:n.REBUILD_LOGIN_FAIL},{accept:o.LOGIN_SUCCESS,to:n.REBUILD_LOGGED_IN},a,i]},r[n.REBUILD_LOGIN_FAIL]={transitions:[{accept:o.LOGIN_START,to:n.REBUILD_LOGGING_IN},a,i]},r[n.REBUILD_LOGGED_IN]={transitions:[{accept:o.REBUILD_WATCH_START,to:n.REBUILD_WATCH_PENDING},a,i]},r[n.REBUILD_WATCH_PENDING]={transitions:[{accept:o.REBUILD_WATCH_FAIL,to:n.REBUILD_WATCH_FAIL},{accept:o.REBUILD_WATCH_SUCCESS,to:n.REBUILD_WATCH_SUCCESS},a,i]},r[n.REBUILD_WATCH_FAIL]={transitions:[{accept:o.LOGIN_START,to:n.REBUILD_LOGGING_IN},a,i]},r[n.REBUILD_WATCH_SUCCESS]={transitions:[{accept:o.NEED_REBUILD_WATCH,to:n.ABNORMAL_WATCH_STATUS},a,i]},r)},"./src/services/database/api/database/realtime/fsm/ws.ts":function(e,t){var r,n,o;Object.defineProperty(t,"__esModule",{value:!0}),t.WSStates=t.WSEvent=t.WSState=void 0,function(e){e.DISCONNECTED="DISCONNECTED",e.CONNECTING="CONNECTING",e.CONNECTED="CONNECTED"}(n=t.WSState||(t.WSState={})),function(e){e.CONNECTION_START="connectionStart",e.CONNECTION_SUCCESS="connectionSuccess",e.CONNECTION_FAIL="connectionFail",e.DISCONNECT="disconnect"}(o=t.WSEvent||(t.WSEvent={})),t.WSStates=((r={})[n.DISCONNECTED]={transitions:[{accept:o.CONNECTION_START,to:n.CONNECTING}]},r[n.CONNECTING]={transitions:[{accept:o.CONNECTION_SUCCESS,to:n.CONNECTED},{accept:o.CONNECTION_FAIL,to:n.DISCONNECTED},{accept:o.DISCONNECT,to:n.DISCONNECTED}]},r[n.CONNECTED]={transitions:[{accept:o.DISCONNECT,to:n.DISCONNECTED},{accept:o.CONNECTION_FAIL,to:n.DISCONNECTED}]},r)},"./src/services/database/api/database/realtime/listener.ts":function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.RealtimeListener=void 0;var r=function(){return function(e){this.close=e.close,this.onChange=e.onChange,this.onError=e.onError,e.debug&&Object.defineProperty(this,"virtualClient",{get:function(){return e.virtualClient}})}}();t.RealtimeListener=r},"./src/services/database/api/database/realtime/message.ts":function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isInitEventMessage=t.genRequestId=void 0,t.genRequestId=function(e){return void 0===e&&(e=""),"".concat(e?"".concat(e,"_"):"").concat(+new Date,"_").concat(Math.random())},t.isInitEventMessage=function(e){return"INIT_EVENT"===e.msgType}},"./src/services/database/api/database/realtime/snapshot.ts":function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Snapshot=void 0;var r=function(){return function(e){var t=e.id,r=e.docChanges,n=e.docs,o=e.type,i=(e.EJSON,e.requestId),s=e.watchId;Object.defineProperties(this,{id:{value:t,writable:!1,enumerable:!0},docChanges:{value:r,writable:!1,enumerable:!0},docs:{value:n,writable:!1,enumerable:!0},type:{value:o,writable:!1,enumerable:!0}}),this.requestId=i,this.watchId=s}}();t.Snapshot=r},"./src/services/database/api/database/realtime/virtual-websocket-client.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.VirtualWebSocketClient=void 0;var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),o=r("./src/utils/set.ts"),i=r("./src/services/database/api/database/realtime/fsm/vws.ts"),s=r("./src/services/database/api/database/realtime/fsm/ws.ts"),a=r("./src/utils/fsm.ts"),c=r("./src/services/database/api/database/realtime/message.ts"),u=r("./src/utils/error.ts"),l=r("./src/config/error.config.ts"),d=r("./src/externals/public-lib/reporter.ts"),p=r("./src/utils/report.ts"),f=r("./src/config/report.config.ts"),_=r("./src/services/database/api/database/realtime/listener.ts"),m=r("./src/services/database/api/database/realtime/snapshot.ts"),h=r("./src/services/database/api/database/realtime/error.ts"),g=2,v=2,y=1e4,E=1e4,b=1e4,S=new Set([i.VWSState.REBUILD_LOGGING_IN,i.VWSState.INIT_LOGGING_IN]),T=function(e){0},A=function(){function e(e){var t=this;this.closeWatchInvoked=!1,this.userOnErrorInvoked=!1,this._loginInvalidated=!1,this._errors=[],this._snapshotHistory=[],this._login=function(e){return n.__awaiter(t,void 0,void 0,function(){var t,r;return n.__generator(this,function(n){switch(n.label){case 0:this._fsm.transition(i.VWSEvent.LOGIN_START),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.login(this.envId,e||this._loginInvalidated,this.timing)];case 2:return t=n.sent(),this.envId||(this.envId=t.envId),this._fsm.transition(i.VWSEvent.LOGIN_SUCCESS,S),this._loginInvalidated=!1,[3,4];case 3:r=n.sent(),this._errors.push(r),this._loginInvalidated=!0;try{this._fsm.transition(i.VWSEvent.LOGIN_FAIL,S)}catch(e){console.warn("[realtime]",e)}return[3,4];case 4:return[2]}})})},this.initWatch=function(){return n.__awaiter(t,void 0,void 0,function(){var e,t,r,o,s,a,u,l,_,h,v,y,b,S,T=this;return n.__generator(this,function(A){switch(A.label){case 0:e=Date.now(),t=(0,c.genRequestId)(),A.label=1;case 1:return A.trys.push([1,3,,4]),this._fsm.transition(i.VWSEvent.INIT_WATCH_START,i.VWSState.INIT_LOGGED_IN),r=this.envId,o={watchId:this.watchId,requestId:t,msgType:"INIT_WATCH",msgData:{envId:r,collName:this.collectionName,query:this.query,limit:this.limit,orderBy:this.orderBy,queryType:this.queryType}},[4,this.send({msg:o,waitResponse:!0,skipOnMessage:!0,timeout:E})];case 2:if(s=A.sent(),this.assertAsyncTaskStatus(),a=s.msgData,u=a.events,l=a.currEvent,this.sessionInfo={queryID:s.msgData.queryID,currentEventId:l-1,currentDocs:[],currentEventTS:Date.now()},u.length>0){try{for(_=n.__values(u),h=_.next();!h.done;h=_.next())h.value.ID=l}catch(e){b={error:e}}finally{try{h&&!h.done&&(S=_.return)&&S.call(_)}finally{if(b)throw b.error}}this.handleServerEvents(s)}else this.sessionInfo.currentEventId=l,v=new m.Snapshot({id:l,docChanges:[],docs:[],type:"init",EJSON:this.getEJSON(),requestId:s.requestId,watchId:this.watchId}),d.default.surroundThirdByTryCatch(function(){return T.listener.onChange(v)})(),this.scheduleSendACK(),this.debug&&this._snapshotHistory.push(v);return this.onWatchStart(this,this.sessionInfo.queryID),this._availableRetries.INIT_WATCH=g,this._wsDisconnectionTS=void 0,(0,p.reportIDKey)(f.ErrorID,f.ErrorKey.REALTIME_DB_INIT_WATCH_SUCCESS,!0),(0,p.reportAPISpeed)({apiName:"_realtime.initWatch(success)",apiStartTime:e,apiEndTime:Date.now()}),this._fsm.transition(i.VWSEvent.INIT_WATCH_SUCCESS),[3,4];case 3:return y=A.sent(),(0,p.reportAPISpeed)({apiName:"_realtime.initWatch(fail)",apiStartTime:e,apiEndTime:Date.now()}),this.handleWatchEstablishmentError(y,{operationName:"INIT_WATCH",requestId:t}),[3,4];case 4:return[2]}})})},this.rebuildWatch=function(){return n.__awaiter(t,void 0,void 0,function(){var e,t,r,o,s,a;return n.__generator(this,function(n){switch(n.label){case 0:e=Date.now(),t=(0,c.genRequestId)(),n.label=1;case 1:if(n.trys.push([1,4,,5]),this._fsm.transition(i.VWSEvent.REBUILD_WATCH_START,i.VWSState.REBUILD_LOGGED_IN),r=this.envId,!this.sessionInfo)throw new Error("can not rebuildWatch without a successful initWatch (lack of sessionInfo)");if(this._wsDisconnectionTS&&Date.now()-this._wsDisconnectionTS>.9*this.getServiceContext().appConfig.realtimeQueryEventCacheTimeout)throw new u.TimeoutError("query event cache timeout, ws has been disconnected for too long, PLEASE RECONNECT manually",{subtype:"queryEventCacheClientTimeout",retryable:!1});return o={watchId:this.watchId,requestId:t,msgType:"REBUILD_WATCH",msgData:{envId:r,collName:this.collectionName,queryID:this.sessionInfo.queryID,eventID:this.sessionInfo.currentEventId}},[4,this.send({msg:o,waitResponse:!0,skipOnMessage:!0,timeout:b})];case 2:return s=n.sent(),this.assertAsyncTaskStatus(),[4,this.handleServerEvents(s)];case 3:return n.sent(),this._availableRetries.REBUILD_WATCH=g,this._wsDisconnectionTS=void 0,(0,p.reportIDKey)(f.ErrorID,f.ErrorKey.REALTIME_DB_REBUILD_WATCH_SUCCESS,!0),(0,p.reportAPISpeed)({apiName:"_realtime.rebuildWatch(success)",apiStartTime:e,apiEndTime:Date.now()}),this._fsm.transition(i.VWSEvent.REBUILD_WATCH_SUCCESS),[3,5];case 4:return a=n.sent(),(0,p.reportAPISpeed)({apiName:"_realtime.rebuildWatch(fail)",apiStartTime:e,apiEndTime:Date.now()}),this.handleWatchEstablishmentError(a,{operationName:"REBUILD_WATCH",requestId:t}),[3,5];case 5:return[2]}})})},this.handleWatchEstablishmentError=function(e,r){return n.__awaiter(t,void 0,void 0,function(){var t,o,s=this;return n.__generator(this,function(n){return t="INIT_WATCH"===r.operationName,o=function(n){var o="".concat(n||e," (").concat(t?"initWatch":"rebuildWatch"," requestId ").concat(r.requestId,")");if(s.closeWithError(new u.CloudSDKError({errCode:t?l.ERR_CODE.SDK_DATABASE_REALTIME_LISTENER_INIT_WATCH_FAIL:l.ERR_CODE.SDK_DATABASE_REALTIME_LISTENER_REBUILD_WATCH_FAIL,errMsg:o})),(0,p.reportIDKey)(f.ErrorID,t?f.ErrorKey.REALTIME_DB_INIT_WATCH_FAIL:f.ErrorKey.REALTIME_DB_REBUILD_WATCH_FAIL,!0),!(0,h.isRealtimeErrorMessageError)(e)){if((0,u.isTimeoutError)(e)){switch(e.payload.subtype){case"totalConnectionTimeout":(0,p.reportIDKey)(f.ErrorID,t?f.ErrorKey.REALTIME_DB_INIT_WATCH_FAIL_TIMEOUT_ERROR_TOTAL_CONNECTION:f.ErrorKey.REALTIME_DB_REBUILD_WATCH_FAIL_TIMEOUT_ERROR_TOTAL_CONNECTION,!0);break;case"queryEventCacheClientTimeout":t||(0,p.reportIDKey)(f.ErrorID,f.ErrorKey.REALTIME_DB_REBUILD_WATCH_FAIL_TIMEOUT_ERROR_QUERY_EVENT_CACHE,!0)}return}return(0,u.isCancelledError)(e)?void(0,p.reportIDKey)(f.ErrorID,t?f.ErrorKey.REALTIME_DB_INIT_WATCH_FAIL_CANCELLED_ERROR:f.ErrorKey.REALTIME_DB_REBUILD_WATCH_FAIL_CANCELLED_ERROR,!0):void(0,p.reportIDKey)(f.ErrorID,t?f.ErrorKey.REALTIME_DB_INIT_WATCH_FAIL_UNKNOWN_ERROR:f.ErrorKey.REALTIME_DB_REBUILD_WATCH_FAIL_UNKNOWN_ERROR,!0)}switch(e.payload.msgData.code){case"CHECK_LOGIN_FAILED":case"SIGN_EXPIRED_ERROR":case"SIGN_INVALID_ERROR":case"SIGN_PARAM_INVALID":(0,p.reportIDKey)(f.ErrorID,t?f.ErrorKey.REALTIME_DB_INIT_WATCH_FAIL_SERVER_SIGN_ERROR:f.ErrorKey.REALTIME_DB_REBUILD_WATCH_FAIL_SERVER_SIGN_ERROR,!0);break;default:(0,p.reportIDKey)(f.ErrorID,t?f.ErrorKey.REALTIME_DB_INIT_WATCH_FAIL_SERVER_OTHER_ERROR:f.ErrorKey.REALTIME_DB_REBUILD_WATCH_FAIL_SERVER_OTHER_ERROR,!0)}},this._errors.push(e),this.handleCommonError(e,{onSignError:function(){s._loginInvalidated=!0,s._fsm.transition(s.initialized?i.VWSEvent.REBUILD_WATCH_FAIL:i.VWSEvent.INIT_WATCH_FAIL)},onTimeoutError:function(e){e.payload&&!e.payload.retryable?o(e):s._fsm.transition(s.initialized?i.VWSEvent.REBUILD_WATCH_FAIL:i.VWSEvent.INIT_WATCH_FAIL)},onNotRetryableError:o,onCancelledError:function(e){s._fsm.transition(s.initialized?i.VWSEvent.REBUILD_WATCH_FAIL:i.VWSEvent.INIT_WATCH_FAIL)},onUnknownError:function(){s._fsm.transition(s.initialized?i.VWSEvent.REBUILD_WATCH_FAIL:i.VWSEvent.INIT_WATCH_FAIL)}}),[2]})})},this.closeWatch=function(){return n.__awaiter(t,void 0,void 0,function(){var e,t;return n.__generator(this,function(r){switch(r.label){case 0:if(this.closeWatchInvoked=!0,e=this.sessionInfo?this.sessionInfo.queryID:"",this._fsm.currentState===i.VWSState.CLOSED)return[2];r.label=1;case 1:return r.trys.push([1,3,4,5]),this._fsm.transition(i.VWSEvent.CLOSE),[4,this.sendCloseWatch()];case 2:return r.sent(),[3,5];case 3:return t=r.sent(),console.warn("[realtime] non-fatal error while closing watch: ".concat(t)),[3,5];case 4:return this.sessionInfo=void 0,this.onWatchClose(this,e),this._cleanup(),[7];case 5:return[2]}})})},this.sendCloseWatch=function(){return n.__awaiter(t,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:return e={watchId:this.watchId,requestId:(0,c.genRequestId)(),msgType:"CLOSE_WATCH",msgData:null},[4,this.send({msg:e})];case 1:return t.sent(),[2]}})})},this.scheduleSendACK=function(){t.clearACKSchedule(),t._ackTimeoutId=setTimeout(function(){t._waitExpectedTimeoutId?t.scheduleSendACK():t.sendACK()},y)},this.clearACKSchedule=function(){t._ackTimeoutId&&clearTimeout(t._ackTimeoutId)},this.sendACK=function(){return n.__awaiter(t,void 0,void 0,function(){var e,t,r;return n.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),this._fsm.currentState!==i.VWSState.INIT_WATCH_SUCCESS&&this._fsm.currentState!==i.VWSState.REBUILD_WATCH_SUCCESS?(this.scheduleSendACK(),[2]):this.sessionInfo?(e={watchId:this.watchId,requestId:(0,c.genRequestId)(),msgType:"CHECK_LAST",msgData:{queryID:this.sessionInfo.queryID,eventID:this.sessionInfo.currentEventId}},[4,this.send({msg:e})]):(console.warn("[realtime listener] can not send ack without a successful initWatch (lack of sessionInfo)"),[2]);case 1:return n.sent(),this.scheduleSendACK(),[3,3];case 2:if(t=n.sent(),(0,h.isRealtimeErrorMessageError)(t))switch((r=t.payload).msgData.code){case"CHECK_LOGIN_FAILED":case"SIGN_EXPIRED_ERROR":case"SIGN_INVALID_ERROR":case"SIGN_PARAM_INVALID":return this._loginInvalidated=!0,this._fsm.currentState!==i.VWSState.INIT_WATCH_SUCCESS&&this._fsm.currentState!==i.VWSState.REBUILD_WATCH_SUCCESS||this._fsm.transition(i.VWSEvent.NEED_REBUILD_WATCH),[2];case"QUERYID_INVALID_ERROR":case"SYS_ERR":case"INVALIID_ENV":case"COLLECTION_PERMISSION_DENIED":return this.closeWithError(new u.CloudSDKError({errCode:l.ERR_CODE.SDK_DATABASE_REALTIME_LISTENER_CHECK_LAST_FAIL,errMsg:r.msgData.code})),[2]}return this._availableRetries.CHECK_LAST&&this._availableRetries.CHECK_LAST>0?(this._availableRetries.CHECK_LAST--,this.scheduleSendACK()):this.closeWithError(new u.CloudSDKError({errCode:l.ERR_CODE.SDK_DATABASE_REALTIME_LISTENER_CHECK_LAST_FAIL,errMsg:t})),[3,3];case 3:return[2]}})})},this.handleCommonError=function(e,t){if((0,h.isRealtimeErrorMessageError)(e)){switch(e.payload.msgData.code){case"CHECK_LOGIN_FAILED":case"SIGN_EXPIRED_ERROR":case"SIGN_INVALID_ERROR":case"SIGN_PARAM_INVALID":return void t.onSignError(e);case"QUERYID_INVALID_ERROR":case"SYS_ERR":case"INVALIID_ENV":case"COLLECTION_PERMISSION_DENIED":default:return void t.onNotRetryableError(e)}}else{if((0,u.isTimeoutError)(e))return void t.onTimeoutError(e);if((0,u.isCancelledError)(e))return void t.onCancelledError(e)}t.onUnknownError(e)},this.watchId="watchid_".concat(+new Date,"_").concat(Math.random()),this._parentFSM=e.parentFSM,this.envId=e.envId,this.collectionName=e.collectionName,this.query=e.query,this.limit=e.limit,this.orderBy=e.orderBy,this.queryType=e.queryType,this.send=e.send,this.login=e.login,this.isWSConnected=e.isWSConnected,this.getWaitExpectedTimeoutLength=e.getWaitExpectedTimeoutLength,this.getEJSON=e.getEJSON,this.getServiceContext=e.getServiceContext,this.onWatchStart=e.onWatchStart,this.onWatchClose=e.onWatchClose,this.timing=e.timing,this.debug=e.debug,this._availableRetries={INIT_WATCH:g,REBUILD_WATCH:g,CHECK_LAST:v},this._fsm=new a.FSM({initialState:i.VWSState.UNINIT,states:i.VWSStates,history:!0}),this._subscribeParentFSMEvents(),this._subscribeFSMEvents(),this.listener=new _.RealtimeListener({close:this.closeWatch,onChange:e.onChange,onError:e.onError,debug:this.debug,virtualClient:this}),this._parentFSM.currentState===s.WSState.CONNECTED&&this._login(),e.debug&&(this.wsclient=e.wsclient)}return Object.defineProperty(e.prototype,"initialized",{get:function(){return Boolean(this.sessionInfo)},enumerable:!1,configurable:!0}),e.prototype._cleanup=function(){this._parentFSM.unsubscribe(this._parentFSMListener)},e.prototype._subscribeParentFSMEvents=function(){var e=this;this._parentFSMListener=function(t){var r=t.event;t.from,t.to;if(e._fsm.currentState!==i.VWSState.CLOSED)if(r.type===s.WSEvent.DISCONNECT||r.type===s.WSEvent.CONNECTION_FAIL)switch(e._fsm.currentState){case i.VWSState.UNINIT:case i.VWSState.INIT_LOGGING_IN:case i.VWSState.INIT_LOGIN_FAIL:case i.VWSState.INIT_LOGGED_IN:case i.VWSState.INIT_WATCH_PENDING:case i.VWSState.INIT_WATCH_FAIL:e.closeWithError(r.error||new Error("websocket connection fail"),!1);break;default:r.type===s.WSEvent.DISCONNECT?(e._wsDisconnectionTS||(e._wsDisconnectionTS=Date.now()),e._fsm.transition(i.VWSEvent.WS_DISCONNECTED)):e.closeWithError(r.error||new Error("websocket connection fail"),!1)}else if(r.type===s.WSEvent.CONNECTION_SUCCESS)switch(e._fsm.currentState){case i.VWSState.UNINIT:case i.VWSState.PAUSED:e._login();break;case i.VWSState.CLOSED:break;default:console.warn("[realtime] current state should not be ".concat(e._fsm.currentState," (parent event ").concat(r,")"))}},this._parentFSM.subscribe(this._parentFSMListener)},e.prototype._subscribeFSMEvents=function(){var e=this;this._FSMListener=function(t){var r=t.event,n=t.from;t.to;switch(r.type){case i.VWSEvent.WS_CONNECTED:e._login().catch(T);break;case i.VWSEvent.LOGIN_SUCCESS:n===i.VWSState.INIT_LOGGING_IN?e.initWatch().catch(T):n===i.VWSState.REBUILD_LOGGING_IN?e.rebuildWatch().catch(T):e.closeWithError(new u.CloudSDKError({errCode:l.ERR_CODE.SDK_DATABASE_REALTIME_LISTENER_UNEXPECTED_FATAL_ERROR,errMsg:"unexpected state: event ".concat(r.type," from ").concat(n)}));break;case i.VWSEvent.LOGIN_FAIL:n===i.VWSState.INIT_LOGGING_IN?e.useRetryTicket("INIT_WATCH")?e._login().catch(T):e.closeWithError(new u.CloudSDKError({errCode:l.ERR_CODE.SDK_DATABASE_REALTIME_LISTENER_INIT_WATCH_FAIL,errMsg:"login fail ".concat(e._errors[e._errors.length-1])})):n===i.VWSState.REBUILD_LOGGING_IN?e.useRetryTicket("REBUILD_WATCH")?e._login().catch(T):e.closeWithError(new u.CloudSDKError({errCode:l.ERR_CODE.SDK_DATABASE_REALTIME_LISTENER_REBUILD_WATCH_FAIL,errMsg:"login fail ".concat(e._errors[e._errors.length-1])})):e.closeWithError(new u.CloudSDKError({errCode:l.ERR_CODE.SDK_DATABASE_REALTIME_LISTENER_UNEXPECTED_FATAL_ERROR,errMsg:"unexpected state: event ".concat(r.type," from ").concat(n)}));break;case i.VWSEvent.INIT_WATCH_SUCCESS:e._availableRetries.INIT_WATCH=g,e._errors=[];break;case i.VWSEvent.INIT_WATCH_FAIL:e.useRetryTicket("INIT_WATCH")?e._login().catch(T):e.closeWithError(new u.CloudSDKError({errCode:l.ERR_CODE.SDK_DATABASE_REALTIME_LISTENER_INIT_WATCH_FAIL,errMsg:"init watch fail ".concat(e._errors[e._errors.length-1])}));break;case i.VWSEvent.REBUILD_WATCH_SUCCESS:e._availableRetries.REBUILD_WATCH=g,e._errors=[];break;case i.VWSEvent.REBUILD_WATCH_FAIL:e.useRetryTicket("REBUILD_WATCH")?e._login().catch(T):e.closeWithError(new u.CloudSDKError({errCode:l.ERR_CODE.SDK_DATABASE_REALTIME_LISTENER_REBUILD_WATCH_FAIL,errMsg:"init watch fail ".concat(e._errors[e._errors.length-1])}));break;case i.VWSEvent.NEED_REBUILD_WATCH:e._login().catch(T)}},this._fsm.subscribe(this._FSMListener)},e.prototype.useRetryTicket=function(e){return!!(this._availableRetries[e]&&this._availableRetries[e]>0)&&(this._availableRetries[e]--,!0)},e.prototype.assertAsyncTaskStatus=function(){if(this.closeWatchInvoked)throw new u.CancelledError("closeWatch",{subtype:"closeWatch"});switch(this._fsm.currentState){case i.VWSState.PAUSED:throw new u.CancelledError("pause",{subtype:"pause"});case i.VWSState.CLOSED:throw new u.CancelledError("close",{subtype:"close"})}},e.prototype.handleServerEvents=function(e){return n.__awaiter(this,void 0,void 0,function(){var t;return n.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),this.scheduleSendACK(),[4,this._handleServerEvents(e)];case 1:return r.sent(),this._postHandleServerEventsValidityCheck(e),[3,3];case 2:throw t=r.sent(),(0,p.reportIDKey)(f.ErrorID,f.ErrorKey.REALTIME_DB_HANDLE_EVENT_ERROR,!0),t;case 3:return[2]}})})},e.prototype._handleServerEvents=function(e){return n.__awaiter(this,void 0,void 0,function(){var t,r,s,a,c,_,h,g,v,y,E=this;return n.__generator(this,function(b){if(t=e.requestId,!(r=e.msgData.events).length||!this.sessionInfo)return[2];s=this.sessionInfo;try{a=r.map(w)}catch(e){return this.closeWithError(new u.CloudSDKError({errCode:l.ERR_CODE.SDK_DATABASE_REALTIME_LISTENER_RECEIVE_INVALID_SERVER_DATA,errMsg:e})),[2]}for(c=n.__spreadArray([],n.__read(s.currentDocs),!1),_=!1,h=function(r,h){var v,y,b=a[r];if(s.currentEventId>=b.id)return!a[r-1]||b.id>a[r-1].id?(0,p.reportIDKey)(f.ErrorID,f.ErrorKey.REALTIME_DB_RECV_DUPLICATE_EVENT,!0):(console.error("[realtime listener] server non-fatal error: events out of order (the latter event's id is smaller than that of the former) (requestId ".concat(t,")")),(0,p.reportIDKey)(f.ErrorID,f.ErrorKey.REALTIME_DB_RECV_DUPLICATE_EVENT_AND_EVENT_OUT_OF_ORDER,!0)),"continue";if(s.currentEventId===b.id-1){switch(b.dataType){case"update":if(!b.doc)switch(b.queueType){case"update":case"dequeue":if(I=c.find(function(e){return e._id===b.docId})){var S=JSON.parse(JSON.stringify(I));if(b.updatedFields)for(var T in b.updatedFields)(0,o.set)(S,T,b.updatedFields[T]);if(b.removedFields)try{for(var A=(v=void 0,n.__values(b.removedFields)),w=A.next();!w.done;w=A.next()){T=w.value;(0,o.unset)(S,T)}}catch(e){v={error:e}}finally{try{w&&!w.done&&(y=A.return)&&y.call(A)}finally{if(v)throw v.error}}b.doc=S}else console.error("[realtime listener] internal non-fatal server error: unexpected update dataType event where no doc is associated."),(0,p.reportIDKey)(f.ErrorID,f.ErrorKey.REALTIME_DB_UNEXPECTED_EVENT_DATATYPE_UPDATE_NO_ASSOCIATED_DOC,!0);break;case"enqueue":var C=new u.CloudSDKError({errCode:l.ERR_CODE.SDK_DATABASE_REALTIME_LISTENER_UNEXPECTED_FATAL_ERROR,errMsg:'HandleServerEvents: full doc is not provided with dataType="update" and queueType="enqueue" (requestId '.concat(e.requestId,")")});throw g.closeWithError(C),C}break;case"limit":if(!b.doc)switch(b.queueType){case"dequeue":var I;(I=c.find(function(e){return e._id===b.docId}))?b.doc=I:console.error("[realtime listener] internal non-fatal server error: unexpected limit dataType dequeue queueType event where no doc is associated.")}break;case"replace":if(!b.doc){C=new u.CloudSDKError({errCode:l.ERR_CODE.SDK_DATABASE_REALTIME_LISTENER_UNEXPECTED_FATAL_ERROR,errMsg:'HandleServerEvents: full doc is not provided with dataType="replace" (requestId '.concat(e.requestId,")")});throw g.closeWithError(C),C}break;case"remove":(S=c.find(function(e){return e._id===b.docId}))?b.doc=S:(console.error("[realtime listener] internal non-fatal server error: unexpected remove event where no doc is associated."),(0,p.reportIDKey)(f.ErrorID,f.ErrorKey.REALTIME_DB_UNEXPECTED_EVENT_REMOVE_NO_ASSOCIATED_DOC,!0))}switch(b.queueType){case"init":_?c.push(b.doc):(_=!0,c=[b.doc]);break;case"enqueue":c.push(b.doc);break;case"dequeue":(O=c.findIndex(function(e){return e._id===b.docId}))>-1?c.splice(O,1):(console.error("[realtime listener] internal non-fatal server error: unexpected dequeue event where no doc is associated."),(0,p.reportIDKey)(f.ErrorID,f.ErrorKey.REALTIME_DB_UNEXPECTED_EVENT_DEQUEUE_NO_ASSOCIATED_DOC,!0));break;case"update":var O;(O=c.findIndex(function(e){return e._id===b.docId}))>-1?c[O]=b.doc:(console.error("[realtime listener] internal non-fatal server error: unexpected queueType update event where no doc is associated."),(0,p.reportIDKey)(f.ErrorID,f.ErrorKey.REALTIME_DB_UNEXPECTED_EVENT_QUEUETYPE_UPDATE_NO_ASSOCIATED_DOC,!0))}if(r===h-1||a[r+1]&&a[r+1].id!==b.id){var R=n.__spreadArray([],n.__read(c),!1),N=a.slice(0,r+1).filter(function(e){return e.id===b.id});g.sessionInfo.currentEventId=b.id,g.sessionInfo.currentDocs=c,g.sessionInfo.currentEventTS=Date.now();var D=new m.Snapshot({id:b.id,type:"init"===N[0].queueType?"init":void 0,docChanges:g.getEJSON().deserialize(N),docs:g.getEJSON().deserialize(R),EJSON:g.getEJSON(),requestId:t,watchId:g.watchId});d.default.surroundThirdByTryCatch(function(){return E.listener.onChange(D)})(),g.debug&&g._snapshotHistory.push(D)}}else(0,p.reportIDKey)(f.ErrorID,f.ErrorKey.REALTIME_DB_EVENT_OUT_OF_ORDER,!0),g._fsm.transition(i.VWSEvent.NEED_REBUILD_WATCH)},g=this,v=0,y=a.length;v<y;v++)h(v,y);return[2]})})},e.prototype._postHandleServerEventsValidityCheck=function(e){this.sessionInfo?(this.sessionInfo.expectEventId&&this.sessionInfo.currentEventId>=this.sessionInfo.expectEventId&&this.clearWaitExpectedEvent(),this.sessionInfo.currentEventId<e.msgData.currEvent&&console.warn("[realtime listener] internal non-fatal error: client eventId ".concat(this.sessionInfo.currentEventId," does not match with server event id after server event handling ").concat(e.msgData.currEvent," (requestId ").concat(e.requestId,")"))):console.error("[realtime listener] internal non-fatal error: sessionInfo lost after server event handling, this should never occur. (requestId ".concat(e.requestId,")"))},e.prototype.clearWaitExpectedEvent=function(){this._waitExpectedTimeoutId&&(clearTimeout(this._waitExpectedTimeoutId),this._waitExpectedTimeoutId=void 0)},e.prototype.onMessage=function(e){var t=this;switch(this._fsm.currentState){case i.VWSState.INIT_WATCH_SUCCESS:case i.VWSState.REBUILD_WATCH_SUCCESS:break;case i.VWSState.PAUSED:if("ERROR"!==e.msgType)return;break;default:return void console.warn("[realtime listener] internal non-fatal error: unexpected message received while state is ".concat(this._fsm.currentState))}if(this.sessionInfo)switch(this.scheduleSendACK(),e.msgType){case"NEXT_EVENT":0,this.handleServerEvents(e);break;case"CHECK_EVENT":this.sessionInfo.currentEventId<e.msgData.currEvent&&(this.sessionInfo.expectEventId=e.msgData.currEvent,this.clearWaitExpectedEvent(),this._waitExpectedTimeoutId=setTimeout(function(){t._fsm.transition(i.VWSEvent.NEED_REBUILD_WATCH)},this.getWaitExpectedTimeoutLength()));break;case"ERROR":this.closeWithError(new u.CloudSDKError({errCode:l.ERR_CODE.SDK_DATABASE_REALTIME_LISTENER_SERVER_ERROR_MSG,errMsg:"".concat(e.msgData.code," - ").concat(e.msgData.message)}));break;default:0}else console.warn("[realtime listener] internal non-fatal error: sessionInfo not found while message is received.")},e.prototype.closeWithError=function(e,t){var r=this;if(void 0===t&&(t=!0),this._fsm.currentState!==i.VWSState.CLOSED&&this._fsm.transition(i.VWSEvent.CLOSE),!this.userOnErrorInvoked){var n=this._fsm.getHistoryRepresentation({limit:20});(0,u.isSDKError)(e)?(e.errMsg+="\nhistory ".concat(n),e.history=n):e&&((e=new u.CloudSDKError({errCode:l.ERR_CODE.SDK_DATABASE_REALTIME_LISTENER_UNEXPECTED_FATAL_ERROR,errMsg:"".concat(e," \nhistory ").concat(n)})).history=n),this.clearACKSchedule(),d.default.surroundThirdByTryCatch(function(){return r.listener.onError(e)})(),this.userOnErrorInvoked=!0,this.onWatchClose(this,this.sessionInfo&&this.sessionInfo.queryID||""),t&&this.sendCloseWatch().catch(T),this.sessionInfo=void 0}},e}();function w(e){var t={id:e.ID,dataType:e.DataType,queueType:e.QueueType,docId:e.DocID,doc:e.Doc&&"{}"!==e.Doc?JSON.parse(e.Doc):void 0};return"update"===e.DataType&&(e.UpdatedFields&&(t.updatedFields=JSON.parse(e.UpdatedFields)),(e.removedFields||e.RemovedFields)&&(t.removedFields=e.removedFields?JSON.parse(e.removedFields):JSON.parse(e.RemovedFields))),t}t.VirtualWebSocketClient=A},"./src/services/database/api/database/realtime/websocket-client.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.RealtimeWebSocketClient=void 0;var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),o=r("./src/externals/public-lib/appserviceSdk.ts"),i=r("./src/services/database/api/database/realtime/fsm/ws.ts"),s=r("./src/services/database/api/database/realtime/virtual-websocket-client.ts"),a=r("./src/utils/fsm.ts"),c=r("./src/utils/utils.ts"),u=r("./src/services/database/internal/backend-api/backend-api.ts"),l=r("./src/services/database/api/database/realtime/message.ts"),d=r("./src/services/database/api/database/realtime/ws-event.ts"),p=r("./src/utils/error.ts"),f=r("./src/services/database/api/database/realtime/error.ts"),_=r("./src/config/error.config.ts"),m=r("./src/externals/globals/wxconfig.ts"),h=r("./src/utils/report.ts"),g=r("./src/config/report.config.ts"),v=r("./src/utils/report.ts"),y=r("./src/externals/public-lib/reporter.ts"),E={CONNECTING:0,OPEN:1,CLOSING:2,CLOSED:3},b=3,S=5e3,T=1e4,A=5e3,w=100,C=function(){function e(e){var t=this;this._virtualWSClient=new Set,this._queryIdClientMap=new Map,this._watchIdClientMap=new Map,this._pingFailed=0,this._pongMissed=0,this._logins=new Map,this._signatures=new Map,this._wsResponseWait=new Map,this._rttObserved=[],this._closedWatches=new Set,this._retryLock=!1,this.initWebSocketConnection=function(e,s){return void 0===s&&(s=t._maxReconnect),n.__awaiter(t,void 0,void 0,function(){var t,s,a,u,l,d,f,y,E,b=this;return n.__generator(this,function(S){switch(S.label){case 0:if(this._EJSON||(t=function(){return n.__awaiter(this,void 0,void 0,function(){var e,t;return n.__generator(this,function(n){return e=Date.now(),t=r("./src/vendor/bson.bundle.js"),(0,v.reportAPISpeed)({apiName:"_realtime.importBSON",apiStartTime:e,apiEndTime:Date.now()}),[2,t.EJSON]})})}().then(function(e){return b._EJSON=e})),this._fsm.currentState!==i.WSState.DISCONNECTED)return[2];if(this._fsm.transition(i.WSEvent.CONNECTION_START),this._logins=new Map,this._wsResponseWait=new Map,s=!1,a=[],u=!1,!this._totalConnectionTimeoutId&&this._totalConnectionTimeout&&this._totalConnectionTimeout!==1/0&&(l=this._totalConnectionTimeout,this._totalConnectionTimeoutId=setTimeout(function(){u=!0,e&&b._retryLock&&(b._retryLock=!1),b._totalConnectionTimeoutId=void 0;var t=new p.TimeoutError("reconnect timeout (reach totalConnectionTimeout ".concat(l,"s)"),{subtype:"totalConnectionTimeout",retryable:!1});(0,h.reportIDKey)(g.ErrorID,g.ErrorKey.REALTIME_DB_WS_TOTAL_CONNECTION_TIMEOUT,!0),b._fsm.transition({type:i.WSEvent.CONNECTION_FAIL,error:t})},1e3*l)),e){if(this._retryLock)return[2];0,this._retryLock=!0}d=function(r){var l,d,p,h;return n.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,11,,17]),[4,(0,c.getNetworkStatus)()];case 1:return r.sent().isConnected?[3,5]:e?[3,2]:(f._fsm.transition({type:i.WSEvent.CONNECTION_FAIL,error:new Error("network offline")}),[2,{value:void 0}]);case 2:return[4,(0,c.onceNetworkOnline)()];case 3:return r.sent(),0===f._virtualWSClient.size?(f.clearTotalReconnectTimeout(),[2,{value:void 0}]):(0,m.isDevTools)()?[4,(0,c.sleep)(w)]:[3,5];case 4:r.sent(),r.label=5;case 5:return u?[2,{value:void 0}]:[4,f.getSignature(f._connectionEnvId)];case 6:return l=r.sent(),u?[2,{value:void 0}]:(d=Date.now(),[4,new Promise(function(e,t){b._ws=(0,o.getSDK)(b._context.identifiers).connectSocket({url:l.wsUrl,header:{"content-type":"application/json"},perMessageDeflate:!0,success:e,fail:t})})]);case 7:return r.sent(),u?[2,{value:void 0}]:((0,v.reportAPISpeed)({apiName:"_realtime.connectSocket",apiStartTime:d,apiEndTime:Date.now()}),[4,f.initWebSocketEvent()]);case 8:return r.sent(),u?[2,{value:void 0}]:t?[4,t]:[3,10];case 9:if(r.sent(),u)return[2,{value:void 0}];r.label=10;case 10:return s=!0,[2,"break"];case 11:return p=r.sent(),a.unshift(p),p.errCode===_.ERR_CODE.TCB_PERMISSION_DENIED?[2,"break"]:[4,(0,c.getNetworkStatus)()];case 12:return h=r.sent().isConnected,u?[2,{value:void 0}]:h?[4,(0,c.sleep)(f._reconnectInterval)]:[3,14];case 13:if(r.sent(),u)return[2,{value:void 0}];r.label=14;case 14:return(0,m.isDevTools)()?[4,(0,c.sleep)(0)]:[3,16];case 15:if(r.sent(),u)return[2,{value:void 0}];r.label=16;case 16:return[3,17];case 17:return[2]}})},f=this,y=this._maxReconnect,S.label=1;case 1:return y>=0?[5,d(y)]:[3,4];case 2:if("object"==typeof(E=S.sent()))return[2,E.value];if("break"===E)return[3,4];S.label=3;case 3:return y--,[3,1];case 4:return e&&this._retryLock&&(this._retryLock=!1),s?(this.clearTotalReconnectTimeout(),(0,h.reportIDKey)(g.ErrorID,e?g.ErrorKey.REALTIME_DB_RECONNECT_WS_SUCCESS:g.ErrorKey.REALTIME_DB_INIT_WS_SUCCESS,!0),this._fsm.transition(i.WSEvent.CONNECTION_SUCCESS),[2]):(this.clearTotalReconnectTimeout(),(0,h.reportIDKey)(g.ErrorID,e?g.ErrorKey.REALTIME_DB_RECONNECT_WS_FAIL:g.ErrorKey.REALTIME_DB_INIT_WS_FAIL,!0),e?this._fsm.transition({type:i.WSEvent.CONNECTION_FAIL,error:new p.CloudSDKError({errCode:_.ERR_CODE.SDK_DATABASE_REALTIME_LISTENER_RECONNECT_WS_FAIL,errMsg:"errors of each retry (latest to oldest): ".concat(JSON.stringify(a.map(function(e){return e+""})))})}):this._fsm.transition({type:i.WSEvent.CONNECTION_FAIL,error:new p.CloudSDKError({errCode:_.ERR_CODE.SDK_DATABASE_REALTIME_LISTENER_INIT_WS_FAIL,errMsg:"errors of each retry (latest to oldest): ".concat(JSON.stringify(a.map(function(e){return e+""})))})}),[2])}})})},this.initWebSocketEvent=function(){return new Promise(function(e,r){if(!t._ws)throw new Error("can not initWebSocketEvent, ws not exists");var n=!1;t._ws.onOpen(function(r){t._context.debug&&console.warn("[realtime] ws event: open",r),n=!0,e()});var o=null;t._ws.onError(function(e){o=e,t._logins=new Map,n?(t._context.debug&&console.error("[realtime] ws event: error",e),t.clearHeartbeat(),(0,h.reportIDKey)(g.ErrorID,g.ErrorKey.REALTIME_DB_WS_ONERROR_WHILE_ACTIVE,!0)):(t._context.debug&&console.error("[realtime] ws open failed with ws event: error",e),r(e),(0,h.reportIDKey)(g.ErrorID,g.ErrorKey.REALTIME_DB_WS_ONERROR_BEFORE_OPEN,!0))}),t._ws.onClose(function(e){t._logins=new Map,t.clearHeartbeat();var r=o||(0,d.getWSCloseError)(e.code);switch(e.code){case d.CLOSE_EVENT_CODE.ReconnectOnServerUpgrade:case d.CLOSE_EVENT_CODE.ReconnectWebSocket:case d.CLOSE_EVENT_CODE.NoRealtimeListeners:t._fsm.transition({type:i.WSEvent.DISCONNECT,error:r});break;case d.CLOSE_EVENT_CODE.HeartbeatPingError:case d.CLOSE_EVENT_CODE.HeartbeatPongTimeoutError:case d.CLOSE_EVENT_CODE.NormalClosure:case d.CLOSE_EVENT_CODE.AbnormalClosure:t._maxReconnect>0?(t._fsm.transition({type:i.WSEvent.DISCONNECT,error:r}),t.initWebSocketConnection(!0)):t._fsm.transition({type:i.WSEvent.CONNECTION_FAIL,error:r}),e.code===d.CLOSE_EVENT_CODE.HeartbeatPingError?(0,h.reportIDKey)(g.ErrorID,g.ErrorKey.REALTIME_DB_WS_ONCLOSE_HEARTBEAT_PING_FAIL,!0):e.code===d.CLOSE_EVENT_CODE.HeartbeatPongTimeoutError?(0,h.reportIDKey)(g.ErrorID,g.ErrorKey.REALTIME_DB_WS_ONCLOSE_HEARTBEAT_PONG_TIMEOUT,!0):(0,h.reportIDKey)(g.ErrorID,g.ErrorKey.REALTIME_DB_WS_ONCLOSE_AB_NORMAL_CLOSURE,!0);break;case d.CLOSE_EVENT_CODE.UnauthenticatedIdleConnection:t._fsm.transition({type:i.WSEvent.CONNECTION_FAIL,error:(0,d.getWSCloseError)(e.code,e.reason)}),(0,h.reportIDKey)(g.ErrorID,g.ErrorKey.REALTIME_DB_WS_ONCLOSE_SERVER_CLOSE_NO_AUTH,!0);break;case d.CLOSE_EVENT_CODE.ServerUpgrade:t._fsm.transition({type:i.WSEvent.DISCONNECT,error:r}),t.initWebSocketConnection(!0),(0,h.reportIDKey)(g.ErrorID,g.ErrorKey.REALTIME_DB_WS_ONCLOSE_SERVER_CLOSE_FOR_UPGRADE,!0);break;default:t._maxReconnect>0?(t._fsm.transition({type:i.WSEvent.DISCONNECT,error:r}),t.initWebSocketConnection(!0)):t._fsm.transition({type:i.WSEvent.CONNECTION_FAIL,error:(0,d.getWSCloseError)(e.code,e.reason)}),(0,h.reportIDKey)(g.ErrorID,g.ErrorKey.REALTIME_DB_WS_ONCLOSE_UNKNOWN_ORIGIN,!0)}(0,h.reportIDKey)(g.ErrorID,g.ErrorKey.REALTIME_DB_WS_ONCLOSE,!0)});var s={timing:{},startKey:"apiStartTime",endKey:"apiEndTime",samplePicker:h.socketOnMessageSamplePicker,autoReport:"_realtime.onSocketMessage"};t._ws.onMessage((0,h.wrapTiming)(t.onSocketMessage,s)),t.heartbeat()})},this.isWSConnected=function(){return Boolean(t._ws&&t._ws.readyState===E.OPEN)},this.onSocketMessage=function(e){var r,n=e.data;t.heartbeat();try{r=JSON.parse(n)}catch(e){throw new Error("[realtime] onMessage parse res.data error: ".concat(e))}t._context.debug&&console.log("[realtime] onMessage ".concat(r.msgType," (").concat((new Date).toLocaleString(),")"),r);var o=t._wsResponseWait.get(r.requestId);if(o){try{"ERROR"===r.msgType?o.reject(new f.RealtimeErrorMessageError(r)):o.resolve(r)}catch(e){t._context.debug&&console.error("ws onMessage responseWaitSpec.resolve(msg) errored:",e)}finally{t._wsResponseWait.delete(r.requestId)}if(o.skipOnMessage)return}if("PONG"!==r.msgType){var i=r.watchId&&t._watchIdClientMap.get(r.watchId);if(i)i.onMessage(r);else switch(r.watchId?t._closedWatches.has(r.watchId)?(0,h.reportIDKey)(g.ErrorID,g.ErrorKey.REALTIME_DB_RECV_MSG_WITH_CLOSED_WATCHID,!0):(0,h.reportIDKey)(g.ErrorID,g.ErrorKey.REALTIME_DB_RECV_MSG_WITH_UNKNOWN_WATCHID,!0):(0,h.reportIDKey)(g.ErrorID,g.ErrorKey.REALTIME_DB_RECV_MSG_WITHOUT_WATCHID,!0),r.msgType){case"INIT_EVENT":case"NEXT_EVENT":case"CHECK_EVENT":(i=t._queryIdClientMap.get(r.msgData.queryID))&&i.onMessage(r)}}else if(t._lastPingSendTS){var s=Date.now()-t._lastPingSendTS;if(s>T)return void(t._context.debug&&console.warn("[realtime] untrusted rtt observed: ".concat(s)));t._rttObserved.length>=b&&t._rttObserved.splice(0,t._rttObserved.length-b+1),t._rttObserved.push(s)}},this.login=function(e,r,o){return n.__awaiter(t,void 0,void 0,function(){var t,i,s,a,u,d,p,f,_=this;return n.__generator(this,function(m){switch(m.label){case 0:if(e=e||this._context.env||this._defaultEnvId,!r)if(e){if(t=this._logins.get(e)){if(t.loggedIn&&t.loginResult)return[2,t.loginResult];if(t.loggingInPromise)return[2,t.loggingInPromise]}}else if((i=this._logins.get(""))&&i.loggingInPromise)return[2,i.loggingInPromise];0,s=new Promise(function(t,i){return n.__awaiter(_,void 0,void 0,function(){var s,a,u,d,p;return n.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,o?(0,h.wrapTiming)(this.getSignature(e,r),{timing:o,startKey:"tunnelStartTime",endKey:"tunnelEndTime",condition:{emptyKey:!0}}):this.getSignature(e,r)];case 1:return s=n.sent(),a=(0,c.getWXVersion)(),u={watchId:void 0,requestId:(0,l.genRequestId)(),msgType:"LOGIN",msgData:{envId:s.envId,signStr:s.signStr,secretVersion:s.secretVersion,referrer:"mp",sdkVersion:a.version,dataVersion:a.updateDateInDashes}},[4,this.send({msg:u,waitResponse:!0,skipOnMessage:!0,timeout:A})];case 2:return(d=n.sent()).msgData.code?i(new Error("".concat(d.msgData.code," ").concat(d.msgData.message))):t({envId:s.envId}),[3,4];case 3:return p=n.sent(),i(p),[3,4];case 4:return[2]}})})}),a=e&&this._logins.get(e),u=Date.now(),a?(a.loggedIn=!1,a.loggingInPromise=s,a.loginStartTS=u):(a={loggedIn:!1,loggingInPromise:s,loginStartTS:u},this._logins.set(e||"",a)),m.label=1;case 1:return m.trys.push([1,3,,4]),[4,s];case 2:if(d=m.sent(),(p=this._logins.get(e||""))&&p===a&&p.loginStartTS===u)return a.loggedIn=!0,a.loggingInPromise=void 0,a.loginStartTS=void 0,a.loginResult=d,[2,d];if(p){if(p.loggedIn&&p.loginResult)return[2,p.loginResult];if(p.loggingInPromise)return[2,p.loggingInPromise];throw new Error("ws unexpected login info")}throw new Error("ws login info reset");case 3:throw f=m.sent(),a.loggedIn=!1,a.loggingInPromise=void 0,a.loginStartTS=void 0,a.loginResult=void 0,f;case 4:return[2]}})})},this.getSignature=function(e,r){return n.__awaiter(t,void 0,void 0,function(){var t,o,i,s;return n.__generator(this,function(a){switch(a.label){case 0:if(e=e||this._context.env||this._defaultEnvId,!r&&e&&this._signatures.has(e)){if(t=this._signatures.get(e),Date.now()<t.expireTS)return[2,t]}else 0;return o=Date.now()+6e4,[4,(0,u.getRealtimeConnectionSignature)(this._context,e)];case 1:return i=a.sent(),Date.now()-o>6e4?[2,this.getSignature(e,r)]:(s=n.__assign(n.__assign({},i),{expireTS:o}),this._signatures.set(s.envId,s),e||(this._defaultEnvId=s.envId),[2,s])}})})},this.getWaitExpectedTimeoutLength=function(){return t._rttObserved.length?t._rttObserved.reduce(function(e,t){return e+t})/t._rttObserved.length*1.5:S},this.ping=function(){return n.__awaiter(t,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:return e={watchId:void 0,requestId:(0,l.genRequestId)(),msgType:"PING",msgData:null},[4,this.send({msg:e})];case 1:return t.sent(),this._context.debug&&console.log("ping sent"),[2]}})})},this.send=function(e){return new Promise(function(r,o){return n.__awaiter(t,void 0,void 0,function(){var t,s,a,u,l,d=this;return n.__generator(this,function(f){if(this._fsm.currentState!==i.WSState.CONNECTED)return[2,o(new Error("websocket not connected"))];s=!1,a=!1,u=function(e){s=!0,t&&clearTimeout(t),r(e)},l=function(e){a=!0,t&&clearTimeout(t),o(e)},e.timeout&&(t=setTimeout(function(){return n.__awaiter(d,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return s&&a?[3,2]:[4,(0,c.sleep)(0)];case 1:e.sent(),s&&a||l(new p.TimeoutError("wsclient.send timedout")),e.label=2;case 2:return[2]}})})},e.timeout));try{if(this._context.debug&&console.log("[realtime] ws send ".concat(e.msg.msgType," (").concat((new Date).toLocaleString(),"): "),e),!this._ws)return l(new Error("invalid state: ws connection not exists, can not send message")),[2];if(this._ws.readyState!==E.OPEN)return l(new Error("ws readyState invalid: ".concat(this._ws.readyState,", can not send message"))),[2];e.waitResponse&&this._wsResponseWait.set(e.msg.requestId,{resolve:u,reject:l,skipOnMessage:e.skipOnMessage}),this._ws.send({data:JSON.stringify(e.msg),success:function(t){e.waitResponse||u(t)},fail:function(t){l(t),e.waitResponse&&d._wsResponseWait.delete(e.msg.requestId)}})}catch(e){l(e)}return[2]})})})},this.onWatchStart=function(e,r){t._queryIdClientMap.set(r,e)},this.onWatchClose=function(e,r){r&&t._queryIdClientMap.delete(r),t._watchIdClientMap.delete(e.watchId),t._virtualWSClient.delete(e),t._closedWatches.add(e.watchId),t._virtualWSClient.size||t.close(d.CLOSE_EVENT_CODE.NoRealtimeListeners)},this.getEJSON=function(){return t._EJSON},this._fsm=new a.FSM({initialState:i.WSState.DISCONNECTED,states:i.WSStates}),this._serviceContext=e.serviceContext}return Object.defineProperty(e.prototype,"_context",{get:function(){return this._serviceContext},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_maxReconnect",{get:function(){return this._context.appConfig.realtimeMaxReconnect},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_reconnectInterval",{get:function(){return this._context.appConfig.realtimeReconnectInterval},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_totalConnectionTimeout",{get:function(){return this._context.appConfig.realtimeTotalConnectionTimeout},enumerable:!1,configurable:!0}),e.prototype.heartbeat=function(e){var t=this;this.clearHeartbeat(),this._pingTimeoutId=setTimeout(function(){return n.__awaiter(t,void 0,void 0,function(){var e=this;return n.__generator(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),this._ws&&this._ws.readyState===E.OPEN?(this._lastPingSendTS=Date.now(),[4,this.ping()]):[2];case 1:return t.sent(),this._pingFailed=0,this._pongTimeoutId=setTimeout(function(){e._context.debug&&console.error("pong timed out"),e._pongMissed<2?(e._pongMissed++,e.heartbeat(!0)):e.close(d.CLOSE_EVENT_CODE.HeartbeatPongTimeoutError)},this._context.appConfig.realtimePongWaitTimeout),[3,3];case 2:return t.sent(),this._pingFailed<2?(this._pingFailed++,this.heartbeat()):this.close(d.CLOSE_EVENT_CODE.HeartbeatPingError),[3,3];case 3:return[2]}})})},e?0:this._context.appConfig.realtimePingInterval)},e.prototype.clearHeartbeat=function(){this._pingTimeoutId&&clearTimeout(this._pingTimeoutId),this._pongTimeoutId&&clearTimeout(this._pongTimeoutId)},e.prototype.clearTotalReconnectTimeout=function(){this._totalConnectionTimeoutId&&clearTimeout(this._totalConnectionTimeoutId)},e.prototype.close=function(e){this.clearHeartbeat(),this._ws&&(this._ws.close({code:e,reason:d.CLOSE_EVENT_CODE_INFO[e].name}),this._ws=void 0)},e.prototype.watch=function(e){var t=this,r={apiStartTime:Date.now()},o=!1,a=function(){(0,v.reportAPISpeed)(n.__assign(n.__assign({},r),{apiName:e.reportAPIName}))},c=e.onChange,u=e.onError;this._fsm.currentState===i.WSState.DISCONNECTED&&(this._connectionEnvId=e.envId,this.initWebSocketConnection(!1));var l=new s.VirtualWebSocketClient(n.__assign(n.__assign({},e),{parentFSM:this._fsm,send:this.send,login:this.login,isWSConnected:this.isWSConnected,getWaitExpectedTimeoutLength:this.getWaitExpectedTimeoutLength,getEJSON:this.getEJSON,getServiceContext:function(){return t._context},onWatchStart:this.onWatchStart,onWatchClose:this.onWatchClose,timing:r,debug:this._context.debug,wsclient:this,onChange:p,onError:f}));this._virtualWSClient.add(l),this._watchIdClientMap.set(l.watchId,l);var d=l.listener;return d;function p(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];o||(o=!0,r.apiEndTime=Date.now(),a()),_(),y.default.surroundThirdByTryCatch(function(){return d.onChange.apply(e,t)})()}function f(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];o||(o=!0,r.apiEndTime=Date.now(),a()),_(),y.default.surroundThirdByTryCatch(function(){return d.onError.apply(e,t)})()}function _(){d.onChange===p&&(d.onChange=c),d.onError===f&&(d.onError=u)}},e}();t.RealtimeWebSocketClient=C},"./src/services/database/api/database/realtime/ws-event.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getWSCloseError=t.CLOSE_EVENT_CODE=t.CLOSE_EVENT_CODE_INFO=void 0;var n=r("./src/utils/error.ts"),o=r("./src/config/error.config.ts");t.CLOSE_EVENT_CODE_INFO={1000:{code:1e3,name:"Normal Closure",description:"Normal closure; the connection successfully completed whatever purpose for which it was created."},1001:{code:1001,name:"Going Away",description:"The endpoint is going away, either because of a server failure or because the browser is navigating away from the page that opened the connection."},1002:{code:1002,name:"Protocol Error",description:"The endpoint is terminating the connection due to a protocol error."},1003:{code:1003,name:"Unsupported Data",description:"The connection is being terminated because the endpoint received data of a type it cannot accept (for example, a text-only endpoint received binary data)."},1005:{code:1005,name:"No Status Received",description:"Indicates that no status code was provided even though one was expected."},1006:{code:1006,name:"Abnormal Closure",description:"Used to indicate that a connection was closed abnormally (that is, with no close frame being sent) when a status code is expected."},1007:{code:1007,name:"Invalid frame payload data",description:"The endpoint is terminating the connection because a message was received that contained inconsistent data (e.g., non-UTF-8 data within a text message)."},1008:{code:1008,name:"Policy Violation",description:"The endpoint is terminating the connection because it received a message that violates its policy. This is a generic status code, used when codes 1003 and 1009 are not suitable."},1009:{code:1009,name:"Message too big",description:"The endpoint is terminating the connection because a data frame was received that is too large."},1010:{code:1010,name:"Missing Extension",description:"The client is terminating the connection because it expected the server to negotiate one or more extension, but the server didn't."},1011:{code:1011,name:"Internal Error",description:"The server is terminating the connection because it encountered an unexpected condition that prevented it from fulfilling the request."},1012:{code:1012,name:"Service Restart",description:"The server is terminating the connection because it is restarting."},1013:{code:1013,name:"Try Again Later",description:"The server is terminating the connection due to a temporary condition, e.g. it is overloaded and is casting off some of its clients."},1014:{code:1014,name:"Bad Gateway",description:"The server was acting as a gateway or proxy and received an invalid response from the upstream server. This is similar to 502 HTTP Status Code."},1015:{code:1015,name:"TLS Handshake",description:"Indicates that the connection was closed due to a failure to perform a TLS handshake (e.g., the server certificate can't be verified)."},3000:{code:3e3,name:"Reconnect WebSocket",description:"The client is terminating the connection because it wants to reconnect"},3001:{code:3001,name:"No Realtime Listeners",description:"The client is terminating the connection because no more realtime listeners exist"},3002:{code:3002,name:"Heartbeat Ping Error",description:"The client is terminating the connection due to its failure in sending heartbeat messages"},3003:{code:3003,name:"Heartbeat Pong Timeout Error",description:"The client is terminating the connection because no heartbeat response is received from the server"},3004:{code:3004,name:"Client Reconnect on Server Upgrade",description:"The client is terminating the connection in response to server upgrade"},3050:{code:3050,name:"Server Close Unauthenticated Idle Connection",description:"The server is terminating the connection because the connection is idle and not authenticated"},3051:{code:3051,name:"Server Upgrade",description:"The server is terminating the connection because it is upgrading"},3052:{code:3052,name:"Server Requires Authentication",description:"The server is terminating the connection because it has not received authentication message as the connection's first message"}},function(e){e[e.NormalClosure=1e3]="NormalClosure",e[e.GoingAway=1001]="GoingAway",e[e.ProtocolError=1002]="ProtocolError",e[e.UnsupportedData=1003]="UnsupportedData",e[e.NoStatusReceived=1005]="NoStatusReceived",e[e.AbnormalClosure=1006]="AbnormalClosure",e[e.InvalidFramePayloadData=1007]="InvalidFramePayloadData",e[e.PolicyViolation=1008]="PolicyViolation",e[e.MessageTooBig=1009]="MessageTooBig",e[e.MissingExtension=1010]="MissingExtension",e[e.InternalError=1011]="InternalError",e[e.ServiceRestart=1012]="ServiceRestart",e[e.TryAgainLater=1013]="TryAgainLater",e[e.BadGateway=1014]="BadGateway",e[e.TLSHandshake=1015]="TLSHandshake",e[e.ReconnectWebSocket=3e3]="ReconnectWebSocket",e[e.NoRealtimeListeners=3001]="NoRealtimeListeners",e[e.HeartbeatPingError=3002]="HeartbeatPingError",e[e.HeartbeatPongTimeoutError=3003]="HeartbeatPongTimeoutError",e[e.ReconnectOnServerUpgrade=3004]="ReconnectOnServerUpgrade",e[e.UnauthenticatedIdleConnection=3050]="UnauthenticatedIdleConnection",e[e.ServerUpgrade=3051]="ServerUpgrade",e[e.AuthenticationRequired=3052]="AuthenticationRequired"}(t.CLOSE_EVENT_CODE||(t.CLOSE_EVENT_CODE={}));t.getWSCloseError=function(e,r){var i=t.CLOSE_EVENT_CODE_INFO[e],s=i?"".concat(i.name,", code ").concat(e,", reason ").concat(r||i.description):"code ".concat(e);return new n.CloudSDKError({errCode:o.ERR_CODE.SDK_DATABASE_REALTIME_LISTENER_WEBSOCKET_CONNECTION_CLOSED,errMsg:s})}},"./src/services/database/api/database/regexp.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.RegExp=t.regExp=void 0;var n=r("./src/services/database/api/database/helper/symbol.ts"),o=r("./src/utils/assert.ts");t.regExp=function(e){return new i(e)};var i=function(){function e(e){(0,o.assertType)(e,{regexp:"string"},"RegExp options"),e.options&&(0,o.assertType)(e.options,"string"),this.regexp=e.regexp,this.options=e.options||""}return Object.defineProperty(e.prototype,"_internalType",{get:function(){return n.SYMBOL_REGEXP},enumerable:!1,configurable:!0}),e.prototype.toJSON=function(){return{$regex:this.regexp,$options:this.options}},e}();t.RegExp=i},"./src/services/database/index.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.registerService=void 0;var n=r("./src/services/database/api/api.ts"),o="database";t.registerService=function(e){e.registerService(function(e){var t={name:o,identifiers:e.identifiers,request:e.request,isInstance:e.isInstance,get debug(){return e.debug},get env(){return e.getEnvForService(o)},appConfig:{get docSizeLimit(){return e.appConfig.db_doc_size_limit},get realtimePingInterval(){return e.appConfig.db_realtime_ping_interval},get realtimePongWaitTimeout(){return e.appConfig.db_realtime_pong_wait_timeout},get realtimeMaxReconnect(){return e.config.database.realtime.maxReconnect},get realtimeReconnectInterval(){return e.config.database.realtime.reconnectInterval},get realtimeTotalConnectionTimeout(){return e.config.database.realtime.totalConnectionTimeout},get realtimeQueryEventCacheTimeout(){return e.appConfig.db_realtime_query_event_cache_timeout}}};return{name:o,context:t,getAPIs:n.getAPIs.bind(null,t)}}(e))}},"./src/services/database/internal/backend-api/backend-api.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getRealtimeConnectionSignature=t.runAggregate=t.countDocument=t.setDocument=t.updateDocument=t.queryDocument=t.removeDocument=t.addDocument=t.ORDER_DIRECTION=t._ID_TYPE=t.QUERY_TYPE=void 0;var n,o,i=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),s=r("./src/utils/assert.ts"),a=r("./src/utils/type.ts"),c=r("./src/externals/globals/wxconfig.ts");!function(e){e[e.WHERE=0]="WHERE",e[e.DOC=1]="DOC"}(n=t.QUERY_TYPE||(t.QUERY_TYPE={})),function(e){e[e.STRING=1]="STRING",e[e.NUMBER=2]="NUMBER"}(o=t._ID_TYPE||(t._ID_TYPE={})),function(e){e[e.ASC=0]="ASC",e[e.DESC=1]="DESC"}(t.ORDER_DIRECTION||(t.ORDER_DIRECTION={})),t.addDocument=function(e){return i.__awaiter(this,void 0,void 0,function(){var t,r,n,a,c,u,l,d,p,f;return i.__generator(this,function(i){switch(i.label){case 0:return t=e.env,r=e.collectionName,n=e.data,a=e.instanceContext,c=e.timing,u=JSON.stringify(n),(0,s.assertStringLength)({input:u,max:a.serviceContext.appConfig.docSizeLimit,name:"record",maxWording:"".concat((a.serviceContext.appConfig.docSizeLimit/1024).toFixed(0)," KB")}),l={collection_name:r,data:u},d=JSON.stringify(l),c.tunnelStartTime=+new Date,[4,a.serviceContext.request({apiName:"tcbapi_db_adddocument",serviceName:a.serviceContext.name,serializedReqData:d,requireDataNotEmpty:!0,env:t||a.serviceContext.env})];case 1:return p=i.sent(),c.tunnelEndTime=+new Date,f=p.data,c.tunnelTimeNoCSNetCost=f.baseresponse.stat.qbase_cost_time,[2,{_id:f._id_type===o.NUMBER?f._id_number:f._id}]}})})},t.removeDocument=function(e){return i.__awaiter(this,void 0,void 0,function(){var t,o,s,a,u,l,d,p,f,_,m;return i.__generator(this,function(i){switch(i.label){case 0:return t=e.collectionName,o=e.query,s=e.options,a=e.instanceContext,u=e.timing,l=e.env,d=(0,c.isDevTools)()?e.explain:void 0,p=s&&s.multi,f=JSON.stringify({collection_name:t,query:JSON.stringify(o),multi:p,query_type:p?n.WHERE:n.DOC,explain:d}),u.tunnelStartTime=+new Date,[4,a.serviceContext.request({apiName:"tcbapi_db_deletedocument",serviceName:a.serviceContext.name,serializedReqData:f,requireDataNotEmpty:!0,env:l||a.serviceContext.env})];case 1:return _=i.sent(),u.tunnelEndTime=+new Date,d?[2,r("./src/vendor/bson.bundle.js").EJSON.deserialize(_.data)]:(m=_.data,u.tunnelTimeNoCSNetCost=m.baseresponse.stat.qbase_cost_time,[2,{removed:m.deleted}])}})})},t.queryDocument=function(e){return i.__awaiter(this,void 0,void 0,function(){var t,n,o,s,a,u,l,d,p,f,_,m,h,g;return i.__generator(this,function(i){switch(i.label){case 0:return t=e.env,n=e.collectionName,o=e.query,s=e.options,a=void 0===s?{}:s,u=e.instanceContext,l=e.timing,d=e.queryType,p=(0,c.isDevTools)()?e.explain:void 0,f={collection_name:n,query:JSON.stringify(o),query_type:d,explain:p},a.offset&&(f.offset=a.offset),a.limit&&(f.limit=a.limit),a.order&&(f.order=a.order),a.projection&&(f.projection=JSON.stringify(a.projection)),_=JSON.stringify(f),l.tunnelStartTime=+new Date,[4,u.serviceContext.request({apiName:"tcbapi_db_querydocument",serviceName:u.serviceContext.name,serializedReqData:_,requireDataNotEmpty:!0,env:t||u.serviceContext.env})];case 1:return m=i.sent(),l.tunnelEndTime=+new Date,p?[2,r("./src/vendor/bson.bundle.js").EJSON.deserialize(m.data)]:(h=m.data,l.tunnelTimeNoCSNetCost=h.baseresponse.stat.qbase_cost_time,g=h.data_list?JSON.parse(h.data_list):[],[2,{list:g=u.engine.Decoder.decode(g),offset:h.offset,limit:h.limit,total:h.total}])}})})},t.updateDocument=function(e){return i.__awaiter(this,void 0,void 0,function(){var t,n,o,a,u,l,d,p,f,_,m,h,g,v,y;return i.__generator(this,function(i){switch(i.label){case 0:return t=e.env,n=e.collectionName,o=e.query,a=e.data,u=e.options,l=void 0===u?{}:u,d=e.instanceContext,p=e.timing,f=e.queryType,_=(0,c.isDevTools)()?e.explain:void 0,m=JSON.stringify(a),(0,s.assertStringLength)({input:m,max:d.serviceContext.appConfig.docSizeLimit,name:"update expression",maxWording:"".concat((d.serviceContext.appConfig.docSizeLimit/1024).toFixed(0)," KB")}),(h={collection_name:n,query:JSON.stringify(o),data:m,query_type:f,explain:_}).multi=!1!==l.multi,h.merge=!1!==l.merge,l.upsert&&(h.upsert=l.upsert),g=JSON.stringify(h),p.tunnelStartTime=+new Date,[4,d.serviceContext.request({apiName:"tcbapi_db_updatedocument",serviceName:d.serviceContext.name,serializedReqData:g,requireDataNotEmpty:!0,env:t||d.serviceContext.env})];case 1:return v=i.sent(),p.tunnelEndTime=+new Date,_?[2,r("./src/vendor/bson.bundle.js").EJSON.deserialize(v.data)]:(y=v.data,p.tunnelTimeNoCSNetCost=y.baseresponse.stat.qbase_cost_time,[2,{updated:y.updated}])}})})},t.setDocument=function(e){return i.__awaiter(this,void 0,void 0,function(){var t,r,n,c,u,l,d,p,f,_,m,h;return i.__generator(this,function(i){switch(i.label){case 0:return t=e.env,r=e.collectionName,n=e._id,c=e.data,e.options,u=e.instanceContext,l=e.timing,d=JSON.stringify(c),(0,s.assertStringLength)({input:d,max:u.serviceContext.appConfig.docSizeLimit,name:"record",maxWording:"".concat((u.serviceContext.appConfig.docSizeLimit/1024).toFixed(0)," KB")}),p=(0,a.isNumber)(n),f={collection_name:r,_id_type:p?o.NUMBER:o.STRING,data:d},p?f._id_number=n:f._id=n,_=JSON.stringify(f),l.tunnelStartTime=+new Date,[4,u.serviceContext.request({apiName:"tcbapi_db_setdocument",serviceName:u.serviceContext.name,serializedReqData:_,requireDataNotEmpty:!0,env:t||u.serviceContext.env})];case 1:return m=i.sent(),l.tunnelEndTime=+new Date,h=m.data,l.tunnelTimeNoCSNetCost=h.baseresponse.stat.qbase_cost_time,[2,{_id:h._id_type===o.NUMBER?h._id_number:h._id,updated:h._id?0:1,created:h._id?1:0}]}})})},t.countDocument=function(e){return i.__awaiter(this,void 0,void 0,function(){var t,o,s,a,u,l,d,p,f,_;return i.__generator(this,function(i){switch(i.label){case 0:return t=e.env,o=e.collectionName,s=e.query,a=e.instanceContext,u=e.timing,l=(0,c.isDevTools)()?e.explain:void 0,d={collection_name:o,query:JSON.stringify(s),query_type:n.WHERE,explain:l},p=JSON.stringify(d),u.tunnelStartTime=+new Date,[4,a.serviceContext.request({apiName:"tcbapi_db_countdocument",serviceName:a.serviceContext.name,serializedReqData:p,requireDataNotEmpty:!0,env:t||a.serviceContext.env})];case 1:return f=i.sent(),u.tunnelEndTime=+new Date,l?[2,r("./src/vendor/bson.bundle.js").EJSON.deserialize(f.data)]:(_=f.data,u.tunnelTimeNoCSNetCost=_.baseresponse.stat.qbase_cost_time,[2,{total:_.total}])}})})},t.runAggregate=function(e){return i.__awaiter(this,void 0,void 0,function(){var t,n,o,s,a,u,l,d,p,f,_;return i.__generator(this,function(i){switch(i.label){case 0:return t=e.env,n=e.collectionName,o=e.stages,s=e.instanceContext,a=e.timing,u=(0,c.isDevTools)()?e.explain:void 0,l={collection_name:n,stages:o.map(function(e){for(var t in e)return{stage_key:t,stage_value:JSON.stringify(e[t])};throw new Error("empty encoded stage (".concat(JSON.stringify(e),")"))}),explain:u},d=JSON.stringify(l),a.tunnelStartTime=+new Date,[4,s.serviceContext.request({apiName:"tcbapi_db_aggregate",serviceName:s.serviceContext.name,serializedReqData:d,requireDataNotEmpty:!0,env:t||s.serviceContext.env})];case 1:return p=i.sent(),a.tunnelEndTime=+new Date,u?[2,r("./src/vendor/bson.bundle.js").EJSON.deserialize(p.data)]:(f=p.data,a.tunnelTimeNoCSNetCost=f.baseresponse.stat.qbase_cost_time,_=r("./src/vendor/bson.bundle.js").EJSON,[2,{list:JSON.parse(f.list).map(function(e){return _.parse(e)})}])}})})},t.getRealtimeConnectionSignature=function(e,t){return i.__awaiter(this,void 0,void 0,function(){var r,n;return i.__generator(this,function(o){switch(o.label){case 0:return[4,e.request({apiName:"tcbapi_db_get_realtime_connection",env:t||e.env,serviceName:e.name,serializedReqData:JSON.stringify({}),requireDataNotEmpty:!0})];case 1:return r=o.sent(),[2,{envId:(n=r.data).env_id,secretVersion:n.secret_version,signStr:n.sign_str,wsUrl:n.ws_url}]}})})}},"./src/services/database/internal/grammar/default/extractor.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getProjectionDefinition=t.extractQueryOptions=void 0;var n=r("./src/services/database/api/database/query.ts"),o=r("./src/services/database/internal/backend-api/backend-api.ts"),i=r("./src/services/database/internal/grammar/default/serializer/common.ts");t.extractQueryOptions=function(e,t){return{limit:e._query.limit,offset:e._query.offset,order:function(e){return e.map(function(e){return{field:e.fieldPath,direction:e.order===n.ORDER_DIRECTION.DESC?o.ORDER_DIRECTION.DESC:o.ORDER_DIRECTION.ASC}})}(e._query.order||[]),projection:t.engine.ProjectionSerializer.encode(e._field)}},t.getProjectionDefinition=function(e){var t=(0,i.flattenObject)(e);for(var r in t)!0===t[r]||1===t[r]?t[r]=1:!1===t[r]||0===t[r]?t[r]=0:delete t[r];return t}},"./src/services/database/internal/grammar/default/index.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js");n.__exportStar(r("./src/services/database/internal/grammar/default/extractor.ts"),t),n.__exportStar(r("./src/services/database/internal/grammar/default/operator-map.ts"),t),n.__exportStar(r("./src/services/database/internal/grammar/default/serializer.ts"),t)},"./src/services/database/internal/grammar/default/operator-map.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.aggregateOperatorToString=t.operatorToString=t.AggregateOperatorMap=t.OperatorMap=void 0;var n=r("./src/services/database/api/database/commands/query.ts"),o=r("./src/services/database/api/database/commands/logic.ts"),i=r("./src/services/database/api/database/commands/update.ts"),s=r("./src/services/database/api/database/commands/aggregate.ts");for(var a in t.OperatorMap={},t.AggregateOperatorMap={},n.QUERY_COMMANDS_LITERAL)t.OperatorMap[n.QUERY_COMMANDS_LITERAL[a]]="$".concat(n.QUERY_COMMANDS_LITERAL[a]);for(var a in o.LOGIC_COMMANDS_LITERAL)t.OperatorMap[o.LOGIC_COMMANDS_LITERAL[a]]="$".concat(o.LOGIC_COMMANDS_LITERAL[a]);for(var a in i.UPDATE_COMMANDS_LITERAL)t.OperatorMap[i.UPDATE_COMMANDS_LITERAL[a]]="$".concat(i.UPDATE_COMMANDS_LITERAL[a]);for(var a in s.AGGREGATE_COMMANDS_LITERAL)"undefined"!=typeof IS_SDK_PACKAGE&&"toString"===s.AGGREGATE_COMMANDS_LITERAL[a]||(t.AggregateOperatorMap[s.AGGREGATE_COMMANDS_LITERAL[a]]="$".concat(s.AGGREGATE_COMMANDS_LITERAL[a]));t.OperatorMap[n.QUERY_COMMANDS_LITERAL.NEQ]="$ne",t.OperatorMap[i.UPDATE_COMMANDS_LITERAL.REMOVE]="$unset",t.OperatorMap[i.UPDATE_COMMANDS_LITERAL.SHIFT]="$pop",t.OperatorMap[i.UPDATE_COMMANDS_LITERAL.UNSHIFT]="$push",t.OperatorMap[n.QUERY_COMMANDS_LITERAL.GEO_NEAR]="$nearSphere",t.OperatorMap[n.QUERY_COMMANDS_LITERAL.GEO_WITHIN]="$geoWithin",t.OperatorMap[n.QUERY_COMMANDS_LITERAL.GEO_INTERSECTS]="$geoIntersects",t.operatorToString=function(e){return t.OperatorMap[e]||"$".concat(e.toLowerCase())},t.aggregateOperatorToString=function(e){return t.AggregateOperatorMap[e]||"$".concat(e.toLowerCase())}},"./src/services/database/internal/grammar/default/serializer.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js");n.__exportStar(r("./src/services/database/internal/grammar/default/serializer/query.ts"),t),n.__exportStar(r("./src/services/database/internal/grammar/default/serializer/update.ts"),t),n.__exportStar(r("./src/services/database/internal/grammar/default/serializer/projection.ts"),t),n.__exportStar(r("./src/services/database/internal/grammar/default/serializer/decoder.ts"),t),n.__exportStar(r("./src/services/database/internal/grammar/default/serializer/aggregate.ts"),t),n.__exportStar(r("./src/services/database/internal/grammar/default/serializer/common.ts"),t)},"./src/services/database/internal/grammar/default/serializer/aggregate.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.AggregateSerializer=void 0;var n=r("./src/services/database/internal/grammar/default/serializer/common.ts"),o=r("./src/services/database/api/database/aggregate.ts"),i=r("./src/services/database/api/database/commands/aggregate.ts"),s=r("./src/utils/type.ts"),a=r("./src/services/database/internal/grammar/default/operator-map.ts"),c=r("./src/services/database/internal/grammar/default/serializer/query.ts"),u=function(){function e(){}return e.encodeStages=function(e){return(new l).encodeStages(e)},e.encode=function(e){return(new l).encodeAny(e)},e}();t.AggregateSerializer=u;var l=function(){function e(){}return e.prototype.encodeStages=function(e){var t=this;return e.map(function(e){return t.encodePipelineStage(e)})},e.prototype.encodeAny=function(e){var t=this;return(0,n.isConversionRequired)(e)?(0,o.isPipeline)(e)?this.encodePipeline(e):(0,o.isPipelineStage)(e)?this.encodePipelineStage(e):(0,i.isAggregateCommand)(e)?this.encodeAggregateCommand(e):(0,n.encodeInternalDataType)(e):(0,s.isObject)(e)?this.encodeObject(e):(0,s.isArray)(e)?e.map(function(e){return t.encodeAny(e)}):e},e.prototype.encodeObject=function(e){var t={};for(var r in e)t[r]=this.encodeAny(e[r]);return t},e.prototype.encodePipeline=function(e){var t=this;return e._stages.map(function(e){return t.encodeAny(e)})},e.prototype.encodePipelineStage=function(e){var t,r,n="$".concat(e.stage);switch(e.stage){case"match":return(t={})[n]=c.QuerySerializer.encode(e.val),t;default:return(r={})[n]=this.encodeAny(e.val),r}},e.prototype.encodeAggregateCommand=function(e){var t;return(t={})[(0,a.aggregateOperatorToString)(e.operator)]=this.encodeAny(e.operands[0]),t},e}()},"./src/services/database/internal/grammar/default/serializer/common.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.decodeInternalDataType=t.encodeInternalDataType=t.isConversionRequired=t.mergeConditionAfterEncode=t.flattenObject=t.flattenQueryObject=void 0;var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),o=r("./src/utils/error.ts"),i=r("./src/config/error.config.ts"),s=r("./src/utils/type.ts"),a=r("./src/services/database/internal/grammar/default/serializer/datatype.ts");function c(e,t,r,a){var u=n.__assign({},e);for(var l in e)if(!/^\$/.test(l)){var d=e[l];if(d&&(0,s.isObject)(d)&&!t(d)){if(a.indexOf(d)>-1)throw new o.CloudSDKError({errCode:i.ERR_CODE.SDK_DATABASE_CIRCULAR_REFERENCE,errMsg:"Cannot convert circular structure to JSON"});var p=c(d,t,n.__spreadArray(n.__spreadArray([],n.__read(r),!1),[l],!1),n.__spreadArray(n.__spreadArray([],n.__read(a),!1),[d],!1));u[l]=p;var f=!1;for(var _ in p)/^\$/.test(_)?f=!0:(u["".concat(l,".").concat(_)]=p[_],delete u[l][_]);f||delete u[l]}}return u}function u(e){return(0,s.isInternalObject)(e)||(0,s.isDate)(e)||(0,s.isRegExp)(e)}t.flattenQueryObject=function(e){return c(e,u,[],[e])},t.flattenObject=function(e){return c(e,function(e){return!1},[],[e])},t.mergeConditionAfterEncode=function(e,t,r){for(var n in t[r]||delete e[r],t)e[n]?(0,s.isArray)(e[n])?e[n].push(t[n]):(0,s.isObject)(e[n])?(0,s.isObject)(t[n])?Object.assign(e[n],t[n]):(console.warn("unmergable condition, query is object but condition is ".concat((0,s.getType)(t),", can only overwrite"),t,r),e[n]=t[n]):(console.warn("to-merge query is of type ".concat((0,s.getType)(e),", can only overwrite"),e,t,r),e[n]=t[n]):e[n]=t[n]},t.isConversionRequired=u,t.encodeInternalDataType=function(e){return(0,a.serialize)(e)},t.decodeInternalDataType=function(e){return(0,a.deserialize)(e)}},"./src/services/database/internal/grammar/default/serializer/datatype.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.deserialize=t.serialize=void 0;var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),o=r("./src/services/database/api/database/helper/symbol.ts"),i=r("./src/utils/type.ts"),s=r("./src/services/database/api/database/date.ts"),a=r("./src/utils/error.ts"),c=r("./src/config/error.config.ts"),u=r("./src/services/database/api/database/helper/geojson.ts");t.serialize=function(e){return function e(t,r){if(!(0,i.isInternalObject)(t)){if((0,i.isDate)(t))return{$date:+t};if((0,i.isRegExp)(t))return{$regex:t.source,$options:t.flags};if((0,i.isArray)(t))return t.map(function(t){if(r.indexOf(t)>-1)throw new a.CloudSDKError({errCode:c.ERR_CODE.SDK_DATABASE_CIRCULAR_REFERENCE,errMsg:"Cannot convert circular structure to JSON"});return e(t,n.__spreadArray(n.__spreadArray([],n.__read(r),!1),[t],!1))});if((0,i.isObject)(t)){var s=n.__assign({},t);for(var u in s){if(r.indexOf(s[u])>-1)throw new a.CloudSDKError({errCode:c.ERR_CODE.SDK_DATABASE_CIRCULAR_REFERENCE,errMsg:"Cannot convert circular structure to JSON"});s[u]=e(s[u],n.__spreadArray(n.__spreadArray([],n.__read(r),!1),[s[u]],!1))}return s}return t}switch(t._internalType){case o.SYMBOL_GEO_POINT:case o.SYMBOL_GEO_MULTIPOINT:case o.SYMBOL_GEO_LINESTRING:case o.SYMBOL_GEO_MULTILINESTRING:case o.SYMBOL_GEO_POLYGON:case o.SYMBOL_GEO_MULTIPOLYGON:return t.toJSON();case o.SYMBOL_SERVER_DATE:return{$date:t.options};case o.SYMBOL_REGEXP:return{$regex:t.regexp,$options:t.options};default:return t.toJSON?t.toJSON():t}}(e,[e])},t.deserialize=function(e){var t=n.__assign({},e);for(var r in t)switch(r){case"$date":switch((0,i.getType)(t[r])){case"number":return new Date(t[r]);case"object":return(0,s.serverDate)(t[r])}break;case"type":switch(t.coordinates,t.type){case"Point":if((0,u.isGeoJSONPoint)(t))return(0,u.toPoint)(t);break;case"MultiPoint":if((0,u.isGeoJSONMultiPoint)(t))return(0,u.toMultiPoint)(t);break;case"LineString":if((0,u.isGeoJSONLineString)(t))return(0,u.toLineString)(t);break;case"MultiLineString":if((0,u.isGeoJSONMultiLineString)(t))return(0,u.toMultiLineString)(t);break;case"Polygon":if((0,u.isGeoJSONPolygon)(t))return(0,u.toPolygon)(t);break;case"MultiPolygon":if((0,u.isGeoJSONMultiPolygon)(t))return(0,u.toMultiPolygon)(t)}}return e}},"./src/services/database/internal/grammar/default/serializer/decoder.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.Decoder=void 0;var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),o=r("./src/utils/type.ts"),i=r("./src/services/database/internal/grammar/default/serializer/common.ts"),s=function(){function e(){}return e.decode=function(t){return(new e).decodeData(t)},e.prototype.decodeData=function(e){var t=this;switch((0,o.getType)(e)){case"object":return this.decodeObject(e);case"array":return e.map(function(e){if((0,o.isObject)(e)){var r=(0,i.decodeInternalDataType)(e);return r!==e?r:t.decodeObject(e)}return e});default:return e}},e.prototype.decodeObject=function(e){var t=n.__assign({},e);for(var r in t){var s=t[r];switch((0,o.getType)(s)){case"object":var a=(0,i.decodeInternalDataType)(s);t[r]=a!==s?a:this.decodeObject(t[r]);break;case"array":(a=this.decodeData(s))!==s&&(t[r]=a);break;default:continue}}return t},e}();t.Decoder=s},"./src/services/database/internal/grammar/default/serializer/projection.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.ProjectionSerializer=void 0;var n=r("./src/services/database/api/database/commands/projection.ts"),o=r("./src/utils/type.ts"),i=r("./src/services/database/internal/grammar/default/operator-map.ts"),s=r("./src/services/database/internal/grammar/default/serializer/common.ts"),a=function(){function e(){}return e.encode=function(t){return(new e).encodeProjection(t)},e.prototype.encodeProjection=function(e){return(0,n.isProjectionCommand)(e)?this.encodeProjectionCommand(e):"object"===(0,o.getType)(e)?this.encodeProjectionObject(e):e},e.prototype.encodeProjectionCommand=function(e){var t,r=(0,i.operatorToString)(e.operator);switch(e.operator){case n.PROJECTION_COMMANDS_LITERAL.SLICE:default:return(t={})[r]=e.operands[0],t}},e.prototype.encodeProjectionObject=function(e){var t=(0,s.flattenQueryObject)(e);for(var r in t)!0===t[r]||1===t[r]?t[r]=1:!1===t[r]||0===t[r]?t[r]=0:(0,n.isProjectionCommand)(t[r])?t[r]=this.encodeProjectionCommand(t[r]):delete t[r];return t},e}();t.ProjectionSerializer=a},"./src/services/database/internal/grammar/default/serializer/query.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.encode=t.QuerySerializer=void 0;var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),o=r("./src/utils/type.ts"),i=r("./src/services/database/api/database/commands/logic.ts"),s=r("./src/services/database/api/database/commands/query.ts"),a=r("./src/services/database/internal/grammar/default/operator-map.ts"),c=r("./src/services/database/internal/grammar/default/serializer/common.ts"),u=r("./src/services/database/internal/grammar/default/serializer/aggregate.ts"),l=r("./src/services/database/api/database/aggregate.ts"),d=r("./src/services/database/api/database/commands/aggregate.ts"),p=function(){function e(){}return e.encode=function(e){return(0,t.encode)(e)},e}();t.QuerySerializer=p;t.encode=function(e){return(0,i.isLogicCommand)(e)?_(e):(0,s.isQueryCommand)(e)?m(e):(0,l.isPipeline)(e)||(0,d.isAggregateCommand)(e)||(0,l.isPipelineStage)(e)?u.AggregateSerializer.encode(e):(0,o.isObject)(e)?f(e):(0,c.encodeInternalDataType)(e)};var f=function(e){var r,n=(0,c.flattenQueryObject)(e),o=[],u=((r={})[i.LOGIC_COMMANDS_LITERAL.OR]=0,r[i.LOGIC_COMMANDS_LITERAL.NOR]=0,r[i.LOGIC_COMMANDS_LITERAL.AND]=0,r[i.LOGIC_COMMANDS_LITERAL.NOT]=0,r),l=function(e){var r,l,d,p,f,h=n[e];if((0,i.isLogicCommand)(h))switch(h.operator){case i.LOGIC_COMMANDS_LITERAL.OR:case i.LOGIC_COMMANDS_LITERAL.NOR:case i.LOGIC_COMMANDS_LITERAL.AND:u[h.operator]++,o.push(((r={})[(0,a.operatorToString)(h.operator)]=h.operands.map(function(r){var n;return(0,t.encode)(((n={})[e]=r,n))}),r));break;case i.LOGIC_COMMANDS_LITERAL.NOT:var g=h.operands[0];if((0,i.isLogicCommand)(g))switch(g.operator){case i.LOGIC_COMMANDS_LITERAL.AND:u[i.LOGIC_COMMANDS_LITERAL.OR]++,o.push(_(new i.LogicCommmand(i.LOGIC_COMMANDS_LITERAL.OR,g.operands.map(function(t){var r;return(r={})[e]=new i.LogicCommmand(i.LOGIC_COMMANDS_LITERAL.NOT,[t]),r}))));break;case i.LOGIC_COMMANDS_LITERAL.OR:u[i.LOGIC_COMMANDS_LITERAL.NOR]++,o.push(_(new i.LogicCommmand(i.LOGIC_COMMANDS_LITERAL.NOR,g.operands.map(function(t){var r;return(r={})[e]=t,r}))));break;case i.LOGIC_COMMANDS_LITERAL.NOR:u[i.LOGIC_COMMANDS_LITERAL.OR]++,o.push(_(new i.LogicCommmand(i.LOGIC_COMMANDS_LITERAL.OR,g.operands.map(function(t){var r;return(r={})[e]=t,r}))));break;case i.LOGIC_COMMANDS_LITERAL.NOT:o.push((0,t.encode)(((l={})[e]=g.operands[0],l)))}else o.push(((d={})[e]=_(h),d))}else(0,s.isQueryCommand)(h)?o.push(((p={})[e]=m(h),p)):o.push(((f={})[e]=(0,c.encodeInternalDataType)(h),f))};for(var d in n)l(d);return h(o)},_=function(e){var r,o,c,u,l,d;switch(e.operator){case i.LOGIC_COMMANDS_LITERAL.AND:if(e.operands.every(function(e){return(0,s.isQueryCommand)(e)})){var p={};try{for(var f=n.__values(e.operands),_=f.next();!_.done;_=f.next()){var h=_.value;Object.assign(p,m(h))}}catch(e){r={error:e}}finally{try{_&&!_.done&&(o=f.return)&&o.call(f)}finally{if(r)throw r.error}}return p}var g=(0,a.operatorToString)(e.operator),v=e.operands.map(t.encode);return(c={})[g]=v,c;case i.LOGIC_COMMANDS_LITERAL.OR:case i.LOGIC_COMMANDS_LITERAL.NOR:g=(0,a.operatorToString)(e.operator),v=e.operands.map(t.encode);return(u={})[g]=v,u;case i.LOGIC_COMMANDS_LITERAL.NOT:g=(0,a.operatorToString)(e.operator),h=e.operands[0];return(l={})[g]=(0,t.encode)(h),l;default:g=(0,a.operatorToString)(e.operator),v=e.operands.map(t.encode);return(d={})[g]=v,d}},m=function(e){var r,n,o,i,u,l,d,p,f=(0,a.operatorToString)(e.operator);switch(e.operator){case s.QUERY_COMMANDS_LITERAL.EQ:case s.QUERY_COMMANDS_LITERAL.NEQ:case s.QUERY_COMMANDS_LITERAL.LT:case s.QUERY_COMMANDS_LITERAL.LTE:case s.QUERY_COMMANDS_LITERAL.GT:case s.QUERY_COMMANDS_LITERAL.GTE:case s.QUERY_COMMANDS_LITERAL.EXISTS:case s.QUERY_COMMANDS_LITERAL.SIZE:return(r={})[f]=(0,c.encodeInternalDataType)(e.operands[0]),r;case s.QUERY_COMMANDS_LITERAL.IN:case s.QUERY_COMMANDS_LITERAL.NIN:case s.QUERY_COMMANDS_LITERAL.MOD:return(n={})[f]=(0,c.encodeInternalDataType)(e.operands),n;case s.QUERY_COMMANDS_LITERAL.ALL:return(o={})[f]=e.operands.map(t.encode),o;case s.QUERY_COMMANDS_LITERAL.ELEM_MATCH:case s.QUERY_COMMANDS_LITERAL.EXPR:return(i={})[f]=(0,t.encode)(e.operands[0]),i;case s.QUERY_COMMANDS_LITERAL.GEO_NEAR:return(u={})[f]={$geometry:(0,c.encodeInternalDataType)(e.operands[0].geometry),$maxDistance:e.operands[0].maxDistance,$minDistance:e.operands[0].minDistance},u;case s.QUERY_COMMANDS_LITERAL.GEO_WITHIN:var _={};return e.operands[0].geometry&&(_.$geometry=(0,c.encodeInternalDataType)(e.operands[0].geometry)),e.operands[0].centerSphere&&(_.$centerSphere=(0,c.encodeInternalDataType)(e.operands[0].centerSphere)),(l={})[f]=_,l;case s.QUERY_COMMANDS_LITERAL.GEO_INTERSECTS:return(d={})[f]={$geometry:(0,c.encodeInternalDataType)(e.operands[0].geometry)},d;default:return(p={})[f]=e.operands.length>1?e.operands.map(t.encode):(0,t.encode)(e.operands[0]),p}},h=function(e){var t,r,o,i,s={$and:0,$or:0,$nor:0};try{for(var a=n.__values(e),c=a.next();!c.done;c=a.next()){(_=c.value).$and&&s.$and++,_.$or&&s.$or++,_.$nor&&s.$nor++}}catch(e){t={error:e}}finally{try{c&&!c.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}var u=s.$and>1||s.$or>1||s.$nor>1,l=!1,d={};try{for(var p=n.__values(e),f=p.next();!f.done;f=p.next()){var _=f.value;for(var m in _){var h=_[m];u?l?d.$and.push(_):"$and"===m||"$or"===m||"$nor"===m?(l=!0,d.$and=[_]):d[m]=h:d[m]=h}}}catch(e){o={error:e}}finally{try{f&&!f.done&&(i=p.return)&&i.call(p)}finally{if(o)throw o.error}}return d}},"./src/services/database/internal/grammar/default/serializer/update.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.UpdateSerializer=void 0;var n=r("./src/utils/type.ts"),o=r("./src/services/database/api/database/commands/update.ts"),i=r("./src/services/database/internal/grammar/default/operator-map.ts"),s=r("./src/services/database/internal/grammar/default/serializer/common.ts"),a=r("./src/services/database/internal/grammar/default/serializer/query.ts"),c=function(){function e(){}return e.encode=function(e){return u(e)},e}();t.UpdateSerializer=c;var u=function(e){return l(e)},l=function(e){var t=(0,s.flattenQueryObject)(e),r={};for(var c in t){var u=t[c];if((0,o.isUpdateCommand)(u)){var l=(0,i.operatorToString)(u.operator);switch(r[l]||(r[l]={}),u.operator){case o.UPDATE_COMMANDS_LITERAL.SET:case o.UPDATE_COMMANDS_LITERAL.INC:case o.UPDATE_COMMANDS_LITERAL.MUL:case o.UPDATE_COMMANDS_LITERAL.MIN:case o.UPDATE_COMMANDS_LITERAL.MAX:case o.UPDATE_COMMANDS_LITERAL.RENAME:case o.UPDATE_COMMANDS_LITERAL.BIT:r[l][c]=(0,s.encodeInternalDataType)(u.operands[0]);break;case o.UPDATE_COMMANDS_LITERAL.REMOVE:r[l][c]="";break;case o.UPDATE_COMMANDS_LITERAL.PUSH:var d=void 0;d=1===u.operands.length&&(0,n.isObject)(u.operands[0])?{$each:u.operands[0].each.map(s.encodeInternalDataType),$position:u.operands[0].position,$slice:u.operands[0].slice,$sort:u.operands[0].sort}:{$each:u.operands.map(s.encodeInternalDataType)},r[l][c]=d;break;case o.UPDATE_COMMANDS_LITERAL.UNSHIFT:d={$each:u.operands.map(s.encodeInternalDataType),$position:0};r[l][c]=d;break;case o.UPDATE_COMMANDS_LITERAL.POP:r[l][c]=1;break;case o.UPDATE_COMMANDS_LITERAL.SHIFT:r[l][c]=-1;break;case o.UPDATE_COMMANDS_LITERAL.ADD_TO_SET:r[l][c]=(0,n.isObject)(u.operands[0])&&u.operands[0].each?{$each:u.operands[0].each}:u.operands[0];break;case o.UPDATE_COMMANDS_LITERAL.PULL:r[l][c]=a.QuerySerializer.encode(u.operands[0]);break;case o.UPDATE_COMMANDS_LITERAL.PULL_ALL:default:r[l][c]=(0,s.encodeInternalDataType)(u.operands[0])}}else r.$set||(r.$set={}),r.$set[c]=(0,s.encodeInternalDataType)(u)}return r}},"./src/services/database/internal/grammar/engine.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getEngine=t.ENGINES=void 0;var n,o=r("./src/services/database/internal/grammar/default/index.ts");!function(e){e[e.DEFAULT=0]="DEFAULT"}(n=t.ENGINES||(t.ENGINES={})),t.getEngine=function(e){return void 0===e&&(e=n.DEFAULT),o}},"./src/services/functions/api/api.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getAPIs=void 0;var n=r("./src/services/functions/api/callFunction.ts");t.getAPIs=function(e){return{callFunction:(0,n.default)(e)}}},"./src/services/functions/api/callFunction.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.API_NAME_V2=t.API_NAME=t.ResultStatus=t.SlowCallScene=t.SlowCallAction=void 0;var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),o=r("./src/hook/invoke.ts"),i=r("./src/utils/assert.ts"),s=r("./src/utils/error.ts"),a=r("./src/utils/fail-safe.ts"),c=r("./src/utils/fn/clone.ts"),u=r("./src/utils/report.ts"),l=r("./src/services/functions/api/callFunction/sync.ts"),d=r("./src/services/functions/api/callFunction/slow.ts"),p=r("./src/services/functions/api/callFunction/slow.v2.ts"),f=r("./src/services/functions/api/callFunction/v3.ts"),_=r("./src/utils/serializer.ts"),m=r("./src/utils/cdn.ts"),h=r("./src/externals/globals/devtools.ts"),g=r("./src/externals/globals/wxconfig.ts");!function(e){e[e.CALL=1]="CALL",e[e.POLL=2]="POLL"}(t.SlowCallAction||(t.SlowCallAction={})),function(e){e[e.INITIATE_CALL=1]="INITIATE_CALL",e[e.NORMAL_POLL_RETRY=2]="NORMAL_POLL_RETRY",e[e.SYSTEM_ERROR_RETRY=3]="SYSTEM_ERROR_RETRY",e[e.TIMEOUT_RETRY=4]="TIMEOUT_RETRY"}(t.SlowCallScene||(t.SlowCallScene={})),function(e){e[e.PENDING=0]="PENDING",e[e.DONE=1]="DONE",e[e.TIMEOUT=2]="TIMEOUT"}(t.ResultStatus||(t.ResultStatus={})),t.API_NAME="cloud.callFunction",t.API_NAME_V2="cloud.callFunction_real_v2",t.default=function(e){var r,v,y,E;return function(e){var r=+new Date;(0,i.assertType)(e,"object");var n=(0,c.shallowClone)(e);return n.data||(n.data={}),n.context={tunnelTimeNoCSNetCost:0,funcName:e.name,apiStartTime:r,warmStartTime:(0,u.getWarmStartTs)()},(0,o.hasAPICallback)(n)?function(e){(0,a.wrapParamCallbacksWithTryCatch)({apiName:t.API_NAME,param:e}),b(e).then(function(r){(0,o.invokeSuccessCompleteCallbacks)(t.API_NAME,e,r)}).catch(function(r){(0,o.invokeFailCompleteCallbacks)(t.API_NAME,e,r)})}(n):b(n)};function b(o){return n.__awaiter(this,void 0,void 0,function(){function a(){return 1===o.version}var c,b,S;return n.__generator(this,function(T){switch(T.label){case 0:return T.trys.push([0,5,6,7]),function(e){(0,i.assertType)(e,{name:"string"}),e.data&&(0,i.assertType)(e.data,"object"),e.config&&e.config.env&&(0,i.assertType)(e.config.env,"string")}(o),o.cdnMapPromise=m.collect(o.data),c=void 0,c="sdk"===e.runtime.platform&&e.plugins.length?(E||(E=(0,f.default)(e)),E)(o):a()?(r||(r=(0,d.default)(e)),r)(o):(v||(v=(0,p.default)(e)),v)(o),(0,g.isDevTools)()&&(b=Date.now(),(0,h.autoDevtoolsNetworkLog)(c,function(){var t;return{url:"wx.cloud.callFunction.".concat(o.name),headers:{Env:e.isInstance?e.env:(null===(t=o.config)||void 0===t?void 0:t.env)||e.env},reqBody:(0,_.serialize)(o.data),timestampMs:b,console:e.debug}})),[4,c];case 1:return[2,T.sent()];case 2:return[4,(y||(y=(0,l.default)(e)),y)(o)];case 3:return[2,T.sent()];case 4:return[3,7];case 5:throw S=T.sent(),(0,s.returnAsFinalCloudSDKError)(S,t.API_NAME);case 6:return(0,u.reportAPISpeed)(n.__assign(n.__assign({},o.context),{apiEndTime:+new Date,apiName:a()?t.API_NAME:t.API_NAME_V2})),[7];case 7:return[2]}})})}}},"./src/services/functions/api/callFunction/slow.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),o=r("./src/config/error.config.ts"),i=r("./src/externals/public-lib/appserviceSdk.ts"),s=r("./src/utils/assert.ts"),a=r("./src/utils/error.ts"),c=r("./src/utils/msg.ts"),u=r("./src/utils/serializer.ts"),l=r("./src/services/functions/utils/extract.ts"),d=r("./src/services/functions/api/callFunction.ts");t.default=function(e){return function(t){return n.__awaiter(this,void 0,void 0,function(){function r(t){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(r){return[2,new Promise(function(r,s){!function t(r,s,c,l){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){return(0,i.getSDK)(e.identifiers).request({url:r,success:function(e){try{if(200!==e.statusCode)return l((0,a.returnAsFinalCloudSDKError)({errCode:o.ERR_CODE.SDK_FUNCTIONS_POLL_RESULT_STATUS_CODE_ERROR,errMsg:"polling status code ".concat(e.statusCode)},d.API_NAME));var n=e.data;if(!n)return l((0,a.returnAsFinalCloudSDKError)({errCode:o.ERR_CODE.SDK_FUNCTIONS_EMPTY_POLL_RESULT_JSON,errMsg:o.ERR_CODE[o.ERR_CODE.SDK_FUNCTIONS_EMPTY_POLL_RESULT_JSON]},d.API_NAME));if(n.base_resp&&0===n.base_resp.ret){if(0!==n.status){if(1===n.status){if(0!==n.service_errcode){var i=(0,a.returnAsFinalCloudSDKError)({errCode:o.ERR_CODE.SDK_FUNCTIONS_CLOUD_FUNCTION_EXECUTION_ERROR,errMsg:"requestID ".concat(n.func_req_id,", cloud function service error code ").concat(n.service_errcode||"unknown",", error message ").concat(n.service_errmsg||"unknown")},d.API_NAME);return i.requestID=n.func_req_id,l(i)}var p=n.content;try{p=(0,u.deserialize)(p)}catch(e){try{p=JSON.parse(p)}catch(e){}}return c({result:p,requestID:n.func_req_id})}return l((0,a.returnAsFinalCloudSDKError)({errCode:o.ERR_CODE.SDK_FUNCTIONS_POLL_RESULT_EXPIRED,errMsg:"timeout for result fetching"},d.API_NAME))}if(!(s>=0))return l((0,a.returnAsFinalCloudSDKError)({errCode:o.ERR_CODE.SDK_FUNCTIONS_EXCEED_MAX_POLL_RETRY,errMsg:o.ERR_CODE[o.ERR_CODE.SDK_FUNCTIONS_EXCEED_MAX_POLL_RETRY]},d.API_NAME));t(r,s-1,c,l)}else{if(!n.base_resp)return l((0,a.returnAsFinalCloudSDKError)({errCode:o.ERR_CODE.SDK_FUNCTIONS_EMPTY_POLL_RESULT_BASE_RESP,errMsg:o.ERR_CODE[o.ERR_CODE.SDK_FUNCTIONS_EMPTY_POLL_RESULT_BASE_RESP]},d.API_NAME));if(0!==n.base_resp.ret)return l((0,a.returnAsFinalCloudSDKError)({errCode:o.ERR_CODE.SDK_FUNCTIONS_POLL_RESULT_BASE_RESP_RET_ABNORMAL,errMsg:"polling base_resp.ret ".concat(n.base_resp.ret)},d.API_NAME))}}catch(e){l((0,a.returnAsFinalCloudSDKError)({errCode:o.ERR_CODE.SDK_FUNCTIONS_POLL_ERROR,errMsg:"polling catch error: ".concat(e)},d.API_NAME))}},fail:function(e){l((0,a.returnAsFinalCloudSDKError)(e,d.API_NAME))}}),[2]})})}(t,e.appConfig.maxPollRetry||50,r,s)})]})})}var p,f,_,m,h,g,v,y,E,b,S,T,A,w,C,I;return n.__generator(this,function(i){switch(i.label){case 0:if(p=n.__assign({},t.data),(f=(0,l.extractCloudID)(p).map(function(e){return{key_name:e.key,cloud_id:e.cloudID}})).length)try{for(_=n.__values(f),m=_.next();!m.done;m=_.next())h=m.value,delete p[h.key_name]}catch(e){C={error:e}}finally{try{m&&!m.done&&(I=_.return)&&I.call(_)}finally{if(C)throw C.error}}return[4,t.cdnMapPromise];case 1:return g=i.sent(),v=(0,u.serialize)(p,g),(0,s.assertStringLength)({input:v,max:e.appConfig.maxReqDataSize,name:"callFunction data",maxWording:"".concat(e.appConfig.maxReqDataSize/1024," KB")}),y={function_name:t.name,data:v,cloudid_list:f},E=(0,u.serialize)(y),t.context.tunnelStartTime=+new Date,[4,e.request(n.__assign(n.__assign({},t.config),{apiName:"tcbapi_slowcallfunction",serviceName:e.name,serializedReqData:E,env:t.config&&t.config.env||e.env}))];case 2:if(b=i.sent(),t.context.tunnelEndTime=+new Date,!(S=b.data))throw(0,a.returnAsFinalCloudSDKError)({errCode:o.ERR_CODE.SDK_FUNCTIONS_EMPTY_CALL_RESULT,errMsg:o.ERR_CODE[o.ERR_CODE.SDK_FUNCTIONS_EMPTY_CALL_RESULT]},d.API_NAME);if(S.event_id,!S.poll_url)throw(0,a.returnAsFinalCloudSDKError)({errCode:o.ERR_CODE.SDK_FUNCTIONS_EMPTY_POLL_URL,errMsg:o.ERR_CODE[o.ERR_CODE.SDK_FUNCTIONS_EMPTY_POLL_URL]},d.API_NAME);return S.poll_url.indexOf("?")>-1?S.poll_url+="&devtools_ignore=true&skip_domain_check=true":S.poll_url+="?devtools_ignore=true&skip_domain_check=true",t.context.pollStartTime=+new Date,[4,r(S.poll_url)];case 3:return T=i.sent(),A=T.result,w=T.requestID,t.context.pollEndTime=+new Date,[2,{errMsg:(0,c.apiSuccessMsg)(d.API_NAME),result:A,requestID:w}]}})})}}},"./src/services/functions/api/callFunction/slow.v2.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),o=r("./src/config/error.config.ts"),i=r("./src/utils/assert.ts"),s=r("./src/utils/error.ts"),a=r("./src/utils/msg.ts"),c=r("./src/utils/serializer.ts"),u=r("./src/services/functions/utils/extract.ts"),l=r("./src/utils/utils.ts"),d=r("./src/externals/globals/wxconfig.ts"),p=r("./src/services/functions/api/callFunction.ts"),f=20,_=2,m=2,h=2e4,g=function(e){var t=new Date;return"".concat(t.getHours(),":").concat(t.getMinutes(),":").concat(t.getSeconds()," ").concat(e)},v=function(e){return e.join("->")};t.default=function(e){return function(t){return n.__awaiter(this,void 0,void 0,function(){function r(t,r,o,i){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){return[2,new Promise(function(n,s){var a=[g("start")],c=function(e,t,r){var n=function(t){e.push(g("app ".concat(t)))};return(0,l.onAppVisibilityChange)(n),{resolve:function(e){(0,l.offAppVisibilityChange)(n),t(e)},reject:function(e){(0,l.offAppVisibilityChange)(n),r(e)}}}(a,n,s),u=c.resolve,d=c.reject;y({param:t,functionName:t.name,data:r,cloudIDList:o,callID:i,action:p.SlowCallAction.CALL,scene:p.SlowCallScene.INITIATE_CALL,tryCount:e.appConfig.maxPollRetry||f,systemErrorRetry:_,timeoutErrorRetry:m,trace:a,resolve:u,reject:d})})]})})}function y(r){return n.__awaiter(this,void 0,void 0,function(){function i(e){try{if(N)return;j(),P(e);var t=e.data;if(!t)return S.push(g("empty resp")),C((0,s.toSDKError)({errCode:o.ERR_CODE.SDK_FUNCTIONS_EMPTY_CALL_RESULT},p.API_NAME));if(!t.baseresponse||0!==t.baseresponse.errcode)return t.baseresponse?0!==t.baseresponse.errcode?C((0,s.toSDKError)({errCode:o.ERR_CODE.SDK_FUNCTIONS_POLL_RESULT_BASE_RESP_RET_ABNORMAL,errMsg:"polling base_resp.errcode ".concat(t.baseresponse.errcode," errmsg ").concat(t.baseresponse.errmsg," (callId: ").concat(f,")")},p.API_NAME)):C((0,s.toSDKError)({errCode:o.ERR_CODE.SDK_FUNCTIONS_EMPTY_POLL_RESULT_BASE_RESP,errMsg:"polling base_resp ".concat(JSON.stringify(t.baseresponse)," (callId: ").concat(f,")")},p.API_NAME)):C((0,s.toSDKError)({errCode:o.ERR_CODE.SDK_FUNCTIONS_EMPTY_POLL_RESULT_BASE_RESP},p.API_NAME));if(0!==t.status){if(1===t.status){if(0!==t.service_errcode){if(t.service_errcode===o.ERR_CODE.TCB_FUNCTIONS_EXEC_FAIL){var i=t.service_errmsg||"";try{for(var a=i.split("\n"),u=[],l=0;l<a.length;l++)a[l].startsWith("Error: ")&&u.push([a[l],l]);if(u.length%2==1){var d=u[Math.floor(u.length/2)][1];i=a.slice(d).join("\n")}}catch(e){}return(_=(0,s.toSDKError)({errCode:o.ERR_CODE.SDK_FUNCTIONS_CLOUD_FUNCTION_EXECUTION_ERROR,errMsg:"云函数执行错误\n云端堆栈信息(error stack)(".concat(t.func_request_id?"requestId ".concat(t.func_request_id,", "):"","callid ").concat(f,"):\n").concat(i)},p.API_NAME)).stack="Error: ".concat(_.message),_.requestID=t.func_request_id,C(_)}var _;return(_=(0,s.toSDKError)({errCode:o.ERR_CODE.SDK_FUNCTIONS_CLOUD_FUNCTION_EXECUTION_ERROR,errMsg:"\n云函数调用失败(".concat(t.func_request_id?"requestId ".concat(t.func_request_id,", "):"","callid ").concat(f,"):\n").concat(t.service_errcode," ").concat(t.service_errmsg)},p.API_NAME)).stack="Error: ".concat(_.message),_.requestID=t.func_request_id,C(_)}var m=t.data;try{m=(0,c.deserialize)(m)}catch(e){try{m=JSON.parse(m)}catch(e){}}return w({result:m,requestID:t.func_request_id})}return S.push(g("poll result expired")),C((0,s.toSDKError)({errCode:o.ERR_CODE.SDK_FUNCTIONS_POLL_RESULT_EXPIRED,errMsg:"timeout for result fetching, result cannot be fetched anymore (callId: ".concat(f,") (trace: ").concat(v(S),")")},p.API_NAME))}if(!(E>=0))return S.push(g("too many polls, abort")),C((0,s.toSDKError)({errCode:o.ERR_CODE.SDK_FUNCTIONS_EXCEED_MAX_POLL_RETRY,errMsg:"(callId: ".concat(f,") (trace: ").concat(v(S),")")},p.API_NAME));S.push(g("normal poll")),y(n.__assign(n.__assign({},r),{action:p.SlowCallAction.POLL,scene:p.SlowCallScene.NORMAL_POLL_RETRY,tryCount:E-1}))}catch(e){C((0,s.toSDKError)({errCode:o.ERR_CODE.SDK_FUNCTIONS_POLL_ERROR,errMsg:"polling catch error: ".concat(e," (callId: ").concat(f,")")},p.API_NAME))}}var a,u,f,_,m,E,S,T,A,w,C,I,O,R,N,D,j,L,M,P,x=this;return n.__generator(this,function(k){return a=r.functionName,u=r.data,f=r.callID,_=r.action,m=r.scene,E=r.tryCount,S=r.trace,T=r.systemErrorRetry,A=r.timeoutErrorRetry,w=r.resolve,C=r.reject,I=_===p.SlowCallAction.CALL&&(0,d.isDevTools)()?t.localDebugNoTimeout:void 0,O={function_name:a,data:_===p.SlowCallAction.CALL?u:void 0,action:_,scene:m,call_id:f,cloudid_list:_===p.SlowCallAction.CALL?b:[],local_debug_no_timeout:I},R=(0,c.serialize)(O),N=!1,D=!1,j=function(){clearTimeout(M),D=!0},L=+new Date,M=I?void 0:setTimeout(function(){return n.__awaiter(x,void 0,void 0,function(){var t;return n.__generator(this,function(i){switch(i.label){case 0:return t=e.appConfig.clientPollTimeout||h,+new Date-L>t?[4,(0,l.sleep)()]:[3,2];case 1:if(i.sent(),D)return[2];i.label=2;case 2:return!(0,d.isDevTools)()&&+new Date-L>e.appConfig.maxStartRetryGap?(S.push(g("timeout, exceed max retry gap")),[2,C((0,s.toSDKError)({errCode:o.ERR_CODE.SDK_FUNCTIONS_POLL_RESULT_EXPIRED,errMsg:"timeout for retry, cannot retry fetching the result anymore (callId: ".concat(f,") (trace: ").concat(v(S),")")},p.API_NAME))]):(N=!0,r.timeoutErrorRetry>0?(S.push(g("timeout, retry")),y(n.__assign(n.__assign({},r),{scene:p.SlowCallScene.TIMEOUT_RETRY,tryCount:E-1,timeoutErrorRetry:A-1}))):(S.push(g("timeout, abort")),C((0,s.toSDKError)({errCode:o.ERR_CODE.SDK_FUNCTIONS_EXCEED_MAX_TIMEOUT_POLL_RETRY,errMsg:"(callId: ".concat(f,") (trace: ").concat(v(S),")")},p.API_NAME))),[2])}})})},e.appConfig.clientPollTimeout||h),P=function(e){var r,n=e.data;n&&n.baseresponse&&n.baseresponse.stat&&(n.baseresponse.stat.qbase_cost_time&&(t.context.tunnelTimeNoCSNetCost+=n.baseresponse.stat.qbase_cost_time),n.baseresponse.stat.func_exec_cost_time&&(t.context.funcExecTime=n.baseresponse.stat.func_exec_cost_time)),t.context.channelType=null!==(r=e.channelType)&&void 0!==r?r:0,e.profile&&(null===l._wxConsole||void 0===l._wxConsole||l._wxConsole.log("callFunction profile",e.profile))},e.request(n.__assign(n.__assign({},t.config),{apiName:"tcbapi_slowcallfunction_v2",serviceName:e.name,serializedReqData:R,env:t.config&&t.config.env||e.env,stdpriv:!0})).then(i).catch(function(e){N||(j(),e&&e.operateWXDataFail&&T>0?(S.push(g("system error (".concat(e,"), retry"))),y(n.__assign(n.__assign({},r),{scene:p.SlowCallScene.SYSTEM_ERROR_RETRY,tryCount:E-1,systemErrorRetry:T-1}))):(S.push(g("system error (".concat(e,"), abort"))),C((0,s.toSDKError)("".concat(e," (callId: ").concat(f,") (trace: ").concat(v(S),")"),p.API_NAME))))}),[2]})})}var E,b,S,T,A,w,C,I,O,R,N,D,j;return n.__generator(this,function(o){switch(o.label){case 0:if(E=n.__assign({},t.data),(b=(0,u.extractCloudID)(E).map(function(e){return{key_name:e.key,cloud_id:e.cloudID}})).length)try{for(S=n.__values(b),T=S.next();!T.done;T=S.next())A=T.value,delete E[A.key_name]}catch(e){D={error:e}}finally{try{T&&!T.done&&(j=S.return)&&j.call(S)}finally{if(D)throw D.error}}return[4,t.cdnMapPromise];case 1:return w=o.sent(),C=(0,c.serialize)(E,w),(0,i.assertStringLength)({input:C,max:e.appConfig.maxReqDataSize,name:"callFunction data",maxWording:"".concat(e.appConfig.maxReqDataSize/1024," KB")}),I="".concat(+new Date,"-").concat(Math.random()),t.context.tunnelStartTime=+new Date,[4,r(t,C,b,I)];case 2:return O=o.sent(),R=O.result,N=O.requestID,t.context.tunnelEndTime=+new Date,[2,{errMsg:(0,a.apiSuccessMsg)(p.API_NAME),result:R,requestID:N}]}})})}}},"./src/services/functions/api/callFunction/sync.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),o=r("./src/utils/msg.ts"),i=r("./src/utils/serializer.ts"),s=r("./src/services/functions/api/callFunction.ts");t.default=function(e){return function(t){return n.__awaiter(this,void 0,void 0,function(){var r,a,c,u,l;return n.__generator(this,function(n){switch(n.label){case 0:return r={function_name:t.name,data:(0,i.serialize)(t.data),cloudid_list:[]},a=(0,i.serialize)(r),[4,e.request({apiName:"tcbapi_callfunction",serviceName:e.name,serializedReqData:a,env:t.config&&t.config.env||e.env})];case 1:if(c=n.sent(),u=c.data,l=u&&u.data)try{l=JSON.parse(l)}catch(e){}return[2,{errMsg:(0,o.apiSuccessMsg)(s.API_NAME),result:l}]}})})}}},"./src/services/functions/api/callFunction/v3.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),o=r("./src/externals/public-lib/appserviceSdk.ts"),i=r("./src/utils/utils.ts"),s=r("../../../cloud-crypto/dist/index.js"),a=r("./src/utils/msg.ts"),c=r("./src/utils/serializer.ts"),u=r("./src/services/functions/api/callFunction.ts");t.default=function(e){return function(t){var r;return n.__awaiter(this,void 0,void 0,function(){var l,d,p,f,_,m,h,g,v;return n.__generator(this,function(n){switch(n.label){case 0:return l={function_name:t.name,data:(0,c.serialize)(t.data),cloudid_list:[]},d=(0,c.serialize)(l),[4,e.serviceEndpoint.getEndpoint("container")];case 1:return p=n.sent(),f=new Uint8Array((0,i.base64ToArrayBuffer)(p.key)),_={"X-WX-EV":3,"Content-Type":"application/octet-stream"},[4,s.V3.encodeRequest(f,{"X-WX-CALLID":"".concat(+new Date,"-").concat(Math.random()),"X-WX-CLOUDFUNCTION-NAME":t.name,"X-WX-CLOUDFUNCTION-ENV":(null===(r=t.config)||void 0===r?void 0:r.env)||e.env||""},"POST",d)];case 2:return m=n.sent(),[4,new Promise(function(e,t){return(0,o.getSDK)().request({url:p.cloudServiceUrl,method:"POST",header:_,data:m.data.buffer,dataType:"arraybuffer",responseType:"arraybuffer",enableHttp2:!0,success:e,fail:t})})];case 3:if(h=n.sent(),g=s.V3.decodeResponse(f,new Uint8Array(h.data)),v=g.body)try{v=JSON.parse(v)}catch(e){}return[2,{errMsg:(0,a.apiSuccessMsg)(u.API_NAME),result:v}]}})})}}},"./src/services/functions/index.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.registerService=t.FUNCTIONS_SERVICE_NAME=void 0;var n=r("./src/services/functions/api/api.ts");t.FUNCTIONS_SERVICE_NAME="functions",t.registerService=function(e){e.registerService(function(e){var r={name:t.FUNCTIONS_SERVICE_NAME,identifiers:e.identifiers,request:e.request,isInstance:e.isInstance,serviceEndpoint:e.serviceEndpoint,runtime:e.runtimeInfo,plugins:e.plugins,get debug(){return e.debug},get env(){return e.getEnvForService(t.FUNCTIONS_SERVICE_NAME)},appConfig:{get maxReqDataSize(){return e.appConfig.call_function_max_req_data_size},get maxPollRetry(){return e.appConfig.call_function_poll_max_retry},get maxStartRetryGap(){return e.appConfig.call_function_valid_start_retry_gap},get clientPollTimeout(){return e.appConfig.call_function_client_poll_timeout}}};return{name:t.FUNCTIONS_SERVICE_NAME,context:r,getAPIs:n.getAPIs.bind(null,r)}}(e))}},"./src/services/functions/utils/extract.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.extractCloudID=void 0;var n=r("./src/utils/symbol.ts"),o=r("./src/utils/type.ts");t.extractCloudID=function(e){var t=[];for(var r in e)(0,o.isObject)(e[r])&&e[r]._internalType===n.SYMBOL_CLOUD_ID&&t.push({key:r,cloudID:e[r].cloudID});return t}},"./src/services/index.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.registerServices=void 0;var n=r("./src/services/functions/index.ts"),o=r("./src/services/container/index.ts"),i=r("./src/services/storage/index.ts"),s=r("./src/services/database/index.ts"),a=r("./src/services/utils/index.ts"),c=r("./src/services/saas/index.ts");t.registerServices=function(e){(0,n.registerService)(e),(0,i.registerService)(e),(0,s.registerService)(e),(0,a.registerService)(e),(0,o.registerService)(e),(0,c.registerSaaSService)(e)}},"./src/services/obs/index.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.ObsImpl=void 0;var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),o=r("./src/externals/globals/wxconfig.ts"),i=r("./src/externals/public-lib/appserviceSdk.ts"),s=r("./src/utils/utils.ts"),a=r("./src/services/obs/utils/param.ts"),c=r("./src/services/obs/utils/functions.ts"),u=r("./src/services/obs/utils/cos.ts"),l=r("./src/services/obs/utils/utils.ts"),d=r("./src/services/obs/utils/types.ts"),p=null,f={autoStart:!0,isWhitelistMaskMode:!0,exposureSelectorList:[],shouldCapturePage:function(){return!0}},_=function(){function e(e){var t,r,s,u=this;if(this.attrs={},this.getUuid=function(){var e;return null!==(e=u.param.uuid)&&void 0!==e?e:null},this.setAttrs=function(e){var t,r;if(e){try{for(var o=n.__values(Object.keys(e)),i=o.next();!i.done;i=o.next()){var s=i.value,a=e[s];"string"==typeof s&&"string"==typeof a?u.attrs[s]=a:console.warn("[wxobs appservice]the type of attributes must be string")}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}u.uploadAttrs()}},this.uploadAttrs=function(){Object.keys(u.attrs).length>0&&(0,i.getSDK)().emitCustomAttrEvent(n.__assign({},u.attrs))},this.param=e,this.cloudServiceProvider=e.cloudServiceProvider,this.encrypt=e.encrypt,(null===(t=(0,a.getRecordingParam)())||void 0===t?void 0:t.versionBlackList)&&o.default.sdkVersion&&(0,a.getRecordingParam)().versionBlackList.indexOf(o.default.sdkVersion)>=0)throw new Error("[wxobs as] this sdk version is blocked");this.prefix=(0,l.genPrefix)(),this.param.uuid="".concat(this.prefix,"/").concat((0,c.uuidv4)()),this.setupState=new Promise(function(e,t){r=e,s=t}),this.setup().then(function(){return r()}).catch(function(e){return s(e)})}return e.prototype.setup=function(){var e;return n.__awaiter(this,void 0,void 0,function(){var t,r,o;return n.__generator(this,function(s){switch(s.label){case 0:return t=(0,a.getProjectId)(),(0,i.getSDK)().count(d.MetricType.CosInfoFetch),[4,(0,u.getCosInfo)(this.prefix,t)];case 1:if(r=s.sent(),o=n.__assign(n.__assign({},f),this.param),!(0,c.supported)())throw(0,i.getSDK)().count(d.MetricType.Unsupport),new Error("[wxobs as] this system version is not supported");return(0,i.getSDK)().setupUserBehaviorAnalytics(n.__assign(n.__assign({projectId:t,encrypt:this.encrypt,cloudServiceProvider:this.cloudServiceProvider,cosInfo:n.__assign(n.__assign({},r),{prefix:this.prefix})},o),{uuid:o.uuid,dataAttrs:null===(e=this.param.captureDataAttrs)||void 0===e||e})),console.log("[wxobs appservice] obs is setup"),this.setAttrs(this.param.attrs),[2]}})})},e}();t.ObsImpl=_;try{null===__subContextEngine__||void 0===__subContextEngine__||__subContextEngine__.onInitReady(function(){var e;try{null===(e=o.default.onReady)||void 0===e||e.call(o.default,function(){if((0,a.isAutoRecordingMode)()){var e=(0,a.getRecordingParam)();if(console.log("[wxobs appservice]auto recording mode",e),void 0!==e)if(p)console.warn("[wxobs appservice]already setup");else try{var t=e.proportion,r=e.isWhitelistMaskMode,n=e.encrypt,o=e.cloudServiceProvider,s=e.exposureSelectorList;t>=100*Math.random()?(console.log("[wxobs as] auto record",{param:e}),p=new _({isWhitelistMaskMode:r,encrypt:n,cloudServiceProvider:o,exposureSelectorList:s}),(0,i.getSDK)().count(d.MetricType.AutoSetup)):(0,i.getSDK)().count(d.MetricType.MissSample)}catch(e){(0,i.getSDK)().handleWxobsError(d.ErrorType.Setup,e)}else console.warn("[wxobs appservice]can not access recording param")}})}catch(e){null===s._wxConsole||void 0===s._wxConsole||s._wxConsole.warn(e)}})}catch(e){}t.default={setup:function(e){if((0,a.isSdkRecordingMode)())if(p)console.warn("[wxobs appservice] already setup");else try{var t=(0,a.getRecordingParam)();return console.log("[wxobs as] sdk record",{param:e,remoteParam:t}),p=new _(n.__assign(n.__assign({},e),{encrypt:null===t||void 0===t?void 0:t.encrypt,cloudServiceProvider:null===t||void 0===t?void 0:t.cloudServiceProvider,exposureSelectorList:null===t||void 0===t?void 0:t.exposureSelectorList})),(0,i.getSDK)().count(d.MetricType.SdkSetup),p.getUuid()}catch(e){return(0,i.getSDK)().handleWxobsError(d.ErrorType.Setup,e),null}else console.warn("[wxobs appservice]sdk recording mode is not supported")},asyncSetup:function(e){var t;return n.__awaiter(this,void 0,void 0,function(){var r,o,s;return n.__generator(this,function(c){switch(c.label){case 0:if(r={},!(0,a.isSdkRecordingMode)())return r.errMsg="sdk recording mode is not supported",[2,r];if(p)return r.errMsg="recording is already setup",[2,r];c.label=1;case 1:return c.trys.push([1,3,,4]),o=(0,a.getRecordingParam)(),console.log("[wxobs as] sdk record"),[4,(p=new _(n.__assign(n.__assign({},e),{encrypt:null===o||void 0===o?void 0:o.encrypt,cloudServiceProvider:null===o||void 0===o?void 0:o.cloudServiceProvider,exposureSelectorList:null===o||void 0===o?void 0:o.exposureSelectorList}))).setupState];case 2:return c.sent(),r.sessionId=null!==(t=p.getUuid())&&void 0!==t?t:void 0,(0,i.getSDK)().count(d.MetricType.SdkSetup),[2,r];case 3:return s=c.sent(),r.errMsg="setup failed: ".concat(s.message),(0,i.getSDK)().handleWxobsError(d.ErrorType.Setup,s),[2,r];case 4:return[2]}})})},setAttrs:function(e){p?p.setAttrs(e):console.warn("[wxobs appservice] not setup")}}},"./src/services/obs/utils/cos.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getCosInfo=void 0;var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),o=r("./src/servicemarket/operateWXData.ts"),i=r("./src/externals/globals/wxconfig.ts"),s=r("./src/externals/public-lib/appserviceSdk.ts"),a=r("./src/services/obs/utils/types.ts");function c(e){return e.includes(".")||e.includes("?")||e.includes("/")||e.includes("#")}function u(e){return!e||""===e.trim()}t.getCosInfo=function e(t,r){var l;return n.__awaiter(this,void 0,void 0,function(){var d,p,f=this;return n.__generator(this,function(_){switch(_.label){case 0:return _.trys.push([0,2,,3]),[4,(0,o.operateWXData)({apiName:"webapi_getcloudstoragefederationtoken",reqData:{project_key:null!==r&&void 0!==r?r:null===(l=i.default.accountInfo)||void 0===l?void 0:l.appId,object_prefix:"".concat(t,"*")}})];case 1:if(void 0===(d=_.sent()).data)throw new Error("no cos info");if(!function(e){return!(u(e.bucket)||u(e.region)||u(e.secretid)||u(e.secretkey)||u(e.token))&&(!c(e.bucket)&&!c(e.region))}(d.data))throw new Error("invalid cos info");return d.data.expire_timestamp&&(p=1e3*d.data.expire_timestamp-Date.now()-3e5,setTimeout(function(){return n.__awaiter(f,void 0,void 0,function(){var o,i;return n.__generator(this,function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),[4,e(t,r)];case 1:return o=c.sent(),(0,s.getSDK)().count(a.MetricType.CosInfoRefetch),(0,s.getSDK)().resetCosInfo(n.__assign(n.__assign({},o),{prefix:t})),[3,3];case 2:return i=c.sent(),(0,s.getSDK)().handleWxobsError(a.ErrorType.Setup,i,"refetch cos info"),(0,s.getSDK)().count(a.MetricType.Error),[3,3];case 3:return[2]}})})},p>0?p:1e3)),[2,d.data];case 2:throw _.sent();case 3:return[2]}})})}},"./src/services/obs/utils/functions.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.supported=t.uuidv4=void 0;var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),o=r("./src/externals/globals/wxconfig.ts"),i=r("./src/utils/utils.ts");t.uuidv4=function(){return"xxxxx-xxxx-xxxx-xxxx-xxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})},t.supported=function(){var e=o.default.system;if(!e||"ios"!==o.default.platform)return!0;var t=n.__read(e.split(" "),2),r=t[0],s=t[1];return"ios"!==r.toLowerCase()||(0,i.compareVersions)(s,"13.4")>=0}},"./src/services/obs/utils/param.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getProjectId=t.getRecordingParam=t.isSdkRecordingMode=t.isAutoRecordingMode=void 0;var n,o=r("./src/externals/globals/wxconfig.ts");!function(e){e[e.AutoRecording=1]="AutoRecording",e[e.SdkRecording=2]="SdkRecording"}(n||(n={})),t.isAutoRecordingMode=function(){var e,t,r,i,s;return(null===(t=null===(e=null===o.default||void 0===o.default?void 0:o.default.appContactInfo)||void 0===e?void 0:e.wxob_meta_data)||void 0===t?void 0:t.wxob_mode)===n.AutoRecording||(null===(s=null===(i=null===(r=null===o.default||void 0===o.default?void 0:o.default.appContactInfo)||void 0===r?void 0:r.stablePassThroughInfo)||void 0===i?void 0:i.wxob_meta_data)||void 0===s?void 0:s.wxob_mode)===n.AutoRecording},t.isSdkRecordingMode=function(){var e,t,r,i,s;return(null===(r=null===(t=null===(e=null===o.default||void 0===o.default?void 0:o.default.appContactInfo)||void 0===e?void 0:e.stablePassThroughInfo)||void 0===t?void 0:t.wxob_meta_data)||void 0===r?void 0:r.wxob_mode)===n.SdkRecording||(null===(s=null===(i=null===o.default||void 0===o.default?void 0:o.default.appContactInfo)||void 0===i?void 0:i.wxob_meta_data)||void 0===s?void 0:s.wxob_mode)===n.SdkRecording},t.getRecordingParam=function(){var e,t,r,n,i,s,a;return(null===(t=null===(e=null===o.default||void 0===o.default?void 0:o.default.appContactInfo)||void 0===e?void 0:e.stablePassThroughInfo)||void 0===t?void 0:t.wxob_meta_data)?{isWhitelistMaskMode:(a=null===(n=null===(r=null===o.default||void 0===o.default?void 0:o.default.appContactInfo)||void 0===r?void 0:r.stablePassThroughInfo)||void 0===n?void 0:n.wxob_meta_data).is_whitelist_mask_mode,proportion:a.proportion,encrypt:a.encrypt,cloudServiceProvider:a.cloud_service_provider,minVersion:a.min_available_sdk_version,versionBlackList:a.sdk_version_black_list,exposureSelectorList:a.exposure_selector_list}:void 0!==(null===(i=null===o.default||void 0===o.default?void 0:o.default.appContactInfo)||void 0===i?void 0:i.wxob_meta_data)?{isWhitelistMaskMode:(a=null===(s=null===o.default||void 0===o.default?void 0:o.default.appContactInfo)||void 0===s?void 0:s.wxob_meta_data).is_whitelist_mask_mode,proportion:a.proportion,encrypt:a.encrypt,cloudServiceProvider:a.cloud_service_provider,minVersion:a.min_available_sdk_version,versionBlackList:a.sdk_version_black_list,exposureSelectorList:a.exposure_selector_list}:void 0},t.getProjectId=function(){var e,t;if(!(null===(e=o.default.accountInfo)||void 0===e?void 0:e.appId))throw new Error("[wxobs as]appid is empty");return null===(t=o.default.accountInfo)||void 0===t?void 0:t.appId}},"./src/services/obs/utils/types.ts":function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorType=t.MetricType=void 0,function(e){e[e.LayoutCost=1]="LayoutCost",e[e.EncryptCost=2]="EncryptCost",e[e.CompressCost=3]="CompressCost",e[e.UploadCosCost=4]="UploadCosCost",e[e.UploadWxCost=5]="UploadWxCost",e[e.TaskCost=6]="TaskCost",e[e.LongTaskCost=7]="LongTaskCost",e[e.WebviewEvent=30]="WebviewEvent",e[e.AppserviceEvent=31]="AppserviceEvent",e[e.Error=32]="Error",e[e.Unsupport=33]="Unsupport",e[e.Task=34]="Task",e[e.LongTask=35]="LongTask",e[e.CosInfoFetch=37]="CosInfoFetch",e[e.CosInfoRefetch=38]="CosInfoRefetch",e[e.UploadCosSucess=39]="UploadCosSucess",e[e.UploadCosFailure=40]="UploadCosFailure",e[e.UploadWxSucess=41]="UploadWxSucess",e[e.UploadWxFailure=42]="UploadWxFailure",e[e.AutoSetup=43]="AutoSetup",e[e.SdkSetup=44]="SdkSetup",e[e.MissSample=45]="MissSample",e[e.CosAppend=46]="CosAppend",e[e.CosPut=47]="CosPut",e[e.CosHead=48]="CosHead",e[e.CommonAssetMiss=49]="CommonAssetMiss",e[e.CommonAssetHit=50]="CommonAssetHit",e[e.UploadWxSize=80]="UploadWxSize",e[e.UploadCosSize=81]="UploadCosSize",e[e.UploadCommonSize=82]="UploadCommonSize",e[e.HitCommonSize=83]="HitCommonSize"}(t.MetricType||(t.MetricType={})),function(e){e[e.Setup=1]="Setup",e[e.AppserviceStart=2]="AppserviceStart",e[e.WebviewStart=3]="WebviewStart",e[e.AppserviceCollect=4]="AppserviceCollect",e[e.WebviewCollect=5]="WebviewCollect",e[e.AppserviceEncode=6]="AppserviceEncode",e[e.WebviewEncode=7]="WebviewEncode",e[e.AppserviceReport=8]="AppserviceReport",e[e.WebviewReportCos=9]="WebviewReportCos",e[e.WebviewClean=10]="WebviewClean",e[e.WebviewReportWx=11]="WebviewReportWx",e[e.WebviewReport=12]="WebviewReport",e[e.AppserviceReportCos=13]="AppserviceReportCos",e[e.AppserviceReportWx=14]="AppserviceReportWx"}(t.ErrorType||(t.ErrorType={}))},"./src/services/obs/utils/utils.ts":function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.genPrefix=void 0,t.genPrefix=function(){var e=new Date,t=e.getFullYear().toString(),r=(e.getMonth()+1).toString().padStart(2,"0"),n=e.getDate().toString().padStart(2,"0"),o=e.getHours().toString().padStart(2,"0"),i=e.getMinutes().toString().padStart(2,"0");return"".concat(t).concat(r).concat(n).concat(o).concat(i)}},"./src/services/saas/api.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getAPIs=void 0;var n=r("./src/services/saas/gateway.ts"),o=r("./src/services/saas/smgateway.ts");t.getAPIs=function(e){return{Gateway:{initRequired:!1,fn:(0,n.getGateway)(e)},SMGateway:{initRequired:!1,fn:(0,o.getSMGateway)(e)}}}},"./src/services/saas/formData.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getFileExtension=t.randString=t.WXFormData=void 0;var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),o=r("./src/externals/public-lib/appserviceSdk.ts"),i=r("./src/utils/utils.ts"),s=r("./src/services/saas/mineMap.ts"),a=function(){function e(){this.fileManager=(0,o.getSDK)().wx.getFileSystemManager(),this.data={},this.files=[]}return e.prototype.append=function(e,t){return this.data[e]=t,!0},e.prototype.appendFormData=function(e){this.data=Object.assign(this.data,e)},e.prototype.appendFile=function(e,t,r){var n=this.fileManager.readFileSync(t);return!(Object.prototype.toString.call(n).indexOf("ArrayBuffer")<0)&&(r||(r=function(e){var t=e.lastIndexOf("/");return e.substring(t+1)}(t)),this.files.push({name:e,buffer:n,fileName:r}),!0)},e.prototype.getData=function(){return function(e,t){var r,o,s,a,l="wxmpFormBoundary"+c(),d="--"+l,p=d+"--",f=[];if(e&&"[object Object]"===Object.prototype.toString.call(e))try{for(var _=n.__values(Object.keys(e)),m=_.next();!m.done;m=_.next()){var h=m.value;f=f.concat(u(d,h,e[h]))}}catch(e){r={error:e}}finally{try{m&&!m.done&&(o=_.return)&&o.call(_)}finally{if(r)throw r.error}}if(t&&"[object Array]"===Object.prototype.toString.call(t))try{for(var g=n.__values(t),v=g.next();!v.done;v=g.next()){var y=v.value;f=f.concat(u(d,y.name,y.buffer,y.fileName))}}catch(e){s={error:e}}finally{try{v&&!v.done&&(a=g.return)&&a.call(g)}finally{if(s)throw s.error}}var E=[];return E.push.apply(E,n.__spreadArray([],n.__read((0,i.stringToUtf8Array)(p)),!1)),f=f.concat(E),{contentType:"multipart/form-data; boundary="+l,buffer:new Uint8Array(f).buffer}}(this.data,this.files)},e}();function c(){for(var e="",t="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",r=17;r>0;--r)e+=t[Math.floor(Math.random()*t.length)];return e}function u(e,t,r,o){var a="",c=!!o;a+=e+"\r\n",a+='Content-Disposition: form-data; name="'+t+'"',c?(a+='; filename="'+o+'"\r\n',a+="Content-Type: "+function(e){var t=e.lastIndexOf("."),r=s.mineMap[e.substring(t)];return r?r[0]:"application/octet-stream"}(o)+"\r\n\r\n"):(a+="\r\n\r\n",a+=r);var u=[];if(u.push.apply(u,n.__spreadArray([],n.__read((0,i.stringToUtf8Array)(a)),!1)),c){var l=new Uint8Array(r);u=u.concat(Array.prototype.slice.call(l))}return u.push.apply(u,n.__spreadArray([],n.__read((0,i.stringToUtf8Array)("\r")),!1)),u.push.apply(u,n.__spreadArray([],n.__read((0,i.stringToUtf8Array)("\n")),!1)),u}t.WXFormData=a,t.randString=c,t.getFileExtension=function(e){var t,r;return null!==(r=null===(t=Object.entries(s.mineMap).find(function(t){return n.__read(t,2)[1].includes(e)}))||void 0===t?void 0:t[0])&&void 0!==r?r:"bin"}},"./src/services/saas/gateway.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.GatewayService=t.getGateway=void 0;var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),o=r("./src/externals/public-lib/appserviceSdk.ts"),i=r("../../../cloud-crypto/dist/index.js"),s=r("./src/services/saas/internal.ts"),a=r("./src/utils/utils.ts"),c=r("./src/runtime/runtime.ts"),u=r("./src/externals/globals/devtools.ts"),l=r("./src/utils/simulate-request.ts"),d=r("./src/utils/report.ts"),p=r("./src/utils/serializer.ts"),f=r("./src/utils/token-manager.ts"),_=r("./src/utils/data-pipe.ts"),m="gateway.call",h=function(e){function t(t,r){var n=e.call(this,t)||this;return n.code=r,n}return n.__extends(t,e),t}(Error),g=function(){return"miniprogram"===(0,c.getRuntimeInfo)().env};t.getGateway=function(e){var t=this;return function(r){var o=new v(r),i=r.domain?r.domain:"".concat(r.id||r.appid,".preview.wxcloudrun.com"),c={name:"gateway-plugin",host:i,getMetadata:function(e){return n.__assign(n.__assign({},e),{host:i})},beforeRequest:function(e){return e},afterRequest:function(e){return e},beforeTunnelRequest:function(e){return e},afterTunnelRequest:function(e){return e},context:e,refreshTunnelInfo:g()?function(){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(r){switch(r.label){case 0:return t=(0,a.getSystemInfo)(),[4,e.request({apiName:"tcbapi_get_service_info",serializedReqData:JSON.stringify({system:t.system,wx_app_version:t.version,scene:3})})];case 1:return[2,r.sent().data]}})})}:void 0};return s.SaaSServiceMap.set(o,c),o.tokenManager.invalidate(),o.exportAPI}};var v=function(e){function t(t){var r=e.call(this)||this;return r.options=t,r.session=void 0,r.tokenManager=new f.TokenManager(r.refreshToken.bind(r),function(e){return Math.max(3e4,e)},function(e){return(0,d.setReportToken)(e,"3")}),r.exportAPI={refresh:r.tokenManager.updateSession.bind(r.tokenManager),call:r.call.bind(r)},r}return n.__extends(t,e),t.prototype.refreshToken=function(e){this.session=e;var t=s.SaaSServiceMap.get(this);return new Promise(function(r,n){t.refreshTunnelInfo?t.refreshTunnelInfo().then(function(e){return r(e)}).catch(function(e){return n(e)}):(0,o.getSDK)().request({url:"https://".concat(t.host,"/__wx__/auth?devtools_ignore=true"),method:"post",header:{"x-wx-accept-encryption":3,"x-wx-encryption-timestamp":Date.now(),"x-wx-lib-build-ts":1685699826199},data:JSON.stringify({session:e,fingerprint:"",timestamp:Date.now(),nonce:Math.random()}),success:function(e){var t=e.data;return r(t)},fail:function(e){n(e)}})})},t.prototype.callV2=function(e){return n.__awaiter(this,void 0,void 0,function(){var t,r,o,i,a,c;return n.__generator(this,function(u){switch(u.label){case 0:return[4,(0,_.processDataPipeParam)(e,"v2-".concat(Date.now(),"-").concat(function(e){void 0===e&&(e=21);for(var t="",r=e;r--;)t+="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"[64*Math.random()|0];return t}(8)))];case 1:return t=u.sent(),r=t.tunnelReqDataType,o=t.callID,i=s.SaaSServiceMap.get(this),a=i.host,e.header=n.__assign(n.__assign({},e.header),{"X-WX-HTTP-HOST":a,"X-WX-HTTP-PATH":e.path}),e.context.tunnelStartTime=+new Date,[4,(0,_.callAndWaitResult)(m,e,e.data,r,o,i.context)];case 2:return c=u.sent().result,E(e,c.header,c.data),e.context.tunnelEndTime=+new Date,(0,d.reportCallContainerLike)(m,e,"v2-gw"),[2,n.__assign(n.__assign({},c),{callID:o,errMsg:"".concat(m,":ok")})]}})})},t.prototype.callV3=function(e){return n.__awaiter(this,void 0,void 0,function(){var t,r,c,u,p,f,_,g,v=this;return n.__generator(this,function(b){switch(b.label){case 0:return t=e.context.apiStartTime,[4,this.tokenManager.getToken()];case 1:return r=b.sent(),e.stats.getServiceEndpoint=Date.now()-t,c=new Uint8Array((0,a.base64ToArrayBuffer)(r.key)),u=s.SaaSServiceMap.get(this),p=u.host,e.stats.domain=p,f=e[s.ExposedHeaderSymbol],_=Date.now(),[4,i.V3.encodeRequest(c,n.__assign(n.__assign(n.__assign({},e.header),{"X-WX-TARGET-SERVICE":"HTTP","X-WX-HTTP-HOST":p,"X-WX-HTTP-PATH":e.path}),f),e.method||"GET",e.data,e.stats)];case 2:return g=b.sent(),console.log("v3 crypto cost",Date.now()-_),e.stats.requestStartTs=Date.now(),e.stats.callid=g.callId,[2,new Promise(function(t,s){try{(0,o.getSDK)().request({url:"https://".concat(p,"/__wx__/call?token=").concat(r.token,"&devtools_ignore=true"),method:"POST",header:n.__assign({"X-WX-EV":3,"Content-Type":"application/octet-stream"},f),data:g.data.buffer,dataType:"arraybuffer",responseType:"arraybuffer",enableHttp2:!0,enableQuic:!0,timeout:e.timeout,success:function(o){if(e.stats||(e.stats={}),e.stats.requestSuccessTs=Date.now(),e.stats.profile=o.profile,e.stats.httpRequest=Date.now()-e.stats.requestStartTs,o.statusCode&&200!==o.statusCode){var a=y(o.data);s(new h("".concat(m,": fail invalid status code ").concat(a,", status code: ").concat(o.statusCode,", callid: ").concat(e.stats.callid),o.statusCode))}else{try{E(e,o.header,o.data)}catch(e){return void s(e)}var u=Date.now(),p=i.V3.decodeResponse(c,new Uint8Array(o.data),e.stats),f=p.header,_=p.body,b=p.statusCode;console.log("v3 decode cost",Date.now()-u);try{E(e,f,_)}catch(o){return 85104!==o.code||e.isRetry?void s(o):void r.invalidate().then(function(){v.call(n.__assign(n.__assign({},e),{isRetry:!0})).then(t).catch(s)}).catch(s)}var S=(0,l.processResponse)(e,_,b);(0,d.reportCallContainerLike)(m,e,"v3"),t({data:S,statusCode:b,header:f,callID:g.callId,errMsg:"".concat(m,":ok"),profile:o.profile})}},fail:function(e){s(n.__assign(n.__assign({},e),{errCode:-9999,errMsg:e.errMsg.replace(/^request/,m),apiEndTime:Date.now()}))}})}catch(e){s(e)}})]}})})},t.prototype.call=function(e){var t,r,o;return n.__awaiter(this,void 0,void 0,function(){var i,a,c,f,h,g,v,y=this;return n.__generator(this,function(E){switch(E.label){case 0:return i=Date.now(),(0,l.processParam)(e),a=s.SaaSServiceMap.get(this),c=n.__assign(n.__assign({},e),{stats:{apiStartTime:i},context:{apiStartTime:i}}),f=this.tokenManager.getTokenSync(),3!==c.apiVersion?[3,2]:[4,this.tokenManager.getToken()];case 1:f=E.sent(),E.label=2;case 2:h=2!==c.apiVersion&&f?this.callV3(c).catch(function(e){var t=Date.now();if(-9999===(null===e||void 0===e?void 0:e.errCode))return(0,d.reportAPISpeed)({apiName:m,funcName:"GatewayV3",apiStartTime:i,apiEndTime:t,tunnelStartTime:i,tunnelEndTime:t,errMsg:null===e||void 0===e?void 0:e.errMsg,resultStatus:2}),y.callV2(c);throw e}):this.callV2(c).catch(function(e){var t=Date.now();if(e.type===_.DATA_PIPE_SIZE_LIMIT_ERROR)return(0,d.reportAPISpeed)({apiName:m,funcName:"GatewayV2",apiStartTime:i,apiEndTime:t,tunnelStartTime:c.context.tunnelStartTime||i,tunnelEndTime:c.context.tunnelEndTime||t,errMsg:"DataSizeLimitFallback",resultStatus:2}),y.callV3(n.__assign(n.__assign({},c),{apiVersion:3}));throw(0,d.reportAPISpeed)({apiName:m,funcName:"GatewayV2",apiStartTime:i,apiEndTime:t,tunnelStartTime:c.context.tunnelStartTime||i,tunnelEndTime:c.context.tunnelEndTime||t,errMsg:null===e||void 0===e?void 0:e.errMsg,resultStatus:2}),e}),h=(0,l.followRedirect)(e,h,this.call.bind(this),a.context,m),(0,u.autoDevtoolsNetworkLog)(h,function(){return{url:"gateway.call".concat(e.path),method:e.method,headers:e.header,reqBody:(0,p.serialize)(e.data),timestampMs:i}}),g=void 0,E.label=3;case 3:return E.trys.push([3,5,6,7]),[4,h];case 4:return g=E.sent(),null===(t=e.success)||void 0===t||t.call(e,g),[2,g];case 5:throw v=E.sent(),g=v,null===(r=e.fail)||void 0===r||r.call(e,v),v;case 6:return null===(o=e.complete)||void 0===o||o.call(e,g),[7];case 7:return[2]}})})},t}(s.SaaSService);function y(e){if(e instanceof ArrayBuffer)try{return(0,a.arrayBufferToString)(e)}catch(e){}return e}function E(e,t,r){if(t["x-wx-system-error"]){var n=+t["x-wx-system-error"];throw r=y(r),new h("".concat(m,": fail wx system error ").concat(r,", code: ").concat(n,", callid: ").concat(e.stats.callid),n)}var o;t["x-wx-server-timing"]&&((o=(t["x-wx-server-timing"]||"").split(",")).length>=2&&(e.stats.serverStartTs=Number(o[0]),e.stats.serverEndTs=Number(o[1])));if(t["x-envoy-upstream-service-time"]){var i=+t["x-envoy-upstream-service-time"];isNaN(i)||(e.stats.upstreamCost=i)}t["x-wx-mesh-upstream-service-time"]&&((o=t["x-wx-mesh-upstream-service-time"].split(",")).length>=2&&(e.stats.meshStartTs=Number(o[0]),e.stats.meshEndTs=Number(o[1])))}t.GatewayService=v},"./src/services/saas/index.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.registerSaaSService=t.SaaSServiceMap=void 0;var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),o=r("./src/services/saas/api.ts"),i=r("./src/services/saas/internal.ts"),s=r("./src/utils/md5.ts"),a=r("./src/externals/public-lib/appserviceSdk.ts"),c=r("./src/services/saas/formData.ts"),u=r("../../node_modules/.pnpm/core-js@3.30.2/node_modules/core-js/full/url/index.js"),l="services";t.SaaSServiceMap=new WeakMap,t.registerSaaSService=function(e){var t=function(e){var t=this,r={name:l,identifiers:e.identifiers,request:e.request,isInstance:e.isInstance,get debug(){return e.debug},get appid(){return e.instanceOptions.appid},appConfig:{}};return{name:l,context:r,getAPIs:o.getAPIs.bind(null,r),getHijackPattern:function(){if("undefined"!=typeof __WXCloudFinanceConf__){console.log("using cloud finance configuration: ",__WXCloudFinanceConf__);var e=(0,o.getAPIs)(r).SMGateway.fn({id:__WXCloudFinanceConf__.gatewayId,domain:__WXCloudFinanceConf__.gatewayDomain});return{request:function(t){var r,o,a=new u(t.url),c=(0,s.md5)(a.hostname);return e.call(n.__assign(n.__assign({publicKey:__WXCloudFinanceConf__.publicKey,data:null!==(o=t.data)&&void 0!==o?o:void 0},t),((r={header:n.__assign(n.__assign({},t.header),{"x-wx-route-tag":c}),path:a.pathname+a.search})[i.ExposedHeaderSymbol]={"x-wx-route-tag":c},r)))},downloadFile:function(r){return n.__awaiter(t,void 0,void 0,function(){var t,o,l,d,p,f,_;return n.__generator(this,function(m){switch(m.label){case 0:return t=new u(r.url),o=(0,s.md5)(t.hostname),[4,e.call((_={url:"",data:void 0,publicKey:__WXCloudFinanceConf__.publicKey,method:"GET",responseType:"arraybuffer",dataType:"arraybuffer",header:n.__assign(n.__assign({},r.header),{"x-wx-route-tag":o}),path:t.pathname+t.search},_[i.ExposedHeaderSymbol]={"x-wx-route-tag":o},_))];case 1:return l=m.sent(),d=l.data,p=(0,a.getSDK)().wx.getFileSystemManager(),f="".concat((0,a.getSDK)().wx.env.USER_DATA_PATH,"/").concat((0,c.randString)(),".").concat((0,c.getFileExtension)(l.header["content-type"])),p.writeFile({filePath:f,data:d,encoding:"binary",success:function(e){var t,n,o,i,s={cookies:null!==(n=null===(t=l.header.cookies)||void 0===t?void 0:t.split(";"))&&void 0!==n?n:[],dataLength:d.byteLength,errMsg:"smGatewayDownloadFile: ok",header:l.header,tempFilePath:f,statusCode:l.statusCode,_fsResult:e};null===(o=r.success)||void 0===o||o.call(r,s),null===(i=r.complete)||void 0===i||i.call(r,s)},fail:function(e){var t,n;null===(t=r.fail)||void 0===t||t.call(r,e),null===(n=r.complete)||void 0===n||n.call(r,e)}}),[2]}})})},uploadFile:function(r){return n.__awaiter(t,void 0,void 0,function(){var t,o,a,l,d;return n.__generator(this,function(p){return(t=new c.WXFormData).appendFile(r.name,r.filePath),t.appendFormData(r.formData),o=t.getData(),a=new u(r.url),l=(0,s.md5)(a.hostname),[2,e.call((d={url:"",data:o.buffer,publicKey:__WXCloudFinanceConf__.publicKey,method:"POST",responseType:"text",dataType:"text",header:n.__assign(n.__assign({},r.header),{"content-type":o.contentType,"x-wx-route-tag":l}),path:a.pathname+a.search},d[i.ExposedHeaderSymbol]={"x-wx-route-tag":l},d.success=function(e){var t;return null===(t=r.success)||void 0===t?void 0:t.call(r,n.__assign(n.__assign({},e),{data:e.data,errMsg:"smGatewayDownloadFile: ok"}))},d.fail=r.fail,d.complete=function(e){var t;return null===(t=r.complete)||void 0===t?void 0:t.call(r,n.__assign(n.__assign({},e),{data:e.data,errMsg:"smGatewayDownloadFile: ok"}))},d))]})})}}}return{}}}}(e);e.registerService(t,"services")}},"./src/services/saas/internal.ts":function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ExposedHeaderSymbol=t.SaaSServiceMap=t.SaaSService=void 0;var r=function(){return function(){}}();t.SaaSService=r,t.SaaSServiceMap=new WeakMap,t.ExposedHeaderSymbol=Symbol("Gateway::ExposedHeader")},"./src/services/saas/mineMap.ts":function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.mineMap=void 0,t.mineMap={.001:["application/x-001"],.323:["text/h323"],.907:["drawing/907"],".acp":["audio/x-mei-aac"],".aif":["audio/aiff"],".aiff":["audio/aiff"],".asa":["text/asa"],".asp":["text/asp"],".au":["audio/basic"],".awf":["application/vnd.adobe.workflow"],".bmp":["application/x-bmp"],".c4t":["application/x-c4t"],".cal":["application/x-cals"],".cdf":["application/x-netcdf"],".cel":["application/x-cel"],".cg4":["application/x-g4"],".cit":["application/x-cit"],".cml":["text/xml"],".cmx":["application/x-cmx"],".crl":["application/pkix-crl"],".csi":["application/x-csi"],".cut":["application/x-cut"],".dbm":["application/x-dbm"],".dcd":["text/xml"],".der":["application/x-x509-ca-cert"],".dib":["application/x-dib"],".doc":["application/msword"],".drw":["application/x-drw"],".dwf":["Model/vnd.dwf","application/x-dwf"],".dwg":["application/x-dwg"],".dxf":["application/x-dxf"],".emf":["application/x-emf"],".ent":["text/xml"],".eps":["application/x-ps","application/postscript"],".etd":["application/x-ebx"],".fax":["image/fax"],".fif":["application/fractals"],".frm":["application/x-frm"],".gbr":["application/x-gbr"],".gif":["image/gif"],".gp4":["application/x-gp4"],".hmr":["application/x-hmr"],".hpl":["application/x-hpl"],".hrf":["application/x-hrf"],".htc":["text/x-component"],".html":["text/html"],".htx":["text/html"],".ico":["image/x-icon","application/x-ico"],".iff":["application/x-iff"],".igs":["application/x-igs"],".img":["application/x-img"],".isp":["application/x-internet-signup"],".java":["java/*"],".jpe":["image/jpeg","application/x-jpe"],".jpeg":["image/jpeg"],".jpg":["application/x-jpg","image/jpeg"],".jsp":["text/html"],".lar":["application/x-laplayer-reg"],".lavs":["audio/x-liquid-secure"],".lmsff":["audio/x-la-lms"],".ltr":["application/x-ltr"],".m2v":["video/x-mpeg"],".m4e":["video/mpeg4"],".man":["application/x-troff-man"],".mdb":["application/msaccess","application/x-mdb"],".mfp":["application/x-shockwave-flash"],".mhtml":["message/rfc822"],".mid":["audio/mid"],".mil":["application/x-mil"],".mnd":["audio/x-musicnet-download"],".mocha":["application/x-javascript"],".mp1":["audio/mp1"],".mp2v":["video/mpeg"],".mp4":["video/mpeg4"],".mpd":["application/vnd.ms-project"],".mpeg":["video/mpg"],".mpga":["audio/rn-mpeg"],".mps":["video/x-mpeg"],".mpv":["video/mpg"],".mpw":["application/vnd.ms-project"],".mtx":["text/xml"],".net":["image/pnetvue"],".nws":["message/rfc822"],".out":["application/x-out"],".p12":["application/x-pkcs12"],".p7c":["application/pkcs7-mime"],".p7r":["application/x-pkcs7-certreqresp"],".pc5":["application/x-pc5"],".pcl":["application/x-pcl"],".pdf":["application/pdf","application/pdf"],".pdx":["application/vnd.adobe.pdx"],".pgl":["application/x-pgl"],".pko":["application/vnd.ms-pki.pko"],".plg":["text/html"],".plt":["application/x-plt"],".png":["application/x-png","image/png"],".ppa":["application/vnd.ms-powerpoint"],".pps":["application/vnd.ms-powerpoint"],".ppt":["application/x-ppt","application/vnd.ms-powerpoint"],".prf":["application/pics-rules"],".prt":["application/x-prt"],".ps":["application/postscript","application/x-ps"],".pwz":["application/vnd.ms-powerpoint"],".ra":["audio/vnd.rn-realaudio"],".ras":["application/x-ras"],".rdf":["text/xml"],".red":["application/x-red"],".rjs":["application/vnd.rn-realsystem-rjs"],".rlc":["application/x-rlc"],".rm":["application/vnd.rn-realmedia"],".rmi":["audio/mid"],".rmm":["audio/x-pn-realaudio"],".rms":["application/vnd.rn-realmedia-secure"],".rmx":["application/vnd.rn-realsystem-rmx"],".rp":["image/vnd.rn-realpix"],".rsml":["application/vnd.rn-rsml"],".rtf":["application/msword","application/x-rtf"],".rv":["video/vnd.rn-realvideo"],".sat":["application/x-sat"],".sdw":["application/x-sdw"],".slb":["application/x-slb"],".slk":["drawing/x-slk"],".smil":["application/smil"],".snd":["audio/basic"],".sor":["text/plain"],".spl":["application/futuresplash"],".ssm":["application/streamingmedia"],".stl":["application/vnd.ms-pki.stl"],".sty":["application/x-sty"],".swf":["application/x-shockwave-flash"],".tg4":["application/x-tg4"],".tif":["image/tiff","image/tiff","application/x-tif"],".tiff":["image/tiff"],".top":["drawing/x-top"],".tsd":["text/xml"],".uin":["application/x-icq"],".vcf":["text/x-vcard"],".vdx":["application/vnd.visio"],".vpg":["application/x-vpeg005"],".vsd":["application/x-vsd","application/vnd.visio"],".vst":["application/vnd.visio","application/x-vst"],".vsw":["application/vnd.visio"],".vtx":["application/vnd.visio"],".wav":["audio/wav"],".wb1":["application/x-wb1"],".wb3":["application/x-wb3"],".wiz":["application/msword"],".wk4":["application/x-wk4"],".wks":["application/x-wks"],".wma":["audio/x-ms-wma"],".wmf":["application/x-wmf"],".wmv":["video/x-ms-wmv"],".wmz":["application/x-ms-wmz"],".wpd":["application/x-wpd"],".wpl":["application/vnd.ms-wpl"],".wr1":["application/x-wr1"],".wrk":["application/x-wrk"],".ws2":["application/x-ws"],".wsdl":["text/xml"],".xdp":["application/vnd.adobe.xdp"],".xfd":["application/vnd.adobe.xfd"],".xhtml":["text/html"],".xls":["application/x-xls","application/vnd.ms-excel"],".xml":["text/xml"],".xq":["text/xml"],".xquery":["text/xml"],".xsl":["text/xml"],".xwd":["application/x-xwd"],".sis":["application/vnd.symbian.install"],".x_t":["application/x-x_t"],".apk":["application/vnd.android.package-archive"],.301:["application/x-301"],.906:["application/x-906"],".a11":["application/x-a11"],".ai":["application/postscript"],".aifc":["audio/aiff"],".anv":["application/x-anv"],".asf":["video/x-ms-asf"],".asx":["video/x-ms-asf"],".avi":["video/avi"],".biz":["text/xml"],".bot":["application/x-bot"],".c90":["application/x-c90"],".cat":["application/vnd.ms-pki.seccat"],".cdr":["application/x-cdr"],".cer":["application/x-x509-ca-cert"],".cgm":["application/x-cgm"],".class":["java/*"],".cmp":["application/x-cmp"],".cot":["application/x-cot"],".crt":["application/x-x509-ca-cert"],".css":["text/css"],".dbf":["application/x-dbf"],".dbx":["application/x-dbx"],".dcx":["application/x-dcx"],".dgn":["application/x-dgn"],".dll":["application/x-msdownload"],".dot":["application/msword"],".dtd":["text/xml"],".dxb":["application/x-dxb"],".edn":["application/vnd.adobe.edn"],".eml":["message/rfc822"],".epi":["application/x-epi"],".exe":["application/x-msdownload"],".fdf":["application/vnd.fdf"],".fo":["text/xml"],".g4":["application/x-g4"],".gl2":["application/x-gl2"],".hgl":["application/x-hgl"],".hpg":["application/x-hpgl"],".hqx":["application/mac-binhex40"],".hta":["application/hta"],".htm":["text/html"],".htt":["text/webviewhtml"],".icb":["application/x-icb"],".ig4":["application/x-g4"],".iii":["application/x-iphone"],".ins":["application/x-internet-signup"],".IVF":["video/x-ivf"],".jfif":["image/jpeg"],".js":["application/x-javascript"],".la1":["audio/x-liquid-file"],".latex":["application/x-latex"],".lbm":["application/x-lbm"],".ls":["application/x-javascript"],".m1v":["video/x-mpeg"],".m3u":["audio/mpegurl"],".mac":["application/x-mac"],".math":["text/xml"],".mht":["message/rfc822"],".mi":["application/x-mi"],".midi":["audio/mid"],".mml":["text/xml"],".mns":["audio/x-musicnet-stream"],".movie":["video/x-sgi-movie"],".mp2":["audio/mp2"],".mp3":["audio/mp3"],".mpa":["video/x-mpg"],".mpe":["video/x-mpeg"],".mpg":["video/mpg"],".mpp":["application/vnd.ms-project"],".mpt":["application/vnd.ms-project"],".mpv2":["video/mpeg"],".mpx":["application/vnd.ms-project"],".mxp":["application/x-mmxp"],".nrf":["application/x-nrf"],".odc":["text/x-ms-odc"],".p10":["application/pkcs10"],".p7b":["application/x-pkcs7-certificates"],".p7m":["application/pkcs7-mime"],".p7s":["application/pkcs7-signature"],".pci":["application/x-pci"],".pcx":["application/x-pcx"],".pfx":["application/x-pkcs12"],".pic":["application/x-pic"],".pl":["application/x-perl"],".pls":["audio/scpls"],".pot":["application/vnd.ms-powerpoint"],".ppm":["application/x-ppm"],".pr":["application/x-pr"],".prn":["application/x-prn"],".ptn":["application/x-ptn"],".r3t":["text/vnd.rn-realtext3d"],".ram":["audio/x-pn-realaudio"],".rat":["application/rat-file"],".rec":["application/vnd.rn-recording"],".rgb":["application/x-rgb"],".rjt":["application/vnd.rn-realsystem-rjt"],".rle":["application/x-rle"],".rmf":["application/vnd.adobe.rmf"],".rmj":["application/vnd.rn-realsystem-rmj"],".rmp":["application/vnd.rn-rn_music_package"],".rmvb":["application/vnd.rn-realmedia-vbr"],".rnx":["application/vnd.rn-realplayer"],".rpm":["audio/x-pn-realaudio-plugin"],".rt":["text/vnd.rn-realtext"],".sam":["application/x-sam"],".sdp":["application/sdp"],".sit":["application/x-stuffit"],".sld":["application/x-sld"],".smi":["application/smil"],".smk":["application/x-smk"],".sol":["text/plain"],".spc":["application/x-pkcs7-certificates"],".spp":["text/xml"],".sst":["application/vnd.ms-pki.certstore"],".stm":["text/html"],".svg":["text/xml"],".tdf":["application/x-tdf"],".tga":["application/x-tga"],".tld":["text/xml"],".torrent":["application/x-bittorrent"],".txt":["text/plain"],".uls":["text/iuls"],".vda":["application/x-vda"],".vml":["text/xml"],".vss":["application/vnd.visio"],".vsx":["application/vnd.visio"],".vxml":["text/xml"],".wax":["audio/x-ms-wax"],".wb2":["application/x-wb2"],".wbmp":["image/vnd.wap.wbmp"],".wk3":["application/x-wk3"],".wkq":["application/x-wkq"],".wm":["video/x-ms-wm"],".wmd":["application/x-ms-wmd"],".wml":["text/vnd.wap.wml"],".wmx":["video/x-ms-wmx"],".wp6":["application/x-wp6"],".wpg":["application/x-wpg"],".wq1":["application/x-wq1"],".wri":["application/x-wri"],".ws":["application/x-ws"],".wsc":["text/scriptlet"],".wvx":["video/x-ms-wvx"],".xdr":["text/xml"],".xfdf":["application/vnd.adobe.xfdf"],".xlw":["application/x-xlw"],".xpl":["audio/scpls"],".xql":["text/xml"],".xsd":["text/xml"],".xslt":["text/xml"],".x_b":["application/x-x_b"],".sisx":["application/vnd.symbian.install"],".ipa":["application/vnd.iphone"],".xap":["application/x-silverlight-app"],".zip":["application/x-zip-compressed"]}},"./src/services/saas/smgateway.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getSMGateway=void 0;var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),o=r("../../../cloud-crypto/dist/index.js"),i=r("./src/services/saas/internal.ts"),s=r("./src/utils/utils.ts"),a=r("./src/runtime/runtime.ts"),c=r("./src/utils/simulate-request.ts"),u=r("./src/services/saas/gateway.ts"),l="smgateway.call",d=function(e){function t(t,r){var n=e.call(this,t)||this;return n.code=r,n}return n.__extends(t,e),t}(Error),p=function(){return"miniprogram"===(0,a.getRuntimeInfo)().env};t.getSMGateway=function(e){var t=this;return function(r){var o=new f(r),a=r.domain?r.domain:"".concat(r.id||r.appid,".preview.wxcloudrun.com"),c={name:"gateway-plugin",host:a,getMetadata:function(e){return n.__assign(n.__assign({},e),{host:a})},beforeRequest:function(e){return e},afterRequest:function(e){return e},beforeTunnelRequest:function(e){return e},afterTunnelRequest:function(e){return e},context:e,refreshTunnelInfo:p()?function(){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(r){switch(r.label){case 0:return t=(0,s.getSystemInfo)(),[4,e.request({apiName:"tcbapi_get_service_info",serializedReqData:JSON.stringify({system:t.system,wx_app_version:t.version,scene:3})})];case 1:return[2,r.sent().data]}})})}:void 0};return i.SaaSServiceMap.set(o,c),o.tokenManager.invalidate(),o.exportAPI}};var f=function(e){function t(t){var r=e.call(this,t)||this;return r.exportAPI={refresh:r.tokenManager.updateSession.bind(r.tokenManager),call:r.call.bind(r)},r}return n.__extends(t,e),t.prototype.callV2=function(t){return n.__awaiter(this,void 0,void 0,function(){var r,i=this;return n.__generator(this,function(s){switch(s.label){case 0:return[4,o.SM.encode(t.publicKey,n.__assign({},t.header),t.method||"GET",t.data,t.stats)];case 1:return r=s.sent(),[2,new Promise(function(s,a){e.prototype.callV2.call(i,n.__assign(n.__assign({},t),{method:"POST",data:r.data.buffer,dataType:"arraybuffer",responseType:"arraybuffer"})).then(function(e){return o.SM.decode(r.ephemeralKey,t.publicKey,new Uint8Array(e.data),t.stats).then(function(t){return n.__assign(n.__assign({},e),{decrypted:t})})}).then(function(e){var r=e.decrypted,n=r.header,o=r.body,i=r.statusCode;_(t,n,o);var a=(0,c.processResponse)(t,o,i);s({data:a,statusCode:i,header:n,callID:e.callID,errMsg:"".concat(l,":ok"),profile:e.profile})}).catch(a)})]}})})},t.prototype.callV3=function(t){return n.__awaiter(this,void 0,void 0,function(){var r,i,s=this;return n.__generator(this,function(a){switch(a.label){case 0:return r=Date.now(),[4,o.SM.encode(t.publicKey,n.__assign({},t.header),t.method||"GET",t.data,t.stats)];case 1:return i=a.sent(),console.log("sm crypto cost",Date.now()-r),[2,new Promise(function(r,a){e.prototype.callV3.call(s,n.__assign(n.__assign({},t),{data:i.data.buffer,dataType:"arraybuffer",responseType:"arraybuffer",method:"POST"})).then(function(e){return o.SM.decode(i.ephemeralKey,t.publicKey,new Uint8Array(e.data),t.stats).then(function(t){return n.__assign(n.__assign({},e),{decrypted:t})})}).then(function(e){var n=Date.now(),o=e.decrypted,i=o.header,s=o.body,a=o.statusCode;console.log("sm crypto decode cost",Date.now()-n),_(t,i,s);var u=(0,c.processResponse)(t,s,a);r({data:u,statusCode:a,header:i,callID:e.callID,errMsg:"".concat(l,":ok"),profile:e.profile})}).catch(a)})]}})})},t.prototype.call=function(t){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(r){return[2,e.prototype.call.call(this,t)]})})},t}(u.GatewayService);function _(e,t,r){if(t["x-wx-system-error"]){var n=+t["x-wx-system-error"];throw r=function(e){if(e instanceof ArrayBuffer)try{return(0,s.arrayBufferToString)(e)}catch(e){}return e}(r),new d("".concat(l,": fail wx system error ").concat(r,", code: ").concat(n,", callid: ").concat(e.stats.callid),n)}var o;t["x-wx-server-timing"]&&((o=(t["x-wx-server-timing"]||"").split(",")).length>=2&&(e.stats.serverStartTs=Number(o[0]),e.stats.serverEndTs=Number(o[1])));if(t["x-envoy-upstream-service-time"]){var i=+t["x-envoy-upstream-service-time"];isNaN(i)||(e.stats.upstreamCost=i)}t["x-wx-mesh-upstream-service-time"]&&((o=t["x-wx-mesh-upstream-service-time"].split(",")).length>=2&&(e.stats.meshStartTs=Number(o[0]),e.stats.meshEndTs=Number(o[1])))}},"./src/services/storage/api/api.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getAPIs=void 0;var n=r("./src/services/storage/api/uploadFile.ts"),o=r("./src/services/storage/api/downloadFile.ts"),i=r("./src/services/storage/api/getTempFileURL.ts"),s=r("./src/services/storage/api/deleteFile.ts");t.getAPIs=function(e){return{uploadFile:(0,n.default)(e),downloadFile:(0,o.default)(e),getTempFileURL:(0,i.default)(e),deleteFile:(0,s.default)(e)}}},"./src/services/storage/api/deleteFile.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),o=r("./src/utils/assert.ts"),i=r("./src/utils/error.ts"),s=r("./src/hook/invoke.ts"),a=r("./src/utils/msg.ts"),c=r("./src/utils/fn/clone.ts"),u=r("./src/utils/report.ts"),l=r("./src/config/error.config.ts"),d="cloud.deleteFile";t.default=function(e){return function(e){var r=(0,c.shallowClone)(e);return r.timing={apiStartTime:+new Date},(0,s.hasAPICallback)(r)?function(e){t(e).then(function(t){(0,s.invokeSuccessCompleteCallbacks)(d,e,t)}).catch(function(t){(0,s.invokeFailCompleteCallbacks)(d,e,t)})}(r):t(r)};function t(t){return n.__awaiter(this,void 0,void 0,function(){var r;return n.__generator(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,3,4]),function(t){(0,o.assertType)(t,{fileList:"array"}),t.config&&t.config.env&&(0,o.assertType)(t.config.env,"string");for(var r=0,n=t.fileList.length;r<n;r++)(0,o.assertType)(t.fileList[r],"string","parameter.fileList[".concat(r,"]"));if(e.appConfig.getTempFileURLMaxReq&&t.fileList.length>e.appConfig.getTempFileURLMaxReq)throw new i.CloudSDKError({errCode:l.ERR_CODE.SDK_API_PARAMETER_ERROR,errMsg:"parameter.fileList exceed max length ".concat(e.appConfig.getTempFileURLMaxReq)})}(t),t.fileList.length?[4,function(t){return n.__awaiter(this,void 0,void 0,function(){var r,o,i,s;return n.__generator(this,function(n){switch(n.label){case 0:return r={fileid_list:t.fileList},o=JSON.stringify(r),t.timing.tunnelStartTime=+new Date,[4,e.request({apiName:"tcbapi_deletefile",serviceName:e.name,serializedReqData:o,env:t.config&&t.config.env||e.env})];case 1:return i=n.sent(),t.timing.tunnelEndTime=+new Date,s=i.data,t.timing.tunnelTimeNoCSNetCost=s.baseresponse.stat.qbase_cost_time,[2,{errMsg:(0,a.apiSuccessMsg)(d),fileList:s.delete_list.map(function(e){return{fileID:e.fileid,status:e.status,errMsg:e.errmsg}})}]}})})}(t)]:[2,{errMsg:(0,a.apiSuccessMsg)(d),fileList:[]}];case 1:return[2,s.sent()];case 2:throw r=s.sent(),(0,i.returnAsFinalCloudSDKError)(r,d);case 3:return(0,u.reportAPISpeed)(n.__assign(n.__assign({},t.timing),{apiEndTime:+new Date,apiName:d})),[7];case 4:return[2]}})})}}},"./src/services/storage/api/downloadFile.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),o=r("./src/utils/assert.ts"),i=r("./src/utils/type.ts"),s=r("./src/utils/fn/clone.ts"),a=r("./src/utils/error.ts"),c=r("./src/hook/invoke.ts"),u=r("./src/externals/public-lib/appserviceSdk.ts"),l=r("./src/utils/report.ts"),d=r("./src/config/error.config.ts"),p="cloud.downloadFile";t.default=function(e){return function(e){if(e=(0,s.shallowClone)(e),(0,c.hasAPICallback)(e))return function(e){var r={aborted:!1},o=function(e){return{onProgressUpdate:function(t){e.onProgressUpdateUserHandler=t},abort:function(){e.abort&&e.abort(),e.aborted=!0}}}(r),i={apiStartTime:+new Date};return t(n.__assign(n.__assign({},e),{context:r,timing:i,downloadTaskAgent:o})).then(function(t){(0,c.invokeSuccessCompleteCallbacks)(p,e,t)}).catch(function(t){(0,c.invokeFailCompleteCallbacks)(p,e,t)}),o}(e);var r={apiStartTime:+new Date};return t(n.__assign(n.__assign({},e),{timing:r}))};function t(t){return n.__awaiter(this,void 0,void 0,function(){var r=this;return n.__generator(this,function(s){return[2,new Promise(function(s,c){return n.__awaiter(r,void 0,void 0,function(){var r,f;return n.__generator(this,function(_){switch(_.label){case 0:return _.trys.push([0,2,3,4]),function(e){(0,o.assertType)(e,{fileID:"string"}),e.config&&e.config.env&&(0,o.assertType)(e.config.env,"string")}(t),t.context&&(t.context.abort=function(){c((0,a.returnAsFinalCloudSDKError)({errMsg:"abort"},p))},t.context.aborted)?[2,c((0,a.returnAsFinalCloudSDKError)({errMsg:"abort"},p))]:[4,function(t){return n.__awaiter(this,void 0,void 0,function(){var r,o;return n.__generator(this,function(s){switch(s.label){case 0:return r=(0,u.getSDK)(e.identifiers),[4,function(t){return n.__awaiter(this,void 0,void 0,function(){var r,o,i,s;return n.__generator(this,function(n){switch(n.label){case 0:return r=JSON.stringify({fileid:t.fileID}),o=+new Date,[4,e.request({apiName:"tcbapi_downloadfile",serviceName:e.name,serializedReqData:r,env:t.config&&t.config.env||e.env})];case 1:if(i=n.sent(),s=i.data,t.timing&&(t.timing.tunnelStartTime=o,t.timing.tunnelEndTime=+new Date,t.timing.tunnelTimeNoCSNetCost=s.baseresponse.stat.qbase_cost_time),!s.download_url)throw new a.CloudSDKError({errCode:d.ERR_CODE.SDK_STORAGE_INTERNAL_SERVER_ERROR_EMPTY_DOWNLOAD_URL,errMsg:d.ERR_CODE[d.ERR_CODE.SDK_STORAGE_INTERNAL_SERVER_ERROR_EMPTY_DOWNLOAD_URL]});return s.download_url.indexOf("?")>-1?s.download_url+="&skip_domain_check=true":s.download_url+="?skip_domain_check=true",[2,s.download_url]}})})}(t)];case 1:return o=s.sent(),[2,new Promise(function(e,n){if(t.context&&t.context.aborted)return n((0,a.returnAsFinalCloudSDKError)({errMsg:"abort"},p));var s=r.downloadFile({url:o,header:t.header,timeout:t.timeout,success:function(t){e(t)},fail:function(e){n(e)}});s&&(s.onProgressUpdate(function(){t.downloadTaskAgent&&t.context&&t.context.onProgressUpdateUserHandler&&(0,i.isFunction)(t.context.onProgressUpdateUserHandler)&&t.context.onProgressUpdateUserHandler.apply(r.downloadFile,arguments)}),t.context&&(t.context.abort=s.abort.bind(s)))})]}})})}(t)];case 1:return r=_.sent(),s(r),[3,4];case 2:return f=_.sent(),c((0,a.returnAsFinalCloudSDKError)(f,p)),[3,4];case 3:return(0,l.reportAPISpeed)(n.__assign(n.__assign({},t.timing),{apiEndTime:+new Date,apiName:p})),[7];case 4:return[2]}})})})]})})}}},"./src/services/storage/api/getTempFileURL.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),o=r("./src/utils/assert.ts"),i=r("./src/utils/error.ts"),s=r("./src/hook/invoke.ts"),a=r("./src/utils/msg.ts"),c=r("./src/utils/fn/clone.ts"),u=r("./src/utils/type.ts"),l=r("./src/utils/report.ts"),d=r("./src/config/error.config.ts"),p="cloud.getTempFileURL";t.default=function(e){return function(e){var r=(0,c.shallowClone)(e);return r.timing={apiStartTime:+new Date},(0,s.hasAPICallback)(r)?function(e){t(e).then(function(t){(0,s.invokeSuccessCompleteCallbacks)(p,e,t)}).catch(function(t){(0,s.invokeFailCompleteCallbacks)(p,e,t)})}(r):t(r)};function t(t){return n.__awaiter(this,void 0,void 0,function(){var r;return n.__generator(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,3,4]),function(t){if((0,o.assertType)(t,{fileList:"array"}),t.config&&t.config.env&&(0,o.assertType)(t.config.env,"string"),e.appConfig.getTempFileURLMaxReq&&t.fileList.length>e.appConfig.getTempFileURLMaxReq)throw new i.CloudSDKError({errCode:d.ERR_CODE.SDK_API_PARAMETER_ERROR,errMsg:"parameter.fileList exceed max length ".concat(e.appConfig.getTempFileURLMaxReq)})}(t),t.fileList.length?[4,function(t){return n.__awaiter(this,void 0,void 0,function(){var r,o,i,s;return n.__generator(this,function(n){switch(n.label){case 0:return r={file_list:t.fileList.map(function(e){return(0,u.isString)(e)?{fileid:e}:{fileid:e.fileID,max_age:e.maxAge}})},o=JSON.stringify(r),t.timing.tunnelStartTime=+new Date,[4,e.request({apiName:"tcbapi_gettempfileurl",serviceName:e.name,serializedReqData:o,env:t.config&&t.config.env||e.env})];case 1:return i=n.sent(),t.timing.tunnelEndTime=+new Date,s=i.data,t.timing.tunnelTimeNoCSNetCost=s.baseresponse.stat.qbase_cost_time,[2,{errMsg:(0,a.apiSuccessMsg)(p),fileList:s.download_list.map(function(e){return{fileID:e.fileid,tempFileURL:e.download_url,maxAge:e.max_age,status:e.status,errMsg:e.errmsg}})}]}})})}(t)]:[2,{errMsg:(0,a.apiSuccessMsg)(p),fileList:[]}];case 1:return[2,s.sent()];case 2:throw r=s.sent(),(0,i.returnAsFinalCloudSDKError)(r,p);case 3:return(0,l.reportAPISpeed)(n.__assign(n.__assign({},t.timing),{apiEndTime:+new Date,apiName:p})),[7];case 4:return[2]}})})}}},"./src/services/storage/api/uploadFile.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),o=r("./src/utils/assert.ts"),i=r("./src/utils/error.ts"),s=r("./src/utils/type.ts"),a=r("./src/utils/fn/clone.ts"),c=r("./src/hook/invoke.ts"),u=r("./src/utils/msg.ts"),l=r("./src/externals/public-lib/appserviceSdk.ts"),d=r("./src/utils/report.ts"),p=r("./src/config/error.config.ts"),f=r("./src/runtime/runtime.ts"),_="cloud.uploadFile",m="cloud.uploadFile_v2";t.default=function(e){return function(e){if(e=(0,a.shallowClone)(e),(0,c.hasAPICallback)(e))return function(e){var r={aborted:!1},o=function(e){return{onProgressUpdate:function(t){e.onProgressUpdateUserHandler=t},abort:function(){e.abort&&e.abort(),e.aborted=!0}}}(r),i={apiStartTime:+new Date};return t(n.__assign(n.__assign({},e),{context:r,timing:i,uploadTaskAgent:o})).then(function(t){(0,c.invokeSuccessCompleteCallbacks)(_,e,t)}).catch(function(t){(0,c.invokeFailCompleteCallbacks)(_,e,t)}),o}(e);var r={apiStartTime:+new Date};return t(n.__assign(n.__assign({},e),{timing:r}))};function t(t){var r=this;return new Promise(function(a,c){return n.__awaiter(r,void 0,void 0,function(){var r,h;return n.__generator(this,function(g){switch(g.label){case 0:return g.trys.push([0,2,3,4]),function(e){(0,o.assertType)(e,{cloudPath:"string"}),"miniprogram"===(0,f.getRuntimeInfo)().env?(0,o.assertType)(e,{filePath:"string"}):(0,o.assertRequiredParam)(e,"file","uploadFile")}(t),t.context&&(t.context.abort=function(){c((0,i.returnAsFinalCloudSDKError)({errMsg:"abort"},_))},t.context.aborted)?[2,c((0,i.returnAsFinalCloudSDKError)({errMsg:"abort"},_))]:[4,function(t){return n.__awaiter(this,void 0,void 0,function(){var r,o;return n.__generator(this,function(a){switch(a.label){case 0:return r=(0,l.getSDK)(e.identifiers),[4,function(t){return n.__awaiter(this,void 0,void 0,function(){var r,o,s,a;return n.__generator(this,function(n){switch(n.label){case 0:return r=JSON.stringify({path:t.cloudPath}),o=+new Date,[4,e.request({apiName:"tcbapi_cos_uploadfile",serviceName:e.name,serializedReqData:r,env:t.config&&t.config.env||e.env})];case 1:if(s=n.sent(),a=s.data,t.timing&&(t.timing.tunnelStartTime=o,t.timing.tunnelEndTime=+new Date,t.timing.tunnelTimeNoCSNetCost=a.baseresponse.stat.qbase_cost_time),!a.url)throw new i.CloudSDKError({errCode:p.ERR_CODE.SDK_STORAGE_INTERNAL_SERVER_ERROR_EMPTY_UPLOAD_URL,errMsg:p.ERR_CODE[p.ERR_CODE.SDK_STORAGE_INTERNAL_SERVER_ERROR_EMPTY_UPLOAD_URL]});return[2,a]}})})}(t)];case 1:return o=a.sent(),[2,new Promise(function(e,a){if(t.context&&t.context.aborted)return a((0,i.returnAsFinalCloudSDKError)({errMsg:"abort"},_));var c,l,d=(0,f.getRuntimeInfo)();if("web"===d.env){var p=new FormData;p.append("key",t.cloudPath),p.append("signature",o.authorization),p.append("x-cos-security-token",o.token),p.append("x-cos-meta-fileid",o.cos_file_id),p.append("file",t.file),c={url:o.url,timeout:t.timeout,filePath:"",header:t.header,name:"",formData:p}}else c={url:o.url,timeout:t.timeout,filePath:t.filePath,header:t.header,name:"file",formData:{key:t.cloudPath,signature:o.authorization,"x-cos-security-token":o.token,"x-cos-meta-fileid":o.cos_file_id}};(l=r.uploadFile(n.__assign(n.__assign({},c),{success:function(t){try{if(t.statusCode>=200&&t.statusCode<300)e({errMsg:(0,u.apiSuccessMsg)(_),fileID:o.file_id,statusCode:t.statusCode});else{var r=new i.CloudSDKError({errMsg:"status ".concat(t.statusCode,", error: ").concat(t.data,";")});a(r)}}catch(r){var n=new i.CloudSDKError({errMsg:"Error : ".concat(t.data,";")});a(n)}},fail:function(e){a(e)}})))&&(l.onProgressUpdate(function(){t.uploadTaskAgent&&t.context&&t.context.onProgressUpdateUserHandler&&(0,s.isFunction)(t.context.onProgressUpdateUserHandler)&&t.context.onProgressUpdateUserHandler.apply(r.uploadFile,arguments)}),t.context&&(t.context.abort=l.abort.bind(l)))})]}})})}(t)];case 1:return r=g.sent(),a(r),[3,4];case 2:return h=g.sent(),c((0,i.returnAsFinalCloudSDKError)(h,_)),[3,4];case 3:return(0,d.reportAPISpeed)(n.__assign(n.__assign({},t.timing),{apiEndTime:+new Date,apiName:m})),[7];case 4:return[2]}})})})}}},"./src/services/storage/index.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.registerService=t.STORAGE_SERVICE_NAME=void 0;var n=r("./src/services/storage/api/api.ts");t.STORAGE_SERVICE_NAME="storage",t.registerService=function(e){e.registerService(function(e){var r={name:t.STORAGE_SERVICE_NAME,identifiers:e.identifiers,request:e.request,isInstance:e.isInstance,get env(){return e.getEnvForService(t.STORAGE_SERVICE_NAME)},get debug(){return e.debug},appConfig:{get uploadMaxFileSize(){return e.appConfig.upload_max_file_size},get getTempFileURLMaxReq(){return e.appConfig.get_temp_file_url_max_requests}}};return{name:t.STORAGE_SERVICE_NAME,context:r,getAPIs:n.getAPIs.bind(null,r)}}(e))}},"./src/services/utils/api/CDN.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r("./src/utils/symbol.ts");t.default=function(e){var t=function(){function e(e){this._internalType=n.SYMBOL_CDN,this.target=e,Object.defineProperties(this,{_internalType:{enumerable:!1,configurable:!1}})}return e.prototype.toString=function(){return JSON.stringify({target:this.target})},e}();return function(e){return new t(e)}}},"./src/services/utils/api/CloudID.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r("./src/utils/symbol.ts");t.default=function(e){var t=function(){function e(e){this._internalType=n.SYMBOL_CLOUD_ID,this.cloudID=e,Object.defineProperties(this,{_internalType:{enumerable:!1,configurable:!1}})}return e.prototype.toJSON=function(){return this.cloudID},e.prototype.toString=function(){return this.cloudID},e}();return function(e){return new t(e)}}},"./src/services/utils/api/api.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getAPIs=void 0;var n=r("./src/services/utils/api/CloudID.ts"),o=r("./src/services/utils/api/CDN.ts");t.getAPIs=function(e){return{CloudID:(0,n.default)(e),CDN:(0,o.default)(e)}}},"./src/services/utils/index.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.registerService=t.UTILS_SERVICE_NAME=void 0;var n=r("./src/services/utils/api/api.ts");t.UTILS_SERVICE_NAME="utils",t.registerService=function(e){e.registerService(function(e){var r={name:t.UTILS_SERVICE_NAME,identifiers:e.identifiers,request:e.request,isInstance:e.isInstance,get debug(){return e.debug}};return{name:t.UTILS_SERVICE_NAME,context:r,getAPIs:n.getAPIs.bind(null,r)}}(e))}},"./src/utils/assert.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.assertObjectNotEmpty=t.assertStringLength=t.assertRequiredParam=t.assertType=t.validType=void 0;var n=r("./src/utils/type.ts"),o=r("./src/utils/error.ts"),i=r("./src/config/error.config.ts");function s(e,t,r){void 0===r&&(r="parameter");var o=function e(t,r,o){var i=(0,n.getType)(t),s=(0,n.getType)(r);if("string"===s)return i!==r?"".concat(o," should be ").concat(r," instead of ").concat(i,";"):"";if(i!==s)return"".concat(o," should be ").concat(s," instead of ").concat(i,"; ");var a="";switch(i){case"object":for(var c in r)a+=e(t[c],r[c],"".concat(o,".").concat(c));break;case"array":for(var u=0;u<r.length;u++)a+=e(t[u],r[u],"".concat(o,"[").concat(u,"]"))}return a}(e,t,r);return{passed:!o,reason:o}}t.validType=s,t.assertType=function(e,t,r,n){void 0===r&&(r="parameter"),void 0===n&&(n=o.CloudSDKError);var a=s(e,t,r);if(!a.passed)throw new n({errCode:i.ERR_CODE.SDK_API_PARAMETER_TYPE_ERROR,errMsg:a.reason})},t.assertRequiredParam=function(e,t,r,n){if(void 0===n&&(n=o.CloudSDKError),void 0===e||null===e)throw new n({errCode:i.ERR_CODE.SDK_API_PARAMETER_ERROR,errMsg:"parameter ".concat(t," of function ").concat(r," must be provided")})},t.assertStringLength=function(e){var t=e.name,r=e.input,n=e.max,s=e.maxWording,a=void 0===s?"":s,c=e.ErrorClass,u=void 0===c?o.CloudSDKError:c;if(r.length>n)throw new u({errCode:i.ERR_CODE.SDK_API_PARAMETER_ERROR,errMsg:"".concat(t," size must be less than ").concat(a||n)})},t.assertObjectNotEmpty=function(e){var t=e.target,r=e.name,n=e.ErrorClass,s=void 0===n?o.CloudSDKError:n;if(0===Object.keys(t).length)throw new s({errCode:i.ERR_CODE.SDK_API_PARAMETER_ERROR,errMsg:"".concat(r," must not be empty")})}},"./src/utils/cdn.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.uploadToCommonCDN=t.populateAndSerialize=t.collect=void 0;var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),o=r("./src/utils/symbol.ts"),i=r("./src/utils/type.ts"),s=r("./src/externals/public-lib/appserviceSdk.ts");function a(e){var t=new WeakMap,r=[];if(e&&(JSON.stringify(e,function(e,n){return n&&n._internalType===o.SYMBOL_CDN?void r.push(new Promise(function(e,r){var o={appType:301,fileType:20303,fileKey:"file_".concat(Math.random())},s=n;switch((0,i.getType)(s.target)){case"object":if(!s.target.filePath)throw new Error("filePath must be provided");o.filePath=s.target.filePath;break;default:o.fileData=s.target}e(c(o).then(function(e){t.set(n,e.fileUrl)}))})):n}),r.length))return Promise.all(r).then(function(){return t})}function c(e){return new Promise(function(t,r){var o=n.__assign(n.__assign({},e),{appType:e.appType||301,fileType:e.fileType||20303,fileKey:e.fileKey||"file_".concat(Math.random())});(0,s.getSDK)().uploadToCommonCDN(n.__assign(n.__assign({},o),{success:t,fail:r}))})}t.collect=a,t.populateAndSerialize=function(e){return n.__awaiter(this,void 0,void 0,function(){var t;return n.__generator(this,function(r){switch(r.label){case 0:return e?[4,a(e)]:[3,2];case 1:return t=r.sent(),[2,JSON.stringify(e,function(e,r){return r&&r.symbol===o.SYMBOL_CDN&&(null===t||void 0===t?void 0:t.has(r))?t.get(r):r})];case 2:return[2,JSON.stringify(e)]}})})},t.uploadToCommonCDN=c},"./src/utils/data-pipe.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.monitorAppVisiblity=t.poll=t.callAndWaitResult=t.processDataPipeParam=t.DATA_PIPE_SIZE_LIMIT_ERROR=t.ResultStatus=t.DataType=t.RetryType=t.Action=void 0;var n,o,i,s=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),a=r("./src/utils/error.ts"),c=r("./src/utils/serializer.ts"),u=r("./src/externals/globals/wxconfig.ts"),l=r("./src/externals/public-lib/appserviceSdk.ts"),d=r("./src/utils/type.ts"),p=r("./src/utils/utils.ts"),f=r("./src/config/error.config.ts");!function(e){e[e.CALL=1]="CALL",e[e.POLL=2]="POLL"}(n=t.Action||(t.Action={})),function(e){e[e.None=0]="None",e[e.Error=1]="Error",e[e.Timeout=2]="Timeout"}(o=t.RetryType||(t.RetryType={})),function(e){e[e.RAW=0]="RAW",e[e.BASE64=1]="BASE64",e[e.CDN_URL=2]="CDN_URL"}(i=t.DataType||(t.DataType={})),function(e){e[e.PENDING=0]="PENDING",e[e.DONE=1]="DONE",e[e.TIMEOUT=2]="TIMEOUT"}(t.ResultStatus||(t.ResultStatus={}));var _=function(e){var t=new Date;return"".concat(t.getHours(),":").concat(t.getMinutes(),":").concat(t.getSeconds()," ").concat(e)},m=function(e){return e.join("->")},h=20,g=2,v=2,y=2e4,E=1e5;t.DATA_PIPE_SIZE_LIMIT_ERROR=Symbol(),t.processDataPipeParam=function(e,r){var n;return void 0===r&&(r="".concat(+new Date,"-").concat(Math.random())),s.__awaiter(this,void 0,void 0,function(){var o,a,u,l,f,_,m,h,g;return s.__generator(this,function(s){switch(s.label){case 0:return e.shouldSerialize?[4,e.cdnMapPromise]:[3,2];case 1:o=s.sent(),e.data=(0,c.serialize)(e.data,o),s.label=2;case 2:if(a=i.RAW,e.stats.callid=r,u=(null===(n=e.method)||void 0===n?void 0:n.toUpperCase())||"GET",e.data&&/^(POST|PUT|PATCH|DELETE)$/.test(u))if("object"===(l=(0,d.getType)(e.data)))e.data=JSON.stringify(e.data);else{if("arraybuffer"!==l&&"string"!==l)throw new Error("input data type is not supported: ".concat(l));if(f=!1,"string"===l?f=e.data.length>E:e.data.byteLength>E?f=!0:(_=(0,p.arrayBufferToBase64)(e.data)).length>E?f=!0:(e.data=_,a=i.BASE64),f)throw m=new Error("input data size too large (> 100KB)"),Object.defineProperty(m,"type",{value:t.DATA_PIPE_SIZE_LIMIT_ERROR}),m}else if("GET"===u&&e.data&&(0,d.isObject)(e.data)){for(g in h=[],e.data)h.push("".concat(g,"=").concat(e.data[g]));e.path+="".concat(e.path.includes("?")?e.path.endsWith("&")?"":"&":"?").concat(h.join("&")),e.data=void 0}else e.data=void 0;for(g in e.header)null!==e.header[g]&&void 0!==e.header[g]&&(e.header[g]+="");return[2,{tunnelReqDataType:a,callID:r}]}})})};var b={"gateway.call":"tcbapi_call_gateway","cloud.callContainer":"tcbapi_call_container"};function S(e,t){var r,d;return s.__awaiter(this,void 0,void 0,function(){function h(r){return s.__awaiter(this,void 0,void 0,function(){var c,u,d,h,v,y;return s.__generator(this,function(E){switch(E.label){case 0:return E.trys.push([0,13,,14]),B||N.reached?[2]:(G(),W(r),(c=r.data)?c.baseresponse&&0===c.baseresponse.errcode?0!==c.status?[3,1]:C>=0?(I.push(_("normal poll")),S(e,s.__assign(s.__assign({},t),{action:n.POLL,retryType:o.None,tryCount:C-1})),[3,10]):(I.push(_("too many polls, abort")),[2,j((0,a.toSDKError)({errCode:f.ERR_CODE.SDK_CONTAINER_EXCEED_MAX_POLL_RETRY,errMsg:"(callId: ".concat(T,") (trace: ").concat(m(I),")")},e))]):[3,11]:(I.push(_("empty resp")),[2,j((0,a.toSDKError)({errCode:f.ERR_CODE.SDK_CONTAINER_EMPTY_CALL_RESULT},e))]));case 1:return 1!==c.status?[3,9]:(u=void 0,c.data_type!==i.BASE64?[3,2]:(u=(0,p.base64ToArrayBuffer)(c.data),"json"===L.dataType?u=(0,p.tryJSONParse)((0,p.arrayBufferToString)(u)):"arraybuffer"!==L.responseType&&(u=(0,p.arrayBufferToString)(u)),[3,8]));case 2:if(c.data_type!==i.CDN_URL)return[3,7];E.label=3;case 3:return E.trys.push([3,5,,6]),d=(0,l.getSDK)(null===g||void 0===g?void 0:g.identifiers),[4,new Promise(function(e,t){d.request({url:c.data,dataType:L.dataType,responseType:L.responseType,success:function(r){200!==r.statusCode?t("download response status code ".concat(r.statusCode)):e(r)},fail:function(e){t(e)}})})];case 4:return h=E.sent(),u=h.data,[3,6];case 5:return v=E.sent(),[2,j((0,a.toSDKError)({errCode:f.ERR_CODE.SDK_CONTAINER_DOWNLOAD_RESULT_FROM_CDN_FAIL,errMsg:"error: ".concat(v," \n (callId: ").concat(T,") (trace: ").concat(m(I),")")},e))];case 6:return[3,8];case 7:u=c.data,"arraybuffer"===L.responseType?u=(0,p.stringToArrayBuffer)(u):"json"===L.dataType&&(u=(0,p.tryJSONParse)(u)),E.label=8;case 8:return[2,D({result:{data:u,statusCode:c.http_code,header:c.headers.reduce(function(e,t){var r=e[t.k+""];return e[t.k+""]=r?r+","+t.v:t.v+"",e},{})}})];case 9:return I.push(_("poll result expired")),[2,j((0,a.toSDKError)({errCode:f.ERR_CODE.SDK_CONTAINER_POLL_RESULT_EXPIRED,errMsg:"timeout for result fetching, result cannot be fetched anymore (callId: ".concat(T,") (trace: ").concat(m(I),")")},e))];case 10:return[3,12];case 11:return c.baseresponse?0!==c.baseresponse.errcode?[2,j((0,a.toSDKError)({errCode:f.ERR_CODE.SDK_CONTAINER_POLL_RESULT_BASE_RESP_RET_ABNORMAL,errMsg:"polling base_resp.errcode ".concat(c.baseresponse.errcode," errmsg ").concat(c.baseresponse.errmsg," (callId: ").concat(T,")")},e))]:[2,j((0,a.toSDKError)({errCode:f.ERR_CODE.SDK_CONTAINER_EMPTY_POLL_RESULT_BASE_RESP,errMsg:"polling base_resp ".concat(JSON.stringify(c.baseresponse)," (callId: ").concat(T,")")},e))]:[2,j((0,a.toSDKError)({errCode:f.ERR_CODE.SDK_CONTAINER_EMPTY_POLL_RESULT_BASE_RESP},e))];case 12:return[3,14];case 13:return y=E.sent(),j((0,a.toSDKError)({errCode:f.ERR_CODE.SDK_CONTAINER_POLL_ERROR,errMsg:"polling catch error: ".concat(y," (callId: ").concat(T,")")},e)),[3,14];case 14:return[2]}})})}var g,v,E,T,A,w,C,I,O,R,N,D,j,L,M,P,x,k,B,U,G,q,F,W,K=this;return s.__generator(this,function(i){for(P in g=t.context,v=t.data,E=t.dataType,T=t.callID,A=t.action,w=t.retryType,C=t.tryCount,I=t.trace,O=t.systemErrorRetry,R=t.timeoutErrorRetry,N=t.userTimeout,D=t.resolve,j=t.reject,L=t.param,M=[],L.header)M.push({k:P,v:L.header[P]});return x=A===n.CALL?{method:L.method||"GET",headers:M,data:A===n.CALL?v:void 0,data_type:E,action:A,retryType:w,call_id:T,user_timeout:L.timeout}:{call_id:T,action:A,retryType:w},k=(0,c.serialize)(x),B=!1,U=!1,G=function(){clearTimeout(F),U=!0},q=+new Date,F=setTimeout(function(){return s.__awaiter(K,void 0,void 0,function(){var r,n,i,c;return s.__generator(this,function(l){switch(l.label){case 0:return r=(null===(n=null===g||void 0===g?void 0:g.appConfig)||void 0===n?void 0:n.clientPollTimeout)||y,+new Date-q>r?[4,(0,p.sleep)()]:[3,2];case 1:if(l.sent(),U)return[2];l.label=2;case 2:return N.reached?[2]:!(0,u.isDevTools)()&&+new Date-q>(null!==(c=null===(i=null===g||void 0===g?void 0:g.appConfig)||void 0===i?void 0:i.maxStartRetryGap)&&void 0!==c?c:6e4)?(I.push(_("timeout, exceed max retry gap")),[2,j((0,a.toSDKError)({errCode:f.ERR_CODE.SDK_CONTAINER_POLL_RESULT_EXPIRED,errMsg:"timeout for retry, cannot retry fetching the result anymore (callId: ".concat(T,") (trace: ").concat(m(I),")")},e))]):(B=!0,t.timeoutErrorRetry>0?(I.push(_("timeout, retry")),S(e,s.__assign(s.__assign({},t),{retryType:o.Timeout,tryCount:C-1,timeoutErrorRetry:R-1}))):(I.push(_("timeout, abort")),j((0,a.toSDKError)({errCode:f.ERR_CODE.SDK_CONTAINER_EXCEED_MAX_TIMEOUT_POLL_RETRY,errMsg:"(callId: ".concat(T,") (trace: ").concat(m(I),")")},e))),[2])}})})},(null===(r=null===g||void 0===g?void 0:g.appConfig)||void 0===r?void 0:r.clientPollTimeout)||y),W=function(e){var t,r=e.data;(null===(t=null===r||void 0===r?void 0:r.baseresponse)||void 0===t?void 0:t.stat)&&r.baseresponse.stat.qbase_cost_time&&(L.context.tunnelTimeNoCSNetCost+=r.baseresponse.stat.qbase_cost_time)},N.reached?[2]:(g.request(s.__assign(s.__assign({},L.config),{apiName:b[e],serviceName:g.name,serializedReqData:k,env:(null===(d=L.config)||void 0===d?void 0:d.env)||g.env})).then(h).catch(function(r){B||N.reached||(G(),(null===r||void 0===r?void 0:r.operateWXDataFail)&&O>0?(I.push(_("system error (".concat(r,"), retry"))),S(e,s.__assign(s.__assign({},t),{retryType:o.Error,tryCount:C-1,systemErrorRetry:O-1}))):(I.push(_("system error (".concat(r,"), abort"))),j((0,a.toSDKError)("".concat(r," (callId: ").concat(T,") (trace: ").concat(m(I),")"),e))))}),[2])})})}function T(e,t,r){var n=function(t){e.push(_("app ".concat(t)))};(0,p.onAppVisibilityChange)(n);return{resolve:function(e){(0,p.offAppVisibilityChange)(n),t(e)},reject:function(e){(0,p.offAppVisibilityChange)(n),r(e)}}}t.callAndWaitResult=function(e,t,r,i,a,c){return s.__awaiter(this,void 0,void 0,function(){var u,l,d;return s.__generator(this,function(s){return u=!1,Object.prototype.hasOwnProperty.call(t,"timeout")&&(l=new Promise(function(e,r){setTimeout(function(){u=!0,r("timeout (options.timeout == ".concat(t.timeout,")"))},t.timeout)})),d=new Promise(function(s,d){var p,f=[_("start")],m=T(f,s,d),y=m.resolve,E=m.reject;S(e,{param:t,data:r,dataType:i,callID:a,action:n.CALL,retryType:o.None,tryCount:(null===(p=null===c||void 0===c?void 0:c.appConfig)||void 0===p?void 0:p.maxPollRetry)||h,systemErrorRetry:g,timeoutErrorRetry:v,userTimeout:{get reached(){return!!l&&u}},trace:f,resolve:y,reject:E,context:c})}),[2,l?Promise.race([d,l]):d]})})},t.poll=S,t.monitorAppVisiblity=T},"./src/utils/error.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.isCancelledError=t.CancelledError=t.isTimeoutError=t.TimeoutError=t.isGenericError=t.toSDKError=t.returnAsFinalCloudSDKError=t.returnAsCloudSDKError=t.isSDKError=t.CloudSDKError=void 0;var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),o=r("./src/utils/type.ts"),i=r("./src/config/error.config.ts"),s=function(e){function t(t){var r=e.call(this,t.errMsg)||this;return r.errCode=-1,Object.defineProperties(r,{message:{get:function(){return"errCode: ".concat(this.errCode," ").concat(i.ERR_CODE[this.errCode]||""," | errMsg: ")+this.errMsg},set:function(e){this.errMsg=e}}}),r.errCode=t.errCode||-1,r.errMsg=t.errMsg,r}return n.__extends(t,e),Object.defineProperty(t.prototype,"message",{get:function(){return"errCode: ".concat(this.errCode," | errMsg: ")+this.errMsg},set:function(e){this.errMsg=e},enumerable:!1,configurable:!0}),t}(Error);function a(e){return e&&e instanceof Error&&(0,o.isString)(e.errMsg)}function c(e,t){if(e){if(a(e))return e;var r,n="".concat(t,":fail ");if(e instanceof Error)e.message="".concat(n).concat(e.message),e.stack=e.stack?e.stack.slice(0,7)+n+e.stack.slice(7):e.stack,(r=e).errCode=-1;else if("string"==typeof e)(r=new Error("".concat(n).concat(e))).errCode=-1;else{var o=e.errMsg||"";(r=new Error("".concat(t,":fail ").concat(e.errCode," ").concat(i.ERR_CODE[e.errCode]||"",". ").concat(o))).errCode=e.errCode||-1}return r.errMsg=r.message+"",r}var s=new Error("".concat(t,":fail"));return s.errCode=-1,s.errMsg=s.message+"",s}t.CloudSDKError=s,t.isSDKError=a,t.returnAsCloudSDKError=function(e,t){if(void 0===t&&(t=""),e){if(a(e))return t&&(e.errMsg+="; "+t),e;var r=e?e.errCode:void 0,n=(e&&e.errMsg||e.toString()||"unknown error")+"; "+t;return new s({errCode:r,errMsg:n})}return new s({errMsg:t})},t.returnAsFinalCloudSDKError=function(e,t){return c(e,t)},t.toSDKError=c;t.isGenericError=function(e){return e.generic};var u=function(e){function t(t,r){var n=e.call(this,t)||this;return n.type="timeout",n.generic=!0,n.payload=r,n}return n.__extends(t,e),t}(Error);t.TimeoutError=u;t.isTimeoutError=function(e){return"timeout"===e.type};var l=function(e){function t(t,r){var n=e.call(this,t)||this;return n.type="cancelled",n.generic=!0,n.payload=r,n}return n.__extends(t,e),t}(Error);t.CancelledError=l;t.isCancelledError=function(e){return"cancelled"===e.type}},"./src/utils/expire.ts":function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getPessimisticExpireTs=void 0,t.getPessimisticExpireTs=function(e){if(void 0===e||!e.timestamp||!e.expires_in)return 0;var t=Date.now()-e.timestamp,r=.8*e.expires_in,n=Math.min(e.timestamp,Date.now())+1e3*r;return t>1e3*r?Date.now()+1e3*r:n}},"./src/utils/fail-safe.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.wrapParamCallbacksWithTryCatch=t.wrapWithTryCatch=t.tryCatch=void 0;var n=r("./src/utils/error.ts"),o=r("./src/utils/type.ts"),i=r("./src/externals/public-lib/reporter.ts");function s(e,t){void 0===t&&(t="");try{return e()}catch(e){if((0,n.isSDKError)(e))return e.errMsg+=t,e;var r=(e?e.toString():"")+t;return new n.CloudSDKError({errMsg:r})}}t.tryCatch=s,t.wrapWithTryCatch=function(e,t){return void 0===t&&(t=""),function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return s(function(){return e.apply(e,r)},t)}},t.wrapParamCallbacksWithTryCatch=function(e){var t=e.param;t&&(t.success&&(0,o.isFunction)(t.success)&&(t.success=i.default.surroundThirdByTryCatch(t.success,"at api ".concat(e.apiName," success callback function"))),t.fail&&(0,o.isFunction)(t.fail)&&(t.fail=i.default.surroundThirdByTryCatch(t.fail,"at api ".concat(e.apiName," fail callback function"))),t.complete&&(0,o.isFunction)(t.complete)&&(t.complete=i.default.surroundThirdByTryCatch(t.complete,"at api ".concat(e.apiName," complete callback function"))))}},"./src/utils/fn/clone.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.shallowClone=void 0;var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),o=r("./src/utils/type.ts");t.shallowClone=function(e,t){if(void 0===t&&(t=!1),t)return function(e){switch((0,o.getType)(e)){case"object":return n.__assign({},e);case"array":return e.slice();case"number":return e instanceof Number?new Number(e):e;case"string":return e instanceof String?new String(e):e;case"boolean":return e instanceof Boolean?new Boolean(e):e;case"date":return new e.constructor(+e);case"map":return new Map(e);case"set":return new Set(e);default:return e}}(e);if((0,o.isPlainObject)(e))return n.__assign({},e);switch((0,o.getType)(e)){case"object":return e;case"array":return e.slice();default:return e}}},"./src/utils/fsm.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.isFSMTransitionError=t.FSMTransitionError=t.FSM=void 0;var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),o=function(){function e(e){for(var t in this.listeners=new Set,this.currentState=e.initialState,this.states=new Map,e.states)this.states.set(t,{name:t,transitions:new Map(e.states[t].transitions.map(function(e){return[e.accept,e.to]}))});this.history={options:{enable:!1,limit:100},transitions:[]},e.history&&("boolean"==typeof e.history?e.history&&(this.history.options.enable=!0):Boolean(e.history.enable)&&(void 0===e.history.limit||null===e.history.limit?this.history.options={enable:!0,limit:100}:e.history.limit>0&&(this.history.options={enable:!0,limit:e.history.limit}))),this.history.options.enable&&this.history.transitions.push({state:this.currentState})}return e.prototype.transition=function(e,t){var r=this;if(t&&(t instanceof Set?!t.has(this.currentState):t!==this.currentState))throw new i("current state (".concat(this.currentState,") != expected from state (").concat(t instanceof Set?JSON.stringify(n.__spreadArray([],n.__read(t),!1)):t,")"),"unexpectedFromState");var o="string"==typeof e?{type:e}:e,s=this.states.get(this.currentState),a=s.transitions.get(o.type);if(!a)throw new i("current state (".concat(this.currentState,') does not accept "').concat(o.type,'"'),"unexpectedInput");this.currentState=a,this.history.options.enable&&(this.history.transitions.push({event:o.type,state:this.currentState}),this.history.transitions.length>this.history.options.limit&&(this.history.transitions.length===this.history.options.limit+1?this.history.transitions.shift():this.history.transitions.splice(0,this.history.transitions.length-this.history.options.limit))),this.listeners.forEach(function(e){try{e({event:o,from:s.name,to:r.currentState})}catch(e){console.error("FSM listener exec error: ",e)}})},e.prototype.canAccept=function(e){return this.states.get(this.currentState).transitions.has(e)},e.prototype.subscribe=function(e){this.listeners.add(e)},e.prototype.unsubscribe=function(e){this.listeners.delete(e)},e.prototype.getHistoryRepresentation=function(e){if(!this.history.options.enable)return"";var t=e.limit?this.history.transitions.slice(-e.limit):this.history.transitions;return"states: ".concat(t.map(function(e){var t=e.state,r=e.event;return"".concat(r?"-(".concat(r,")->"):"").concat(t)}).join(""))},e}();t.FSM=o;var i=function(e){function t(t,r,n){var o=e.call(this,t)||this;return o.type="transition",o.generic=!0,o.subtype=r,o.payload=n,o}return n.__extends(t,e),t}(Error);t.FSMTransitionError=i;t.isFSMTransitionError=function(e){return"transition"===e.type}},"./src/utils/md5.ts":function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.md5=void 0,t.md5=function(e){var t,r,n,o,i,s="0123456789abcdef",a=function(e){var t,r="";for(t=0;t<=3;t++)r+=s.charAt(e>>8*t+4&15)+s.charAt(e>>8*t&15);return r},c=function(e,t){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r},u=function(e,t,r,n,o,i){return c(function(e,t){return e<<t|e>>>32-t}(c(c(t,e),c(n,i)),o),r)},l=function(e,t,r,n,o,i,s){return u(t&r|~t&n,e,t,o,i,s)},d=function(e,t,r,n,o,i,s){return u(t&n|r&~n,e,t,o,i,s)},p=function(e,t,r,n,o,i,s){return u(t^r^n,e,t,o,i,s)},f=function(e,t,r,n,o,i,s){return u(r^(t|~n),e,t,o,i,s)},_=function(e){var t,r=1+(e.length+8>>6),n=new Array(16*r);for(t=0;t<16*r;t++)n[t]=0;for(t=0;t<e.length;t++)n[t>>2]|=e.charCodeAt(t)<<t%4*8;return n[t>>2]|=128<<t%4*8,n[16*r-2]=8*e.length,n}(e),m=1732584193,h=-271733879,g=-1732584194,v=271733878;for(t=0;t<_.length;t+=16)r=m,n=h,o=g,i=v,h=f(h=f(h=f(h=f(h=p(h=p(h=p(h=p(h=d(h=d(h=d(h=d(h=l(h=l(h=l(h=l(h,g=l(g,v=l(v,m=l(m,h,g,v,_[t],7,-680876936),h,g,_[t+1],12,-389564586),m,h,_[t+2],17,606105819),v,m,_[t+3],22,-1044525330),g=l(g,v=l(v,m=l(m,h,g,v,_[t+4],7,-176418897),h,g,_[t+5],12,1200080426),m,h,_[t+6],17,-1473231341),v,m,_[t+7],22,-45705983),g=l(g,v=l(v,m=l(m,h,g,v,_[t+8],7,1770035416),h,g,_[t+9],12,-1958414417),m,h,_[t+10],17,-42063),v,m,_[t+11],22,-1990404162),g=l(g,v=l(v,m=l(m,h,g,v,_[t+12],7,1804603682),h,g,_[t+13],12,-40341101),m,h,_[t+14],17,-1502002290),v,m,_[t+15],22,1236535329),g=d(g,v=d(v,m=d(m,h,g,v,_[t+1],5,-165796510),h,g,_[t+6],9,-1069501632),m,h,_[t+11],14,643717713),v,m,_[t],20,-373897302),g=d(g,v=d(v,m=d(m,h,g,v,_[t+5],5,-701558691),h,g,_[t+10],9,38016083),m,h,_[t+15],14,-660478335),v,m,_[t+4],20,-405537848),g=d(g,v=d(v,m=d(m,h,g,v,_[t+9],5,568446438),h,g,_[t+14],9,-1019803690),m,h,_[t+3],14,-187363961),v,m,_[t+8],20,1163531501),g=d(g,v=d(v,m=d(m,h,g,v,_[t+13],5,-1444681467),h,g,_[t+2],9,-51403784),m,h,_[t+7],14,1735328473),v,m,_[t+12],20,-1926607734),g=p(g,v=p(v,m=p(m,h,g,v,_[t+5],4,-378558),h,g,_[t+8],11,-2022574463),m,h,_[t+11],16,1839030562),v,m,_[t+14],23,-35309556),g=p(g,v=p(v,m=p(m,h,g,v,_[t+1],4,-1530992060),h,g,_[t+4],11,1272893353),m,h,_[t+7],16,-155497632),v,m,_[t+10],23,-1094730640),g=p(g,v=p(v,m=p(m,h,g,v,_[t+13],4,681279174),h,g,_[t],11,-358537222),m,h,_[t+3],16,-722521979),v,m,_[t+6],23,76029189),g=p(g,v=p(v,m=p(m,h,g,v,_[t+9],4,-640364487),h,g,_[t+12],11,-421815835),m,h,_[t+15],16,530742520),v,m,_[t+2],23,-995338651),g=f(g,v=f(v,m=f(m,h,g,v,_[t],6,-198630844),h,g,_[t+7],10,1126891415),m,h,_[t+14],15,-1416354905),v,m,_[t+5],21,-57434055),g=f(g,v=f(v,m=f(m,h,g,v,_[t+12],6,1700485571),h,g,_[t+3],10,-1894986606),m,h,_[t+10],15,-1051523),v,m,_[t+1],21,-2054922799),g=f(g,v=f(v,m=f(m,h,g,v,_[t+8],6,1873313359),h,g,_[t+15],10,-30611744),m,h,_[t+6],15,-1560198380),v,m,_[t+13],21,1309151649),g=f(g,v=f(v,m=f(m,h,g,v,_[t+4],6,-145523070),h,g,_[t+11],10,-1120210379),m,h,_[t+2],15,718787259),v,m,_[t+9],21,-343485551),m=c(m,r),h=c(h,n),g=c(g,o),v=c(v,i);return a(m)+a(h)+a(g)+a(v)}},"./src/utils/merge.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js");function o(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}t.default=function e(t,r){var i,s;if(t===r)return t;try{for(var a=n.__values(Object.keys(r)),c=a.next();!c.done;c=a.next()){var u=c.value,l=o(r,u),d=o(t,u),p=void 0;"object"==typeof l?e(p=d||{},l):p=l,t[u]=p}}catch(e){i={error:e}}finally{try{c&&!c.done&&(s=a.return)&&s.call(a)}finally{if(i)throw i.error}}return t}},"./src/utils/msg.ts":function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.apiFailMsg=t.apiCancelMsg=t.apiSuccessMsg=void 0,t.apiSuccessMsg=function(e){return"".concat(e,":ok")},t.apiCancelMsg=function(e,t){return"".concat(e,":cancel ").concat(t)},t.apiFailMsg=function(e,t){return"".concat(e,":fail ").concat(t)}},"./src/utils/report.ts":function(e,t,r){var n;Object.defineProperty(t,"__esModule",{value:!0}),t.reportCallContainerLike=t.socketOnMessageSamplePicker=t.wrapTiming=t.reportMMData=t.setReportToken=t.reportIDKey=t.reportAPISpeed=t.init=t.getWarmStartTs=t.getColdStartTs=void 0;var o=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),i=r("./src/externals/public-lib/reporter.ts"),s=r("./src/externals/public-lib/appserviceSdk.ts"),a=r("./src/utils/throttle.ts"),c=r("./src/utils/service-endpoint.ts"),u=r("./src/externals/globals/wxconfig.ts"),l=r("./src/utils/type.ts"),d=r("./src/utils/utils.ts"),p=!1,f=[],_=Date.now(),m=Date.now(),h="unknown";null===(n=u.default.onReady)||void 0===n||n.call(u.default,function(){_=Date.now(),m=Date.now()});t.getColdStartTs=function(){return _};t.getWarmStartTs=function(){return m};t.init=function(){if(!p)try{var e=(0,s.getSDK)();e.wx.onAppShow&&e.wx.onAppShow(function(){m=Date.now()}),e.wx.getNetworkType({success:function(e){h=e.networkType},complete:function(){p=!0,g()}}),e.wx.onNetworkStatusChange(function(e){p||(p=!0,g()),h=e.networkType})}catch(e){}};var g=function(){var e,t;try{for(var r=o.__values(f),n=r.next();!n.done;n=r.next()){var i=n.value;try{i()}catch(e){0}}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}f=[]};function v(e){for(var t=0;t<e.length;t++){var r=e[t];"string"==typeof r&&(e[t]=r.replace(/,/g," "))}return e}t.reportAPISpeed=function(e){setTimeout(function(){var r,n,o,s;try{if(!function(e){return!(e.tunnelStartTime&&e.tunnelEndTime&&e.tunnelEndTime<e.tunnelStartTime||!(e.apiStartTime&&e.apiEndTime&&e.apiEndTime>e.apiStartTime))}(e))return;if(!p&&f.length<100)return void f.push(t.reportAPISpeed.bind(null,e));var a=e.apiEndTime-e.apiStartTime,c=e.tunnelEndTime?e.tunnelEndTime-e.tunnelStartTime:0,u=v([0,e.apiName,a,c,(e.pollStartTime&&e.pollEndTime&&e.pollEndTime>e.pollStartTime?e.pollEndTime-e.pollStartTime:0)||0,h,e.tunnelTimeNoCSNetCost?a-e.tunnelTimeNoCSNetCost:0,e.tunnelTimeNoCSNetCost?c-e.tunnelTimeNoCSNetCost:0,e.funcExecTime?e.funcExecTime:0,null!==(r=e.channelType)&&void 0!==r?r:0,e.funcName||"",e.apiStartTime-_,void 0!==e.warmStartTime?e.apiStartTime-e.warmStartTime:0,null!==(n=e.usingPrefetchToken)&&void 0!==n?n:0,null!==(o=e.resultStatus)&&void 0!==o?o:1,null!==(s=e.errMsg)&&void 0!==s?s:""]);i.default.fake?(0,t.reportMMData)(16588,6,u.join(",")):i.default.reportKeyValue({key:"CloudReport",value:u.join(","),force:!0})}catch(e){}})};var y,E;t.reportIDKey=function(e,t,r,n){i.default.reportIDKeyDirectly({id:e,key:t,force:r,immediately:n})};t.setReportToken=function(e,t){return y=e,E=t};var b=[];t.reportMMData=function(e,t,r){b.push({log_id:e,version:t,user_log_list:r}),y&&S()};var S=(0,a.default)(function(){(0,s.getSDK)().request({url:"https://servicewechat.com/wxa-qbase/report?token=".concat(y.token,"&v=").concat(E),method:"POST",header:{},enableHttp2:!0,dataType:"json",data:JSON.stringify({report_info_list:b}),success:function(e){for(var t in e.header)"x-wx-system-error"===t.toLocaleLowerCase()&&"85104"===e.header[t]&&y.invalidate()}}),b=[],(0,c.keepAlive)()},3e4);t.wrapTiming=function(e,r){var n=(0,l.isFunction)(e);function i(){for(var t,o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];if(r.samplePicker&&!r.samplePicker.next())return n?e.apply(this,o):e;var a=Date.now(),c=!0;try{if((null===(t=r.condition)||void 0===t?void 0:t.emptyKey)&&r.timing[r.startKey])return n?e.apply(this,o):e;var u=void 0;if(n){var d=e.apply(this,o);if(!(0,l.isPromise)(d))return c=!1,d;u=d}else u=e;return u.then(function(){return s(a)}).catch(function(){return s(a)}),u}catch(e){throw c=!1,e}finally{c||s(a)}}function s(e){r.timing[r.startKey]=e,r.timing[r.endKey]=Date.now(),r.autoReport&&(0,t.reportAPISpeed)(o.__assign(o.__assign({},r.timing),{apiName:r.autoReport}))}return n?i:i()};function T(e){if(e&&!isNaN(e))return e>6e4?6e4:e<0?0:e}t.socketOnMessageSamplePicker=function(e,t){return function(){var r,n;return o.__generator(this,function(o){switch(o.label){case 0:r=function(){return parseInt(Math.round(2*Math.random()*e),10)},n=t?0:r(),o.label=1;case 1:return n>0?(n--,[4,!1]):[3,3];case 2:return o.sent(),[3,5];case 3:return n=r(),[4,!0];case 4:o.sent(),o.label=5;case 5:return[3,1];case 6:return[2]}})}}(10,!0)(),t.reportCallContainerLike=function(e,r,n){r.stats.apiEndTime=Date.now(),(0,t.reportAPISpeed)(o.__assign(o.__assign({},r.context),{apiEndTime:r.stats.apiEndTime,apiName:e}));var i=Boolean(r.stats.profile),s=r.stats.profile||{},a=r.stats.serverEndTs-r.stats.serverStartTs,c=r.stats.httpRequest?r.stats.httpRequest<=6e4?r.stats.httpRequest:6e4:void 0,u=r.stats.apiEndTime,l=u-r.context.apiStartTime;l>9e4&&(l=9e4);var p=r.path||"";p=p.split("?")[0].replace(/\/\d+\//g,"/*/").replace(/\/\d+$/g,"/*"),(0,t.reportMMData)(22601,14,v([r.stats.callid,r.context.apiStartTime,u,r.stats.serverStartTs,r.stats.serverEndTs,r.stats.requestBodyBytes,r.stats.responseBodyBytes,r.stats.getServiceEndpoint,r.stats.queryDNS,r.stats.compress,r.stats.loadAsmcrypto,r.stats.encrypt,c,r.stats.decrypt,r.stats.uncompress,r.stats.decodePb,r.stats.decodeBody,r.stats.ip,s.redirectStart,i?s.redirectEnd-s.redirectStart:void 0,s.fetchStart,s.domainLookupStart,i?s.domainLookUpEnd-s.domainLookUpStart:void 0,s.connectStart,i?s.connectEnd-s.connectStart:void 0,s.SSLconnectionStart,i?s.SSLconnectionEnd-s.SSLconnectionStart:void 0,s.requestStart,i?s.requestEnd-s.requestStart:void 0,s.responseStart,i?s.responseEnd-s.responseStart:void 0,s.rtt,s.estimate_nettype,T(s.httpRttEstimate),T(s.transportRttEstimate),T(s.downstreamThroughputKbpsEstimate),s.throughputKbps,s.peerIP,s.port,i?s.socketReused?1:0:void 0,s.sendBytesCount,s.receivedBytedCount,s.protocol,(0,d.getSystemInfo)().system,l,a>0?a:0,c?l-c:void 0,p,(0,d.getSystemInfo)().platform,r.stats.requestStartTs,1685699826199,r.stats.ecdnId,r.stats.ecdnEdgeTiming,r.stats.domain,r.stats.stringToBuffer,r.stats.encodePb,r.stats.tsBeforeCallContainerImpl,r.stats.tsCallContainerImplStart,r.stats.decodeJson,"WACloud:".concat(n),i?s.requestStart-r.stats.requestStartTs:void 0,i?r.stats.requestSuccessTs-s.requestEnd:void 0,r.stats.responseProcessEndTs?u-r.stats.responseProcessEndTs:void 0,r.stats.upstreamCost,r.stats.meshStartTs,r.stats.meshEndTs]).join(","))}},"./src/utils/serializer.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.deserialize=t.toJSONSerializable=t.stringifyReplacer=t.serialize=void 0;var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),o=r("./src/utils/error.ts"),i=r("./src/config/error.config.ts"),s=r("./src/utils/type.ts");function a(e){switch((0,s.getType)(e)){case"object":return function e(t){var r=t;var n=c(r);if(r!==n)return n;for(var o in r){var i=r[o],u=(0,s.getType)(i);switch(u){case"object":var l=c(i);r[o]=l!==i?l:e(r[o]);break;case"array":var l=a(i);l!==i&&(r[o]=l);break;default:continue}}return r}(e);case"array":return e.map(a);default:return e}}function c(e){for(var t in e)switch(t){case"type":switch(e.type){case"Buffer":if((0,s.isArray)(e.data)&&(0,s.isNumber)(e.data[0]))try{return new Uint8Array(e.data).buffer}catch(t){return e}}}return e}t.serialize=function(e,t){return JSON.stringify(e,function(e,r){if(t&&t.has(r))return t.get(r);switch((0,s.getType)(r)){case"arraybuffer":var o=new Uint8Array(r);return{type:"Buffer",data:n.__spreadArray([],n.__read(o),!1)}}return r})},t.stringifyReplacer=function(e,t){switch((0,s.getType)(t)){case"arraybuffer":var r=new Uint8Array(t);return{type:"Buffer",data:n.__spreadArray([],n.__read(r),!1)}}return t},t.toJSONSerializable=function e(t,r){if(void 0===r&&(r="data"),null!==t&&void 0!==t){if(!0===t||!1===t)return t;switch((0,s.getType)(t)){case"number":if(isFinite(t))return t;break;case"string":return t;case"array":return t.map(function(t,n){return e(t,"".concat(r,"[").concat(n,"]"))});case"object":var a={};for(var c in t)t.hasOwnProperty(c)&&(a[c]=e(t[c],"".concat(r,".").concat(c)));return a;case"arraybuffer":var u=new Uint8Array(t);return{type:"Buffer",data:n.__spreadArray([],n.__read(u),!1)}}if("function"==typeof t)return t;!function(e){throw new o.CloudSDKError({errCode:i.ERR_CODE.SDK_API_PARAMETER_TYPE_ERROR,errMsg:"".concat(e," is not JSON-serializable")})}(r)}},t.deserialize=function(e){return a(JSON.parse(e))}},"./src/utils/service-endpoint.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.keepAlive=t.deferKeepAlive=t.getCloudServiceToken=t.ServiceEndpoint=void 0;var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),o=r("./src/network/tunnel.ts"),i=r("../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/debounce.js"),s=r("./src/externals/public-lib/appserviceSdk.ts"),a=r("./src/utils/report.ts"),c=r("./src/utils/report.ts"),u=r("./src/utils/utils.ts"),l=r("./src/utils/token-manager.ts"),d=/https:\/\/servicewechat\.com/,p={},f="servicewechat.com",_=!1,m="".concat(Math.random(),"_").concat(Date.now());"undefined"!=typeof Foundation&&Foundation.onLoad(function(){m="".concat(Math.random(),"_").concat(Date.now())});var h={},g=function(){function e(e){var t=this;this.identifiers=e,this.containerTokenManager=new l.TokenManager(this.refreshContainerServiceEndpoint.bind(this),function(e){return e},function(e){return t.processServiceEndpoint(e)}),h.container=this.containerTokenManager}return e.prototype.setMetaData=function(e){this._meta=e},e.prototype.setTunnelRequest=function(e){this._tunnelRequest=e},e.prototype.getEndpointSync=function(e){if("container"===e){var t=this.containerTokenManager.getTokenSync();if(null===t||void 0===t?void 0:t.url)return t}},e.prototype.getEndpoint=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return"container"===e?[2,this.containerTokenManager.getToken()]:[2,null]})})},e.prototype.processServiceEndpoint=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(r){return(0,a.setReportToken)(e,"1"),f=e.domain||"servicewechat.com",function(){var e;n.__awaiter(this,void 0,void 0,function(){var r,o,i=this;return n.__generator(this,function(a){return v?[2]:(v=!0,(r=function(){v&&setTimeout(function(){return n.__awaiter(i,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,(0,t.keepAlive)()];case 1:return e.sent(),r(),[2]}})})},2e4)})(),y||(y=!0,o=(0,s.getSDK)(),(null===(e=o.wx)||void 0===e?void 0:e.onAppHide)&&o.wx.onAppHide(function(){v=!1})),(0,t.keepAlive)(),[2,(0,t.keepAlive)()])})})}(),(0,t.deferKeepAlive)(),[2]})})},e.prototype.refreshContainerServiceEndpoint=function(){var e,t,r,i;return n.__awaiter(this,void 0,void 0,function(){var a,c,l,d,f,h,g,v,y;return n.__generator(this,function(n){switch(n.label){case 0:return clearTimeout(p.container),!(0,s.getSDK)().private_getBackgroundFetchData||_?[3,3]:(_=!0,!(a=(0,u.privateGetBackgroundFetchData)(500,this.identifiers))||a.url_info?[3,2]:[4,a]);case 1:a=n.sent(),n.label=2;case 2:if(a&&a.expiresTs>Date.now()&&a.url_info)return[2,{url:(null===(e=a.url_info)||void 0===e?void 0:e.cloudrun_url)?"".concat(a.url_info.cloudrun_url,"?token=").concat(a.token):"https://".concat(a.domain,"/wxa-qbase/container_service?token=").concat(a.token),cloudServiceUrl:(null===(t=a.url_info)||void 0===t?void 0:t.cloudbase_url)?"".concat(a.url_info.cloudbase_url,"?token=").concat(a.token):void 0,domain:a.domain||"servicewechat.com",token:a.token,http:!0,key:a.key,timestamp:a.timestamp,expires_in:a.expires_in,exp:a.expires_in}];n.label=3;case 3:c=[],l=0,n.label=4;case 4:if(!(l<3))return[3,12];n.label=5;case 5:return n.trys.push([5,10,,11]),d=Date.now(),f=(0,u.getSystemInfo)(),this._tunnelRequest?[4,this._tunnelRequest({apiName:"tcbapi_get_service_info",serializedReqData:JSON.stringify({client_random:m,system:f.system,wx_app_version:f.version})})]:[3,7];case 6:return h=n.sent(),[3,9];case 7:return[4,(0,o.default)({apiName:"qbase_commapi",data:{qbase_api_name:"tcbapi_get_service_info",qbase_req:JSON.stringify({client_random:m,system:f.system,wx_app_version:f.version}),qbase_options:{},qbase_meta:this._meta,cli_req_id:"".concat(+new Date,"_").concat(Math.random())}})];case 8:h=n.sent(),n.label=9;case 9:return g=h.data,Date.now()-d>1e3*g.expires_in?(c.push("result already expired (startTs ".concat(d," resultTs ").concat(Date.now(),")")),[3,11]):(v=g.domain||"servicewechat.com",[2,{url:(null===(r=g.url_info)||void 0===r?void 0:r.cloudrun_url)?"".concat(g.url_info.cloudrun_url,"?token=").concat(g.token):"https://".concat(v,"/wxa-qbase/container_service?token=").concat(g.token),cloudServiceUrl:(null===(i=g.url_info)||void 0===i?void 0:i.cloudbase_url)?"".concat(g.url_info.cloudbase_url,"?token=").concat(g.token):void 0,domain:v,token:g.token,http:g.http,key:g.key,timestamp:g.timestamp,ip:g.ip,vip:g.vip,expires_in:g.expires_in,exp:g.expires_in}]);case 10:return y=n.sent(),c.push(y+""),[3,11];case 11:return l++,[3,4];case 12:throw new Error("get container service endpoints errors: ".concat(c.join("\n")))}})})},e.prototype.invalidateToken=function(e,t){"container"===e&&this.containerTokenManager.invalidate(t)},e.invalidateService=function(e,t){var r;null===(r=h[e])||void 0===r||r.invalidate(t)},e}();t.ServiceEndpoint=g,t.getCloudServiceToken=function(e){var t,r=null===(t=h.container)||void 0===t?void 0:t.getTokenSync();if(null===r||void 0===r?void 0:r.cloudServiceUrl)return e.rdm&&(r.cloudServiceUrl=r.cloudServiceUrl.replace(d,"https://wxardm.weixin.qq.com")),r};var v=!1,y=!1,E=0;var b=0;t.deferKeepAlive=function(){b=Date.now()},t.keepAlive=(0,i.default)(function(){return new Promise(function(e){if(!(Date.now()-b<3e4)){var t=Date.now(),r=!/^\d+/.test(f);(0,s.getSDK)().request({url:"".concat(r?"https":"http","://").concat(f,"/wxa-qbase/keepalive"),header:r?{}:{host:"servicewechat.com"},method:"GET",dataType:"text",enableHttp2:r,success:function(){e(),E++%4==0&&(0,c.reportMMData)(22990,1,["privateHttpKeepAlive",f,t,Date.now(),Date.now()-t].join(","))},fail:function(){e()}})}})})},"./src/utils/set.ts":function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.unset=t.set=void 0;var r=function(e){var t=new Map;return function(r){return t.has(r)||t.set(r,e(r)),t.get(r)}}(function(e){return e.replace(/\[(\d+)\]/g,".[$1]").split(".").map(function(e){return/^\[(\d+)\]$/.test(e)?parseInt(e.substring(1,e.length-1)):e})});t.set=function(e,t,n){if(e){if(!Object.prototype.hasOwnProperty.call(e,t)){for(var o=r(t),i=e,s=0;s<o.length-1;++s){var a=o[s];i[a]||(i[a]="string"==typeof o[s+1]?{}:[]),i=i[a]}return i[o[o.length-1]]=n,e}e[t]=n}},t.unset=function(e,t){if(e){if(!Object.prototype.hasOwnProperty.call(e,t)){for(var n=r(t),o=e,i=0;i<n.length-1;++i){var s=n[i];if(!o[s])return;o=o[s]}return delete o[n[n.length-1]],e}delete e[t]}}},"./src/utils/simulate-request.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.processResponse=t.followRedirect=t.is3XXResponse=t.processParam=void 0;var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),o=r("./src/index.ts"),i=r("./src/utils/fn/clone.ts"),s=r("./src/utils/type.ts"),a=r("./src/utils/userAgent.ts"),c=r("./src/utils/utils.ts"),u=r("./src/utils/md5.ts"),l=r("./src/services/saas/internal.ts");function d(e){return e>=300&&e<=399}t.processParam=function(e){e.path||(e.path=""),e.method||(e.method="GET"),e.header||(e.header={}),e.dataType||(e.dataType="json"),e.responseType||(e.responseType="text");var t="";for(var r in e.header)"content-type"===r.toLowerCase()&&e.header&&(t=e.header[r]);if(t||(t="application/json",e.header["content-type"]="application/json"),e.header["User-Agent"]=(0,a.getUA)()||"",/get/i.test(e.method||"")&&e.data&&(0,s.isObject)(e.data)){var n="";for(var r in e.data)n+="".concat(n.length?"&":"").concat((0,c.encodeWithDecode)(r),"=").concat((0,c.encodeWithDecode)(e.data[r]));e.path.includes("?")?e.path+="".concat(e.path.endsWith("&")?"":n?"&":"").concat(n):e.path+="".concat(e.path.endsWith("?")?"":n?"?":"").concat(n),e.data=void 0}else if(/post|put|patch|delete/i.test(e.method||"")&&e.data)if(t.includes("application/json")){var o=(0,s.getType)(e.data);e.shouldSerialize="string"!==o}else if(t.includes("application/x-www-form-urlencoded")&&(0,s.isObject)(e.data)){for(var r in n="",e.data)n+="".concat(n.length?"&":"").concat(encodeURIComponent(r),"=").concat(encodeURIComponent(e.data[r]));e.data=n}},t.is3XXResponse=d;!function(e){function t(t,r){var n=e.call(this,t)||this;return n.code=r,n}n.__extends(t,e)}(Error);var p=new WeakMap,f=5;t.followRedirect=function(e,t,r,s,a,c){var _;return null===(_=e.followRedirect)||void 0===_||_?function e(_,m){return new Promise(function(h,g){m.then(function(m){var v;if(d(m.statusCode)){var y=null!==(v=p.get(t))&&void 0!==v?v:0;if(y>=f)g("reach the max redirect count");else{p.set(t,y+1);var E="";for(var b in m.header)"location"===b.toLowerCase()&&(E=m.header[b]);if(E)if(E.startsWith("/")){var S=(0,i.shallowClone)(_);_.path=E,e(S,r(_)).then(h).catch(g)}else if(c){var T=new URL(E);console.log("[!] strict redirect to gateway, parsed: ",T);var A=(0,u.md5)(T.hostname);_.header=Object.assign({"x-wx-route-tag":A},_.header),_[l.ExposedHeaderSymbol]={"x-wx-route-tag":A},S=(0,i.shallowClone)(_),_.path=T.pathname+T.search,e(S,r(_)).then(h).catch(g)}else(0,o.getSDK)(s.identifiers).request({url:E,method:_.method,header:_.header,data:_.data,dataType:_.dataType,responseType:_.responseType,timeout:_.timeout,success:function(e){h(n.__assign(n.__assign({},e),{errMsg:"".concat(a,":ok")}))},fail:function(e){g(e.errMsg.replace(/^request/,a))}});else h(m)}}else h(m)}).catch(g)})}(e,t):t},t.processResponse=function(e,t,r){var n,o="string"==typeof t?null:new Uint8Array(t).buffer;if("json"!==e.dataType&&e.dataType||d(r))n="text"===e.responseType?"string"==typeof t?t:(0,c.arrayBufferToString)(o):"arraybuffer"===e.responseType?"string"==typeof t?(0,c.stringToArrayBuffer)(t):o:t;else{var i="string"==typeof t?t:(0,c.arrayBufferToString)(o);n=(0,c.tryJSONParse)(i)}return n}},"./src/utils/symbol.ts":function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SYMBOL_CDN=t.SYMBOL_CLOUD_ID=void 0,t.SYMBOL_CLOUD_ID=Symbol.for("CLOUD_ID"),t.SYMBOL_CDN=Symbol("CDN")},"./src/utils/throttle.ts":function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){var r=null,n=!1,o=function(){r?n=!0:(e(),r=setTimeout(function(){clearTimeout(r),r=null,n&&(n=!1,o())},t))};return o}},"./src/utils/token-manager.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.TokenManager=void 0;var n=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),o=r("./src/utils/expire.ts"),i=r("./src/utils/report.ts"),s=function(){},a=function(){function e(e,t,r){this.refreshToken=e,this.proactiveRefreshTimer=t,this.onRefreshedToken=r,this.state="init",this.currentToken=void 0,this.currentSession=void 0,this.currentTask=void 0,this.refreshHandler=void 0}return e.prototype.transition=function(e,t){switch(s("[gateway:token] transition ".concat(this.state," -> ").concat(e),t),this.state){case"init":"refreshing"===e?(this.state="refreshing",this.currentTask=t.task):s("[gateway:token] invalid transition ".concat(this.state," -> ").concat(e));break;case"normal":"refreshing"===e?(this.state="refreshing",Object.defineProperty(this.currentToken,"__invalidated",{value:!0}),this.currentToken=void 0,this.currentTask=t.task):"normal"===e?t.token&&this.currentToken&&t.token.timestamp>this.currentToken.timestamp&&(this.currentToken=t.token,this.currentTask=void 0):s("[gateway:token] invalid transition ".concat(this.state," -> ").concat(e));break;case"refreshing":"normal"===e?(this.state="normal",this.currentToken=t.token,this.currentTask=void 0):s("[gateway:token] invalid transition ".concat(this.state," -> ").concat(e))}},e.prototype.getTokenSync=function(){if(this.currentToken)return this.currentToken.exp<Date.now()?void this.invalidate(this.currentToken):this.currentToken},e.prototype.getToken=function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(e){return this.currentToken?this.currentToken.exp<Date.now()?[2,this.invalidate(this.currentToken)]:[2,this.currentToken]:[2,this.invalidate()]})})},e.prototype.updateSession=function(e){return n.__awaiter(this,void 0,void 0,function(){var t,r;return n.__generator(this,function(n){switch(n.label){case 0:return t=new Promise(function(t){return"string"==typeof e?t(e):e?e.then(t):t(e)}),r=this,[4,t];case 1:return r.currentSession=n.sent(),[2,this.invalidate()]}})})},e.prototype.invalidate=function(e,t){var r;return n.__awaiter(this,void 0,void 0,function(){var a,c,u,l=this;return n.__generator(this,function(d){switch(d.label){case 0:return"refreshing"===this.state&&this.currentTask?[2,this.currentTask]:(null===e||void 0===e?void 0:e.__invalidated)&&"normal"===this.state&&this.currentToken?(s("[gateway:token] already invalidated token returning latest not refreshing"),[2,this.currentToken]):(this.refreshHandler&&clearTimeout(this.refreshHandler),a=this.currentSession,c=new Promise(function(r,s){var c=Date.now();l.refreshToken(a).then(function(t){var i=0,s=0;"iat"in t?(i=1e3*t.iat,s=t.exp-t.iat):(i=t.timestamp,s=t.expires_in);var a=(0,o.getPessimisticExpireTs)({timestamp:i,expires_in:s}),c=n.__assign(n.__assign({},t),{exp:a,timestamp:i,invalidate:function(){return l.invalidate(e)}});l.transition("normal",{token:c});var u=c.exp-Date.now();l.refreshHandler=l.proactiveRefreshTimer?setTimeout(function(){l.invalidate(void 0,!0)},l.proactiveRefreshTimer(u)):void 0,r(c)}).catch(function(e){var r=Date.now(),n="";(n=e instanceof Error?e.message:"string"==typeof e?e:e+"").replace(/,/g,"."),(0,i.reportAPISpeed)({apiName:"TokenManager",funcName:t?"ProactiveRefreshTimer":"Invalidation",apiStartTime:c,apiEndTime:r,tunnelStartTime:c,tunnelEndTime:r,errMsg:n,resultStatus:2}),s(n)})}),t||this.transition("refreshing",{task:c}),[4,c]);case 1:return u=d.sent(),null===(r=this.onRefreshedToken)||void 0===r||r.call(this,u),[2,u]}})})},e}();t.TokenManager=a},"./src/utils/type.ts":function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isPlainObject=t.isInternalObject=t.isRegExp=t.isDate=t.isArray=t.isFunction=t.isPromise=t.isNumber=t.isString=t.isObject=t.getType=void 0;t.getType=function(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()};t.isObject=function(e){return"object"===(0,t.getType)(e)};t.isString=function(e){return"string"===(0,t.getType)(e)};t.isNumber=function(e){return"number"===(0,t.getType)(e)};t.isPromise=function(e){return"promise"===(0,t.getType)(e)};t.isFunction=function(e){return"function"==typeof e};t.isArray=function(e){return Array.isArray(e)};t.isDate=function(e){return"date"===(0,t.getType)(e)};t.isRegExp=function(e){return"regexp"===(0,t.getType)(e)};t.isInternalObject=function(e){return e&&"symbol"===(0,t.getType)(e._internalType)};t.isPlainObject=function(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}},"./src/utils/userAgent.ts":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getUA=void 0;var n,o=r("./src/externals/public-lib/appserviceSdk.ts");t.getUA=function(){if(!n){var e=(0,o.getSDK)();if(!e.private_getUserAgent)return n;e.private_getUserAgent(function(e){n=e})}return n}},"./src/utils/utils.ts":function(e,t,r){(function(e){var n=this;Object.defineProperty(t,"__esModule",{value:!0}),t.fetchFunc=t.compareVersions=t.parseUrl=t.stringToUtf8Array=t.stringToArrayBuffer=t.arrayBufferToString=t.base64ToArrayBuffer=t.arrayBufferToBase64=t.encodeWithDecode=t.tryDecodeURIComponent=t.tryJSONParse=t.privateGetBackgroundFetchData=t.getSystemInfo=t.offAppVisibilityChange=t.onAppVisibilityChange=t.onceNetworkOnline=t.throwErrorIfNetworkOffline=t.getNetworkStatus=t.getWXVersion=t.autoCount=t.nextLoop=t.sleep=t._wxConsole=void 0;var o=r("../../node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),i=r("./src/externals/public-lib/appserviceSdk.ts"),s=r("./src/utils/report.ts"),a=r("./src/utils/expire.ts");t._wxConsole="undefined"!=typeof wxConsole?wxConsole:void 0;t.sleep=function(e){return void 0===e&&(e=0),new Promise(function(t){return setTimeout(t,e)})};t.nextLoop=function(){return new Promise(function(t){return e(t)})};var c={};t.autoCount=function(e){return void 0===e&&(e="any"),c[e]||(c[e]=0),c[e]++};var u;t.getWXVersion=function(){var e,t,r=(0,i.getSDK)().wx;if(r&&r.version){e=r.version.version,t=r.version.updateTime;var n=r.version.updateTime.match(/^(\d+)\.(\d+)\.(\d+)/);return{version:e,updateTime:t,updateDateInDashes:n?"".concat(n[1],"-").concat(n[2],"-").concat(n[3]):"unknown"}}return{version:"unknown",updateTime:"unknown",updateDateInDashes:"unknown"}};var l=!1,d=[];t.getNetworkStatus=function(){return new Promise(function(e,t){if(u)e(u);else try{(0,i.getSDK)().wx.getNetworkType({success:function(t){u={networkType:t.networkType,isConnected:"none"!==t.networkType},e(u),l||((0,i.getSDK)().wx.onNetworkStatusChange(function(e){if(u.networkType=e.networkType,u.isConnected=e.isConnected,e.isConnected&&d.length)for(;d.length;)try{d.shift()()}catch(e){}}),l=!0)},fail:t})}catch(e){t(e)}})};t.throwErrorIfNetworkOffline=function(){return new Promise(function(e,r){return o.__awaiter(n,void 0,void 0,function(){return o.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,(0,t.getNetworkStatus)()];case 1:return n.sent().isConnected?e():r("network offline"),[3,3];case 2:return n.sent(),e(),[3,3];case 3:return[2]}})})})};t.onceNetworkOnline=function(){return new Promise(function(e){u&&u.isConnected?e():d.push(e)})};var p,f=!1,_=new Set;t.onAppVisibilityChange=function(e){try{(0,i.getSDK)().wx.onAppShow&&(f||(function(){var e=(0,i.getSDK)().wx;e.onAppShow&&e.onAppHide&&(e.onAppShow(function(){var e,t;"visible";try{for(var r=o.__values(_),n=r.next();!n.done;n=r.next()){var i=n.value;try{i("show")}catch(e){}}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}}),e.onAppHide(function(){var e,t;"hidden";try{for(var r=o.__values(_),n=r.next();!n.done;n=r.next()){var i=n.value;try{i("hide")}catch(e){}}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}}))}(),f=!0),_.size>50&&_.clear(),_.add(e))}catch(e){}},t.offAppVisibilityChange=function(e){_.delete(e)},t.getSystemInfo=function(){if(p)return p;var e=(0,i.getSDK)().wx;return p=e.getSystemInfoSync()};var m,h=!1,g=void 0;function v(e){try{return decodeURIComponent(e)}catch(t){return e}}t.privateGetBackgroundFetchData=function(e,r){if(void 0===e&&(e=500),void 0===r&&(r={}),(0,i.getSDK)().private_getBackgroundFetchData&&!r.pluginId){if(g)return g;if(m)return m.then(function(){return g});if(!h){h=!0;var n=Date.now(),o=(0,s.getWarmStartTs)();return m=Promise.race([(0,t.sleep)(e).then(function(){return{error:"bg fetch timeout"}}),new Promise(function(e,t){(0,i.getSDK)().private_getBackgroundFetchData({fetchType:0,success:function(t){try{t||e({error:"empty"}),(g=JSON.parse(t.fetchedData)).expiresTs=(0,a.getPessimisticExpireTs)(g),e(g),(0,s.reportAPISpeed)({apiName:"private_getBackgroundFetchData",apiStartTime:n,apiEndTime:Date.now(),warmStartTime:o})}catch(t){e({error:t})}},fail:function(t){e({error:t})}})})]),g?(null===t._wxConsole||void 0===t._wxConsole||t._wxConsole.log("private_getBackgroundFetchData (cloud) (sync)",JSON.stringify(g)),g):m.then(function(e){return m=void 0,null===t._wxConsole||void 0===t._wxConsole||t._wxConsole.log("private_getBackgroundFetchData (cloud)",JSON.stringify(e)),e.error?void 0:e})}}},t.tryJSONParse=function(e){try{return JSON.parse(e)}catch(t){return e}},t.tryDecodeURIComponent=v,t.encodeWithDecode=function(e){return encodeURIComponent(v(e))};var y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function E(e){for(var t=[],r=0;r<e.length;r++){var n=e.charCodeAt(r);n<128?t.push(n):n<2048?t.push(192|n>>6,128|63&n):n<55296||n>=57344?t.push(224|n>>12,128|n>>6&63,128|63&n):(r++,n=65536+((1023&n)<<10|1023&e.charCodeAt(r)),t.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|63&n))}return new Uint8Array(t)}t.arrayBufferToBase64=function(e){for(var t="",r=new Uint8Array(e),n=r.byteLength,o=0;o<n;o++)t+=String.fromCharCode(r[o]);return function(e){for(var t=String(e),r="",n=void 0,o=void 0,i=0,s=y;t.charAt(0|i)||(s="=",i%1);r+=s.charAt(63&n>>8-i%1*8)){if((o=t.charCodeAt(i+=.75))>255)throw new Error('"btoa" failed');n=n<<8|o}return r}(t)},t.base64ToArrayBuffer=function(e){for(var t=function(e){var t=String(e).replace(/=+$/,""),r="";if(t.length%4==1)throw new Error('"atob" failed');for(var n=0,o=void 0,i=void 0,s=0;i=t.charAt(s++);~i&&(o=n%4?64*o+i:i,n++%4)?r+=String.fromCharCode(255&o>>(-2*n&6)):0)i=y.indexOf(i);return r}(e),r=t.length,n=new Uint8Array(r),o=0;o<r;o++)n[o]=t.charCodeAt(o);return n.buffer},t.arrayBufferToString=function(e){return b(new Uint8Array(e))},t.stringToArrayBuffer=function(e){return E(e).buffer},t.stringToUtf8Array=E;var b=function(){var e=new Array(128),t=String.fromCodePoint||String.fromCharCode,r=[];return function(n){var o,i,s=n.length;r.length=0;for(var a=0;a<s;)(i=n[a++])<=127?o=i:i<=223?o=(31&i)<<6|63&n[a++]:i<=239?o=(15&i)<<12|(63&n[a++])<<6|63&n[a++]:String.fromCodePoint?o=(7&i)<<18|(63&n[a++])<<12|(63&n[a++])<<6|63&n[a++]:(o=63,a+=3),r.push(e[o]||(e[o]=t(o)));return r.join("")}}();t.parseUrl=function(e){var t={protocol:/^(.+):\/\//,host:/:\/\/(.+?)[?#\s/]/,path:/\w(\/.*?)[?#\s]/,query:/\?(.+?)[#/\s]/,hash:/#(\w+)\s$/};e+=" ";var r={};return Object.keys(t).forEach(function(n){var o=t[n];r[n]="query"===n?o.exec(e)&&function(e){return e.split("&").reduce(function(e,t){var r=t.split("=");return e[r[0]]=r[1],e},{})}(o.exec(e)[1]):o.exec(e)&&o.exec(e)[1]}),r},t.compareVersions=function(e,t){for(var r=e.split(".").map(Number),n=t.split(".").map(Number),o=0;o<r.length;++o){if(n.length===o)return 1;if(r[o]!==n[o])return r[o]>n[o]?1:-1}return r.length!==n.length?-1:0},t.fetchFunc=function(e,t){var r=t.method,n=t.headers,o=t.body;return new Promise(function(t,s){(0,i.getSDK)().request({url:e,method:r,header:n,data:o,success:t,fail:s})})}}).call(this,r("../../node_modules/.pnpm/timers-browserify@2.0.12/node_modules/timers-browserify/main.js").setImmediate)},"./src/vendor/bson.bundle.js":function(e,t,r){(function(e,r){var n=[],o=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,s=!1;function a(){s=!0;for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0,r=e.length;t<r;++t)n[t]=e[t],o[e.charCodeAt(t)]=t;o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63}function c(e){return n[e>>18&63]+n[e>>12&63]+n[e>>6&63]+n[63&e]}function u(e,t,r){for(var n,o=[],i=t;i<r;i+=3)n=(e[i]<<16)+(e[i+1]<<8)+e[i+2],o.push(c(n));return o.join("")}function l(e){var t;s||a();for(var r=e.length,o=r%3,i="",c=[],l=0,d=r-o;l<d;l+=16383)c.push(u(e,l,l+16383>d?d:l+16383));return 1===o?(t=e[r-1],i+=n[t>>2],i+=n[t<<4&63],i+="=="):2===o&&(t=(e[r-2]<<8)+e[r-1],i+=n[t>>10],i+=n[t>>4&63],i+=n[t<<2&63],i+="="),c.push(i),c.join("")}function d(e,t,r,n,o){var i,s,a=8*o-n-1,c=(1<<a)-1,u=c>>1,l=-7,d=r?o-1:0,p=r?-1:1,f=e[t+d];for(d+=p,i=f&(1<<-l)-1,f>>=-l,l+=a;l>0;i=256*i+e[t+d],d+=p,l-=8);for(s=i&(1<<-l)-1,i>>=-l,l+=n;l>0;s=256*s+e[t+d],d+=p,l-=8);if(0===i)i=1-u;else{if(i===c)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,n),i-=u}return(f?-1:1)*s*Math.pow(2,i-n)}function p(e,t,r,n,o,i){var s,a,c,u=8*i-o-1,l=(1<<u)-1,d=l>>1,p=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:i-1,_=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=l):(s=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-s))<1&&(s--,c*=2),(t+=s+d>=1?p/c:p*Math.pow(2,1-d))*c>=2&&(s++,c/=2),s+d>=l?(a=0,s=l):s+d>=1?(a=(t*c-1)*Math.pow(2,o),s+=d):(a=t*Math.pow(2,d-1)*Math.pow(2,o),s=0));o>=8;e[r+f]=255&a,f+=_,a/=256,o-=8);for(s=s<<o|a,u+=o;u>0;e[r+f]=255&s,f+=_,s/=256,u-=8);e[r+f-_]|=128*m}var f={}.toString,_=Array.isArray||function(e){return"[object Array]"==f.call(e)};v.TYPED_ARRAY_SUPPORT=void 0===e.TYPED_ARRAY_SUPPORT||e.TYPED_ARRAY_SUPPORT;var m=h();function h(){return v.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function g(e,t){if(h()<t)throw new RangeError("Invalid typed array length");return v.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=v.prototype:(null===e&&(e=new v(t)),e.length=t),e}function v(e,t,r){if(!(v.TYPED_ARRAY_SUPPORT||this instanceof v))return new v(e,t,r);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return b(this,e)}return y(this,e,t,r)}function y(e,t,r,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,r,n){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");t=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n);v.TYPED_ARRAY_SUPPORT?(e=t).__proto__=v.prototype:e=S(e,t);return e}(e,t,r,n):"string"==typeof t?function(e,t,r){"string"==typeof r&&""!==r||(r="utf8");if(!v.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|w(t,r),o=(e=g(e,n)).write(t,r);o!==n&&(e=e.slice(0,o));return e}(e,t,r):function(e,t){if(A(t)){var r=0|T(t.length);return 0===(e=g(e,r)).length?e:(t.copy(e,0,0,r),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||function(e){return e!=e}(t.length)?g(e,0):S(e,t);if("Buffer"===t.type&&_(t.data))return S(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function E(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function b(e,t){if(E(t),e=g(e,t<0?0:0|T(t)),!v.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function S(e,t){var r=t.length<0?0:0|T(t.length);e=g(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function T(e){if(e>=h())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+h().toString(16)+" bytes");return 0|e}function A(e){return!(null==e||!e._isBuffer)}function w(e,t){if(A(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return z(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return Q(e).length;default:if(n)return z(e).length;t=(""+t).toLowerCase(),n=!0}}function C(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function I(e,t,r,n,o){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=o?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(o)return-1;r=e.length-1}else if(r<0){if(!o)return-1;r=0}if("string"==typeof t&&(t=v.from(t,n)),A(t))return 0===t.length?-1:O(e,t,r,n,o);if("number"==typeof t)return t&=255,v.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):O(e,[t],r,n,o);throw new TypeError("val must be string, number or Buffer")}function O(e,t,r,n,o){var i,s=1,a=e.length,c=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;s=2,a/=2,c/=2,r/=2}function u(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(o){var l=-1;for(i=r;i<a;i++)if(u(e,i)===u(t,-1===l?0:i-l)){if(-1===l&&(l=i),i-l+1===c)return l*s}else-1!==l&&(i-=i-l),l=-1}else for(r+c>a&&(r=a-c),i=r;i>=0;i--){for(var d=!0,p=0;p<c;p++)if(u(e,i+p)!==u(t,p)){d=!1;break}if(d)return i}return-1}function R(e,t,r,n){r=Number(r)||0;var o=e.length-r;n?(n=Number(n))>o&&(n=o):n=o;var i=t.length;if(i%2!=0)throw new TypeError("Invalid hex string");n>i/2&&(n=i/2);for(var s=0;s<n;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[r+s]=a}return s}function N(e,t,r,n){return Z(z(t,e.length-r),e,r,n)}function D(e,t,r,n){return Z(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function j(e,t,r,n){return D(e,t,r,n)}function L(e,t,r,n){return Z(Q(t),e,r,n)}function M(e,t,r,n){return Z(function(e,t){for(var r,n,o,i=[],s=0;s<e.length&&!((t-=2)<0);++s)r=e.charCodeAt(s),n=r>>8,o=r%256,i.push(o),i.push(n);return i}(t,e.length-r),e,r,n)}function P(e,t,r){return 0===t&&r===e.length?l(e):l(e.slice(t,r))}function x(e,t,r){r=Math.min(e.length,r);for(var n=[],o=t;o<r;){var i,s,a,c,u=e[o],l=null,d=u>239?4:u>223?3:u>191?2:1;if(o+d<=r)switch(d){case 1:u<128&&(l=u);break;case 2:128==(192&(i=e[o+1]))&&(c=(31&u)<<6|63&i)>127&&(l=c);break;case 3:i=e[o+1],s=e[o+2],128==(192&i)&&128==(192&s)&&(c=(15&u)<<12|(63&i)<<6|63&s)>2047&&(c<55296||c>57343)&&(l=c);break;case 4:i=e[o+1],s=e[o+2],a=e[o+3],128==(192&i)&&128==(192&s)&&128==(192&a)&&(c=(15&u)<<18|(63&i)<<12|(63&s)<<6|63&a)>65535&&c<1114112&&(l=c)}null===l?(l=65533,d=1):l>65535&&(l-=65536,n.push(l>>>10&1023|55296),l=56320|1023&l),n.push(l),o+=d}return function(e){var t=e.length;if(t<=k)return String.fromCharCode.apply(String,e);var r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=k));return r}(n)}v.poolSize=8192,v._augment=function(e){return e.__proto__=v.prototype,e},v.from=function(e,t,r){return y(null,e,t,r)},v.TYPED_ARRAY_SUPPORT&&(v.prototype.__proto__=Uint8Array.prototype,v.__proto__=Uint8Array),v.alloc=function(e,t,r){return function(e,t,r,n){return E(t),t<=0?g(e,t):void 0!==r?"string"==typeof n?g(e,t).fill(r,n):g(e,t).fill(r):g(e,t)}(null,e,t,r)},v.allocUnsafe=function(e){return b(null,e)},v.allocUnsafeSlow=function(e){return b(null,e)},v.isBuffer=ee,v.compare=function(e,t){if(!A(e)||!A(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,n=t.length,o=0,i=Math.min(r,n);o<i;++o)if(e[o]!==t[o]){r=e[o],n=t[o];break}return r<n?-1:n<r?1:0},v.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},v.concat=function(e,t){if(!_(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return v.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=v.allocUnsafe(t),o=0;for(r=0;r<e.length;++r){var i=e[r];if(!A(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(n,o),o+=i.length}return n},v.byteLength=w,v.prototype._isBuffer=!0,v.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)C(this,t,t+1);return this},v.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)C(this,t,t+3),C(this,t+1,t+2);return this},v.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)C(this,t,t+7),C(this,t+1,t+6),C(this,t+2,t+5),C(this,t+3,t+4);return this},v.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?x(this,0,e):function(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return G(this,t,r);case"utf8":case"utf-8":return x(this,t,r);case"ascii":return B(this,t,r);case"latin1":case"binary":return U(this,t,r);case"base64":return P(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return q(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}.apply(this,arguments)},v.prototype.equals=function(e){if(!A(e))throw new TypeError("Argument must be a Buffer");return this===e||0===v.compare(this,e)},v.prototype.inspect=function(){var e="";return this.length>0&&(e=this.toString("hex",0,50).match(/.{2}/g).join(" "),this.length>50&&(e+=" ... ")),"<Buffer "+e+">"},v.prototype.compare=function(e,t,r,n,o){if(!A(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===o&&(o=this.length),t<0||r>e.length||n<0||o>this.length)throw new RangeError("out of range index");if(n>=o&&t>=r)return 0;if(n>=o)return-1;if(t>=r)return 1;if(t>>>=0,r>>>=0,n>>>=0,o>>>=0,this===e)return 0;for(var i=o-n,s=r-t,a=Math.min(i,s),c=this.slice(n,o),u=e.slice(t,r),l=0;l<a;++l)if(c[l]!==u[l]){i=c[l],s=u[l];break}return i<s?-1:s<i?1:0},v.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},v.prototype.indexOf=function(e,t,r){return I(this,e,t,r,!0)},v.prototype.lastIndexOf=function(e,t,r){return I(this,e,t,r,!1)},v.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var o=this.length-t;if((void 0===r||r>o)&&(r=o),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var i=!1;;)switch(n){case"hex":return R(this,e,t,r);case"utf8":case"utf-8":return N(this,e,t,r);case"ascii":return D(this,e,t,r);case"latin1":case"binary":return j(this,e,t,r);case"base64":return L(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M(this,e,t,r);default:if(i)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),i=!0}},v.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var k=4096;function B(e,t,r){var n="";r=Math.min(e.length,r);for(var o=t;o<r;++o)n+=String.fromCharCode(127&e[o]);return n}function U(e,t,r){var n="";r=Math.min(e.length,r);for(var o=t;o<r;++o)n+=String.fromCharCode(e[o]);return n}function G(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var o="",i=t;i<r;++i)o+=X(e[i]);return o}function q(e,t,r){for(var n=e.slice(t,r),o="",i=0;i<n.length;i+=2)o+=String.fromCharCode(n[i]+256*n[i+1]);return o}function F(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function W(e,t,r,n,o,i){if(!A(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<i)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function K(e,t,r,n){t<0&&(t=65535+t+1);for(var o=0,i=Math.min(e.length-r,2);o<i;++o)e[r+o]=(t&255<<8*(n?o:1-o))>>>8*(n?o:1-o)}function H(e,t,r,n){t<0&&(t=4294967295+t+1);for(var o=0,i=Math.min(e.length-r,4);o<i;++o)e[r+o]=t>>>8*(n?o:3-o)&255}function Y(e,t,r,n,o,i){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function V(e,t,r,n,o){return o||Y(e,0,r,4),p(e,t,r,n,23,4),r+4}function J(e,t,r,n,o){return o||Y(e,0,r,8),p(e,t,r,n,52,8),r+8}v.prototype.slice=function(e,t){var r,n=this.length;if(e=~~e,t=void 0===t?n:~~t,e<0?(e+=n)<0&&(e=0):e>n&&(e=n),t<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e),v.TYPED_ARRAY_SUPPORT)(r=this.subarray(e,t)).__proto__=v.prototype;else{var o=t-e;r=new v(o,void 0);for(var i=0;i<o;++i)r[i]=this[i+e]}return r},v.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||F(e,t,this.length);for(var n=this[e],o=1,i=0;++i<t&&(o*=256);)n+=this[e+i]*o;return n},v.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||F(e,t,this.length);for(var n=this[e+--t],o=1;t>0&&(o*=256);)n+=this[e+--t]*o;return n},v.prototype.readUInt8=function(e,t){return t||F(e,1,this.length),this[e]},v.prototype.readUInt16LE=function(e,t){return t||F(e,2,this.length),this[e]|this[e+1]<<8},v.prototype.readUInt16BE=function(e,t){return t||F(e,2,this.length),this[e]<<8|this[e+1]},v.prototype.readUInt32LE=function(e,t){return t||F(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},v.prototype.readUInt32BE=function(e,t){return t||F(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},v.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||F(e,t,this.length);for(var n=this[e],o=1,i=0;++i<t&&(o*=256);)n+=this[e+i]*o;return n>=(o*=128)&&(n-=Math.pow(2,8*t)),n},v.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||F(e,t,this.length);for(var n=t,o=1,i=this[e+--n];n>0&&(o*=256);)i+=this[e+--n]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*t)),i},v.prototype.readInt8=function(e,t){return t||F(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},v.prototype.readInt16LE=function(e,t){t||F(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},v.prototype.readInt16BE=function(e,t){t||F(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},v.prototype.readInt32LE=function(e,t){return t||F(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},v.prototype.readInt32BE=function(e,t){return t||F(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},v.prototype.readFloatLE=function(e,t){return t||F(e,4,this.length),d(this,e,!0,23,4)},v.prototype.readFloatBE=function(e,t){return t||F(e,4,this.length),d(this,e,!1,23,4)},v.prototype.readDoubleLE=function(e,t){return t||F(e,8,this.length),d(this,e,!0,52,8)},v.prototype.readDoubleBE=function(e,t){return t||F(e,8,this.length),d(this,e,!1,52,8)},v.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||W(this,e,t,r,Math.pow(2,8*r)-1,0);var o=1,i=0;for(this[t]=255&e;++i<r&&(o*=256);)this[t+i]=e/o&255;return t+r},v.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||W(this,e,t,r,Math.pow(2,8*r)-1,0);var o=r-1,i=1;for(this[t+o]=255&e;--o>=0&&(i*=256);)this[t+o]=e/i&255;return t+r},v.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||W(this,e,t,1,255,0),v.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},v.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||W(this,e,t,2,65535,0),v.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):K(this,e,t,!0),t+2},v.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||W(this,e,t,2,65535,0),v.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):K(this,e,t,!1),t+2},v.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||W(this,e,t,4,4294967295,0),v.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):H(this,e,t,!0),t+4},v.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||W(this,e,t,4,4294967295,0),v.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):H(this,e,t,!1),t+4},v.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t|=0,!n){var o=Math.pow(2,8*r-1);W(this,e,t,r,o-1,-o)}var i=0,s=1,a=0;for(this[t]=255&e;++i<r&&(s*=256);)e<0&&0===a&&0!==this[t+i-1]&&(a=1),this[t+i]=(e/s>>0)-a&255;return t+r},v.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t|=0,!n){var o=Math.pow(2,8*r-1);W(this,e,t,r,o-1,-o)}var i=r-1,s=1,a=0;for(this[t+i]=255&e;--i>=0&&(s*=256);)e<0&&0===a&&0!==this[t+i+1]&&(a=1),this[t+i]=(e/s>>0)-a&255;return t+r},v.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||W(this,e,t,1,127,-128),v.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},v.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||W(this,e,t,2,32767,-32768),v.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):K(this,e,t,!0),t+2},v.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||W(this,e,t,2,32767,-32768),v.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):K(this,e,t,!1),t+2},v.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||W(this,e,t,4,2147483647,-2147483648),v.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):H(this,e,t,!0),t+4},v.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||W(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),v.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):H(this,e,t,!1),t+4},v.prototype.writeFloatLE=function(e,t,r){return V(this,e,t,!0,r)},v.prototype.writeFloatBE=function(e,t,r){return V(this,e,t,!1,r)},v.prototype.writeDoubleLE=function(e,t,r){return J(this,e,t,!0,r)},v.prototype.writeDoubleBE=function(e,t,r){return J(this,e,t,!1,r)},v.prototype.copy=function(e,t,r,n){if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var o,i=n-r;if(this===e&&r<t&&t<n)for(o=i-1;o>=0;--o)e[o+t]=this[o+r];else if(i<1e3||!v.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)e[o+t]=this[o+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+i),t);return i},v.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!v.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var i;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(i=t;i<r;++i)this[i]=e;else{var s=A(e)?e:z(new v(e,n).toString()),a=s.length;for(i=0;i<r-t;++i)this[i+t]=s[i%a]}return this};var $=/[^+\/0-9A-Za-z-_]/g;function X(e){return e<16?"0"+e.toString(16):e.toString(16)}function z(e,t){var r;t=t||1/0;for(var n=e.length,o=null,i=[],s=0;s<n;++s){if((r=e.charCodeAt(s))>55295&&r<57344){if(!o){if(r>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(s+1===n){(t-=3)>-1&&i.push(239,191,189);continue}o=r;continue}if(r<56320){(t-=3)>-1&&i.push(239,191,189),o=r;continue}r=65536+(o-55296<<10|r-56320)}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,r<128){if((t-=1)<0)break;i.push(r)}else if(r<2048){if((t-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function Q(e){return function(e){var t,r,n,c,u,l;s||a();var d=e.length;if(d%4>0)throw new Error("Invalid string. Length must be a multiple of 4");u="="===e[d-2]?2:"="===e[d-1]?1:0,l=new i(3*d/4-u),n=u>0?d-4:d;var p=0;for(t=0,r=0;t<n;t+=4,r+=3)c=o[e.charCodeAt(t)]<<18|o[e.charCodeAt(t+1)]<<12|o[e.charCodeAt(t+2)]<<6|o[e.charCodeAt(t+3)],l[p++]=c>>16&255,l[p++]=c>>8&255,l[p++]=255&c;return 2===u?(c=o[e.charCodeAt(t)]<<2|o[e.charCodeAt(t+1)]>>4,l[p++]=255&c):1===u&&(c=o[e.charCodeAt(t)]<<10|o[e.charCodeAt(t+1)]<<4|o[e.charCodeAt(t+2)]>>2,l[p++]=c>>8&255,l[p++]=255&c),l}(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace($,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function Z(e,t,r,n){for(var o=0;o<n&&!(o+r>=t.length||o>=e.length);++o)t[o+r]=e[o];return o}function ee(e){return null!=e&&(!!e._isBuffer||te(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&te(e.slice(0,0))}(e))}function te(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}var re=Object.freeze({INSPECT_MAX_BYTES:50,kMaxLength:m,Buffer:v,SlowBuffer:function(e){return+e!=e&&(e=0),v.alloc(+e)},isBuffer:ee});Map;var ne=function(){function e(e,t,r){this.low=0|e,this.high=0|t,this.unsigned=!!r}function t(e){return!0===(e&&e.__isLong__)}e.prototype.__isLong__,Object.defineProperty(e.prototype,"__isLong__",{value:!0}),e.isLong=t;var r={},n={};function o(e,t){var o,i,a;return t?(a=0<=(e>>>=0)&&e<256)&&(i=n[e])?i:(o=s(e,(0|e)<0?-1:0,!0),a&&(n[e]=o),o):(a=-128<=(e|=0)&&e<128)&&(i=r[e])?i:(o=s(e,e<0?-1:0,!1),a&&(r[e]=o),o)}function i(e,t){if(isNaN(e))return t?m:_;if(t){if(e<0)return m;if(e>=d)return E}else{if(e<=-p)return b;if(e+1>=p)return y}return e<0?i(-e,t).neg():s(e%l|0,e/l|0,t)}function s(t,r,n){return new e(t,r,n)}e.fromInt=o,e.fromNumber=i,e.fromBits=s;var a=Math.pow;function c(e,t,r){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return _;if("number"==typeof t?(r=t,t=!1):t=!!t,(r=r||10)<2||36<r)throw RangeError("radix");var n;if((n=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===n)return c(e.substring(1),t,r).neg();for(var o=i(a(r,8)),s=_,u=0;u<e.length;u+=8){var l=Math.min(8,e.length-u),d=parseInt(e.substring(u,u+l),r);if(l<8){var p=i(a(r,l));s=s.mul(p).add(i(d))}else s=(s=s.mul(o)).add(i(d))}return s.unsigned=t,s}function u(e,t){return"number"==typeof e?i(e,t):"string"==typeof e?c(e,t):s(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}e.fromString=c,e.fromValue=u;var l=4294967296,d=l*l,p=d/2,f=o(1<<24),_=o(0);e.ZERO=_;var m=o(0,!0);e.UZERO=m;var h=o(1);e.ONE=h;var g=o(1,!0);e.UONE=g;var v=o(-1);e.NEG_ONE=v;var y=s(-1,2147483647,!1);e.MAX_VALUE=y;var E=s(-1,-1,!0);e.MAX_UNSIGNED_VALUE=E;var b=s(0,-2147483648,!1);e.MIN_VALUE=b;var S=e.prototype;return S.toInt=function(){return this.unsigned?this.low>>>0:this.low},S.toNumber=function(){return this.unsigned?(this.high>>>0)*l+(this.low>>>0):this.high*l+(this.low>>>0)},S.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(b)){var t=i(e),r=this.div(t),n=r.mul(t).sub(this);return r.toString(e)+n.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var o=i(a(e,6),this.unsigned),s=this,c="";;){var u=s.div(o),l=(s.sub(u.mul(o)).toInt()>>>0).toString(e);if((s=u).isZero())return l+c;for(;l.length<6;)l="0"+l;c=""+l+c}},S.getHighBits=function(){return this.high},S.getHighBitsUnsigned=function(){return this.high>>>0},S.getLowBits=function(){return this.low},S.getLowBitsUnsigned=function(){return this.low>>>0},S.getNumBitsAbs=function(){if(this.isNegative())return this.eq(b)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},S.isZero=function(){return 0===this.high&&0===this.low},S.eqz=S.isZero,S.isNegative=function(){return!this.unsigned&&this.high<0},S.isPositive=function(){return this.unsigned||this.high>=0},S.isOdd=function(){return 1==(1&this.low)},S.isEven=function(){return 0==(1&this.low)},S.equals=function(e){return t(e)||(e=u(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&(this.high===e.high&&this.low===e.low)},S.eq=S.equals,S.notEquals=function(e){return!this.eq(e)},S.neq=S.notEquals,S.ne=S.notEquals,S.lessThan=function(e){return this.comp(e)<0},S.lt=S.lessThan,S.lessThanOrEqual=function(e){return this.comp(e)<=0},S.lte=S.lessThanOrEqual,S.le=S.lessThanOrEqual,S.greaterThan=function(e){return this.comp(e)>0},S.gt=S.greaterThan,S.greaterThanOrEqual=function(e){return this.comp(e)>=0},S.gte=S.greaterThanOrEqual,S.ge=S.greaterThanOrEqual,S.compare=function(e){if(t(e)||(e=u(e)),this.eq(e))return 0;var r=this.isNegative(),n=e.isNegative();return r&&!n?-1:!r&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},S.comp=S.compare,S.negate=function(){return!this.unsigned&&this.eq(b)?b:this.not().add(h)},S.neg=S.negate,S.add=function(e){t(e)||(e=u(e));var r=this.high>>>16,n=65535&this.high,o=this.low>>>16,i=65535&this.low,a=e.high>>>16,c=65535&e.high,l=e.low>>>16,d=0,p=0,f=0,_=0;return f+=(_+=i+(65535&e.low))>>>16,p+=(f+=o+l)>>>16,d+=(p+=n+c)>>>16,d+=r+a,s((f&=65535)<<16|(_&=65535),(d&=65535)<<16|(p&=65535),this.unsigned)},S.subtract=function(e){return t(e)||(e=u(e)),this.add(e.neg())},S.sub=S.subtract,S.multiply=function(e){if(this.isZero())return _;if(t(e)||(e=u(e)),e.isZero())return _;if(this.eq(b))return e.isOdd()?b:_;if(e.eq(b))return this.isOdd()?b:_;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(f)&&e.lt(f))return i(this.toNumber()*e.toNumber(),this.unsigned);var r=this.high>>>16,n=65535&this.high,o=this.low>>>16,a=65535&this.low,c=e.high>>>16,l=65535&e.high,d=e.low>>>16,p=65535&e.low,m=0,h=0,g=0,v=0;return g+=(v+=a*p)>>>16,h+=(g+=o*p)>>>16,g&=65535,h+=(g+=a*d)>>>16,m+=(h+=n*p)>>>16,h&=65535,m+=(h+=o*d)>>>16,h&=65535,m+=(h+=a*l)>>>16,m+=r*p+n*d+o*l+a*c,s((g&=65535)<<16|(v&=65535),(m&=65535)<<16|(h&=65535),this.unsigned)},S.mul=S.multiply,S.divide=function(e){if(t(e)||(e=u(e)),e.isZero())throw Error("division by zero");var r,n,o;if(this.isZero())return this.unsigned?m:_;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return m;if(e.gt(this.shru(1)))return g;o=m}else{if(this.eq(b))return e.eq(h)||e.eq(v)?b:e.eq(b)?h:(r=this.shr(1).div(e).shl(1)).eq(_)?e.isNegative()?h:v:(n=this.sub(e.mul(r)),o=r.add(n.div(e)));else if(e.eq(b))return this.unsigned?m:_;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();o=_}for(n=this;n.gte(e);){r=Math.max(1,Math.floor(n.toNumber()/e.toNumber()));for(var s=Math.ceil(Math.log(r)/Math.LN2),c=s<=48?1:a(2,s-48),l=i(r),d=l.mul(e);d.isNegative()||d.gt(n);)d=(l=i(r-=c,this.unsigned)).mul(e);l.isZero()&&(l=h),o=o.add(l),n=n.sub(d)}return o},S.div=S.divide,S.modulo=function(e){return t(e)||(e=u(e)),this.sub(this.div(e).mul(e))},S.mod=S.modulo,S.rem=S.modulo,S.not=function(){return s(~this.low,~this.high,this.unsigned)},S.and=function(e){return t(e)||(e=u(e)),s(this.low&e.low,this.high&e.high,this.unsigned)},S.or=function(e){return t(e)||(e=u(e)),s(this.low|e.low,this.high|e.high,this.unsigned)},S.xor=function(e){return t(e)||(e=u(e)),s(this.low^e.low,this.high^e.high,this.unsigned)},S.shiftLeft=function(e){return t(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?s(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):s(0,this.low<<e-32,this.unsigned)},S.shl=S.shiftLeft,S.shiftRight=function(e){return t(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?s(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):s(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},S.shr=S.shiftRight,S.shiftRightUnsigned=function(e){if(t(e)&&(e=e.toInt()),0===(e&=63))return this;var r=this.high;return e<32?s(this.low>>>e|r<<32-e,r>>>e,this.unsigned):s(32===e?r:r>>>e-32,0,this.unsigned)},S.shru=S.shiftRightUnsigned,S.shr_u=S.shiftRightUnsigned,S.toSigned=function(){return this.unsigned?s(this.low,this.high,!1):this},S.toUnsigned=function(){return this.unsigned?this:s(this.low,this.high,!0)},S.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},S.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},S.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},e.fromBytes=function(t,r,n){return n?e.fromBytesLE(t,r):e.fromBytesBE(t,r)},e.fromBytesLE=function(t,r){return new e(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,r)},e.fromBytesBE=function(t,r){return new e(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],r)},e.prototype.toExtendedJSON=function(e){return e&&e.relaxed?this.toNumber():{$numberLong:this.toString()}},e.fromExtendedJSON=function(t,r){var n=e.fromString(t.$numberLong);return r&&r.relaxed?n.toNumber():n},Object.defineProperty(e.prototype,"_bsontype",{value:"Long"}),e}();function oe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ie(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function se(e,t,r){return t&&ie(e.prototype,t),r&&ie(e,r),e}var ae=function(){function e(t){oe(this,e),t instanceof Number&&(t=t.valueOf()),this.value=t}return se(e,[{key:"valueOf",value:function(){return this.value}},{key:"toJSON",value:function(){return this.value}},{key:"toExtendedJSON",value:function(e){return e&&(e.legacy||e.relaxed&&isFinite(this.value))?this.value:{$numberDouble:this.value.toString()}}}],[{key:"fromExtendedJSON",value:function(t,r){return r&&r.relaxed?parseFloat(t.$numberDouble):new e(parseFloat(t.$numberDouble))}}]),Object.defineProperty(e.prototype,"_bsontype",{value:"Double"}),e}();function ce(e){return(ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ue(e,t){return!t||"object"!==ce(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function le(e){return(le=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function de(e,t){return(de=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var pe=function(e){function t(e,r){return oe(this,t),ue(ne.isLong(e)?ue(this,le(t).call(this,e.low,e.high,!0)):ue(this,le(t).call(this,e,r,!0)))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&de(e,t)}(t,ne),se(t,[{key:"toJSON",value:function(){return{$timestamp:this.toString()}}},{key:"toExtendedJSON",value:function(){return{$timestamp:{t:this.high>>>0,i:this.low>>>0}}}}],[{key:"fromInt",value:function(e){return new t(ne.fromInt(e,!0))}},{key:"fromNumber",value:function(e){return new t(ne.fromNumber(e,!0))}},{key:"fromBits",value:function(e,r){return new t(e,r)}},{key:"fromString",value:function(e,r){return new t(ne.fromString(e,r,!0))}},{key:"fromExtendedJSON",value:function(e){return new t(e.$timestamp.i,e.$timestamp.t)}}]),Object.defineProperty(t.prototype,"_bsontype",{value:"Timestamp"}),t.MAX_VALUE=t.MAX_UNSIGNED_VALUE,t}(),fe={};function _e(e){for(var t=new Uint8Array(e),r=0;r<e;++r)t[r]=Math.floor(256*Math.random());return t}var me={normalizedFunctionString:function(e){return e.toString().replace("function(","function (")},randomBytes:function(){var e=_e;if("undefined"!=typeof window&&window.crypto&&window.crypto.getRandomValues)e=function(e){return window.crypto.getRandomValues(new Uint8Array(e))};else{try{e=fe.randomBytes}catch(e){}null==e&&(e=_e)}return e}()};new Date;var he=function(){function e(e,t){var r={seen:[],stylize:ve};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),Te(t)?r.showHidden=t:t&&Me(r,t),Ie(r.showHidden)&&(r.showHidden=!1),Ie(r.depth)&&(r.depth=2),Ie(r.colors)&&(r.colors=!1),Ie(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=ge),ye(r,e,r.depth)}return e.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},e.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e}();function ge(e,t){var r=he.styles[t];return r?"["+he.colors[r][0]+"m"+e+"["+he.colors[r][1]+"m":e}function ve(e,t){return e}function ye(e,t,r){if(e.customInspect&&t&&je(t.inspect)&&t.inspect!==he&&(!t.constructor||t.constructor.prototype!==t)){var n=t.inspect(r,e);return Ce(n)||(n=ye(e,n,r)),n}var o=function(e,t){if(Ie(t))return e.stylize("undefined","undefined");if(Ce(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}if(we(t))return e.stylize(""+t,"number");if(Te(t))return e.stylize(""+t,"boolean");if(Ae(t))return e.stylize("null","null")}(e,t);if(o)return o;var i=Object.keys(t),s=function(e){var t={};return e.forEach(function(e,r){t[e]=!0}),t}(i);if(e.showHidden&&(i=Object.getOwnPropertyNames(t)),De(t)&&(i.indexOf("message")>=0||i.indexOf("description")>=0))return Ee(t);if(0===i.length){if(je(t)){var a=t.name?": "+t.name:"";return e.stylize("[Function"+a+"]","special")}if(Oe(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(Ne(t))return e.stylize(Date.prototype.toString.call(t),"date");if(De(t))return Ee(t)}var c,u="",l=!1,d=["{","}"];(Se(t)&&(l=!0,d=["[","]"]),je(t))&&(u=" [Function"+(t.name?": "+t.name:"")+"]");return Oe(t)&&(u=" "+RegExp.prototype.toString.call(t)),Ne(t)&&(u=" "+Date.prototype.toUTCString.call(t)),De(t)&&(u=" "+Ee(t)),0!==i.length||l&&0!=t.length?r<0?Oe(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special"):(e.seen.push(t),c=l?function(e,t,r,n,o){for(var i=[],s=0,a=t.length;s<a;++s)Pe(t,String(s))?i.push(be(e,t,r,n,String(s),!0)):i.push("");return o.forEach(function(o){o.match(/^\d+$/)||i.push(be(e,t,r,n,o,!0))}),i}(e,t,r,s,i):i.map(function(n){return be(e,t,r,s,n,l)}),e.seen.pop(),function(e,t,r){if(e.reduce(function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60)return r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1];return r[0]+t+" "+e.join(", ")+" "+r[1]}(c,u,d)):d[0]+u+d[1]}function Ee(e){return"["+Error.prototype.toString.call(e)+"]"}function be(e,t,r,n,o,i){var s,a,c;if((c=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]}).get?a=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(a=e.stylize("[Setter]","special")),Pe(n,o)||(s="["+o+"]"),a||(e.seen.indexOf(c.value)<0?(a=Ae(r)?ye(e,c.value,null):ye(e,c.value,r-1)).indexOf("\n")>-1&&(a=i?a.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+a.split("\n").map(function(e){return"   "+e}).join("\n")):a=e.stylize("[Circular]","special")),Ie(s)){if(i&&o.match(/^\d+$/))return a;(s=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+a}function Se(e){return Array.isArray(e)}function Te(e){return"boolean"==typeof e}function Ae(e){return null===e}function we(e){return"number"==typeof e}function Ce(e){return"string"==typeof e}function Ie(e){return void 0===e}function Oe(e){return Re(e)&&"[object RegExp]"===Le(e)}function Re(e){return"object"===ce(e)&&null!==e}function Ne(e){return Re(e)&&"[object Date]"===Le(e)}function De(e){return Re(e)&&("[object Error]"===Le(e)||e instanceof Error)}function je(e){return"function"==typeof e}function Le(e){return Object.prototype.toString.call(e)}function Me(e,t){if(!t||!Re(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e}function Pe(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var xe=he,ke=function t(r,n){if(Ie(e.process))return function(){return t(r,n).apply(this,arguments)};var o=!1;return function(){return o||(console.error(n),o=!0),r.apply(this,arguments)}},Be=(()=>re.Buffer)(),Ue=ke,Ge=(0,me.randomBytes)(5),qe=new RegExp("^[0-9a-fA-F]{24}$"),Fe=function(){var e=!1;try{Be&&Be.from&&(e=!0)}catch(t){e=!1}return e}(),We=function(){for(var e=[],t=0;t<256;t++)e[t]=(t<=15?"0":"")+t.toString(16);return e}(),Ke=function(){for(var e=[],t=0;t<10;)e[48+t]=t++;for(;t<16;)e[55+t]=e[87+t]=t++;return e}(),He=Be;function Ye(e,t){var r=e[t];return new TypeError('ObjectId string "'.concat(e,'" contains invalid character "').concat(r,'" with character code (').concat(e.charCodeAt(t),"). All character codes for a non-hex string must be less than 256."))}var Ve=function(){function e(t){if(oe(this,e),t instanceof e)return t;if(null==t||"number"==typeof t)return this.id=e.generate(t),void(e.cacheHexString&&(this.__id=this.toString("hex")));var r=e.isValid(t);if(!r&&null!=t)throw new TypeError("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters");if(r&&"string"==typeof t&&24===t.length&&Fe)return new e(Be.from(t,"hex"));if(r&&"string"==typeof t&&24===t.length)return e.createFromHexString(t);if(null==t||12!==t.length){if(null!=t&&t.toHexString)return e.createFromHexString(t.toHexString());throw new TypeError("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters")}this.id=t,e.cacheHexString&&(this.__id=this.toString("hex"))}return se(e,[{key:"toHexString",value:function(){if(e.cacheHexString&&this.__id)return this.__id;var t="";if(!this.id||!this.id.length)throw new TypeError("invalid ObjectId, ObjectId.id must be either a string or a Buffer, but is ["+JSON.stringify(this.id)+"]");if(this.id instanceof He)return t=function(e){return e.toString("hex")}(this.id),e.cacheHexString&&(this.__id=t),t;for(var r=0;r<this.id.length;r++){var n=We[this.id.charCodeAt(r)];if("string"!=typeof n)throw Ye(this.id,r);t+=n}return e.cacheHexString&&(this.__id=t),t}},{key:"toString",value:function(e){return this.id&&this.id.copy?this.id.toString("string"==typeof e?e:"hex"):this.toHexString()}},{key:"toJSON",value:function(){return this.toHexString()}},{key:"equals",value:function(t){return t instanceof e?this.toString()===t.toString():"string"==typeof t&&e.isValid(t)&&12===t.length&&this.id instanceof He?t===this.id.toString("binary"):"string"==typeof t&&e.isValid(t)&&24===t.length?t.toLowerCase()===this.toHexString():"string"==typeof t&&e.isValid(t)&&12===t.length?t===this.id:!(null==t||!(t instanceof e||t.toHexString))&&t.toHexString()===this.toHexString()}},{key:"getTimestamp",value:function(){var e=new Date,t=this.id.readUInt32BE(0);return e.setTime(1e3*Math.floor(t)),e}},{key:"toExtendedJSON",value:function(){return this.toHexString?{$oid:this.toHexString()}:{$oid:this.toString("hex")}}}],[{key:"getInc",value:function(){return e.index=(e.index+1)%16777215}},{key:"generate",value:function(t){"number"!=typeof t&&(t=~~(Date.now()/1e3));var r=e.getInc(),n=Be.alloc(12);return n[3]=255&t,n[2]=t>>8&255,n[1]=t>>16&255,n[0]=t>>24&255,n[4]=Ge[0],n[5]=Ge[1],n[6]=Ge[2],n[7]=Ge[3],n[8]=Ge[4],n[11]=255&r,n[10]=r>>8&255,n[9]=r>>16&255,n}},{key:"createPk",value:function(){return new e}},{key:"createFromTime",value:function(t){var r=Be.from([0,0,0,0,0,0,0,0,0,0,0,0]);return r[3]=255&t,r[2]=t>>8&255,r[1]=t>>16&255,r[0]=t>>24&255,new e(r)}},{key:"createFromHexString",value:function(t){if(void 0===t||null!=t&&24!==t.length)throw new TypeError("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters");if(Fe)return new e(Be.from(t,"hex"));for(var r=new He(12),n=0,o=0;o<24;)r[n++]=Ke[t.charCodeAt(o++)]<<4|Ke[t.charCodeAt(o++)];return new e(r)}},{key:"isValid",value:function(t){return null!=t&&("number"==typeof t||("string"==typeof t?12===t.length||24===t.length&&qe.test(t):t instanceof e||(t instanceof He&&12===t.length||!!t.toHexString&&(12===t.id.length||24===t.id.length&&qe.test(t.id)))))}},{key:"fromExtendedJSON",value:function(t){return new e(t.$oid)}}]),e.get_inc=Ue(function(){return e.getInc()},"Please use the static `ObjectId.getInc()` instead"),e.prototype.get_inc=Ue(function(){return e.getInc()},"Please use the static `ObjectId.getInc()` instead"),e.prototype.getInc=Ue(function(){return e.getInc()},"Please use the static `ObjectId.getInc()` instead"),e.prototype.generate=Ue(function(t){return e.generate(t)},"Please use the static `ObjectId.generate(time)` instead"),Object.defineProperty(e.prototype,"generationTime",{enumerable:!0,get:function(){return this.id[3]|this.id[2]<<8|this.id[1]<<16|this.id[0]<<24},set:function(e){this.id[3]=255&e,this.id[2]=e>>8&255,this.id[1]=e>>16&255,this.id[0]=e>>24&255}}),e.prototype[xe.custom||"inspect"]=e.prototype.toString,e.index=~~(16777215*Math.random()),Object.defineProperty(e.prototype,"_bsontype",{value:"ObjectID"}),e}();var Je=function(){function e(t,r){oe(this,e),this.pattern=t||"",this.options=r?function(e){return e.split("").sort().join("")}(r):"";for(var n=0;n<this.options.length;n++)if("i"!==this.options[n]&&"m"!==this.options[n]&&"x"!==this.options[n]&&"l"!==this.options[n]&&"s"!==this.options[n]&&"u"!==this.options[n])throw new Error("The regular expression option [".concat(this.options[n],"] is not supported"))}return se(e,[{key:"toExtendedJSON",value:function(e){return(e=e||{}).legacy?{$regex:this.pattern,$options:this.options}:{$regularExpression:{pattern:this.pattern,options:this.options}}}}],[{key:"parseOptions",value:function(e){return e?e.split("").sort().join(""):""}},{key:"fromExtendedJSON",value:function(t){return t.$regex?"BSONRegExp"===t.$regex._bsontype?t:new e(t.$regex,e.parseOptions(t.$options)):new e(t.$regularExpression.pattern,e.parseOptions(t.$regularExpression.options))}}]),Object.defineProperty(e.prototype,"_bsontype",{value:"BSONRegExp"}),e}(),$e=function(){function e(t){oe(this,e),this.value=t}return se(e,[{key:"valueOf",value:function(){return this.value}},{key:"toString",value:function(){return this.value}},{key:"inspect",value:function(){return this.value}},{key:"toJSON",value:function(){return this.value}},{key:"toExtendedJSON",value:function(){return{$symbol:this.value}}}],[{key:"fromExtendedJSON",value:function(t){return new e(t.$symbol)}}]),Object.defineProperty(e.prototype,"_bsontype",{value:"Symbol"}),e}(),Xe=function(){function e(t){oe(this,e),t instanceof Number&&(t=t.valueOf()),this.value=t}return se(e,[{key:"valueOf",value:function(){return this.value}},{key:"toJSON",value:function(){return this.value}},{key:"toExtendedJSON",value:function(e){return e&&(e.relaxed||e.legacy)?this.value:{$numberInt:this.value.toString()}}}],[{key:"fromExtendedJSON",value:function(t,r){return r&&r.relaxed?parseInt(t.$numberInt,10):new e(t.$numberInt)}}]),Object.defineProperty(e.prototype,"_bsontype",{value:"Int32"}),e}(),ze=function(){function e(t,r){oe(this,e),this.code=t,this.scope=r}return se(e,[{key:"toJSON",value:function(){return{scope:this.scope,code:this.code}}},{key:"toExtendedJSON",value:function(){return this.scope?{$code:this.code,$scope:this.scope}:{$code:this.code}}}],[{key:"fromExtendedJSON",value:function(t){return new e(t.$code,t.$scope)}}]),Object.defineProperty(e.prototype,"_bsontype",{value:"Code"}),e}(),Qe=(()=>re.Buffer)(),Ze=/^(\+|-)?(\d+|(\d*\.\d*))?(E|e)?([-+])?(\d+)?$/,et=/^(\+|-)?(Infinity|inf)$/i,tt=/^(\+|-)?NaN$/i,rt=[124,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),nt=[248,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),ot=[120,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),it=/^([-+])?(\d+)?$/;function st(e){return!isNaN(parseInt(e,10))}function at(e){var t=ne.fromNumber(1e9),r=ne.fromNumber(0);if(!(e.parts[0]||e.parts[1]||e.parts[2]||e.parts[3]))return{quotient:e,rem:r};for(var n=0;n<=3;n++)r=(r=r.shiftLeft(32)).add(new ne(e.parts[n],0)),e.parts[n]=r.div(t).low,r=r.modulo(t);return{quotient:e,rem:r}}function ct(e,t){throw new TypeError('"'.concat(e,'" is not a valid Decimal128 string - ').concat(t))}var ut=function(){function e(e){this.bytes=e}e.fromString=function(t){var r,n=!1,o=!1,i=!1,s=0,a=0,c=0,u=0,l=0,d=[0],p=0,f=0,_=0,m=0,h=0,g=0,v=[0,0],y=[0,0],E=0;if(t.length>=7e3)throw new TypeError(t+" not a valid Decimal128 string");var b=t.match(Ze),S=t.match(et),T=t.match(tt);if(!b&&!S&&!T||0===t.length)throw new TypeError(t+" not a valid Decimal128 string");if(b){var A=b[2],w=b[4],C=b[5],I=b[6];w&&void 0===I&&ct(t,"missing exponent power"),w&&void 0===A&&ct(t,"missing exponent base"),void 0===w&&(C||I)&&ct(t,"missing e before exponent")}if("+"!==t[E]&&"-"!==t[E]||(n="-"===t[E++]),!st(t[E])&&"."!==t[E]){if("i"===t[E]||"I"===t[E])return new e(Qe.from(n?nt:ot));if("N"===t[E])return new e(Qe.from(rt))}for(;st(t[E])||"."===t[E];)"."!==t[E]?(p<34&&("0"!==t[E]||i)&&(i||(l=a),i=!0,d[f++]=parseInt(t[E],10),p+=1),i&&(c+=1),o&&(u+=1),a+=1,E+=1):(o&&ct(t,"contains multiple periods"),o=!0,E+=1);if(o&&!a)throw new TypeError(t+" not a valid Decimal128 string");if("e"===t[E]||"E"===t[E]){var O=t.substr(++E).match(it);if(!O||!O[2])return new e(Qe.from(rt));h=parseInt(O[0],10),E+=O[0].length}if(t[E])return new e(Qe.from(rt));if(_=0,p){if(m=p-1,1!==(s=c))for(;"0"===t[l+s-1];)s-=1}else _=0,m=0,d[0]=0,c=1,p=1,s=0;for(h<=u&&u-h>16384?h=-6176:h-=u;h>6111;){if((m+=1)-_>34){if(d.join("").match(/^0+$/)){h=6111;break}ct(t,"overflow")}h-=1}for(;h<-6176||p<c;){if(0===m&&s<p){h=-6176,s=0;break}if(p<c?c-=1:m-=1,h<6111)h+=1;else{if(d.join("").match(/^0+$/)){h=6111;break}ct(t,"overflow")}}if(m-_+1<s){var R=a;o&&(l+=1,R+=1),n&&(l+=1,R+=1);var N=parseInt(t[l+m+1],10),D=0;if(N>=5&&(D=1,5===N))for(D=d[m]%2==1,g=l+m+2;g<R;g++)if(parseInt(t[g],10)){D=1;break}if(D)for(var j=m;j>=0;j--)if(++d[j]>9&&(d[j]=0,0===j)){if(!(h<6111))return new e(Qe.from(n?nt:ot));h+=1,d[j]=1}}if(v=ne.fromNumber(0),y=ne.fromNumber(0),0===s)v=ne.fromNumber(0),y=ne.fromNumber(0);else if(m-_<17){var L=_;for(y=ne.fromNumber(d[L++]),v=new ne(0,0);L<=m;L++)y=(y=y.multiply(ne.fromNumber(10))).add(ne.fromNumber(d[L]))}else{var M=_;for(v=ne.fromNumber(d[M++]);M<=m-17;M++)v=(v=v.multiply(ne.fromNumber(10))).add(ne.fromNumber(d[M]));for(y=ne.fromNumber(d[M++]);M<=m;M++)y=(y=y.multiply(ne.fromNumber(10))).add(ne.fromNumber(d[M]))}var P=function(e,t){if(!e&&!t)return{high:ne.fromNumber(0),low:ne.fromNumber(0)};var r=e.shiftRightUnsigned(32),n=new ne(e.getLowBits(),0),o=t.shiftRightUnsigned(32),i=new ne(t.getLowBits(),0),s=r.multiply(o),a=r.multiply(i),c=n.multiply(o),u=n.multiply(i);return s=s.add(a.shiftRightUnsigned(32)),a=new ne(a.getLowBits(),0).add(c).add(u.shiftRightUnsigned(32)),{high:s=s.add(a.shiftRightUnsigned(32)),low:u=a.shiftLeft(32).add(new ne(u.getLowBits(),0))}}(v,ne.fromString("100000000000000000"));P.low=P.low.add(y),function(e,t){var r=e.high>>>0,n=t.high>>>0;return r<n||r===n&&e.low>>>0<t.low>>>0}(P.low,y)&&(P.high=P.high.add(ne.fromNumber(1))),r=h+6176;var x={low:ne.fromNumber(0),high:ne.fromNumber(0)};P.high.shiftRightUnsigned(49).and(ne.fromNumber(1)).equals(ne.fromNumber(1))?(x.high=x.high.or(ne.fromNumber(3).shiftLeft(61)),x.high=x.high.or(ne.fromNumber(r).and(ne.fromNumber(16383).shiftLeft(47))),x.high=x.high.or(P.high.and(ne.fromNumber(0x7fffffffffff)))):(x.high=x.high.or(ne.fromNumber(16383&r).shiftLeft(49)),x.high=x.high.or(P.high.and(ne.fromNumber(562949953421311)))),x.low=P.low,n&&(x.high=x.high.or(ne.fromString("9223372036854775808")));var k=Qe.alloc(16);return E=0,k[E++]=255&x.low.low,k[E++]=x.low.low>>8&255,k[E++]=x.low.low>>16&255,k[E++]=x.low.low>>24&255,k[E++]=255&x.low.high,k[E++]=x.low.high>>8&255,k[E++]=x.low.high>>16&255,k[E++]=x.low.high>>24&255,k[E++]=255&x.high.low,k[E++]=x.high.low>>8&255,k[E++]=x.high.low>>16&255,k[E++]=x.high.low>>24&255,k[E++]=255&x.high.high,k[E++]=x.high.high>>8&255,k[E++]=x.high.high>>16&255,k[E++]=x.high.high>>24&255,new e(k)};return e.prototype.toString=function(){for(var e,t,r,n,o,i,s=0,a=new Array(36),c=0;c<a.length;c++)a[c]=0;var u,l,d,p,f,_=0,m=!1,h={parts:new Array(4)},g=[];_=0;var v=this.bytes;if(n=v[_++]|v[_++]<<8|v[_++]<<16|v[_++]<<24,r=v[_++]|v[_++]<<8|v[_++]<<16|v[_++]<<24,t=v[_++]|v[_++]<<8|v[_++]<<16|v[_++]<<24,e=v[_++]|v[_++]<<8|v[_++]<<16|v[_++]<<24,_=0,{low:new ne(n,r),high:new ne(t,e)}.high.lessThan(ne.ZERO)&&g.push("-"),(o=e>>26&31)>>3==3){if(30===o)return g.join("")+"Infinity";if(31===o)return"NaN";i=e>>15&16383,d=8+(e>>14&1)}else d=e>>14&7,i=e>>17&16383;if(u=i-6176,h.parts[0]=(16383&e)+((15&d)<<14),h.parts[1]=t,h.parts[2]=r,h.parts[3]=n,0===h.parts[0]&&0===h.parts[1]&&0===h.parts[2]&&0===h.parts[3])m=!0;else for(f=3;f>=0;f--){var y=0,E=at(h);if(h=E.quotient,y=E.rem.low)for(p=8;p>=0;p--)a[9*f+p]=y%10,y=Math.floor(y/10)}if(m)s=1,a[_]=0;else for(s=36;!a[_];)s-=1,_+=1;if((l=s-1+u)>=34||l<=-7||u>0){if(s>34)return g.push(0),u>0?g.push("E+"+u):u<0&&g.push("E"+u),g.join("");g.push(a[_++]),(s-=1)&&g.push(".");for(var b=0;b<s;b++)g.push(a[_++]);g.push("E"),l>0?g.push("+"+l):g.push(l)}else if(u>=0)for(var S=0;S<s;S++)g.push(a[_++]);else{var T=s+u;if(T>0)for(var A=0;A<T;A++)g.push(a[_++]);else g.push("0");for(g.push(".");T++<0;)g.push("0");for(var w=0;w<s-Math.max(T-1,0);w++)g.push(a[_++])}return g.join("")},e.prototype.toJSON=function(){return{$numberDecimal:this.toString()}},e.prototype.toExtendedJSON=function(){return{$numberDecimal:this.toString()}},e.fromExtendedJSON=function(t){return e.fromString(t.$numberDecimal)},Object.defineProperty(e.prototype,"_bsontype",{value:"Decimal128"}),e}(),lt=function(){function e(){oe(this,e)}return se(e,[{key:"toExtendedJSON",value:function(){return{$minKey:1}}}],[{key:"fromExtendedJSON",value:function(){return new e}}]),Object.defineProperty(e.prototype,"_bsontype",{value:"MinKey"}),e}(),dt=function(){function e(){oe(this,e)}return se(e,[{key:"toExtendedJSON",value:function(){return{$maxKey:1}}}],[{key:"fromExtendedJSON",value:function(){return new e}}]),Object.defineProperty(e.prototype,"_bsontype",{value:"MaxKey"}),e}(),pt=function(){function e(t,r,n,o){oe(this,e);var i=t.split(".");2===i.length&&(n=i.shift(),t=i.shift()),this.collection=t,this.oid=r,this.db=n,this.fields=o||{}}return se(e,[{key:"toJSON",value:function(){var e=Object.assign({$ref:this.collection,$id:this.oid},this.fields);return null!=this.db&&(e.$db=this.db),e}},{key:"toExtendedJSON",value:function(e){e=e||{};var t={$ref:this.collection,$id:this.oid};return e.legacy?t:(this.db&&(t.$db=this.db),t=Object.assign(t,this.fields))}}],[{key:"fromExtendedJSON",value:function(t){var r=Object.assign({},t);return["$ref","$id","$db"].forEach(function(e){return delete r[e]}),new e(t.$ref,t.$id,t.$db,r)}}]),Object.defineProperty(e.prototype,"_bsontype",{value:"DBRef"}),Object.defineProperty(e.prototype,"namespace",{get:function(){return this.collection},set:function(e){this.collection=e},configurable:!1}),e}(),ft=(()=>re.Buffer)(),_t=function(){function e(r,n){if(oe(this,e),!(null==r||"string"==typeof r||ft.isBuffer(r)||r instanceof Uint8Array||Array.isArray(r)))throw new TypeError("only String, Buffer, Uint8Array or Array accepted");if(this.sub_type=null==n?t:n,this.position=0,null==r||r instanceof Number)void 0!==ft?this.buffer=ft.alloc(e.BUFFER_SIZE):"undefined"!=typeof Uint8Array?this.buffer=new Uint8Array(new ArrayBuffer(e.BUFFER_SIZE)):this.buffer=new Array(e.BUFFER_SIZE);else{if("string"==typeof r)if(void 0!==ft)this.buffer=ft.from(r);else{if("undefined"==typeof Uint8Array&&!Array.isArray(r))throw new TypeError("only String, Buffer, Uint8Array or Array accepted");this.buffer=function(e){for(var t="undefined"!=typeof Uint8Array?new Uint8Array(new ArrayBuffer(e.length)):new Array(e.length),r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(r)}else this.buffer=r;this.position=r.length}}se(e,[{key:"put",value:function(t){if(null!=t.length&&"number"!=typeof t&&1!==t.length)throw new TypeError("only accepts single character String, Uint8Array or Array");if("number"!=typeof t&&t<0||t>255)throw new TypeError("only accepts number in a valid unsigned byte range 0-255");var n=null;if(n="string"==typeof t?t.charCodeAt(0):null!=t.length?t[0]:t,this.buffer.length>this.position)this.buffer[this.position++]=n;else if(void 0!==ft&&ft.isBuffer(this.buffer)){var o=ft.alloc(e.BUFFER_SIZE+this.buffer.length);this.buffer.copy(o,0,0,this.buffer.length),this.buffer=o,this.buffer[this.position++]=n}else{var i=null;i=r(this.buffer)?new Uint8Array(new ArrayBuffer(e.BUFFER_SIZE+this.buffer.length)):new Array(e.BUFFER_SIZE+this.buffer.length);for(var s=0;s<this.buffer.length;s++)i[s]=this.buffer[s];this.buffer=i,this.buffer[this.position++]=n}}},{key:"write",value:function(e,t){if(t="number"==typeof t?t:this.position,this.buffer.length<t+e.length){var n=null;if(void 0!==ft&&ft.isBuffer(this.buffer))n=ft.alloc(this.buffer.length+e.length),this.buffer.copy(n,0,0,this.buffer.length);else if(r(this.buffer)){n=new Uint8Array(new ArrayBuffer(this.buffer.length+e.length));for(var o=0;o<this.position;o++)n[o]=this.buffer[o]}this.buffer=n}if(void 0!==ft&&ft.isBuffer(e)&&ft.isBuffer(this.buffer))e.copy(this.buffer,t,0,e.length),this.position=t+e.length>this.position?t+e.length:this.position;else if(void 0!==ft&&"string"==typeof e&&ft.isBuffer(this.buffer))this.buffer.write(e,t,"binary"),this.position=t+e.length>this.position?t+e.length:this.position;else if(r(e)||Array.isArray(e)&&"string"!=typeof e){for(var i=0;i<e.length;i++)this.buffer[t++]=e[i];this.position=t>this.position?t:this.position}else if("string"==typeof e){for(var s=0;s<e.length;s++)this.buffer[t++]=e.charCodeAt(s);this.position=t>this.position?t:this.position}}},{key:"read",value:function(e,t){if(t=t&&t>0?t:this.position,this.buffer.slice)return this.buffer.slice(e,e+t);for(var r="undefined"!=typeof Uint8Array?new Uint8Array(new ArrayBuffer(t)):new Array(t),n=0;n<t;n++)r[n]=this.buffer[e++];return r}},{key:"value",value:function(e){if((e=null!=e&&e)&&void 0!==ft&&ft.isBuffer(this.buffer)&&this.buffer.length===this.position)return this.buffer;if(void 0!==ft&&ft.isBuffer(this.buffer))return e?this.buffer.slice(0,this.position):this.buffer.toString("binary",0,this.position);if(e){if(null!=this.buffer.slice)return this.buffer.slice(0,this.position);for(var t=r(this.buffer)?new Uint8Array(new ArrayBuffer(this.position)):new Array(this.position),n=0;n<this.position;n++)t[n]=this.buffer[n];return t}return function(e,t,r){for(var n="",o=t;o<r;o++)n+=String.fromCharCode(e[o]);return n}(this.buffer,0,this.position)}},{key:"length",value:function(){return this.position}},{key:"toJSON",value:function(){return null!=this.buffer?this.buffer.toString("base64"):""}},{key:"toString",value:function(e){return null!=this.buffer?this.buffer.slice(0,this.position).toString(e):""}},{key:"toExtendedJSON",value:function(e){e=e||{};var t=ft.isBuffer(this.buffer)?this.buffer.toString("base64"):ft.from(this.buffer).toString("base64"),r=Number(this.sub_type).toString(16);return e.legacy?{$binary:t,$type:1===r.length?"0"+r:r}:{$binary:{base64:t,subType:1===r.length?"0"+r:r}}}}],[{key:"fromExtendedJSON",value:function(t,r){var n,o;return(r=r||{}).legacy?(o=t.$type?parseInt(t.$type,16):0,n=ft.from(t.$binary,"base64")):(o=t.$binary.subType?parseInt(t.$binary.subType,16):0,n=ft.from(t.$binary.base64,"base64")),new e(n,o)}}]);var t=0;function r(e){return"[object Uint8Array]"===Object.prototype.toString.call(e)}return e.BUFFER_SIZE=256,e.SUBTYPE_DEFAULT=0,e.SUBTYPE_FUNCTION=1,e.SUBTYPE_BYTE_ARRAY=2,e.SUBTYPE_UUID_OLD=3,e.SUBTYPE_UUID=4,e.SUBTYPE_MD5=5,e.SUBTYPE_USER_DEFINED=128,Object.defineProperty(e.prototype,"_bsontype",{value:"Binary"}),e}(),mt={BSON_INT32_MAX:2147483647,BSON_INT32_MIN:-2147483648,BSON_INT64_MAX:Math.pow(2,63)-1,BSON_INT64_MIN:-Math.pow(2,63),JS_INT_MAX:9007199254740992,JS_INT_MIN:-9007199254740992,BSON_DATA_NUMBER:1,BSON_DATA_STRING:2,BSON_DATA_OBJECT:3,BSON_DATA_ARRAY:4,BSON_DATA_BINARY:5,BSON_DATA_UNDEFINED:6,BSON_DATA_OID:7,BSON_DATA_BOOLEAN:8,BSON_DATA_DATE:9,BSON_DATA_NULL:10,BSON_DATA_REGEXP:11,BSON_DATA_DBPOINTER:12,BSON_DATA_CODE:13,BSON_DATA_SYMBOL:14,BSON_DATA_CODE_W_SCOPE:15,BSON_DATA_INT:16,BSON_DATA_TIMESTAMP:17,BSON_DATA_LONG:18,BSON_DATA_DECIMAL128:19,BSON_DATA_MIN_KEY:255,BSON_DATA_MAX_KEY:127,BSON_BINARY_SUBTYPE_DEFAULT:0,BSON_BINARY_SUBTYPE_FUNCTION:1,BSON_BINARY_SUBTYPE_BYTE_ARRAY:2,BSON_BINARY_SUBTYPE_UUID:3,BSON_BINARY_SUBTYPE_MD5:4,BSON_BINARY_SUBTYPE_USER_DEFINED:128},ht={$oid:Ve,$binary:_t,$symbol:$e,$numberInt:Xe,$numberDecimal:ut,$numberDouble:ae,$numberLong:ne,$minKey:lt,$maxKey:dt,$regex:Je,$regularExpression:Je,$timestamp:pe};function gt(e,t){var r=this;return"boolean"==typeof(t=Object.assign({},{relaxed:!0,legacy:!1},t)).relaxed&&(t.strict=!t.relaxed),"boolean"==typeof t.strict&&(t.relaxed=!t.strict),JSON.parse(e,function(e,n){return function e(t,r,n,o){if("number"==typeof n){if(o.relaxed||o.legacy)return n;if(Math.floor(n)===n){if(n>=yt&&n<=vt)return new Xe(n);if(n>=bt&&n<=Et)return new ne.fromNumber(n)}return new ae(n)}if(null==n||"object"!==ce(n))return n;if(n.$undefined)return null;for(var i=Object.keys(n).filter(function(e){return e.startsWith("$")&&null!=n[e]}),s=0;s<i.length;s++){var a=ht[i[s]];if(a)return a.fromExtendedJSON(n,o)}if(null!=n.$date){var c=n.$date,u=new Date;return o.legacy?"number"==typeof c?u.setTime(c):"string"==typeof c&&u.setTime(Date.parse(c)):"string"==typeof c?u.setTime(Date.parse(c)):ne.isLong(c)?u.setTime(c.toNumber()):"number"==typeof c&&o.relaxed&&u.setTime(c),u}if(null!=n.$code){var l=Object.assign({},n);return n.$scope&&(l.$scope=e(t,null,n.$scope)),ze.fromExtendedJSON(n)}if(null!=n.$ref||null!=n.$dbPointer){var d=n.$ref?n:n.$dbPointer;if(d instanceof pt)return d;var p=!0;if(Object.keys(d).filter(function(e){return e.startsWith("$")}).forEach(function(e){-1===["$ref","$id","$db"].indexOf(e)&&(p=!1)}),p)return pt.fromExtendedJSON(d)}return n}(r,0,n,t)})}var vt=2147483647,yt=-2147483648,Et=0x8000000000000000,bt=-0x8000000000000000;function St(e,t,r,n){null!=r&&"object"===ce(r)&&(n=r,r=0),null==t||"object"!==ce(t)||Array.isArray(t)||(n=t,t=null,r=0),n=Object.assign({},{relaxed:!0,legacy:!1},n);var o=Array.isArray(e)?Tt(e,n):It(e,n);return JSON.stringify(o,t,r)}function Tt(e,t){return e.map(function(e){return wt(e,t)})}function At(e){var t=e.toISOString();return 0!==e.getUTCMilliseconds()?t:t.slice(0,-5)+"Z"}function wt(e,t){if(Array.isArray(e))return Tt(e,t);if(void 0===e)return null;if(e instanceof Date){var r=e.getTime(),n=r>-1&&r<2534023188e5;return t.legacy?t.relaxed&&n?{$date:e.getTime()}:{$date:At(e)}:t.relaxed&&n?{$date:At(e)}:{$date:{$numberLong:e.getTime().toString()}}}if("number"==typeof e&&!t.relaxed){if(Math.floor(e)===e){var o=e>=bt&&e<=Et;if(e>=yt&&e<=vt)return{$numberInt:e.toString()};if(o)return{$numberLong:e.toString()}}return{$numberDouble:e.toString()}}if(e instanceof RegExp){var i=e.flags;return void 0===i&&(i=e.toString().match(/[gimuy]*$/)[0]),new Je(e.source,i).toExtendedJSON(t)}return null!=e&&"object"===ce(e)?It(e,t):e}var Ct={Binary:function(e){return new _t(e.value(),e.subtype)},Code:function(e){return new ze(e.code,e.scope)},DBRef:function(e){return new pt(e.collection||e.namespace,e.oid,e.db,e.fields)},Decimal128:function(e){return new ut(e.bytes)},Double:function(e){return new ae(e.value)},Int32:function(e){return new Xe(e.value)},Long:function(e){return ne.fromBits(null!=e.low?e.low:e.low_,null!=e.low?e.high:e.high_,null!=e.low?e.unsigned:e.unsigned_)},MaxKey:function(){return new dt},MinKey:function(){return new lt},ObjectID:function(e){return new Ve(e)},ObjectId:function(e){return new Ve(e)},BSONRegExp:function(e){return new Je(e.pattern,e.options)},Symbol:function(e){return new $e(e.value)},Timestamp:function(e){return pe.fromBits(e.low,e.high)}};function It(e,t){if(null==e||"object"!==ce(e))throw new Error("not an object instance");var r=e._bsontype;if(void 0===r){var n={};for(var o in e)n[o]=wt(e[o],t);return n}if("string"==typeof r){var i=e;if("function"!=typeof i.toExtendedJSON){var s=Ct[r];if(!s)throw new TypeError("Unrecognized or invalid _bsontype: "+r);i=s(i)}return"Code"===r&&i.scope?i=new ze(i.code,wt(i.scope,t)):"DBRef"===r&&i.oid&&(i=new pt(i.collection,wt(i.oid,t),i.db,i.fields)),i.toExtendedJSON(t)}throw new Error("_bsontype must be a string, but was: "+ce(r))}var Ot={parse:gt,deserialize:function(e,t){return t=t||{},gt(JSON.stringify(e),t)},serialize:function(e,t){return t=t||{},JSON.parse(St(e,t))},stringify:St};mt.JS_INT_MAX,mt.JS_INT_MIN;t.EJSON=Ot}).call(this,r("../../node_modules/.pnpm/webpack@4.46.0_webpack-command@0.4.2/node_modules/webpack/buildin/global.js"),r("../../node_modules/.pnpm/buffer@4.9.2/node_modules/buffer/index.js").Buffer)},"@web":function(e,t){e.exports={}}});
  var __sdk__ = Object.assign({
    // private api is not available in cloud: true
    isUsedCache: () => false,
    reportCallContainer: () => {},
    private_getUserAgent: cb => cb(''),
    request: wx.request,
  }, wx)
  __sdk__.wx = __sdk__
  __cloudSDK__.setDefaultSDK(__sdk__)

  var apis = __cloudSDK__.getCloudAPI()
  if (!wx.cloud) {
    wx.cloud = apis
  } else {
    for (var api in apis) {
      wx.cloud[api] = apis[api]
    }
  }

  __sdk__.cloud = wx.cloud
  // wxlib under 2.5.x, using plugins in app.json, property overwrite will not work, this is an escape hatch
  wx.__cloud__ = apis
  var loadEnd = Date.now()
  Object.defineProperty(wx.cloud, 'profile', {
    value: { loadStart, loadEnd },
    configurable: true,
  })
  console.log('using cloud: true (build ts 1685699826199)')
} catch(err) {
  console.error('cloud sdk (build ts 1685699826199) injection failed with error', err)
}
})();
