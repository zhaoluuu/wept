!function(require, directRequire){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.transWXMLToJS=void 0;const tslib_1=require("tslib"),packOptionsHelper_1=tslib_1.__importDefault(require("../../../utils/packOptionsHelper")),appconfig_1=tslib_1.__importDefault(require("../utils/appconfig/appconfig")),checkcustomcomponent_1=require("../utils/appconfig/checkcustomcomponent"),tools_1=require("../utils/tools"),compilewxml_1=require("./wxml/compilewxml");async function transWXMLToJS(e,o,t){packOptionsHelper_1.default.updateState(e);const n=await appconfig_1.default.getAppConfig(e,o),{app:i,page:c}=t;let r;if(!i&&(r=(0,tools_1.checkIsInSubPackage)(n,c),!r))return{code:"",name:"$gwx"};const a=await wxmlToJS(e,o,{appConfig:n,config:r}),{name:l,code:s}=a;return{name:l,code:s}}async function wxmlToJS(e,o,t){try{return await _wxmlToJS(e,o,t)}catch(e){throw formateError(e)}}exports.transWXMLToJS=transWXMLToJS;const COMPILE_WXML_ERROR_CONSOLE="编译 .wxml 文件错误，错误信息如上，可在控制台查看更详细信息",TRANS_WXML_JS_ERR=10040;function formateError(e){const o=new Error(COMPILE_WXML_ERROR_CONSOLE);return o.code=10040,o.msgForConsole=e.message,o}async function _wxmlToJS(e,o,t){const{appConfig:n,config:i}=t,c=await o.getPackageWxmlAndWxsFiles((null==i?void 0:i.root)||"__APP__"),r=packOptionsHelper_1.default.filter(c.wxmlFiles),{wxsFiles:a}=c;let l,s=r.concat(a),p=!1;(null==a?void 0:a.length)>0&&(p=!0),s=s.map(e=>"./"+e),c&&(l=c.content);const u=i?"$"+Buffer.from(i.root).toString("hex"):"$gwx",m=">_<"+Date.now()%1e4,_=(await(0,checkcustomcomponent_1.getWxmlCompileConfig)(e,o,n,i)).join(m);return await(0,compilewxml_1.compileWxml)({files:s,isCut:!1,configSplit:m,configContent:_,hasWxs:p,genfuncName:u,cwd:e.srcPath,replaceContent:l})}
}(require("licia/lazyImport")(require), require)