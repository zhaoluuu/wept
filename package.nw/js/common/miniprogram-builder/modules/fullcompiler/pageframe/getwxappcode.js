!function(require, directRequire){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getPageFrameWxAppCode=exports.getWxAppCodeJsonOfPage=exports.getWxAppCodeWxssOfPage=exports.getWxAppCodeWxmlOfPage=void 0;const tslib_1=require("tslib"),appconfig_1=tslib_1.__importDefault(require("../utils/appconfig/appconfig")),tools_1=require("../../../utils/tools"),checkcustomcomponent_1=require("../utils/appconfig/checkcustomcomponent"),wxappcodejson_1=tslib_1.__importDefault(require("../utils/appconfig/wxappcodejson")),transwxsstojs_1=require("../trans/transwxsstojs"),taskmanager_1=tslib_1.__importDefault(require("../utils/taskmanager"));async function getWxAppCodeWxmlOfPage(e,o,t,s){const p=[],a=encodeURI(t);return p.push(`__wxAppCode__[decodeURI("${a}") + ".wxml"]=${s}("./" + decodeURI("${a}") + ".wxml")`),p}async function getWxAppCodeWxssOfPage(e,o,t){const s=[],p=await(0,transwxsstojs_1.transWXSSToJS)(e,o,{page:t});if(p.page){const e=encodeURI(t);s.push(`__wxAppCode__[decodeURI("${e}") + ".wxss"]=${p.page}`)}return s}async function getWxAppCodeJsonOfPage(e,o,t){const s=[],p=encodeURI(t),a=await(0,wxappcodejson_1.default)(e,o,t);return s.push(`__wxAppCode__[decodeURI("${p}") + ".json"]=${JSON.stringify(a)}`),s}async function getPageFrameWxAppCode(e,o,t={}){const{app:s,page:p}=t;let a,n="$gwx";const g=await appconfig_1.default.getAppConfig(e,o);if(!s){if(a=(0,tools_1.checkIsInSubPackage)(g,p),!a)return"";n="$"+Buffer.from(a.root).toString("hex")}const r=await(0,checkcustomcomponent_1.getFileListJustInPack)(e,o,g,a),c=new taskmanager_1.default;for(let s=0,p=r.length;s<p;s++)t.noJson||c.addTask(getWxAppCodeJsonOfPage,e,o,r[s]),c.addTask(getWxAppCodeWxmlOfPage,e,o,r[s],n),t.noWXSS||c.addTask(getWxAppCodeWxssOfPage,e,o,r[s]);const x=[],d=await c.runAllAsync();for(const e of d)x.push(...e);return x.join("\n")}exports.getWxAppCodeWxmlOfPage=getWxAppCodeWxmlOfPage,exports.getWxAppCodeWxssOfPage=getWxAppCodeWxssOfPage,exports.getWxAppCodeJsonOfPage=getWxAppCodeJsonOfPage,exports.getPageFrameWxAppCode=getPageFrameWxAppCode;
}(require("licia/lazyImport")(require), require)