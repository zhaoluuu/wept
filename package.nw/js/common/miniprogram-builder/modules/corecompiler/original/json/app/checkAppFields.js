!function(require, directRequire){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.checkAccountCardPackage=exports.checkRequiredPrivateInfos=exports.checkResolveAlias=exports.checkRenderer=exports.checkOpenDataContext=exports.getAppJSONVariableDecalearProperty=exports.checkEntranceDeclare=exports.checkComponentPath=exports.checkMainPkgPluginIsInSubPkg=exports.checkMainPkgPageIsInSubpkg=exports.checkTabbarPage=exports.checkEntryPagePath=exports.checkPreloadRule=exports.checkFunctionalPages=exports.checkNavigateToMiniProgramAppIdList=exports.checkPlugins=exports.checkSubpackages=exports.checkSitemapLocation=exports.checkMainPkgPages=exports.checkOpenLocationPagePath=exports.checkWorkers=exports.checkTabbar=exports.checkWindow=exports.checkPageExist=void 0;const tslib_1=require("tslib"),path_1=tslib_1.__importDefault(require("path")),lodash_1=tslib_1.__importDefault(require("lodash")),config_1=require("../../../../../config/config"),common_1=require("../common"),common_2=require("../../../../../utils/common"),tools_1=require("../../../../../utils/tools"),locales_1=tslib_1.__importDefault(require("../../../../../utils/locales/locales")),schemaValidate_1=require("../../validate/schemaValidate"),projectconfig_1=require("../projectconfig");function checkPageExist(o,t,e){const{miniprogramRoot:a,project:n,filePath:c}=o;n.stat(a,t+".wxml")||(0,common_2.throwError)({msg:locales_1.default.config.CORRESPONDING_FILE_NOT_FOUND.format(e,t+".wxml"),code:config_1.FILE_NOT_FOUND,filePath:c}),n.stat(a,t+".js")||(0,common_2.throwError)({msg:locales_1.default.config.CORRESPONDING_FILE_NOT_FOUND.format(e,t+".js"),code:config_1.FILE_NOT_FOUND,filePath:c})}function checkWindow(o){const{inputJSON:t,mode:e}=o;let a=""+o.filePath;t.themeLocation&&(a+=` or ${t.themeLocation}["${e}"]`);const n=[],{window:c}=t;c&&(void 0!==c.navigationBarBackgroundColor&&((0,tools_1.isHexColor)(c.navigationBarBackgroundColor)||n.push(`["window"]["navigationBarBackgroundColor"]: "${c.navigationBarBackgroundColor}" is not hexColor`)),void 0!==c.backgroundColor&&((0,tools_1.isHexColor)(c.backgroundColor)||n.push(`["window"]["backgroundColor"]: "${c.backgroundColor}" is not hexColor`)),n.length>0&&(0,common_2.throwError)({msg:n.join("\n"),filePath:a}))}function checkTabbar(o){const{project:t,miniprogramRoot:e,inputJSON:a,mode:n}=o;let c=""+o.filePath;a.themeLocation&&(c+=` or ${a.themeLocation}["${n}"]`);const{tabBar:i}=a,r=t.attrSync(),{setting:s}=r;if(!i)return;const l=[];i.list.length<s.MinTabbarCount&&(0,common_2.throwError)({msg:locales_1.default.config.JSON_TABBAR_AT_LEAST.format(s.MinTabbarCount),filePath:c});const _=i.custom?s.MaxCustomTabbarCount:s.MaxTabbarCount;i.list.length>_&&(0,common_2.throwError)({msg:locales_1.default.config.JSON_TABBAR_AT_MOST.format(_),filePath:c});for(let o=0;o<i.list.length;o++){const a=i.list[o],{pagePath:n}=a;if((0,common_2.checkPath)({value:n,tips:`["tabBar"]["list"][${o}]["pagePath"]`,filePath:c}),!n){l.push(locales_1.default.config.JSON_TABBAR_PATH_EMPTY.format(o));continue}n.indexOf("?")>=0&&l.push(locales_1.default.config.JSON_SHOULD_NOT_CONTAIN.format(`["tabBar"]["list"][${o}]["pagePath"]`,"?")),n.indexOf(".")>=0&&l.push(locales_1.default.config.JSON_SHOULD_NOT_CONTAIN.format(`["tabBar"]["list"][${o}]["pagePath"]`,"."));const r=i.list.slice(0,o).findIndex(o=>o.pagePath===n);r>=0&&l.push(locales_1.default.config.JSON_TABBAR_PATH_SAME_WITH_OTHER.format(o,r));const _=[];a.iconPath&&((0,common_2.checkPath)({value:a.iconPath,tips:`["tabBar"]["list"][${o}]["iconPath"]`,filePath:c,checkPathType:common_2.ECheckPathType.TAB_BAR_ICON}),_.push({name:"iconPath",path:a.iconPath})),a.selectedIconPath&&((0,common_2.checkPath)({value:a.selectedIconPath,tips:`["tabBar"]["list"][${o}]["selectedIconPath"]`,filePath:c,checkPathType:common_2.ECheckPathType.TAB_BAR_ICON}),_.push({name:"selectedIconPath",path:a.selectedIconPath})),_.forEach(a=>{const n=t.stat(e,a.path);if(!n)return void l.push(locales_1.default.config.NOT_FOUND.format(`["tabBar"]["list"][${o}]["${a.name}"]: "${a.path}"`));if(n.isDirectory)return void l.push(locales_1.default.config.JSON_CONTENT_SHOULD_BE.format(`["tabBar"]["list"][${o}]["${a.name}"]`,locales_1.default.config.FILE));n.size>1024*s.MaxTabbarIconSize&&l.push(locales_1.default.config.JSON_TABBAR_ICON_MAX_SIZE.format([o,a.name,s.MaxTabbarIconSize]));const c=path_1.default.posix.extname(a.path);config_1.TABBAR_ICON_WHITE_LIST.indexOf(c)<0&&l.push(locales_1.default.config.JSON_TABBAR_ICON_EXT.format([o,a.name,config_1.TABBAR_ICON_WHITE_LIST.join("、")]))})}l.length>0&&(0,common_2.throwError)({msg:l.join("\n"),filePath:c})}function checkWorkers(o){const{project:t,miniprogramRoot:e,filePath:a,inputJSON:n}=o,{workers:c}=n;if(void 0===c)return;const i='["workers"]';""===c&&(0,common_2.throwError)({msg:locales_1.default.config.JSON_CONTENT_SHOULD_BE.format(i,locales_1.default.config.DIRECTORY),filePath:a});const r=(0,tools_1.getWorkersPath)(c);(0,common_2.checkPath)({value:r,tips:i,filePath:a});const s=t.stat(e,r);s&&s.isDirectory||(0,common_2.throwError)({msg:locales_1.default.config.JSON_CONTENT_SHOULD_BE.format([i,locales_1.default.config.DIRECTORY]),filePath:a}),"string"==typeof n.workers?n.workers=(0,tools_1.normalizePath)(n.workers+"/"):n.workers.path=(0,tools_1.normalizePath)(n.workers.path+"/")}function checkOpenLocationPagePath(o){const{filePath:t,inputJSON:e}=o,{openLocationPagePath:a}=e;if(void 0===a)return;const n='["openLocationPagePath"]';(0,common_2.checkPath)({value:a,tips:n,filePath:t}),checkPageExist(o,a,n)}exports.checkPageExist=checkPageExist,exports.checkWindow=checkWindow,exports.checkTabbar=checkTabbar,exports.checkWorkers=checkWorkers,exports.checkOpenLocationPagePath=checkOpenLocationPagePath;const checkMainPkgPages=o=>{const{filePath:t,inputJSON:e}=o,{pages:a}=e;if(!a)return;const n={};for(let e=0;e<a.length;e++){const c=a[e],i=`["pages"][${e}]`;(0,common_2.checkPath)({value:c,tips:i,filePath:t}),n[c]&&(0,common_2.throwError)({msg:locales_1.default.config.JSON_PAGES_REPEAT.format(`"${c}"`,'["pages"]'),filePath:t}),n[c]=!0,checkPageExist(o,c,i)}};function checkSitemapLocation(o){const{filePath:t,inputJSON:e}=o,{sitemapLocation:a}=e;if(void 0===a)return;const{project:n,miniprogramRoot:c}=o,i='["sitemapLocation"]';(0,common_2.checkPath)({value:a,tips:i,filePath:t});const r=n.stat(c,a);r&&!r.isDirectory||(0,common_2.throwError)({msg:locales_1.default.config.CORRESPONDING_FILE_NOT_FOUND.format(i,a),filePath:t});".json"!==path_1.default.posix.extname(a)&&(0,common_2.throwError)({msg:locales_1.default.config.EXT_SHOULD_BE_ERROR.format(i,".json"),filePath:t});const s=n.getFile(c,a),l=(0,common_2.checkUTF8)(s,a),_=(0,common_1.checkJSONFormat)(l,a),f=(0,schemaValidate_1.schemaValidate)("sitemap",_);(0,schemaValidate_1.transValidateResult)(a,f)}function checkSubpackages(o){const{project:t,miniprogramRoot:e,filePath:a,inputJSON:n}=o;let c='["subPackages"]';n.subpackages&&(c='["subpackages"]',n.subPackages=n.subpackages,delete n.subpackages);const i=[];if(n.subPackages){const r=t.attrSync(),{setting:s}=r;n.subPackages.length>s.MaxSubPackageLimit&&(0,common_2.throwError)({msg:locales_1.default.config.EXCEED_LIMIT.format([c,s.MaxSubPackageLimit]),filePath:a});const l={},_={};for(let r=0;r<n.subPackages.length;r++){const s=n.subPackages[r],f=`${c}[${r}]`;if((0,common_2.checkPath)({value:s.root,tips:`${c}[${r}]["root"]`,filePath:a}),s.root===config_1.MINI_PROGRAM_MAIN_PACKAGE_ROOT){i.push(locales_1.default.config.JSON_CONTENT_SHOULD_NOT_BE.format(`${c}[${r}]["root"]`,config_1.MINI_PROGRAM_MAIN_PACKAGE_ROOT));continue}if(s.name){if(s.name===config_1.MINI_PROGRAM_MAIN_PACKAGE_ROOT){i.push(locales_1.default.config.JSON_CONTENT_SHOULD_NOT_BE.format(`${c}[${r}]["name"]`,config_1.MINI_PROGRAM_MAIN_PACKAGE_ROOT));continue}if(_[s.name]){i.push(locales_1.default.config.SAME_ITEM.format(f,_[s.name],"name"));continue}_[s.name]=f}if(s.root=(0,tools_1.normalizePath)(s.root+"/"),l[s.root]){i.push(locales_1.default.config.SAME_ITEM.format(f,l[s.root],"root"));continue}l[s.root]=f;const h=t.stat(e,s.root);if(!h){i.push(locales_1.default.config.JSON_CONTENT_SHOULD_BE.format([`${c}[${r}]["root"]`,locales_1.default.config.DIRECTORY]));continue}if(!h.isDirectory){i.push(locales_1.default.config.JSON_CONTENT_SHOULD_BE.format([`${c}[${r}]["root"]`,locales_1.default.config.DIRECTORY]));continue}const g={};for(let t=0,e=s.pages.length;t<e;t++){const e=s.pages[t];(0,common_2.checkPath)({value:e,tips:`${c}[${r}]["pages"][${t}]`,filePath:a});const n=(0,tools_1.normalizePath)(path_1.default.posix.join(s.root,e));g[n]?i.push(locales_1.default.config.JSON_PAGES_REPEAT.format([`"${e}"`,`${c}[${r}]`])):(g[n]=!0,checkPageExist(o,n,`${c}[${r}]["pages"][${t}]`))}}i.length>0&&(0,common_2.throwError)({msg:i.join("\n"),filePath:a});for(let o=0;o<n.subPackages.length;o++){const t=n.subPackages[o];let e=-1;const a="/"+t.root;n.subPackages.forEach((t,n)=>{if(n!==o&&t.root){const o="/"+t.root;a.startsWith(o)&&(e=n)}}),-1===e||i.push(locales_1.default.config.JSON_SHOULD_NOT_CONTAIN.format(`${c}[${e}]["root"]`,`${c}[${o}]["root"]`))}i.length>0&&(0,common_2.throwError)({msg:i.join("\n"),filePath:a})}}function checkPlugins(o){const{filePath:t,inputJSON:e,project:a}=o,n=[],c=e.plugins||{},i=(0,projectconfig_1.getProjectConfigJSON)(a),r=(null==i?void 0:i.pluginAppid)||a.appid;function s(o,t){const e=a.type===config_1.COMPILE_TYPE.miniProgramPlugin;if(e||"dev"!==o.version)if(e)"dev"===o.version&&o.provider!==r?n.push(locales_1.default.config.JSON_CONTENT_SHOULD_BE.format(t+'["provider"]',`"${r}"`)):o.provider===r&&"dev"!==o.version&&n.push(locales_1.default.config.JSON_CONTENT_SHOULD_BE.format(t+'["version"]','"dev"'));else{if("dev"===o.version||"latest"===o.version||/^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}$/.test(o.version)||/^dev-[A-Za-z0-9]+$/.test(o.version))return!0;n.push(locales_1.default.config.JSON_CONTENT_SHOULD_BE.format([t+'["version"]',locales_1.default.config.TRIPLE_NUMBER_DOT]))}else n.push(`${locales_1.default.config.JSON_CONTENT_SHOULD_NOT_BE.format(t+'["version"]',"dev")}\n${locales_1.default.config.PLEASE_CHOOSE_PLUGIN_MODE}`)}for(const o in c){s(c[o],`["plugins"]["${o}"]`)}e.subPackages&&e.subPackages.forEach((o,t)=>{if(!o.plugins)return;const e=`["subPackages"][${t}]`;for(const t in o.plugins){s(o.plugins[t],`${e}["plugins"]["${t}"]`)}}),n.length>0&&(0,common_2.throwError)({msg:n.join("\n"),filePath:t})}function checkNavigateToMiniProgramAppIdList(o){const{filePath:t,inputJSON:e,project:a}=o,n=[];if(e.navigateToMiniProgramAppIdList){const o=a.attrSync(),{appType:t=config_1.APP_TYPE.NORMAL,setting:c}=o;if(t!==config_1.APP_TYPE.NATIVE){const o=null==c?void 0:c.NavigateMiniprogramLimit;e.navigateToMiniProgramAppIdList.length>o&&n.push(locales_1.default.config.EXCEED_LIMIT.format('["navigateToMiniProgramAppIdList"]',o))}}n.length>0&&(0,common_2.throwError)({msg:n.join("\n"),filePath:t})}function checkFunctionalPages(o){const{inputJSON:t}=o;if(t.functionalPages&&"object"!==(0,tools_1.getType)(t.functionalPages)){const o='["functionalPages"] 配置需要更新，详见文档: https://developers.weixin.qq.com/miniprogram/dev/framework/plugin/functional-pages.html';t.__warning__?t.__warning__=`${t.__warning__}\n${o}`:t.__warning__=o}}function checkPreloadRule(o,t){const{inputJSON:e,filePath:a}=o,{preloadRule:n,subPackages:c}=e;if(!n||!c)return;const i=[],r={},s={},l={};t.forEach(o=>{r[o.root]=!0,l[o.path]=!0,o.name&&(s[o.name]=!0)});for(const o in n){if(!l[o]&&!o.includes("__plugin__/")){i.push(locales_1.default.config.NOT_FOUND.format(`["preloadRule"]["${o}"]: ${locales_1.default.config.PAGE_PATH}`));continue}const t=n[o];for(let e=0,a=t.packages.length;e<a;e++){let a=t.packages[e];a!==config_1.MINI_PROGRAM_MAIN_PACKAGE_ROOT&&(s[a]||(a=(0,tools_1.normalizePath)(a+"/"),r[a]||i.push(locales_1.default.config.NOT_FOUND.format(`["preloadRule"]["${o}"]["packages"][${e}]: ${a}`))))}}i.length>0&&(0,common_2.throwError)({msg:i.join("\n"),filePath:a})}function checkEntryPagePath(o,t){const{inputJSON:e,filePath:a}=o,{entryPagePath:n}=e;if(!n)return;(0,common_2.checkPath)({value:n,tips:'["entryPagePath"]',filePath:a});let c=!1;for(const o of t)if(o.path===n){c=!0;break}c||(0,common_2.throwError)({msg:locales_1.default.config.JSON_ENTRY_PAGE_PATH_NOT_FOUND.format(["pages、subPackages","entryPagePath"]),filePath:a})}function checkTabbarPage(o){const{filePath:t,inputJSON:e}=o,{tabBar:a,pages:n=[]}=e;if(!a)return;const c=[];for(let o=0;o<a.list.length;o++){const t=a.list[o],{pagePath:e}=t;n.indexOf(e)<0&&c.push(`["tabBar"][${o}]["pagePath"]: "${e}" need in ["pages"]`)}c.length>0&&(0,common_2.throwError)({msg:c.join("\n"),filePath:t})}function checkMainPkgPageIsInSubpkg(o){const{filePath:t,inputJSON:e}=o,{subPackages:a,pages:n=[]}=e;if(!a)return;const c=[];for(let o=0;o<a.length;o++){const t=a[o];for(let e=0;e<n.length;e++){const a=n[e];a.startsWith(t.root)&&c.push(locales_1.default.config.SHOULD_NOT_IN.format([`["pages"][${e}]: "${a}"`,`["subPackages"][${o}]`]))}}c.length>0&&(0,common_2.throwError)({msg:c.join("\n"),filePath:t})}function checkMainPkgPluginIsInSubPkg(o){const{filePath:t,inputJSON:e}=o,{plugins:a={},subPackages:n}=e,c={},i={},r=[];for(const o in a){const t=a[o],e=`["plugins"]["${o}"]`;c[t.provider]?r.push(locales_1.default.config.SAME_ITEM.format(`["plugins"]["${o}"]`,c[t.provider].tips,"provider")):c[t.provider]=i[o]={provider:t.provider,version:t.version,alias:o,tips:e}}if(n)for(let o=0;o<n.length;o++){const t=n[o];if(t.plugins)for(const e in t.plugins){const a=`["subPackages"][${o}]["plugins"]`,n=t.plugins[e];c[n.provider]?r.push(locales_1.default.config.SAME_ITEM.format(`${a}["${e}"]`,c[n.provider].tips,"provider")):i[e]?r.push(locales_1.default.config.PLUGINS_SAME_ALIAS.format(`${a}["${e}"]`,i[e].tips)):c[n.provider]=i[e]={provider:n.provider,version:n.version,alias:n,tips:a}}}r.length>0&&(0,common_2.throwError)({msg:r.join("\n"),filePath:t})}function checkComponentPath(o){const{project:t,miniprogramRoot:e,filePath:a,inputJSON:n}=o;(0,common_1.checkComponentPath)({project:t,root:e,relativePath:path_1.default.posix.relative(e,a),inputJSON:n})}function checkEntranceDeclare(o){const t=o.inputJSON;if(!t.entranceDeclare||!t.entranceDeclare.locationMessage)return;let e=t.pages||[];t.subpackages&&(e=e.concat(t.subpackages.map(o=>o.pages.map(t=>o.root+t))),e=lodash_1.default.flattenDeep(e)),t.subPackages&&(e=e.concat(t.subPackages.map(o=>o.pages.map(t=>o.root+t))),e=lodash_1.default.flattenDeep(e));const a=[],n=t.entranceDeclare.locationMessage.path;void 0===n?a.push(locales_1.default.config.JSON_ENTRANCE_DECLARE_PATH_EMPTY.format([])):e.includes(n)||a.push(locales_1.default.config.JSON_ENTRANCE_DECLARE_PATH_ERR.format([n||"undefined"])),a.length>0&&(0,common_2.throwError)({msg:a.join("\n"),filePath:o.filePath})}function getAppJSONVariableDecalearProperty(o){const{windowPropertWhiteList:t,tabBarPropertyWhiteList:e,tabbarListItemPropertyWhiteList:a}=config_1.jsonVariablePropertyWhiteList;let n=[];return"[object Object]"===Object.prototype.toString.call(o.window)&&(n=n.concat(Object.keys(o.window).filter(o=>t.includes(o)).map(t=>({property:`["window"]["${t}"]`,value:o.window[t]})).filter(o=>"string"==typeof o.value&&o.value.startsWith("@")))),"[object Object]"===Object.prototype.toString.call(o.tabBar)&&(n=n.concat(Object.keys(o.tabBar).filter(o=>e.includes(o)).map(t=>({property:`["tabBar"]["${t}"]`,value:o.tabBar[t]})).filter(o=>"string"==typeof o.value&&o.value.startsWith("@"))),Array.isArray(o.tabBar.list)&&o.tabBar.list.forEach((t,e)=>{n=n.concat(Object.keys(t).filter(o=>a.includes(o)).map(t=>({property:`["tabBar"]["list"][${e}]["${t}"]`,value:o.tabBar.list[e][t]})).filter(o=>"string"==typeof o.value&&o.value.startsWith("@")))})),n}function checkOpenDataContext(o,t){const{project:e,miniprogramRoot:a,filePath:n}=o,{openDataContext:c}=t;if(void 0===c)return;(0,common_2.checkPath)({value:c,tips:'["openDataContext"]',filePath:n});const i=e.stat(a,c);i&&i.isDirectory||(0,common_2.throwError)({msg:locales_1.default.config.JSON_CONTENT_SHOULD_BE.format(['["openDataContext"]',locales_1.default.config.DIRECTORY]),filePath:n});const r=path_1.default.posix.join(c,"./index.js"),s=e.stat(a,r);s&&s.isFile||(0,common_2.throwError)({msg:locales_1.default.config.CORRESPONDING_FILE_NOT_FOUND.format('["openDataContext"]',r),filePath:n}),t.openDataContext=(0,tools_1.normalizePath)(c+"/")}function checkRenderer(o){var t,e,a,n;const{filePath:c,inputJSON:i}=o,{renderer:r,lazyCodeLoading:s,rendererOptions:l}=i;if("skyline"===r&&"requiredComponents"!==s&&(0,common_2.throwError)({msg:locales_1.default.config.APP_JSON_SHOULD_SET_LAZYCODELOADING.format("app.json"),filePath:c}),"skyline"===r&&(void 0===l?(0,common_2.throwError)({msg:locales_1.default.config.JSON_SHOULD_SET_RENDEREROPTIONS.format("app.json"),filePath:c}):void 0===l.skyline&&(0,common_2.throwError)({msg:locales_1.default.config.JSON_SHOULD_SET_RENDEREROPTIONS_SKYLINE.format("app.json"),filePath:c})),"skyline"===r||(null==l?void 0:l.skyline)){const o=(null===(t=i.window)||void 0===t?void 0:t.navigationBarTextStyle)||(null===(e=i.window)||void 0===e?void 0:e.navigationBarTitleText)||(null===(a=i.window)||void 0===a?void 0:a.navigationBarBackgroundColor),c="custom"===(null===(n=i.window)||void 0===n?void 0:n.navigationStyle);if(o&&!c){const o=locales_1.default.config.APP_JSON_SKYLINE_WINDOW_TIPS.format("");i.__warning__?i.__warning__=`${i.__warning__}\n${o}`:i.__warning__=o}}}function checkResolveAlias(o){const{filePath:t,inputJSON:e}=o,{resolveAlias:a}=e;if(a){const o=o=>o.includes("//");for(const e in a)(o(e)||o(a[e]))&&(0,common_2.throwError)({msg:locales_1.default.config.JSON_RESOLVE_ALIAS_ILLEGAL.format(e,a[e]),filePath:t}),a[e].startsWith("./")&&(0,common_2.throwError)({msg:locales_1.default.config.JSON_RESOLVE_ALIAS_SHOULD_NOT_START_WITH.format(a[e]),filePath:t}),e.endsWith("/*")&&a[e].endsWith("/*")||(0,common_2.throwError)({msg:locales_1.default.config.JSON_RESOLVE_ALIAS_INCLUDE_STAR.format(e,a[e]),filePath:t})}}exports.checkMainPkgPages=checkMainPkgPages,exports.checkSitemapLocation=checkSitemapLocation,exports.checkSubpackages=checkSubpackages,exports.checkPlugins=checkPlugins,exports.checkNavigateToMiniProgramAppIdList=checkNavigateToMiniProgramAppIdList,exports.checkFunctionalPages=checkFunctionalPages,exports.checkPreloadRule=checkPreloadRule,exports.checkEntryPagePath=checkEntryPagePath,exports.checkTabbarPage=checkTabbarPage,exports.checkMainPkgPageIsInSubpkg=checkMainPkgPageIsInSubpkg,exports.checkMainPkgPluginIsInSubPkg=checkMainPkgPluginIsInSubPkg,exports.checkComponentPath=checkComponentPath,exports.checkEntranceDeclare=checkEntranceDeclare,exports.getAppJSONVariableDecalearProperty=getAppJSONVariableDecalearProperty,exports.checkOpenDataContext=checkOpenDataContext,exports.checkRenderer=checkRenderer,exports.checkResolveAlias=checkResolveAlias;const detailLocationApis={getLocation:!0,onLocationChange:!0,startLocationUpdate:!0,startLocationUpdateBackground:!0};function checkRequiredPrivateInfos(o){const{filePath:t,inputJSON:e}=o,{requiredPrivateInfos:a}=e;if(a){if(a.indexOf("getFuzzyLocation")>=0){const o=[];for(let t=0;t<a.length;t++){const e=a[t];detailLocationApis[e]&&o.push(`'${e}'`)}o.length>0&&(0,common_2.throwError)({msg:locales_1.default.config.JSON_REQUIRED_PRIVATE_INFOS_MUTUALLY_EXCLUSIVE.format("'getFuzzyLocation'",o.join("、")),filePath:t})}}}function checkAccountCardPackage(o){const{project:t,filePath:e,inputJSON:a,miniprogramRoot:n}=o,{accountCardPackage:c}=a;if(c){c.root=(0,tools_1.normalizePath)(c.root+"/");const o=a.subPackages||a.subpackages||[];console.log("subPackages",o),o.find(o=>o.root===c.root&&o.independent)||(0,common_2.throwError)({msg:locales_1.default.config.ACCOUNT_CARD_PACKAPGE_IN_VALID.format(),filePath:e});for(const o of c.cardList){const{componentPath:a}=o,i=path_1.default.posix.join(c.root,a+".js");t.stat(n,path_1.default.posix.join(c.root,a+".js"))||(0,common_2.throwError)({msg:locales_1.default.config.CORRESPONDING_FILE_NOT_FOUND.format('["accountCardPackage"]',i),code:config_1.FILE_NOT_FOUND,filePath:e})}}}exports.checkRequiredPrivateInfos=checkRequiredPrivateInfos,exports.checkAccountCardPackage=checkAccountCardPackage;
}(require("licia/lazyImport")(require), require)