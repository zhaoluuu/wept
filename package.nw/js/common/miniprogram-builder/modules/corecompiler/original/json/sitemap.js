!function(require, directRequire){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getSiteMapJSON=void 0;const tslib_1=require("tslib"),path_1=tslib_1.__importDefault(require("path")),tools_1=require("../../../../utils/tools"),common_1=require("../../../../utils/common"),schemaValidate_1=require("../validate/schemaValidate"),cache_1=require("../../../../utils/cache"),config_1=require("../../../../config/config"),reactiveCache_1=require("./reactiveCache"),common_2=require("./common"),projectconfig_1=require("./projectconfig"),appJSON_1=require("./app/appJSON");exports.getSiteMapJSON=(0,reactiveCache_1.wrapCompileJSONFunc)(cache_1.CACHE_KEY.SITE_MAP_JSON,e=>{const t=(0,projectconfig_1.getProjectConfigJSON)(e),i=(0,appJSON_1.getAppJSON)(e),{sitemapLocation:o=""}=i;let a=o;if(a)a=(0,tools_1.normalizePath)(path_1.default.posix.join(t.miniprogramRoot||"",a));else{if(a=(0,tools_1.normalizePath)(path_1.default.posix.join(t.miniprogramRoot||"","sitemap.json")),!e.stat("",a))return e.type,config_1.COMPILE_TYPE.miniProgramPlugin,{desc:"",rules:[{action:"disallow",page:"*"}]}}const r=e.getFile("",a),c=(0,common_1.checkUTF8)(r,a),s=(0,common_2.checkJSONFormat)(c,a),p=(0,schemaValidate_1.schemaValidate)("sitemap",s);return(0,schemaValidate_1.transValidateResult)(a,p),s});
}(require("licia/lazyImport")(require), require)