!function(require, directRequire){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.runSubProcess=void 0;let exitTimer,inited=!1;function setExitTimer(e=6e4){-1!==e&&(clearTimeout(exitTimer),exitTimer=setTimeout(()=>{process.exit(0)},e))}function processOnMessageFactory(e){return async s=>{if("object"!=typeof s)return void console.error("child process unrecognized message "+s);const{initHandler:o,messageHandler:r}=e;if("init"===s.type){if(inited)return void console.error("native compiler has been inited");try{await o(s),inited=!0,process.send({type:"ready"})}catch(e){process.send({type:"noReady",error:{code:e.code||-1,message:e.message,stack:e.stack,path:e.path||""}}),process.exit(-1e3)}}else inited||console.error("compiler not inited yet"),await r(s);setExitTimer(e.timeout)}}function runSubProcess(e){process.on("message",processOnMessageFactory(e)),process.on("disconnect",()=>{try{process.exit(0)}catch(e){process.kill(process.pid,"SIGTERM")}}),process.on("uncaughtException",e=>{console.log(e)})}exports.runSubProcess=runSubProcess;
}(require("licia/lazyImport")(require), require)