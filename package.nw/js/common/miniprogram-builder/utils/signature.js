!function(require, directRequire){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.aesDecrypt=exports.aesEncrypt=exports.checkFileMd5Signature=exports.checkSignature=exports.checkBufferSignature=exports.generateMd5=void 0;const fs=require("fs"),crypto=require("crypto"),PUBLIKEY="-----BEGIN PUBLIC KEY-----\nMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCZm2cFP/uF81V5KH/B9dn/g7WA\nCM3yu0P7n9sm/O6c58HTYI0+xugCfwMuoX7hyU4jkWbZ/BYK7IgWhmVfiRtgomJe\nwuZlxfGUpmrr1PA2KbYVpPW0V6e/2uZu1Ev3xU7PkHKYf4AKgPO8w98hvKlUJRbk\nH4AYMxX6eL9j9qCBGQIDAQAB\n-----END PUBLIC KEY-----";function generateMd5(e){const r=crypto.createHash("md5");r.update(e);return r.digest("hex")}function checkBufferSignature(e,r,t){if(!r)return!1;return checkSignature(generateMd5(e),r,t)}function checkSignature(e,r,t){if(!r)return!1;const c=Buffer.from(r,"base64"),n=crypto.createVerify("RSA-SHA1");return n.update(e),!!n.verify(t||PUBLIKEY,c)}function checkFileMd5Signature(e,r,t){return checkBufferSignature(fs.readFileSync(e),r,t)}function aesEncrypt(e){const{data:r,key:t,iv:c,algorithm:n}=e,a=crypto.createCipheriv(n||"aes-128-cbc",t,c);let u=a.update(r,"utf8","binary");return u+=a.final("binary"),u=Buffer.from(u,"binary").toString("base64"),u}function aesDecrypt(e){const{key:r,iv:t,algorithm:c}=e,n=Buffer.from(e.data,"base64").toString("binary"),a=crypto.createDecipheriv(c||"aes-128-cbc",r,t);let u=a.update(n,"binary","utf8");return u+=a.final("utf8"),u}exports.generateMd5=generateMd5,exports.checkBufferSignature=checkBufferSignature,exports.checkSignature=checkSignature,exports.checkFileMd5Signature=checkFileMd5Signature,exports.aesEncrypt=aesEncrypt,exports.aesDecrypt=aesDecrypt;
}(require("licia/lazyImport")(require), require)