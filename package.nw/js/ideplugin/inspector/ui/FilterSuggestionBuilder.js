import{Suggestions}from"./SuggestBox.js";export class FilterSuggestionBuilder{constructor(e,s){this._keys=e,this._valueSorter=s||((e,s)=>s.sort()),this._valuesMap=new Map}completions(e,s,t){if(!s&&!t)return Promise.resolve([]);const r=s.startsWith("-");r&&(s=s.substring(1));const o=r?"-":"",i=s.indexOf(":"),a=[];if(-1===i){const e=new RegExp("^"+s.escapeForRegExp(),"i");for(const s of this._keys)e.test(s)&&a.push({text:o+s+":"})}else{const e=s.substring(0,i).toLowerCase(),t=s.substring(i+1),r=new RegExp("^"+t.escapeForRegExp(),"i"),n=Array.from(this._valuesMap.get(e)||new Set);this._valueSorter(e,n);for(const s of n)r.test(s)&&s!==t&&a.push({text:o+e+":"+s})}return Promise.resolve(a)}addItem(e,s){if(!s)return;let t=this._valuesMap.get(e);t||(t=new Set,this._valuesMap.set(e,t)),t.add(s)}clear(){this._valuesMap.clear()}}