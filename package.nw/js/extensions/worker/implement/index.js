(()=>{"use strict";var e={6366:(e,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.INativeWorkerOnMessageType=r.INativeWorkerPushMessageType=void 0,function(e){e[e.Run=0]="Run",e[e.InitWorker=1]="InitWorker",e[e.TriggerOnMessage=2]="TriggerOnMessage",e[e.InvokeJS=3]="InvokeJS",e[e.TriggerOnEvent=4]="TriggerOnEvent"}(r.INativeWorkerPushMessageType||(r.INativeWorkerPushMessageType={})),function(e){e.WeixinWorkerInvoke="WeixinWorkerInvoke"}(r.INativeWorkerOnMessageType||(r.INativeWorkerOnMessageType={}))},6488:(e,r)=>{function t(e){return new Int32Array(e).reduce(((e,r)=>e+String.fromCharCode(r)),"")}function n(e){let r="";const t=new Uint8Array(e),n=t.byteLength;for(let e=0;e<n;e++)r+=String.fromCharCode(t[e]);return __global.btoa(r)}Object.defineProperty(r,"__esModule",{value:!0}),r.coverRes=r.isSyncSDK=r.arrayBufferToBase64=r.int32Array2Str=r.str2Int32Array=r.str2ab=r.ab2str=void 0,r.ab2str=t,r.str2ab=function(e){const r=new ArrayBuffer(4*e.length),t=new Int32Array(r);for(let r=0,n=e.length;r<n;r++)t[r]=e.charCodeAt(r);return r},r.str2Int32Array=function(e){const r=new ArrayBuffer(4*e.length),t=new Int32Array(r);for(let r=0,n=e.length;r<n;r++)t[r]=e.charCodeAt(r);return t},r.int32Array2Str=function(e,r,n=1){const o=e.load(r,1),a=new ArrayBuffer(4*o),s=new Int32Array(a);for(let t=n;t<o+n;t++){const o=e.load(r,t);s[t-n]=o}return t(a)},r.arrayBufferToBase64=n;const o={getSystemInfo:!0,getBackgroundAudioState:!0,setBackgroundAudioState:!0,operateBackgroundAudio:!0,createRequestTask:!0,createUploadTask:!0,createDownloadTask:!0,createSocketTask:!0,operateSocketTask:!0,createAudioInstance:!0,unlink:!0};r.isSyncSDK=function(e){return!!o[e]||/Sync$/.test(e)},r.coverRes=function(e){for(const t in e)if(r=e[t],"[object ArrayBuffer]"===Object.prototype.toString.call(r)){const r=n(e[t]);e.__nativeBuffers__=[{key:t,base64:r}],delete e[t]}var r;return e}}},r={};function t(n){var o=r[n];if(void 0!==o)return o.exports;var a=r[n]={exports:{}};return e[n](a,a.exports,t),a.exports}(()=>{const e=t(6366),r=t(6488);!function(t){const n=t.postMessage,o=t.eval,a=t.Atomics,s=t._console=t.console,i={create:r=>{n({type:e.INativeWorkerOnMessageType.WeixinWorkerInvoke,method:"create",arguments:[t.WeixinWorker.__workerId__,r]})},terminate:r=>{n({type:e.INativeWorkerOnMessageType.WeixinWorkerInvoke,method:"terminate",arguments:[t.WeixinWorker.__workerId__,r]})},postMsgToWorker:(r,o)=>{n({type:e.INativeWorkerOnMessageType.WeixinWorkerInvoke,method:"postMsgToWorker",arguments:[t.WeixinWorker.__workerId__,r,o]})},postMsgToAppService:r=>{try{"string"==typeof r&&(r=JSON.parse(r)),n({type:e.INativeWorkerOnMessageType.WeixinWorkerInvoke,method:"postMsgToAppService",arguments:[i.__workerId__,r]})}catch(e){s.error("send msg to appservice error: ",e)}}};t.WeixinWorker=i;let c,k,d=[];const u=t,g=t.XMLHttpRequest,p=t.importScripts,v=function(e){const r=`../__dev__/${e}?appendSurceURL=${e}`;if("function"==typeof p)return void p(r);const t=new g;t.open("GET",r,!1),t.send(),200===t.status?o(`${t.responseText}\n //# sourceURL=${r}`):s.error("loadLibCodeSync error: ",t.status)};t.onmessage=r=>{var n;if(r.data)switch(r.data.type){case e.INativeWorkerPushMessageType.InitWorker:i.__workerId__=r.data.__workerId__,d=(null===(n=r.data.options)||void 0===n?void 0:n.APIList)||[],c=r.data.sab,c&&(k=new Int32Array(c)),r.data.wxLibWorker&&(null==u?void 0:u.__initWorkerWithLib)&&(u.__initWorkerWithLib(v.bind(u),u),delete u.__initWorkerWithLib);break;case e.INativeWorkerPushMessageType.Run:o(r.data.code);break;case e.INativeWorkerPushMessageType.TriggerOnMessage:t.WeixinWorker.appServiceMsgHandler(r.data.msg);break;case e.INativeWorkerPushMessageType.InvokeJS:{const e=JSON.stringify(r.data.data||{}),t=r.data.callbackId;void 0!==t&&o(`WeixinJSBridge.invokeCallbackHandler(${t}, ${e})`);break}case e.INativeWorkerPushMessageType.TriggerOnEvent:{const{eventName:e,data:t}=r.data;o(`WeixinJSBridge.subscribeHandler('${e}', ${JSON.stringify(t||{})})`)}}},t.workerInvokeJsApi=(t,c,u)=>{if(!d.includes(t))return s.warn(`[worker] ${t}:fail not support`),{errMsg:`${t}:fail not support`};if("string"==typeof c&&(c=JSON.parse(c)),n({type:e.INativeWorkerOnMessageType.WeixinWorkerInvoke,method:"invokeJS",api:t,args:c,callbackId:u,__workerId__:i.__workerId__}),r.isSyncSDK(t)&&k){a.wait(k,0,0);const e=r.int32Array2Str(a,k,2);return o(`WeixinJSBridge.invokeCallbackHandler(${u}, ${e})`),a.store(k,0,0),a.store(k,1,0),JSON.parse(e)}}}(self)})()})();
//# sourceURL=ide:///extensions/worker/implement/index.js