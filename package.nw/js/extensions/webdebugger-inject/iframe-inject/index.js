(()=>{"use strict";var e={8422:e=>{const t=window.navigator||window.__global.navigator,s=window.WebSocket||window.__global.WebSocket,o=window.prompt||window.__global.prompt,n=t.userAgent.match(/port\/(\d*)/),a=n?parseInt(n[1]):9974,i=`ws://127.0.0.1:${a}`;window.__maxConnectTryTime=10;e.exports=class{constructor(e,t=!0){this._protocol=e,this._needToken=t,this._ws=null,this._msgQueue=[],this._callback=new Set,this._parseJson=null,this.tryTime=0,"complete"===document.readyState?setTimeout((()=>{this.connect()})):window.addEventListener("load",(()=>{this.connect()}))}connect(){if(!a)return;if(this.tryTime++,this.tryTime>=window.__maxConnectTryTime)return void console.error("当前应用通道断开且重连次数已满，请重新编译应用");let e=this._protocol;if(this._needToken){e=`${e}#${o("GET_MESSAGE_TOKEN")}#`}this._ws=new s(i,e),this._ws.onopen=()=>{const e=[].concat(this._msgQueue);this._msgQueue=[],e.forEach((e=>{this.send(e)}))},this._ws.onclose=()=>{this._ws=null,setTimeout((()=>{this.connect()}),150)},this._ws.onmessage=e=>{try{const t=this._parseJson?this._parseJson(e.data):JSON.parse(e.data);this._callback.forEach((e=>{try{e.call(this,t)}catch(e){console.error("onmessage",e)}}))}catch(e){console.error("onmessage",e)}}}send(e){this._ws&&this._ws.readyState===s.OPEN?this._ws.send(JSON.stringify(e)):this._msgQueue.push(e)}registerCallback(e){"function"==typeof e&&this._callback.add(e)}removeCallback(e){this._callback.delete(e)}}},8253:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=s(8422),n=navigator.userAgent.match(/webview\/([\w]*)/),a=n?n[1]:"",i=`${Date.now()}${Math.floor(1e4*Math.random())}`;let r;const c=()=>{if(r)return r;return r=new o(`JSCOREWEBVIEW_${i}`),r};t.default={send(e){e.webviewID=a,e.runtimeID=i;c().send(e)},registerCallback(e){c().registerCallback(e)}}}},t={};function s(o){var n=t[o];if(void 0!==n)return n.exports;var a=t[o]={exports:{}};return e[o](a,a.exports,s),a.exports}(()=>{const e=s(8253);!function(t){t.__wxtag={sendMessage:(t,s)=>{e.default.send({command:"IFRAME_TO_JSCORE",data:{comptName:t,message:s}})}}}(self)})()})();
//# sourceURL=ide:///extensions/webdebugger-inject/iframe-inject/index.js